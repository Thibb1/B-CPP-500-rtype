\hypertarget{binary__writer_8hpp_source}{}\doxysection{binary\+\_\+writer.\+hpp}
\label{binary__writer_8hpp_source}\index{build/\_deps/json-\/src/include/nlohmann/detail/output/binary\_writer.hpp@{build/\_deps/json-\/src/include/nlohmann/detail/output/binary\_writer.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//     \_\_ \_\_\_\_\_ \_\_\_\_\_ \_\_\_\_\_}}
\DoxyCodeLine{2 \textcolor{comment}{//  \_\_|  |   \_\_|     |   | |  JSON for Modern C++}}
\DoxyCodeLine{3 \textcolor{comment}{// |  |  |\_\_   |  |  | | | |  version 3.11.2}}
\DoxyCodeLine{4 \textcolor{comment}{// |\_\_\_\_\_|\_\_\_\_\_|\_\_\_\_\_|\_|\_\_\_|  https://github.com/nlohmann/json}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2013-\/2022 Niels Lohmann <https://nlohmann.me>}}
\DoxyCodeLine{7 \textcolor{comment}{// SPDX-\/License-\/Identifier: MIT}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <algorithm>} \textcolor{comment}{// reverse}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <array>} \textcolor{comment}{// array}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <map>} \textcolor{comment}{// map}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <cmath>} \textcolor{comment}{// isnan, isinf}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <cstdint>} \textcolor{comment}{// uint8\_t, uint16\_t, uint32\_t, uint64\_t}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <cstring>} \textcolor{comment}{// memcpy}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <limits>} \textcolor{comment}{// numeric\_limits}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <string>} \textcolor{comment}{// string}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <utility>} \textcolor{comment}{// move}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <vector>} \textcolor{comment}{// vector}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <nlohmann/detail/input/binary\_reader.hpp>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <nlohmann/detail/macro\_scope.hpp>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <nlohmann/detail/output/output\_adapters.hpp>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <nlohmann/detail/string\_concat.hpp>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 NLOHMANN\_JSON\_NAMESPACE\_BEGIN}
\DoxyCodeLine{28 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacedetail}{detail}}}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{32 \textcolor{comment}{// binary writer //}}
\DoxyCodeLine{34 \textcolor{comment}{}}
\DoxyCodeLine{38 \textcolor{keyword}{template}<\textcolor{keyword}{typename} BasicJsonType, \textcolor{keyword}{typename} CharType>}
\DoxyCodeLine{39 \textcolor{keyword}{class }\mbox{\hyperlink{classdetail_1_1binary__writer}{binary\_writer}}}
\DoxyCodeLine{40 \{}
\DoxyCodeLine{41     \textcolor{keyword}{using }string\_t = \textcolor{keyword}{typename} BasicJsonType::string\_t;}
\DoxyCodeLine{42     \textcolor{keyword}{using }binary\_t = \textcolor{keyword}{typename} BasicJsonType::binary\_t;}
\DoxyCodeLine{43     \textcolor{keyword}{using }number\_float\_t = \textcolor{keyword}{typename} BasicJsonType::number\_float\_t;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45   \textcolor{keyword}{public}:}
\DoxyCodeLine{51     \textcolor{keyword}{explicit} \mbox{\hyperlink{classdetail_1_1binary__writer_a5b4f1bfcd0f3f7b57060c059e008c45b}{binary\_writer}}(\mbox{\hyperlink{namespacedetail_a160eb5d333fe01b259af32d3d4798a7b}{output\_adapter\_t<CharType>}} adapter) : oa(std::move(adapter))}
\DoxyCodeLine{52     \{}
\DoxyCodeLine{53         JSON\_ASSERT(oa);}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{60     \textcolor{keywordtype}{void} \mbox{\hyperlink{classdetail_1_1binary__writer_a1aae361b7492825979cbb80245b9c0d6}{write\_bson}}(\textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{61     \{}
\DoxyCodeLine{62         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{63         \{}
\DoxyCodeLine{64             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{65             \{}
\DoxyCodeLine{66                 write\_bson\_object(*j.m\_value.object);}
\DoxyCodeLine{67                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{68             \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{71             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{72             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{73             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{74             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{75             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{76             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{77             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{78             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{79             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{80             \{}
\DoxyCodeLine{81                 JSON\_THROW(type\_error::create(317, concat(\textcolor{stringliteral}{"{}to serialize to BSON, top-\/level type must be object, but is "{}}, j.type\_name()), \&j));}
\DoxyCodeLine{82             \}}
\DoxyCodeLine{83         \}}
\DoxyCodeLine{84     \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{89     \textcolor{keywordtype}{void} \mbox{\hyperlink{classdetail_1_1binary__writer_ae6ab36b61e8ad346e75d9f9abc983d4c}{write\_cbor}}(\textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{90     \{}
\DoxyCodeLine{91         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{92         \{}
\DoxyCodeLine{93             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{94             \{}
\DoxyCodeLine{95                 oa-\/>write\_character(to\_char\_type(0xF6));}
\DoxyCodeLine{96                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{97             \}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{100             \{}
\DoxyCodeLine{101                 oa-\/>write\_character(j.m\_value.boolean}
\DoxyCodeLine{102                                     ? to\_char\_type(0xF5)}
\DoxyCodeLine{103                                     : to\_char\_type(0xF4));}
\DoxyCodeLine{104                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{105             \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{108             \{}
\DoxyCodeLine{109                 \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= 0)}
\DoxyCodeLine{110                 \{}
\DoxyCodeLine{111                     \textcolor{comment}{// CBOR does not differentiate between positive signed}}
\DoxyCodeLine{112                     \textcolor{comment}{// integers and unsigned integers. Therefore, we used the}}
\DoxyCodeLine{113                     \textcolor{comment}{// code from the value\_t::number\_unsigned case here.}}
\DoxyCodeLine{114                     \textcolor{keywordflow}{if} (j.m\_value.number\_integer <= 0x17)}
\DoxyCodeLine{115                     \{}
\DoxyCodeLine{116                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{117                     \}}
\DoxyCodeLine{118                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{119                     \{}
\DoxyCodeLine{120                         oa-\/>write\_character(to\_char\_type(0x18));}
\DoxyCodeLine{121                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{122                     \}}
\DoxyCodeLine{123                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{124                     \{}
\DoxyCodeLine{125                         oa-\/>write\_character(to\_char\_type(0x19));}
\DoxyCodeLine{126                         write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{127                     \}}
\DoxyCodeLine{128                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{129                     \{}
\DoxyCodeLine{130                         oa-\/>write\_character(to\_char\_type(0x1A));}
\DoxyCodeLine{131                         write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{132                     \}}
\DoxyCodeLine{133                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{134                     \{}
\DoxyCodeLine{135                         oa-\/>write\_character(to\_char\_type(0x1B));}
\DoxyCodeLine{136                         write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{137                     \}}
\DoxyCodeLine{138                 \}}
\DoxyCodeLine{139                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{140                 \{}
\DoxyCodeLine{141                     \textcolor{comment}{// The conversions below encode the sign in the first}}
\DoxyCodeLine{142                     \textcolor{comment}{// byte, and the value is converted to a positive number.}}
\DoxyCodeLine{143                     \textcolor{keyword}{const} \textcolor{keyword}{auto} positive\_number = -\/1 -\/ j.m\_value.number\_integer;}
\DoxyCodeLine{144                     \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= -\/24)}
\DoxyCodeLine{145                     \{}
\DoxyCodeLine{146                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x20 + positive\_number));}
\DoxyCodeLine{147                     \}}
\DoxyCodeLine{148                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (positive\_number <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{149                     \{}
\DoxyCodeLine{150                         oa-\/>write\_character(to\_char\_type(0x38));}
\DoxyCodeLine{151                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(positive\_number));}
\DoxyCodeLine{152                     \}}
\DoxyCodeLine{153                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (positive\_number <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{154                     \{}
\DoxyCodeLine{155                         oa-\/>write\_character(to\_char\_type(0x39));}
\DoxyCodeLine{156                         write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(positive\_number));}
\DoxyCodeLine{157                     \}}
\DoxyCodeLine{158                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (positive\_number <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{159                     \{}
\DoxyCodeLine{160                         oa-\/>write\_character(to\_char\_type(0x3A));}
\DoxyCodeLine{161                         write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(positive\_number));}
\DoxyCodeLine{162                     \}}
\DoxyCodeLine{163                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{164                     \{}
\DoxyCodeLine{165                         oa-\/>write\_character(to\_char\_type(0x3B));}
\DoxyCodeLine{166                         write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(positive\_number));}
\DoxyCodeLine{167                     \}}
\DoxyCodeLine{168                 \}}
\DoxyCodeLine{169                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{170             \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{173             \{}
\DoxyCodeLine{174                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= 0x17)}
\DoxyCodeLine{175                 \{}
\DoxyCodeLine{176                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned));}
\DoxyCodeLine{177                 \}}
\DoxyCodeLine{178                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{179                 \{}
\DoxyCodeLine{180                     oa-\/>write\_character(to\_char\_type(0x18));}
\DoxyCodeLine{181                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned));}
\DoxyCodeLine{182                 \}}
\DoxyCodeLine{183                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{184                 \{}
\DoxyCodeLine{185                     oa-\/>write\_character(to\_char\_type(0x19));}
\DoxyCodeLine{186                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned));}
\DoxyCodeLine{187                 \}}
\DoxyCodeLine{188                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{189                 \{}
\DoxyCodeLine{190                     oa-\/>write\_character(to\_char\_type(0x1A));}
\DoxyCodeLine{191                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned));}
\DoxyCodeLine{192                 \}}
\DoxyCodeLine{193                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{194                 \{}
\DoxyCodeLine{195                     oa-\/>write\_character(to\_char\_type(0x1B));}
\DoxyCodeLine{196                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned));}
\DoxyCodeLine{197                 \}}
\DoxyCodeLine{198                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{199             \}}
\DoxyCodeLine{200 }
\DoxyCodeLine{201             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{202             \{}
\DoxyCodeLine{203                 \textcolor{keywordflow}{if} (std::isnan(j.m\_value.number\_float))}
\DoxyCodeLine{204                 \{}
\DoxyCodeLine{205                     \textcolor{comment}{// NaN is 0xf97e00 in CBOR}}
\DoxyCodeLine{206                     oa-\/>write\_character(to\_char\_type(0xF9));}
\DoxyCodeLine{207                     oa-\/>write\_character(to\_char\_type(0x7E));}
\DoxyCodeLine{208                     oa-\/>write\_character(to\_char\_type(0x00));}
\DoxyCodeLine{209                 \}}
\DoxyCodeLine{210                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::isinf(j.m\_value.number\_float))}
\DoxyCodeLine{211                 \{}
\DoxyCodeLine{212                     \textcolor{comment}{// Infinity is 0xf97c00, -\/Infinity is 0xf9fc00}}
\DoxyCodeLine{213                     oa-\/>write\_character(to\_char\_type(0xf9));}
\DoxyCodeLine{214                     oa-\/>write\_character(j.m\_value.number\_float > 0 ? to\_char\_type(0x7C) : to\_char\_type(0xFC));}
\DoxyCodeLine{215                     oa-\/>write\_character(to\_char\_type(0x00));}
\DoxyCodeLine{216                 \}}
\DoxyCodeLine{217                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{218                 \{}
\DoxyCodeLine{219                     write\_compact\_float(j.m\_value.number\_float, detail::input\_format\_t::cbor);}
\DoxyCodeLine{220                 \}}
\DoxyCodeLine{221                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{222             \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{225             \{}
\DoxyCodeLine{226                 \textcolor{comment}{// step 1: write control byte and the string length}}
\DoxyCodeLine{227                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.string-\/>size();}
\DoxyCodeLine{228                 \textcolor{keywordflow}{if} (N <= 0x17)}
\DoxyCodeLine{229                 \{}
\DoxyCodeLine{230                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x60 + N));}
\DoxyCodeLine{231                 \}}
\DoxyCodeLine{232                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{233                 \{}
\DoxyCodeLine{234                     oa-\/>write\_character(to\_char\_type(0x78));}
\DoxyCodeLine{235                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{236                 \}}
\DoxyCodeLine{237                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{238                 \{}
\DoxyCodeLine{239                     oa-\/>write\_character(to\_char\_type(0x79));}
\DoxyCodeLine{240                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{241                 \}}
\DoxyCodeLine{242                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{243                 \{}
\DoxyCodeLine{244                     oa-\/>write\_character(to\_char\_type(0x7A));}
\DoxyCodeLine{245                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{246                 \}}
\DoxyCodeLine{247                 \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{248                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{249                 \{}
\DoxyCodeLine{250                     oa-\/>write\_character(to\_char\_type(0x7B));}
\DoxyCodeLine{251                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{252                 \}}
\DoxyCodeLine{253                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255                 \textcolor{comment}{// step 2: write the string}}
\DoxyCodeLine{256                 oa-\/>write\_characters(}
\DoxyCodeLine{257                     \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.string-\/>c\_str()),}
\DoxyCodeLine{258                     j.m\_value.string-\/>size());}
\DoxyCodeLine{259                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{260             \}}
\DoxyCodeLine{261 }
\DoxyCodeLine{262             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{263             \{}
\DoxyCodeLine{264                 \textcolor{comment}{// step 1: write control byte and the array size}}
\DoxyCodeLine{265                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.array-\/>size();}
\DoxyCodeLine{266                 \textcolor{keywordflow}{if} (N <= 0x17)}
\DoxyCodeLine{267                 \{}
\DoxyCodeLine{268                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x80 + N));}
\DoxyCodeLine{269                 \}}
\DoxyCodeLine{270                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{271                 \{}
\DoxyCodeLine{272                     oa-\/>write\_character(to\_char\_type(0x98));}
\DoxyCodeLine{273                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{274                 \}}
\DoxyCodeLine{275                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{276                 \{}
\DoxyCodeLine{277                     oa-\/>write\_character(to\_char\_type(0x99));}
\DoxyCodeLine{278                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{279                 \}}
\DoxyCodeLine{280                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{281                 \{}
\DoxyCodeLine{282                     oa-\/>write\_character(to\_char\_type(0x9A));}
\DoxyCodeLine{283                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{284                 \}}
\DoxyCodeLine{285                 \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{286                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{287                 \{}
\DoxyCodeLine{288                     oa-\/>write\_character(to\_char\_type(0x9B));}
\DoxyCodeLine{289                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{290                 \}}
\DoxyCodeLine{291                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{292 }
\DoxyCodeLine{293                 \textcolor{comment}{// step 2: write each element}}
\DoxyCodeLine{294                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.array)}
\DoxyCodeLine{295                 \{}
\DoxyCodeLine{296                     \mbox{\hyperlink{classdetail_1_1binary__writer_ae6ab36b61e8ad346e75d9f9abc983d4c}{write\_cbor}}(el);}
\DoxyCodeLine{297                 \}}
\DoxyCodeLine{298                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{299             \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{302             \{}
\DoxyCodeLine{303                 \textcolor{keywordflow}{if} (j.m\_value.binary-\/>has\_subtype())}
\DoxyCodeLine{304                 \{}
\DoxyCodeLine{305                     \textcolor{keywordflow}{if} (j.m\_value.binary-\/>subtype() <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{306                     \{}
\DoxyCodeLine{307                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xd8));}
\DoxyCodeLine{308                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.binary-\/>subtype()));}
\DoxyCodeLine{309                     \}}
\DoxyCodeLine{310                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.binary-\/>subtype() <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{311                     \{}
\DoxyCodeLine{312                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xd9));}
\DoxyCodeLine{313                         write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(j.m\_value.binary-\/>subtype()));}
\DoxyCodeLine{314                     \}}
\DoxyCodeLine{315                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.binary-\/>subtype() <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{316                     \{}
\DoxyCodeLine{317                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xda));}
\DoxyCodeLine{318                         write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(j.m\_value.binary-\/>subtype()));}
\DoxyCodeLine{319                     \}}
\DoxyCodeLine{320                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.binary-\/>subtype() <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{321                     \{}
\DoxyCodeLine{322                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xdb));}
\DoxyCodeLine{323                         write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(j.m\_value.binary-\/>subtype()));}
\DoxyCodeLine{324                     \}}
\DoxyCodeLine{325                 \}}
\DoxyCodeLine{326 }
\DoxyCodeLine{327                 \textcolor{comment}{// step 1: write control byte and the binary array size}}
\DoxyCodeLine{328                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.binary-\/>size();}
\DoxyCodeLine{329                 \textcolor{keywordflow}{if} (N <= 0x17)}
\DoxyCodeLine{330                 \{}
\DoxyCodeLine{331                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x40 + N));}
\DoxyCodeLine{332                 \}}
\DoxyCodeLine{333                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{334                 \{}
\DoxyCodeLine{335                     oa-\/>write\_character(to\_char\_type(0x58));}
\DoxyCodeLine{336                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{337                 \}}
\DoxyCodeLine{338                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{339                 \{}
\DoxyCodeLine{340                     oa-\/>write\_character(to\_char\_type(0x59));}
\DoxyCodeLine{341                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{342                 \}}
\DoxyCodeLine{343                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{344                 \{}
\DoxyCodeLine{345                     oa-\/>write\_character(to\_char\_type(0x5A));}
\DoxyCodeLine{346                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{347                 \}}
\DoxyCodeLine{348                 \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{349                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{350                 \{}
\DoxyCodeLine{351                     oa-\/>write\_character(to\_char\_type(0x5B));}
\DoxyCodeLine{352                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{353                 \}}
\DoxyCodeLine{354                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{355 }
\DoxyCodeLine{356                 \textcolor{comment}{// step 2: write each element}}
\DoxyCodeLine{357                 oa-\/>write\_characters(}
\DoxyCodeLine{358                     \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.binary-\/>data()),}
\DoxyCodeLine{359                     N);}
\DoxyCodeLine{360 }
\DoxyCodeLine{361                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{362             \}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{365             \{}
\DoxyCodeLine{366                 \textcolor{comment}{// step 1: write control byte and the object size}}
\DoxyCodeLine{367                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.object-\/>size();}
\DoxyCodeLine{368                 \textcolor{keywordflow}{if} (N <= 0x17)}
\DoxyCodeLine{369                 \{}
\DoxyCodeLine{370                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xA0 + N));}
\DoxyCodeLine{371                 \}}
\DoxyCodeLine{372                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{373                 \{}
\DoxyCodeLine{374                     oa-\/>write\_character(to\_char\_type(0xB8));}
\DoxyCodeLine{375                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{376                 \}}
\DoxyCodeLine{377                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{378                 \{}
\DoxyCodeLine{379                     oa-\/>write\_character(to\_char\_type(0xB9));}
\DoxyCodeLine{380                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{381                 \}}
\DoxyCodeLine{382                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{383                 \{}
\DoxyCodeLine{384                     oa-\/>write\_character(to\_char\_type(0xBA));}
\DoxyCodeLine{385                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{386                 \}}
\DoxyCodeLine{387                 \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{388                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{389                 \{}
\DoxyCodeLine{390                     oa-\/>write\_character(to\_char\_type(0xBB));}
\DoxyCodeLine{391                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{392                 \}}
\DoxyCodeLine{393                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395                 \textcolor{comment}{// step 2: write each element}}
\DoxyCodeLine{396                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.object)}
\DoxyCodeLine{397                 \{}
\DoxyCodeLine{398                     \mbox{\hyperlink{classdetail_1_1binary__writer_ae6ab36b61e8ad346e75d9f9abc983d4c}{write\_cbor}}(el.first);}
\DoxyCodeLine{399                     \mbox{\hyperlink{classdetail_1_1binary__writer_ae6ab36b61e8ad346e75d9f9abc983d4c}{write\_cbor}}(el.second);}
\DoxyCodeLine{400                 \}}
\DoxyCodeLine{401                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{402             \}}
\DoxyCodeLine{403 }
\DoxyCodeLine{404             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{405             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{406                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{407         \}}
\DoxyCodeLine{408     \}}
\DoxyCodeLine{409 }
\DoxyCodeLine{413     \textcolor{keywordtype}{void} \mbox{\hyperlink{classdetail_1_1binary__writer_adc3dbefa80134d3530a1b3f1c9629586}{write\_msgpack}}(\textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{414     \{}
\DoxyCodeLine{415         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{416         \{}
\DoxyCodeLine{417             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}: \textcolor{comment}{// nil}}
\DoxyCodeLine{418             \{}
\DoxyCodeLine{419                 oa-\/>write\_character(to\_char\_type(0xC0));}
\DoxyCodeLine{420                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{421             \}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}: \textcolor{comment}{// true and false}}
\DoxyCodeLine{424             \{}
\DoxyCodeLine{425                 oa-\/>write\_character(j.m\_value.boolean}
\DoxyCodeLine{426                                     ? to\_char\_type(0xC3)}
\DoxyCodeLine{427                                     : to\_char\_type(0xC2));}
\DoxyCodeLine{428                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{429             \}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{432             \{}
\DoxyCodeLine{433                 \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= 0)}
\DoxyCodeLine{434                 \{}
\DoxyCodeLine{435                     \textcolor{comment}{// MessagePack does not differentiate between positive}}
\DoxyCodeLine{436                     \textcolor{comment}{// signed integers and unsigned integers. Therefore, we used}}
\DoxyCodeLine{437                     \textcolor{comment}{// the code from the value\_t::number\_unsigned case here.}}
\DoxyCodeLine{438                     \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned < 128)}
\DoxyCodeLine{439                     \{}
\DoxyCodeLine{440                         \textcolor{comment}{// positive fixnum}}
\DoxyCodeLine{441                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{442                     \}}
\DoxyCodeLine{443                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{444                     \{}
\DoxyCodeLine{445                         \textcolor{comment}{// uint 8}}
\DoxyCodeLine{446                         oa-\/>write\_character(to\_char\_type(0xCC));}
\DoxyCodeLine{447                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{448                     \}}
\DoxyCodeLine{449                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{450                     \{}
\DoxyCodeLine{451                         \textcolor{comment}{// uint 16}}
\DoxyCodeLine{452                         oa-\/>write\_character(to\_char\_type(0xCD));}
\DoxyCodeLine{453                         write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{454                     \}}
\DoxyCodeLine{455                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{456                     \{}
\DoxyCodeLine{457                         \textcolor{comment}{// uint 32}}
\DoxyCodeLine{458                         oa-\/>write\_character(to\_char\_type(0xCE));}
\DoxyCodeLine{459                         write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{460                     \}}
\DoxyCodeLine{461                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{462                     \{}
\DoxyCodeLine{463                         \textcolor{comment}{// uint 64}}
\DoxyCodeLine{464                         oa-\/>write\_character(to\_char\_type(0xCF));}
\DoxyCodeLine{465                         write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{466                     \}}
\DoxyCodeLine{467                 \}}
\DoxyCodeLine{468                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{469                 \{}
\DoxyCodeLine{470                     \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= -\/32)}
\DoxyCodeLine{471                     \{}
\DoxyCodeLine{472                         \textcolor{comment}{// negative fixnum}}
\DoxyCodeLine{473                         write\_number(\textcolor{keyword}{static\_cast<}std::int8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{474                     \}}
\DoxyCodeLine{475                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= (std::numeric\_limits<std::int8\_t>::min)() \&\&}
\DoxyCodeLine{476                              j.m\_value.number\_integer <= (std::numeric\_limits<std::int8\_t>::max)())}
\DoxyCodeLine{477                     \{}
\DoxyCodeLine{478                         \textcolor{comment}{// int 8}}
\DoxyCodeLine{479                         oa-\/>write\_character(to\_char\_type(0xD0));}
\DoxyCodeLine{480                         write\_number(\textcolor{keyword}{static\_cast<}std::int8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{481                     \}}
\DoxyCodeLine{482                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= (std::numeric\_limits<std::int16\_t>::min)() \&\&}
\DoxyCodeLine{483                              j.m\_value.number\_integer <= (std::numeric\_limits<std::int16\_t>::max)())}
\DoxyCodeLine{484                     \{}
\DoxyCodeLine{485                         \textcolor{comment}{// int 16}}
\DoxyCodeLine{486                         oa-\/>write\_character(to\_char\_type(0xD1));}
\DoxyCodeLine{487                         write\_number(\textcolor{keyword}{static\_cast<}std::int16\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{488                     \}}
\DoxyCodeLine{489                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= (std::numeric\_limits<std::int32\_t>::min)() \&\&}
\DoxyCodeLine{490                              j.m\_value.number\_integer <= (std::numeric\_limits<std::int32\_t>::max)())}
\DoxyCodeLine{491                     \{}
\DoxyCodeLine{492                         \textcolor{comment}{// int 32}}
\DoxyCodeLine{493                         oa-\/>write\_character(to\_char\_type(0xD2));}
\DoxyCodeLine{494                         write\_number(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{495                     \}}
\DoxyCodeLine{496                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_integer >= (std::numeric\_limits<std::int64\_t>::min)() \&\&}
\DoxyCodeLine{497                              j.m\_value.number\_integer <= (std::numeric\_limits<std::int64\_t>::max)())}
\DoxyCodeLine{498                     \{}
\DoxyCodeLine{499                         \textcolor{comment}{// int 64}}
\DoxyCodeLine{500                         oa-\/>write\_character(to\_char\_type(0xD3));}
\DoxyCodeLine{501                         write\_number(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{502                     \}}
\DoxyCodeLine{503                 \}}
\DoxyCodeLine{504                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{505             \}}
\DoxyCodeLine{506 }
\DoxyCodeLine{507             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{508             \{}
\DoxyCodeLine{509                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned < 128)}
\DoxyCodeLine{510                 \{}
\DoxyCodeLine{511                     \textcolor{comment}{// positive fixnum}}
\DoxyCodeLine{512                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{513                 \}}
\DoxyCodeLine{514                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{515                 \{}
\DoxyCodeLine{516                     \textcolor{comment}{// uint 8}}
\DoxyCodeLine{517                     oa-\/>write\_character(to\_char\_type(0xCC));}
\DoxyCodeLine{518                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{519                 \}}
\DoxyCodeLine{520                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{521                 \{}
\DoxyCodeLine{522                     \textcolor{comment}{// uint 16}}
\DoxyCodeLine{523                     oa-\/>write\_character(to\_char\_type(0xCD));}
\DoxyCodeLine{524                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{525                 \}}
\DoxyCodeLine{526                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{527                 \{}
\DoxyCodeLine{528                     \textcolor{comment}{// uint 32}}
\DoxyCodeLine{529                     oa-\/>write\_character(to\_char\_type(0xCE));}
\DoxyCodeLine{530                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{531                 \}}
\DoxyCodeLine{532                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{533                 \{}
\DoxyCodeLine{534                     \textcolor{comment}{// uint 64}}
\DoxyCodeLine{535                     oa-\/>write\_character(to\_char\_type(0xCF));}
\DoxyCodeLine{536                     write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(j.m\_value.number\_integer));}
\DoxyCodeLine{537                 \}}
\DoxyCodeLine{538                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{539             \}}
\DoxyCodeLine{540 }
\DoxyCodeLine{541             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{542             \{}
\DoxyCodeLine{543                 write\_compact\_float(j.m\_value.number\_float, detail::input\_format\_t::msgpack);}
\DoxyCodeLine{544                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{545             \}}
\DoxyCodeLine{546 }
\DoxyCodeLine{547             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{548             \{}
\DoxyCodeLine{549                 \textcolor{comment}{// step 1: write control byte and the string length}}
\DoxyCodeLine{550                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.string-\/>size();}
\DoxyCodeLine{551                 \textcolor{keywordflow}{if} (N <= 31)}
\DoxyCodeLine{552                 \{}
\DoxyCodeLine{553                     \textcolor{comment}{// fixstr}}
\DoxyCodeLine{554                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0xA0 | N));}
\DoxyCodeLine{555                 \}}
\DoxyCodeLine{556                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{557                 \{}
\DoxyCodeLine{558                     \textcolor{comment}{// str 8}}
\DoxyCodeLine{559                     oa-\/>write\_character(to\_char\_type(0xD9));}
\DoxyCodeLine{560                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{561                 \}}
\DoxyCodeLine{562                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{563                 \{}
\DoxyCodeLine{564                     \textcolor{comment}{// str 16}}
\DoxyCodeLine{565                     oa-\/>write\_character(to\_char\_type(0xDA));}
\DoxyCodeLine{566                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{567                 \}}
\DoxyCodeLine{568                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{569                 \{}
\DoxyCodeLine{570                     \textcolor{comment}{// str 32}}
\DoxyCodeLine{571                     oa-\/>write\_character(to\_char\_type(0xDB));}
\DoxyCodeLine{572                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{573                 \}}
\DoxyCodeLine{574 }
\DoxyCodeLine{575                 \textcolor{comment}{// step 2: write the string}}
\DoxyCodeLine{576                 oa-\/>write\_characters(}
\DoxyCodeLine{577                     \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.string-\/>c\_str()),}
\DoxyCodeLine{578                     j.m\_value.string-\/>size());}
\DoxyCodeLine{579                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{580             \}}
\DoxyCodeLine{581 }
\DoxyCodeLine{582             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{583             \{}
\DoxyCodeLine{584                 \textcolor{comment}{// step 1: write control byte and the array size}}
\DoxyCodeLine{585                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.array-\/>size();}
\DoxyCodeLine{586                 \textcolor{keywordflow}{if} (N <= 15)}
\DoxyCodeLine{587                 \{}
\DoxyCodeLine{588                     \textcolor{comment}{// fixarray}}
\DoxyCodeLine{589                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x90 | N));}
\DoxyCodeLine{590                 \}}
\DoxyCodeLine{591                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{592                 \{}
\DoxyCodeLine{593                     \textcolor{comment}{// array 16}}
\DoxyCodeLine{594                     oa-\/>write\_character(to\_char\_type(0xDC));}
\DoxyCodeLine{595                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{596                 \}}
\DoxyCodeLine{597                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{598                 \{}
\DoxyCodeLine{599                     \textcolor{comment}{// array 32}}
\DoxyCodeLine{600                     oa-\/>write\_character(to\_char\_type(0xDD));}
\DoxyCodeLine{601                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{602                 \}}
\DoxyCodeLine{603 }
\DoxyCodeLine{604                 \textcolor{comment}{// step 2: write each element}}
\DoxyCodeLine{605                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.array)}
\DoxyCodeLine{606                 \{}
\DoxyCodeLine{607                     \mbox{\hyperlink{classdetail_1_1binary__writer_adc3dbefa80134d3530a1b3f1c9629586}{write\_msgpack}}(el);}
\DoxyCodeLine{608                 \}}
\DoxyCodeLine{609                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{610             \}}
\DoxyCodeLine{611 }
\DoxyCodeLine{612             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{613             \{}
\DoxyCodeLine{614                 \textcolor{comment}{// step 0: determine if the binary type has a set subtype to}}
\DoxyCodeLine{615                 \textcolor{comment}{// determine whether or not to use the ext or fixext types}}
\DoxyCodeLine{616                 \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_ext = j.m\_value.binary-\/>has\_subtype();}
\DoxyCodeLine{617 }
\DoxyCodeLine{618                 \textcolor{comment}{// step 1: write control byte and the byte string length}}
\DoxyCodeLine{619                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.binary-\/>size();}
\DoxyCodeLine{620                 \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{621                 \{}
\DoxyCodeLine{622                     std::uint8\_t output\_type\{\};}
\DoxyCodeLine{623                     \textcolor{keywordtype}{bool} fixed = \textcolor{keyword}{true};}
\DoxyCodeLine{624                     \textcolor{keywordflow}{if} (use\_ext)}
\DoxyCodeLine{625                     \{}
\DoxyCodeLine{626                         \textcolor{keywordflow}{switch} (N)}
\DoxyCodeLine{627                         \{}
\DoxyCodeLine{628                             \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{629                                 output\_type = 0xD4; \textcolor{comment}{// fixext 1}}
\DoxyCodeLine{630                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{631                             \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{632                                 output\_type = 0xD5; \textcolor{comment}{// fixext 2}}
\DoxyCodeLine{633                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{634                             \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{635                                 output\_type = 0xD6; \textcolor{comment}{// fixext 4}}
\DoxyCodeLine{636                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{637                             \textcolor{keywordflow}{case} 8:}
\DoxyCodeLine{638                                 output\_type = 0xD7; \textcolor{comment}{// fixext 8}}
\DoxyCodeLine{639                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{640                             \textcolor{keywordflow}{case} 16:}
\DoxyCodeLine{641                                 output\_type = 0xD8; \textcolor{comment}{// fixext 16}}
\DoxyCodeLine{642                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{643                             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{644                                 output\_type = 0xC7; \textcolor{comment}{// ext 8}}
\DoxyCodeLine{645                                 fixed = \textcolor{keyword}{false};}
\DoxyCodeLine{646                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{647                         \}}
\DoxyCodeLine{648 }
\DoxyCodeLine{649                     \}}
\DoxyCodeLine{650                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{651                     \{}
\DoxyCodeLine{652                         output\_type = 0xC4; \textcolor{comment}{// bin 8}}
\DoxyCodeLine{653                         fixed = \textcolor{keyword}{false};}
\DoxyCodeLine{654                     \}}
\DoxyCodeLine{655 }
\DoxyCodeLine{656                     oa-\/>write\_character(to\_char\_type(output\_type));}
\DoxyCodeLine{657                     \textcolor{keywordflow}{if} (!fixed)}
\DoxyCodeLine{658                     \{}
\DoxyCodeLine{659                         write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{660                     \}}
\DoxyCodeLine{661                 \}}
\DoxyCodeLine{662                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{663                 \{}
\DoxyCodeLine{664                     std::uint8\_t output\_type = use\_ext}
\DoxyCodeLine{665                                                ? 0xC8 \textcolor{comment}{// ext 16}}
\DoxyCodeLine{666                                                : 0xC5; \textcolor{comment}{// bin 16}}
\DoxyCodeLine{667 }
\DoxyCodeLine{668                     oa-\/>write\_character(to\_char\_type(output\_type));}
\DoxyCodeLine{669                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{670                 \}}
\DoxyCodeLine{671                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{672                 \{}
\DoxyCodeLine{673                     std::uint8\_t output\_type = use\_ext}
\DoxyCodeLine{674                                                ? 0xC9 \textcolor{comment}{// ext 32}}
\DoxyCodeLine{675                                                : 0xC6; \textcolor{comment}{// bin 32}}
\DoxyCodeLine{676 }
\DoxyCodeLine{677                     oa-\/>write\_character(to\_char\_type(output\_type));}
\DoxyCodeLine{678                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{679                 \}}
\DoxyCodeLine{680 }
\DoxyCodeLine{681                 \textcolor{comment}{// step 1.5: if this is an ext type, write the subtype}}
\DoxyCodeLine{682                 \textcolor{keywordflow}{if} (use\_ext)}
\DoxyCodeLine{683                 \{}
\DoxyCodeLine{684                     write\_number(\textcolor{keyword}{static\_cast<}std::int8\_t\textcolor{keyword}{>}(j.m\_value.binary-\/>subtype()));}
\DoxyCodeLine{685                 \}}
\DoxyCodeLine{686 }
\DoxyCodeLine{687                 \textcolor{comment}{// step 2: write the byte string}}
\DoxyCodeLine{688                 oa-\/>write\_characters(}
\DoxyCodeLine{689                     \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.binary-\/>data()),}
\DoxyCodeLine{690                     N);}
\DoxyCodeLine{691 }
\DoxyCodeLine{692                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{693             \}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{696             \{}
\DoxyCodeLine{697                 \textcolor{comment}{// step 1: write control byte and the object size}}
\DoxyCodeLine{698                 \textcolor{keyword}{const} \textcolor{keyword}{auto} N = j.m\_value.object-\/>size();}
\DoxyCodeLine{699                 \textcolor{keywordflow}{if} (N <= 15)}
\DoxyCodeLine{700                 \{}
\DoxyCodeLine{701                     \textcolor{comment}{// fixmap}}
\DoxyCodeLine{702                     write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x80 | (N \& 0xF)));}
\DoxyCodeLine{703                 \}}
\DoxyCodeLine{704                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint16\_t>::max)())}
\DoxyCodeLine{705                 \{}
\DoxyCodeLine{706                     \textcolor{comment}{// map 16}}
\DoxyCodeLine{707                     oa-\/>write\_character(to\_char\_type(0xDE));}
\DoxyCodeLine{708                     write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{709                 \}}
\DoxyCodeLine{710                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (N <= (std::numeric\_limits<std::uint32\_t>::max)())}
\DoxyCodeLine{711                 \{}
\DoxyCodeLine{712                     \textcolor{comment}{// map 32}}
\DoxyCodeLine{713                     oa-\/>write\_character(to\_char\_type(0xDF));}
\DoxyCodeLine{714                     write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(N));}
\DoxyCodeLine{715                 \}}
\DoxyCodeLine{716 }
\DoxyCodeLine{717                 \textcolor{comment}{// step 2: write each element}}
\DoxyCodeLine{718                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.object)}
\DoxyCodeLine{719                 \{}
\DoxyCodeLine{720                     \mbox{\hyperlink{classdetail_1_1binary__writer_adc3dbefa80134d3530a1b3f1c9629586}{write\_msgpack}}(el.first);}
\DoxyCodeLine{721                     \mbox{\hyperlink{classdetail_1_1binary__writer_adc3dbefa80134d3530a1b3f1c9629586}{write\_msgpack}}(el.second);}
\DoxyCodeLine{722                 \}}
\DoxyCodeLine{723                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{724             \}}
\DoxyCodeLine{725 }
\DoxyCodeLine{726             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{727             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{728                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{729         \}}
\DoxyCodeLine{730     \}}
\DoxyCodeLine{731 }
\DoxyCodeLine{739     \textcolor{keywordtype}{void} \mbox{\hyperlink{classdetail_1_1binary__writer_a972bec9688cbc5673bb482bbe9543e2a}{write\_ubjson}}(\textcolor{keyword}{const} BasicJsonType\& j, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_count,}
\DoxyCodeLine{740                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_type, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} add\_prefix = \textcolor{keyword}{true},}
\DoxyCodeLine{741                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_bjdata = \textcolor{keyword}{false})}
\DoxyCodeLine{742     \{}
\DoxyCodeLine{743         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{744         \{}
\DoxyCodeLine{745             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{746             \{}
\DoxyCodeLine{747                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{748                 \{}
\DoxyCodeLine{749                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'Z'}));}
\DoxyCodeLine{750                 \}}
\DoxyCodeLine{751                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{752             \}}
\DoxyCodeLine{753 }
\DoxyCodeLine{754             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{755             \{}
\DoxyCodeLine{756                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{757                 \{}
\DoxyCodeLine{758                     oa-\/>write\_character(j.m\_value.boolean}
\DoxyCodeLine{759                                         ? to\_char\_type(\textcolor{charliteral}{'T'})}
\DoxyCodeLine{760                                         : to\_char\_type(\textcolor{charliteral}{'F'}));}
\DoxyCodeLine{761                 \}}
\DoxyCodeLine{762                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{763             \}}
\DoxyCodeLine{764 }
\DoxyCodeLine{765             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{766             \{}
\DoxyCodeLine{767                 write\_number\_with\_ubjson\_prefix(j.m\_value.number\_integer, add\_prefix, use\_bjdata);}
\DoxyCodeLine{768                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{769             \}}
\DoxyCodeLine{770 }
\DoxyCodeLine{771             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{772             \{}
\DoxyCodeLine{773                 write\_number\_with\_ubjson\_prefix(j.m\_value.number\_unsigned, add\_prefix, use\_bjdata);}
\DoxyCodeLine{774                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{775             \}}
\DoxyCodeLine{776 }
\DoxyCodeLine{777             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{778             \{}
\DoxyCodeLine{779                 write\_number\_with\_ubjson\_prefix(j.m\_value.number\_float, add\_prefix, use\_bjdata);}
\DoxyCodeLine{780                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{781             \}}
\DoxyCodeLine{782 }
\DoxyCodeLine{783             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{784             \{}
\DoxyCodeLine{785                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{786                 \{}
\DoxyCodeLine{787                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'S'}));}
\DoxyCodeLine{788                 \}}
\DoxyCodeLine{789                 write\_number\_with\_ubjson\_prefix(j.m\_value.string-\/>size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{790                 oa-\/>write\_characters(}
\DoxyCodeLine{791                     \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.string-\/>c\_str()),}
\DoxyCodeLine{792                     j.m\_value.string-\/>size());}
\DoxyCodeLine{793                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{794             \}}
\DoxyCodeLine{795 }
\DoxyCodeLine{796             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{797             \{}
\DoxyCodeLine{798                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{799                 \{}
\DoxyCodeLine{800                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'['}));}
\DoxyCodeLine{801                 \}}
\DoxyCodeLine{802 }
\DoxyCodeLine{803                 \textcolor{keywordtype}{bool} prefix\_required = \textcolor{keyword}{true};}
\DoxyCodeLine{804                 \textcolor{keywordflow}{if} (use\_type \&\& !j.m\_value.array-\/>empty())}
\DoxyCodeLine{805                 \{}
\DoxyCodeLine{806                     JSON\_ASSERT(use\_count);}
\DoxyCodeLine{807                     \textcolor{keyword}{const} CharType first\_prefix = ubjson\_prefix(j.front(), use\_bjdata);}
\DoxyCodeLine{808                     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} same\_prefix = std::all\_of(j.begin() + 1, j.end(),}
\DoxyCodeLine{809                                                          [\textcolor{keyword}{this}, first\_prefix, use\_bjdata](\textcolor{keyword}{const} BasicJsonType \& v)}
\DoxyCodeLine{810                     \{}
\DoxyCodeLine{811                         return ubjson\_prefix(v, use\_bjdata) == first\_prefix;}
\DoxyCodeLine{812                     \});}
\DoxyCodeLine{813 }
\DoxyCodeLine{814                     std::vector<CharType> bjdx = \{\textcolor{charliteral}{'['}, \textcolor{charliteral}{'\{'}, \textcolor{charliteral}{'S'}, \textcolor{charliteral}{'H'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'F'}, \textcolor{charliteral}{'N'}, \textcolor{charliteral}{'Z'}\}; \textcolor{comment}{// excluded markers in bjdata optimized type}}
\DoxyCodeLine{815 }
\DoxyCodeLine{816                     \textcolor{keywordflow}{if} (same\_prefix \&\& !(use\_bjdata \&\& std::find(bjdx.begin(), bjdx.end(), first\_prefix) != bjdx.end()))}
\DoxyCodeLine{817                     \{}
\DoxyCodeLine{818                         prefix\_required = \textcolor{keyword}{false};}
\DoxyCodeLine{819                         oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\$'}));}
\DoxyCodeLine{820                         oa-\/>write\_character(first\_prefix);}
\DoxyCodeLine{821                     \}}
\DoxyCodeLine{822                 \}}
\DoxyCodeLine{823 }
\DoxyCodeLine{824                 \textcolor{keywordflow}{if} (use\_count)}
\DoxyCodeLine{825                 \{}
\DoxyCodeLine{826                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\#'}));}
\DoxyCodeLine{827                     write\_number\_with\_ubjson\_prefix(j.m\_value.array-\/>size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{828                 \}}
\DoxyCodeLine{829 }
\DoxyCodeLine{830                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.array)}
\DoxyCodeLine{831                 \{}
\DoxyCodeLine{832                     \mbox{\hyperlink{classdetail_1_1binary__writer_a972bec9688cbc5673bb482bbe9543e2a}{write\_ubjson}}(el, use\_count, use\_type, prefix\_required, use\_bjdata);}
\DoxyCodeLine{833                 \}}
\DoxyCodeLine{834 }
\DoxyCodeLine{835                 \textcolor{keywordflow}{if} (!use\_count)}
\DoxyCodeLine{836                 \{}
\DoxyCodeLine{837                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{']'}));}
\DoxyCodeLine{838                 \}}
\DoxyCodeLine{839 }
\DoxyCodeLine{840                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{841             \}}
\DoxyCodeLine{842 }
\DoxyCodeLine{843             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{844             \{}
\DoxyCodeLine{845                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{846                 \{}
\DoxyCodeLine{847                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'['}));}
\DoxyCodeLine{848                 \}}
\DoxyCodeLine{849 }
\DoxyCodeLine{850                 \textcolor{keywordflow}{if} (use\_type \&\& !j.m\_value.binary-\/>empty())}
\DoxyCodeLine{851                 \{}
\DoxyCodeLine{852                     JSON\_ASSERT(use\_count);}
\DoxyCodeLine{853                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\$'}));}
\DoxyCodeLine{854                     oa-\/>write\_character(\textcolor{charliteral}{'U'});}
\DoxyCodeLine{855                 \}}
\DoxyCodeLine{856 }
\DoxyCodeLine{857                 \textcolor{keywordflow}{if} (use\_count)}
\DoxyCodeLine{858                 \{}
\DoxyCodeLine{859                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\#'}));}
\DoxyCodeLine{860                     write\_number\_with\_ubjson\_prefix(j.m\_value.binary-\/>size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{861                 \}}
\DoxyCodeLine{862 }
\DoxyCodeLine{863                 \textcolor{keywordflow}{if} (use\_type)}
\DoxyCodeLine{864                 \{}
\DoxyCodeLine{865                     oa-\/>write\_characters(}
\DoxyCodeLine{866                         \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(j.m\_value.binary-\/>data()),}
\DoxyCodeLine{867                         j.m\_value.binary-\/>size());}
\DoxyCodeLine{868                 \}}
\DoxyCodeLine{869                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{870                 \{}
\DoxyCodeLine{871                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < j.m\_value.binary-\/>size(); ++i)}
\DoxyCodeLine{872                     \{}
\DoxyCodeLine{873                         oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'U'}));}
\DoxyCodeLine{874                         oa-\/>write\_character(j.m\_value.binary-\/>data()[i]);}
\DoxyCodeLine{875                     \}}
\DoxyCodeLine{876                 \}}
\DoxyCodeLine{877 }
\DoxyCodeLine{878                 \textcolor{keywordflow}{if} (!use\_count)}
\DoxyCodeLine{879                 \{}
\DoxyCodeLine{880                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{']'}));}
\DoxyCodeLine{881                 \}}
\DoxyCodeLine{882 }
\DoxyCodeLine{883                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{884             \}}
\DoxyCodeLine{885 }
\DoxyCodeLine{886             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{887             \{}
\DoxyCodeLine{888                 \textcolor{keywordflow}{if} (use\_bjdata \&\& j.m\_value.object-\/>size() == 3 \&\& j.m\_value.object-\/>find(\textcolor{stringliteral}{"{}\_ArrayType\_"{}}) != j.m\_value.object-\/>end() \&\& j.m\_value.object-\/>find(\textcolor{stringliteral}{"{}\_ArraySize\_"{}}) != j.m\_value.object-\/>end() \&\& j.m\_value.object-\/>find(\textcolor{stringliteral}{"{}\_ArrayData\_"{}}) != j.m\_value.object-\/>end())}
\DoxyCodeLine{889                 \{}
\DoxyCodeLine{890                     \textcolor{keywordflow}{if} (!write\_bjdata\_ndarray(*j.m\_value.object, use\_count, use\_type))  \textcolor{comment}{// decode bjdata ndarray in the JData format (https://github.com/NeuroJSON/jdata)}}
\DoxyCodeLine{891                     \{}
\DoxyCodeLine{892                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{893                     \}}
\DoxyCodeLine{894                 \}}
\DoxyCodeLine{895 }
\DoxyCodeLine{896                 \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{897                 \{}
\DoxyCodeLine{898                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\{'}));}
\DoxyCodeLine{899                 \}}
\DoxyCodeLine{900 }
\DoxyCodeLine{901                 \textcolor{keywordtype}{bool} prefix\_required = \textcolor{keyword}{true};}
\DoxyCodeLine{902                 \textcolor{keywordflow}{if} (use\_type \&\& !j.m\_value.object-\/>empty())}
\DoxyCodeLine{903                 \{}
\DoxyCodeLine{904                     JSON\_ASSERT(use\_count);}
\DoxyCodeLine{905                     \textcolor{keyword}{const} CharType first\_prefix = ubjson\_prefix(j.front(), use\_bjdata);}
\DoxyCodeLine{906                     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} same\_prefix = std::all\_of(j.begin(), j.end(),}
\DoxyCodeLine{907                                                          [\textcolor{keyword}{this}, first\_prefix, use\_bjdata](\textcolor{keyword}{const} BasicJsonType \& v)}
\DoxyCodeLine{908                     \{}
\DoxyCodeLine{909                         return ubjson\_prefix(v, use\_bjdata) == first\_prefix;}
\DoxyCodeLine{910                     \});}
\DoxyCodeLine{911 }
\DoxyCodeLine{912                     std::vector<CharType> bjdx = \{\textcolor{charliteral}{'['}, \textcolor{charliteral}{'\{'}, \textcolor{charliteral}{'S'}, \textcolor{charliteral}{'H'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'F'}, \textcolor{charliteral}{'N'}, \textcolor{charliteral}{'Z'}\}; \textcolor{comment}{// excluded markers in bjdata optimized type}}
\DoxyCodeLine{913 }
\DoxyCodeLine{914                     \textcolor{keywordflow}{if} (same\_prefix \&\& !(use\_bjdata \&\& std::find(bjdx.begin(), bjdx.end(), first\_prefix) != bjdx.end()))}
\DoxyCodeLine{915                     \{}
\DoxyCodeLine{916                         prefix\_required = \textcolor{keyword}{false};}
\DoxyCodeLine{917                         oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\$'}));}
\DoxyCodeLine{918                         oa-\/>write\_character(first\_prefix);}
\DoxyCodeLine{919                     \}}
\DoxyCodeLine{920                 \}}
\DoxyCodeLine{921 }
\DoxyCodeLine{922                 \textcolor{keywordflow}{if} (use\_count)}
\DoxyCodeLine{923                 \{}
\DoxyCodeLine{924                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\#'}));}
\DoxyCodeLine{925                     write\_number\_with\_ubjson\_prefix(j.m\_value.object-\/>size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{926                 \}}
\DoxyCodeLine{927 }
\DoxyCodeLine{928                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : *j.m\_value.object)}
\DoxyCodeLine{929                 \{}
\DoxyCodeLine{930                     write\_number\_with\_ubjson\_prefix(el.first.size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{931                     oa-\/>write\_characters(}
\DoxyCodeLine{932                         \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(el.first.c\_str()),}
\DoxyCodeLine{933                         el.first.size());}
\DoxyCodeLine{934                     \mbox{\hyperlink{classdetail_1_1binary__writer_a972bec9688cbc5673bb482bbe9543e2a}{write\_ubjson}}(el.second, use\_count, use\_type, prefix\_required, use\_bjdata);}
\DoxyCodeLine{935                 \}}
\DoxyCodeLine{936 }
\DoxyCodeLine{937                 \textcolor{keywordflow}{if} (!use\_count)}
\DoxyCodeLine{938                 \{}
\DoxyCodeLine{939                     oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'\}'}));}
\DoxyCodeLine{940                 \}}
\DoxyCodeLine{941 }
\DoxyCodeLine{942                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{943             \}}
\DoxyCodeLine{944 }
\DoxyCodeLine{945             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{946             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{947                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{948         \}}
\DoxyCodeLine{949     \}}
\DoxyCodeLine{950 }
\DoxyCodeLine{951   \textcolor{keyword}{private}:}
\DoxyCodeLine{953     \textcolor{comment}{// BSON //}}
\DoxyCodeLine{955 \textcolor{comment}{}}
\DoxyCodeLine{960     \textcolor{keyword}{static} std::size\_t calc\_bson\_entry\_header\_size(\textcolor{keyword}{const} string\_t\& name, \textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{961     \{}
\DoxyCodeLine{962         \textcolor{keyword}{const} \textcolor{keyword}{auto} it = name.find(\textcolor{keyword}{static\_cast<}typename string\_t::value\_type\textcolor{keyword}{>}(0));}
\DoxyCodeLine{963         \textcolor{keywordflow}{if} (JSON\_HEDLEY\_UNLIKELY(it != BasicJsonType::string\_t::npos))}
\DoxyCodeLine{964         \{}
\DoxyCodeLine{965             JSON\_THROW(out\_of\_range::create(409, concat(\textcolor{stringliteral}{"{}BSON key cannot contain code point U+0000 (at byte "{}}, std::to\_string(it), \textcolor{stringliteral}{"{})"{}}), \&j));}
\DoxyCodeLine{966             \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}\textcolor{keyword}{>}(j);}
\DoxyCodeLine{967         \}}
\DoxyCodeLine{968 }
\DoxyCodeLine{969         \textcolor{keywordflow}{return} \textcolor{comment}{/*id*/} 1ul + name.size() + \textcolor{comment}{/*zero-\/terminator*/}1u;}
\DoxyCodeLine{970     \}}
\DoxyCodeLine{971 }
\DoxyCodeLine{975     \textcolor{keywordtype}{void} write\_bson\_entry\_header(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{976                                  \textcolor{keyword}{const} std::uint8\_t element\_type)}
\DoxyCodeLine{977     \{}
\DoxyCodeLine{978         oa-\/>write\_character(to\_char\_type(element\_type)); \textcolor{comment}{// boolean}}
\DoxyCodeLine{979         oa-\/>write\_characters(}
\DoxyCodeLine{980             \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(name.c\_str()),}
\DoxyCodeLine{981             name.size() + 1u);}
\DoxyCodeLine{982     \}}
\DoxyCodeLine{983 }
\DoxyCodeLine{987     \textcolor{keywordtype}{void} write\_bson\_boolean(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{988                             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} value)}
\DoxyCodeLine{989     \{}
\DoxyCodeLine{990         write\_bson\_entry\_header(name, 0x08);}
\DoxyCodeLine{991         oa-\/>write\_character(value ? to\_char\_type(0x01) : to\_char\_type(0x00));}
\DoxyCodeLine{992     \}}
\DoxyCodeLine{993 }
\DoxyCodeLine{997     \textcolor{keywordtype}{void} write\_bson\_double(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{998                            \textcolor{keyword}{const} \textcolor{keywordtype}{double} value)}
\DoxyCodeLine{999     \{}
\DoxyCodeLine{1000         write\_bson\_entry\_header(name, 0x01);}
\DoxyCodeLine{1001         write\_number<double>(value, \textcolor{keyword}{true});}
\DoxyCodeLine{1002     \}}
\DoxyCodeLine{1003 }
\DoxyCodeLine{1007     \textcolor{keyword}{static} std::size\_t calc\_bson\_string\_size(\textcolor{keyword}{const} string\_t\& value)}
\DoxyCodeLine{1008     \{}
\DoxyCodeLine{1009         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(std::int32\_t) + value.size() + 1ul;}
\DoxyCodeLine{1010     \}}
\DoxyCodeLine{1011 }
\DoxyCodeLine{1015     \textcolor{keywordtype}{void} write\_bson\_string(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1016                            \textcolor{keyword}{const} string\_t\& value)}
\DoxyCodeLine{1017     \{}
\DoxyCodeLine{1018         write\_bson\_entry\_header(name, 0x02);}
\DoxyCodeLine{1019 }
\DoxyCodeLine{1020         write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(value.size() + 1ul), \textcolor{keyword}{true});}
\DoxyCodeLine{1021         oa-\/>write\_characters(}
\DoxyCodeLine{1022             \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(value.c\_str()),}
\DoxyCodeLine{1023             value.size() + 1);}
\DoxyCodeLine{1024     \}}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1029     \textcolor{keywordtype}{void} write\_bson\_null(\textcolor{keyword}{const} string\_t\& name)}
\DoxyCodeLine{1030     \{}
\DoxyCodeLine{1031         write\_bson\_entry\_header(name, 0x0A);}
\DoxyCodeLine{1032     \}}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1037     \textcolor{keyword}{static} std::size\_t calc\_bson\_integer\_size(\textcolor{keyword}{const} std::int64\_t value)}
\DoxyCodeLine{1038     \{}
\DoxyCodeLine{1039         \textcolor{keywordflow}{return} (std::numeric\_limits<std::int32\_t>::min)() <= value \&\& value <= (std::numeric\_limits<std::int32\_t>::max)()}
\DoxyCodeLine{1040                ? \textcolor{keyword}{sizeof}(std::int32\_t)}
\DoxyCodeLine{1041                : \textcolor{keyword}{sizeof}(std::int64\_t);}
\DoxyCodeLine{1042     \}}
\DoxyCodeLine{1043 }
\DoxyCodeLine{1047     \textcolor{keywordtype}{void} write\_bson\_integer(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1048                             \textcolor{keyword}{const} std::int64\_t value)}
\DoxyCodeLine{1049     \{}
\DoxyCodeLine{1050         \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int32\_t>::min)() <= value \&\& value <= (std::numeric\_limits<std::int32\_t>::max)())}
\DoxyCodeLine{1051         \{}
\DoxyCodeLine{1052             write\_bson\_entry\_header(name, 0x10); \textcolor{comment}{// int32}}
\DoxyCodeLine{1053             write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(value), \textcolor{keyword}{true});}
\DoxyCodeLine{1054         \}}
\DoxyCodeLine{1055         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1056         \{}
\DoxyCodeLine{1057             write\_bson\_entry\_header(name, 0x12); \textcolor{comment}{// int64}}
\DoxyCodeLine{1058             write\_number<std::int64\_t>(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(value), \textcolor{keyword}{true});}
\DoxyCodeLine{1059         \}}
\DoxyCodeLine{1060     \}}
\DoxyCodeLine{1061 }
\DoxyCodeLine{1065     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} std::size\_t calc\_bson\_unsigned\_size(\textcolor{keyword}{const} std::uint64\_t value) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1066     \{}
\DoxyCodeLine{1067         \textcolor{keywordflow}{return} (value <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int32\_t>::max)()))}
\DoxyCodeLine{1068                ? \textcolor{keyword}{sizeof}(std::int32\_t)}
\DoxyCodeLine{1069                : \textcolor{keyword}{sizeof}(std::int64\_t);}
\DoxyCodeLine{1070     \}}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1075     \textcolor{keywordtype}{void} write\_bson\_unsigned(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1076                              \textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{1077     \{}
\DoxyCodeLine{1078         \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int32\_t>::max)()))}
\DoxyCodeLine{1079         \{}
\DoxyCodeLine{1080             write\_bson\_entry\_header(name, 0x10 \textcolor{comment}{/* int32 */});}
\DoxyCodeLine{1081             write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1082         \}}
\DoxyCodeLine{1083         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int64\_t>::max)()))}
\DoxyCodeLine{1084         \{}
\DoxyCodeLine{1085             write\_bson\_entry\_header(name, 0x12 \textcolor{comment}{/* int64 */});}
\DoxyCodeLine{1086             write\_number<std::int64\_t>(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(j.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1087         \}}
\DoxyCodeLine{1088         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1089         \{}
\DoxyCodeLine{1090             JSON\_THROW(out\_of\_range::create(407, concat(\textcolor{stringliteral}{"{}integer number "{}}, std::to\_string(j.m\_value.number\_unsigned), \textcolor{stringliteral}{"{} cannot be represented by BSON as it does not fit int64"{}}), \&j));}
\DoxyCodeLine{1091         \}}
\DoxyCodeLine{1092     \}}
\DoxyCodeLine{1093 }
\DoxyCodeLine{1097     \textcolor{keywordtype}{void} write\_bson\_object\_entry(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1098                                  \textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::object\_t\& value)}
\DoxyCodeLine{1099     \{}
\DoxyCodeLine{1100         write\_bson\_entry\_header(name, 0x03); \textcolor{comment}{// object}}
\DoxyCodeLine{1101         write\_bson\_object(value);}
\DoxyCodeLine{1102     \}}
\DoxyCodeLine{1103 }
\DoxyCodeLine{1107     \textcolor{keyword}{static} std::size\_t calc\_bson\_array\_size(\textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::array\_t\& value)}
\DoxyCodeLine{1108     \{}
\DoxyCodeLine{1109         std::size\_t array\_index = 0ul;}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111         \textcolor{keyword}{const} std::size\_t embedded\_document\_size = std::accumulate(std::begin(value), std::end(value), \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(0), [\&array\_index](std::size\_t result, \textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::array\_t::value\_type \& el)}
\DoxyCodeLine{1112         \{}
\DoxyCodeLine{1113             \textcolor{keywordflow}{return} result + calc\_bson\_element\_size(std::to\_string(array\_index++), el);}
\DoxyCodeLine{1114         \});}
\DoxyCodeLine{1115 }
\DoxyCodeLine{1116         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(std::int32\_t) + embedded\_document\_size + 1ul;}
\DoxyCodeLine{1117     \}}
\DoxyCodeLine{1118 }
\DoxyCodeLine{1122     \textcolor{keyword}{static} std::size\_t calc\_bson\_binary\_size(\textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::binary\_t\& value)}
\DoxyCodeLine{1123     \{}
\DoxyCodeLine{1124         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(std::int32\_t) + value.size() + 1ul;}
\DoxyCodeLine{1125     \}}
\DoxyCodeLine{1126 }
\DoxyCodeLine{1130     \textcolor{keywordtype}{void} write\_bson\_array(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1131                           \textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::array\_t\& value)}
\DoxyCodeLine{1132     \{}
\DoxyCodeLine{1133         write\_bson\_entry\_header(name, 0x04); \textcolor{comment}{// array}}
\DoxyCodeLine{1134         write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(calc\_bson\_array\_size(value)), \textcolor{keyword}{true});}
\DoxyCodeLine{1135 }
\DoxyCodeLine{1136         std::size\_t array\_index = 0ul;}
\DoxyCodeLine{1137 }
\DoxyCodeLine{1138         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value)}
\DoxyCodeLine{1139         \{}
\DoxyCodeLine{1140             write\_bson\_element(std::to\_string(array\_index++), el);}
\DoxyCodeLine{1141         \}}
\DoxyCodeLine{1142 }
\DoxyCodeLine{1143         oa-\/>write\_character(to\_char\_type(0x00));}
\DoxyCodeLine{1144     \}}
\DoxyCodeLine{1145 }
\DoxyCodeLine{1149     \textcolor{keywordtype}{void} write\_bson\_binary(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1150                            \textcolor{keyword}{const} binary\_t\& value)}
\DoxyCodeLine{1151     \{}
\DoxyCodeLine{1152         write\_bson\_entry\_header(name, 0x05);}
\DoxyCodeLine{1153 }
\DoxyCodeLine{1154         write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(value.size()), \textcolor{keyword}{true});}
\DoxyCodeLine{1155         write\_number(value.has\_subtype() ? \textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(value.subtype()) : \textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(0x00));}
\DoxyCodeLine{1156 }
\DoxyCodeLine{1157         oa-\/>write\_characters(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }CharType*\textcolor{keyword}{>}(value.data()), value.size());}
\DoxyCodeLine{1158     \}}
\DoxyCodeLine{1159 }
\DoxyCodeLine{1164     \textcolor{keyword}{static} std::size\_t calc\_bson\_element\_size(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1165             \textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{1166     \{}
\DoxyCodeLine{1167         \textcolor{keyword}{const} \textcolor{keyword}{auto} header\_size = calc\_bson\_entry\_header\_size(name, j);}
\DoxyCodeLine{1168         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{1169         \{}
\DoxyCodeLine{1170             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{1171                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_object\_size(*j.m\_value.object);}
\DoxyCodeLine{1172 }
\DoxyCodeLine{1173             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{1174                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_array\_size(*j.m\_value.array);}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{1177                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_binary\_size(*j.m\_value.binary);}
\DoxyCodeLine{1178 }
\DoxyCodeLine{1179             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{1180                 \textcolor{keywordflow}{return} header\_size + 1ul;}
\DoxyCodeLine{1181 }
\DoxyCodeLine{1182             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{1183                 \textcolor{keywordflow}{return} header\_size + 8ul;}
\DoxyCodeLine{1184 }
\DoxyCodeLine{1185             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{1186                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_integer\_size(j.m\_value.number\_integer);}
\DoxyCodeLine{1187 }
\DoxyCodeLine{1188             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{1189                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_unsigned\_size(j.m\_value.number\_unsigned);}
\DoxyCodeLine{1190 }
\DoxyCodeLine{1191             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{1192                 \textcolor{keywordflow}{return} header\_size + calc\_bson\_string\_size(*j.m\_value.string);}
\DoxyCodeLine{1193 }
\DoxyCodeLine{1194             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{1195                 \textcolor{keywordflow}{return} header\_size + 0ul;}
\DoxyCodeLine{1196 }
\DoxyCodeLine{1197             \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{1198             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{1199             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1200                 JSON\_ASSERT(\textcolor{keyword}{false}); \textcolor{comment}{// NOLINT(cert-\/dcl03-\/c,hicpp-\/static-\/assert,misc-\/static-\/assert)}}
\DoxyCodeLine{1201                 \textcolor{keywordflow}{return} 0ul;}
\DoxyCodeLine{1202                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{1203         \}}
\DoxyCodeLine{1204     \}}
\DoxyCodeLine{1205 }
\DoxyCodeLine{1212     \textcolor{keywordtype}{void} write\_bson\_element(\textcolor{keyword}{const} string\_t\& name,}
\DoxyCodeLine{1213                             \textcolor{keyword}{const} BasicJsonType\& j)}
\DoxyCodeLine{1214     \{}
\DoxyCodeLine{1215         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{1216         \{}
\DoxyCodeLine{1217             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{1218                 \textcolor{keywordflow}{return} write\_bson\_object\_entry(name, *j.m\_value.object);}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}:}
\DoxyCodeLine{1221                 \textcolor{keywordflow}{return} write\_bson\_array(name, *j.m\_value.array);}
\DoxyCodeLine{1222 }
\DoxyCodeLine{1223             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{1224                 \textcolor{keywordflow}{return} write\_bson\_binary(name, *j.m\_value.binary);}
\DoxyCodeLine{1225 }
\DoxyCodeLine{1226             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{1227                 \textcolor{keywordflow}{return} write\_bson\_boolean(name, j.m\_value.boolean);}
\DoxyCodeLine{1228 }
\DoxyCodeLine{1229             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{1230                 \textcolor{keywordflow}{return} write\_bson\_double(name, j.m\_value.number\_float);}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{1233                 \textcolor{keywordflow}{return} write\_bson\_integer(name, j.m\_value.number\_integer);}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{1236                 \textcolor{keywordflow}{return} write\_bson\_unsigned(name, j);}
\DoxyCodeLine{1237 }
\DoxyCodeLine{1238             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{1239                 \textcolor{keywordflow}{return} write\_bson\_string(name, *j.m\_value.string);}
\DoxyCodeLine{1240 }
\DoxyCodeLine{1241             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{1242                 \textcolor{keywordflow}{return} write\_bson\_null(name);}
\DoxyCodeLine{1243 }
\DoxyCodeLine{1244             \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{1245             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{1246             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1247                 JSON\_ASSERT(\textcolor{keyword}{false}); \textcolor{comment}{// NOLINT(cert-\/dcl03-\/c,hicpp-\/static-\/assert,misc-\/static-\/assert)}}
\DoxyCodeLine{1248                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1249                 \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{1250         \}}
\DoxyCodeLine{1251     \}}
\DoxyCodeLine{1252 }
\DoxyCodeLine{1259     \textcolor{keyword}{static} std::size\_t calc\_bson\_object\_size(\textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::object\_t\& value)}
\DoxyCodeLine{1260     \{}
\DoxyCodeLine{1261         std::size\_t document\_size = std::accumulate(value.begin(), value.end(), \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(0),}
\DoxyCodeLine{1262                                     [](\textcolor{keywordtype}{size\_t} result, \textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::object\_t::value\_type \& el)}
\DoxyCodeLine{1263         \{}
\DoxyCodeLine{1264             return result += calc\_bson\_element\_size(el.first, el.second);}
\DoxyCodeLine{1265         \});}
\DoxyCodeLine{1266 }
\DoxyCodeLine{1267         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(std::int32\_t) + document\_size + 1ul;}
\DoxyCodeLine{1268     \}}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1274     \textcolor{keywordtype}{void} write\_bson\_object(\textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::object\_t\& value)}
\DoxyCodeLine{1275     \{}
\DoxyCodeLine{1276         write\_number<std::int32\_t>(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(calc\_bson\_object\_size(value)), \textcolor{keyword}{true});}
\DoxyCodeLine{1277 }
\DoxyCodeLine{1278         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value)}
\DoxyCodeLine{1279         \{}
\DoxyCodeLine{1280             write\_bson\_element(el.first, el.second);}
\DoxyCodeLine{1281         \}}
\DoxyCodeLine{1282 }
\DoxyCodeLine{1283         oa-\/>write\_character(to\_char\_type(0x00));}
\DoxyCodeLine{1284     \}}
\DoxyCodeLine{1285 }
\DoxyCodeLine{1287     \textcolor{comment}{// CBOR //}}
\DoxyCodeLine{1289 \textcolor{comment}{}}
\DoxyCodeLine{1290     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_cbor\_float\_prefix(\textcolor{keywordtype}{float} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1291     \{}
\DoxyCodeLine{1292         \textcolor{keywordflow}{return} to\_char\_type(0xFA);  \textcolor{comment}{// Single-\/Precision Float}}
\DoxyCodeLine{1293     \}}
\DoxyCodeLine{1294 }
\DoxyCodeLine{1295     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_cbor\_float\_prefix(\textcolor{keywordtype}{double} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1296     \{}
\DoxyCodeLine{1297         \textcolor{keywordflow}{return} to\_char\_type(0xFB);  \textcolor{comment}{// Double-\/Precision Float}}
\DoxyCodeLine{1298     \}}
\DoxyCodeLine{1299 }
\DoxyCodeLine{1301     \textcolor{comment}{// MsgPack //}}
\DoxyCodeLine{1303 \textcolor{comment}{}}
\DoxyCodeLine{1304     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_msgpack\_float\_prefix(\textcolor{keywordtype}{float} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1305     \{}
\DoxyCodeLine{1306         \textcolor{keywordflow}{return} to\_char\_type(0xCA);  \textcolor{comment}{// float 32}}
\DoxyCodeLine{1307     \}}
\DoxyCodeLine{1308 }
\DoxyCodeLine{1309     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_msgpack\_float\_prefix(\textcolor{keywordtype}{double} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1310     \{}
\DoxyCodeLine{1311         \textcolor{keywordflow}{return} to\_char\_type(0xCB);  \textcolor{comment}{// float 64}}
\DoxyCodeLine{1312     \}}
\DoxyCodeLine{1313 }
\DoxyCodeLine{1315     \textcolor{comment}{// UBJSON //}}
\DoxyCodeLine{1317 \textcolor{comment}{}}
\DoxyCodeLine{1318     \textcolor{comment}{// UBJSON: write number (floating point)}}
\DoxyCodeLine{1319     \textcolor{keyword}{template}<\textcolor{keyword}{typename} NumberType, \textcolor{keyword}{typename} std::enable\_if<}
\DoxyCodeLine{1320                  std::is\_floating\_point<NumberType>::value, \textcolor{keywordtype}{int}>::type = 0>}
\DoxyCodeLine{1321     \textcolor{keywordtype}{void} write\_number\_with\_ubjson\_prefix(\textcolor{keyword}{const} NumberType n,}
\DoxyCodeLine{1322                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} add\_prefix,}
\DoxyCodeLine{1323                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_bjdata)}
\DoxyCodeLine{1324     \{}
\DoxyCodeLine{1325         \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1326         \{}
\DoxyCodeLine{1327             oa-\/>write\_character(get\_ubjson\_float\_prefix(n));}
\DoxyCodeLine{1328         \}}
\DoxyCodeLine{1329         write\_number(n, use\_bjdata);}
\DoxyCodeLine{1330     \}}
\DoxyCodeLine{1331 }
\DoxyCodeLine{1332     \textcolor{comment}{// UBJSON: write number (unsigned integer)}}
\DoxyCodeLine{1333     \textcolor{keyword}{template}<\textcolor{keyword}{typename} NumberType, \textcolor{keyword}{typename} std::enable\_if<}
\DoxyCodeLine{1334                  std::is\_unsigned<NumberType>::value, \textcolor{keywordtype}{int}>::type = 0>}
\DoxyCodeLine{1335     \textcolor{keywordtype}{void} write\_number\_with\_ubjson\_prefix(\textcolor{keyword}{const} NumberType n,}
\DoxyCodeLine{1336                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} add\_prefix,}
\DoxyCodeLine{1337                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_bjdata)}
\DoxyCodeLine{1338     \{}
\DoxyCodeLine{1339         \textcolor{keywordflow}{if} (n <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int8\_t>::max)()))}
\DoxyCodeLine{1340         \{}
\DoxyCodeLine{1341             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1342             \{}
\DoxyCodeLine{1343                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'i'}));  \textcolor{comment}{// int8}}
\DoxyCodeLine{1344             \}}
\DoxyCodeLine{1345             write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1346         \}}
\DoxyCodeLine{1347         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{1348         \{}
\DoxyCodeLine{1349             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1350             \{}
\DoxyCodeLine{1351                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'U'}));  \textcolor{comment}{// uint8}}
\DoxyCodeLine{1352             \}}
\DoxyCodeLine{1353             write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1354         \}}
\DoxyCodeLine{1355         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int16\_t>::max)()))}
\DoxyCodeLine{1356         \{}
\DoxyCodeLine{1357             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1358             \{}
\DoxyCodeLine{1359                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'I'}));  \textcolor{comment}{// int16}}
\DoxyCodeLine{1360             \}}
\DoxyCodeLine{1361             write\_number(\textcolor{keyword}{static\_cast<}std::int16\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1362         \}}
\DoxyCodeLine{1363         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_bjdata \&\& n <= \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<uint16\_t>::max)()))}
\DoxyCodeLine{1364         \{}
\DoxyCodeLine{1365             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1366             \{}
\DoxyCodeLine{1367                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'u'}));  \textcolor{comment}{// uint16 -\/ bjdata only}}
\DoxyCodeLine{1368             \}}
\DoxyCodeLine{1369             write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1370         \}}
\DoxyCodeLine{1371         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int32\_t>::max)()))}
\DoxyCodeLine{1372         \{}
\DoxyCodeLine{1373             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1374             \{}
\DoxyCodeLine{1375                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'l'}));  \textcolor{comment}{// int32}}
\DoxyCodeLine{1376             \}}
\DoxyCodeLine{1377             write\_number(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1378         \}}
\DoxyCodeLine{1379         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_bjdata \&\& n <= \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<uint32\_t>::max)()))}
\DoxyCodeLine{1380         \{}
\DoxyCodeLine{1381             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1382             \{}
\DoxyCodeLine{1383                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'m'}));  \textcolor{comment}{// uint32 -\/ bjdata only}}
\DoxyCodeLine{1384             \}}
\DoxyCodeLine{1385             write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1386         \}}
\DoxyCodeLine{1387         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int64\_t>::max)()))}
\DoxyCodeLine{1388         \{}
\DoxyCodeLine{1389             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1390             \{}
\DoxyCodeLine{1391                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'L'}));  \textcolor{comment}{// int64}}
\DoxyCodeLine{1392             \}}
\DoxyCodeLine{1393             write\_number(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1394         \}}
\DoxyCodeLine{1395         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_bjdata \&\& n <= (std::numeric\_limits<uint64\_t>::max)())}
\DoxyCodeLine{1396         \{}
\DoxyCodeLine{1397             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1398             \{}
\DoxyCodeLine{1399                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'M'}));  \textcolor{comment}{// uint64 -\/ bjdata only}}
\DoxyCodeLine{1400             \}}
\DoxyCodeLine{1401             write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1402         \}}
\DoxyCodeLine{1403         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1404         \{}
\DoxyCodeLine{1405             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1406             \{}
\DoxyCodeLine{1407                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'H'}));  \textcolor{comment}{// high-\/precision number}}
\DoxyCodeLine{1408             \}}
\DoxyCodeLine{1409 }
\DoxyCodeLine{1410             \textcolor{keyword}{const} \textcolor{keyword}{auto} number = BasicJsonType(n).dump();}
\DoxyCodeLine{1411             write\_number\_with\_ubjson\_prefix(number.size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{1412             \textcolor{keywordflow}{for} (std::size\_t i = 0; i < number.size(); ++i)}
\DoxyCodeLine{1413             \{}
\DoxyCodeLine{1414                 oa-\/>write\_character(to\_char\_type(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(number[i])));}
\DoxyCodeLine{1415             \}}
\DoxyCodeLine{1416         \}}
\DoxyCodeLine{1417     \}}
\DoxyCodeLine{1418 }
\DoxyCodeLine{1419     \textcolor{comment}{// UBJSON: write number (signed integer)}}
\DoxyCodeLine{1420     \textcolor{keyword}{template} < \textcolor{keyword}{typename} NumberType, \textcolor{keyword}{typename} std::enable\_if <}
\DoxyCodeLine{1421                    std::is\_signed<NumberType>::value\&\&}
\DoxyCodeLine{1422                    !std::is\_floating\_point<NumberType>::value, \textcolor{keywordtype}{int} >::type = 0 >}
\DoxyCodeLine{1423     \textcolor{keywordtype}{void} write\_number\_with\_ubjson\_prefix(\textcolor{keyword}{const} NumberType n,}
\DoxyCodeLine{1424                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} add\_prefix,}
\DoxyCodeLine{1425                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_bjdata)}
\DoxyCodeLine{1426     \{}
\DoxyCodeLine{1427         \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int8\_t>::min)() <= n \&\& n <= (std::numeric\_limits<std::int8\_t>::max)())}
\DoxyCodeLine{1428         \{}
\DoxyCodeLine{1429             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1430             \{}
\DoxyCodeLine{1431                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'i'}));  \textcolor{comment}{// int8}}
\DoxyCodeLine{1432             \}}
\DoxyCodeLine{1433             write\_number(\textcolor{keyword}{static\_cast<}std::int8\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1434         \}}
\DoxyCodeLine{1435         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint8\_t>::min)()) <= n \&\& n <= \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint8\_t>::max)()))}
\DoxyCodeLine{1436         \{}
\DoxyCodeLine{1437             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1438             \{}
\DoxyCodeLine{1439                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'U'}));  \textcolor{comment}{// uint8}}
\DoxyCodeLine{1440             \}}
\DoxyCodeLine{1441             write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1442         \}}
\DoxyCodeLine{1443         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int16\_t>::min)() <= n \&\& n <= (std::numeric\_limits<std::int16\_t>::max)())}
\DoxyCodeLine{1444         \{}
\DoxyCodeLine{1445             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1446             \{}
\DoxyCodeLine{1447                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'I'}));  \textcolor{comment}{// int16}}
\DoxyCodeLine{1448             \}}
\DoxyCodeLine{1449             write\_number(\textcolor{keyword}{static\_cast<}std::int16\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1450         \}}
\DoxyCodeLine{1451         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_bjdata \&\& (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint16\_t>::min)()) <= n \&\& n <= \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint16\_t>::max)())))}
\DoxyCodeLine{1452         \{}
\DoxyCodeLine{1453             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1454             \{}
\DoxyCodeLine{1455                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'u'}));  \textcolor{comment}{// uint16 -\/ bjdata only}}
\DoxyCodeLine{1456             \}}
\DoxyCodeLine{1457             write\_number(\textcolor{keyword}{static\_cast<}uint16\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1458         \}}
\DoxyCodeLine{1459         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int32\_t>::min)() <= n \&\& n <= (std::numeric\_limits<std::int32\_t>::max)())}
\DoxyCodeLine{1460         \{}
\DoxyCodeLine{1461             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1462             \{}
\DoxyCodeLine{1463                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'l'}));  \textcolor{comment}{// int32}}
\DoxyCodeLine{1464             \}}
\DoxyCodeLine{1465             write\_number(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1466         \}}
\DoxyCodeLine{1467         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_bjdata \&\& (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint32\_t>::min)()) <= n \&\& n <= \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint32\_t>::max)())))}
\DoxyCodeLine{1468         \{}
\DoxyCodeLine{1469             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1470             \{}
\DoxyCodeLine{1471                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'m'}));  \textcolor{comment}{// uint32 -\/ bjdata only}}
\DoxyCodeLine{1472             \}}
\DoxyCodeLine{1473             write\_number(\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1474         \}}
\DoxyCodeLine{1475         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int64\_t>::min)() <= n \&\& n <= (std::numeric\_limits<std::int64\_t>::max)())}
\DoxyCodeLine{1476         \{}
\DoxyCodeLine{1477             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1478             \{}
\DoxyCodeLine{1479                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'L'}));  \textcolor{comment}{// int64}}
\DoxyCodeLine{1480             \}}
\DoxyCodeLine{1481             write\_number(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(n), use\_bjdata);}
\DoxyCodeLine{1482         \}}
\DoxyCodeLine{1483         \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{1484         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1485         \{}
\DoxyCodeLine{1486             \textcolor{keywordflow}{if} (add\_prefix)}
\DoxyCodeLine{1487             \{}
\DoxyCodeLine{1488                 oa-\/>write\_character(to\_char\_type(\textcolor{charliteral}{'H'}));  \textcolor{comment}{// high-\/precision number}}
\DoxyCodeLine{1489             \}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491             \textcolor{keyword}{const} \textcolor{keyword}{auto} number = BasicJsonType(n).dump();}
\DoxyCodeLine{1492             write\_number\_with\_ubjson\_prefix(number.size(), \textcolor{keyword}{true}, use\_bjdata);}
\DoxyCodeLine{1493             \textcolor{keywordflow}{for} (std::size\_t i = 0; i < number.size(); ++i)}
\DoxyCodeLine{1494             \{}
\DoxyCodeLine{1495                 oa-\/>write\_character(to\_char\_type(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(number[i])));}
\DoxyCodeLine{1496             \}}
\DoxyCodeLine{1497         \}}
\DoxyCodeLine{1498         \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{1499     \}}
\DoxyCodeLine{1500 }
\DoxyCodeLine{1504     CharType ubjson\_prefix(\textcolor{keyword}{const} BasicJsonType\& j, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_bjdata) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1505     \{}
\DoxyCodeLine{1506         \textcolor{keywordflow}{switch} (j.type())}
\DoxyCodeLine{1507         \{}
\DoxyCodeLine{1508             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a37a6259cc0c1dae299a7866489dff0bd}{value\_t::null}}:}
\DoxyCodeLine{1509                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'Z'};}
\DoxyCodeLine{1510 }
\DoxyCodeLine{1511             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a84e2c64f38f78ba3ea5c905ab5a2da27}{value\_t::boolean}}:}
\DoxyCodeLine{1512                 \textcolor{keywordflow}{return} j.m\_value.boolean ? \textcolor{charliteral}{'T'} : \textcolor{charliteral}{'F'};}
\DoxyCodeLine{1513 }
\DoxyCodeLine{1514             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a5763da164f8659d94a56e29df64b4bcc}{value\_t::number\_integer}}:}
\DoxyCodeLine{1515             \{}
\DoxyCodeLine{1516                 \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int8\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::int8\_t>::max)())}
\DoxyCodeLine{1517                 \{}
\DoxyCodeLine{1518                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'i'};}
\DoxyCodeLine{1519                 \}}
\DoxyCodeLine{1520                 \textcolor{keywordflow}{if} ((std::numeric\_limits<std::uint8\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::uint8\_t>::max)())}
\DoxyCodeLine{1521                 \{}
\DoxyCodeLine{1522                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'U'};}
\DoxyCodeLine{1523                 \}}
\DoxyCodeLine{1524                 \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int16\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::int16\_t>::max)())}
\DoxyCodeLine{1525                 \{}
\DoxyCodeLine{1526                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'I'};}
\DoxyCodeLine{1527                 \}}
\DoxyCodeLine{1528                 \textcolor{keywordflow}{if} (use\_bjdata \&\& ((std::numeric\_limits<std::uint16\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::uint16\_t>::max)()))}
\DoxyCodeLine{1529                 \{}
\DoxyCodeLine{1530                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'u'};}
\DoxyCodeLine{1531                 \}}
\DoxyCodeLine{1532                 \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int32\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::int32\_t>::max)())}
\DoxyCodeLine{1533                 \{}
\DoxyCodeLine{1534                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'l'};}
\DoxyCodeLine{1535                 \}}
\DoxyCodeLine{1536                 \textcolor{keywordflow}{if} (use\_bjdata \&\& ((std::numeric\_limits<std::uint32\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::uint32\_t>::max)()))}
\DoxyCodeLine{1537                 \{}
\DoxyCodeLine{1538                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'m'};}
\DoxyCodeLine{1539                 \}}
\DoxyCodeLine{1540                 \textcolor{keywordflow}{if} ((std::numeric\_limits<std::int64\_t>::min)() <= j.m\_value.number\_integer \&\& j.m\_value.number\_integer <= (std::numeric\_limits<std::int64\_t>::max)())}
\DoxyCodeLine{1541                 \{}
\DoxyCodeLine{1542                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'L'};}
\DoxyCodeLine{1543                 \}}
\DoxyCodeLine{1544                 \textcolor{comment}{// anything else is treated as high-\/precision number}}
\DoxyCodeLine{1545                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'H'}; \textcolor{comment}{// LCOV\_EXCL\_LINE}}
\DoxyCodeLine{1546             \}}
\DoxyCodeLine{1547 }
\DoxyCodeLine{1548             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632adce7cc8ec29055c4158828921f2f265e}{value\_t::number\_unsigned}}:}
\DoxyCodeLine{1549             \{}
\DoxyCodeLine{1550                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int8\_t>::max)()))}
\DoxyCodeLine{1551                 \{}
\DoxyCodeLine{1552                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'i'};}
\DoxyCodeLine{1553                 \}}
\DoxyCodeLine{1554                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint8\_t>::max)()))}
\DoxyCodeLine{1555                 \{}
\DoxyCodeLine{1556                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'U'};}
\DoxyCodeLine{1557                 \}}
\DoxyCodeLine{1558                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int16\_t>::max)()))}
\DoxyCodeLine{1559                 \{}
\DoxyCodeLine{1560                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'I'};}
\DoxyCodeLine{1561                 \}}
\DoxyCodeLine{1562                 \textcolor{keywordflow}{if} (use\_bjdata \&\& j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint16\_t>::max)()))}
\DoxyCodeLine{1563                 \{}
\DoxyCodeLine{1564                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'u'};}
\DoxyCodeLine{1565                 \}}
\DoxyCodeLine{1566                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int32\_t>::max)()))}
\DoxyCodeLine{1567                 \{}
\DoxyCodeLine{1568                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'l'};}
\DoxyCodeLine{1569                 \}}
\DoxyCodeLine{1570                 \textcolor{keywordflow}{if} (use\_bjdata \&\& j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::uint32\_t>::max)()))}
\DoxyCodeLine{1571                 \{}
\DoxyCodeLine{1572                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'m'};}
\DoxyCodeLine{1573                 \}}
\DoxyCodeLine{1574                 \textcolor{keywordflow}{if} (j.m\_value.number\_unsigned <= \textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}((std::numeric\_limits<std::int64\_t>::max)()))}
\DoxyCodeLine{1575                 \{}
\DoxyCodeLine{1576                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'L'};}
\DoxyCodeLine{1577                 \}}
\DoxyCodeLine{1578                 \textcolor{keywordflow}{if} (use\_bjdata \&\& j.m\_value.number\_unsigned <= (std::numeric\_limits<std::uint64\_t>::max)())}
\DoxyCodeLine{1579                 \{}
\DoxyCodeLine{1580                     \textcolor{keywordflow}{return} \textcolor{charliteral}{'M'};}
\DoxyCodeLine{1581                 \}}
\DoxyCodeLine{1582                 \textcolor{comment}{// anything else is treated as high-\/precision number}}
\DoxyCodeLine{1583                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'H'}; \textcolor{comment}{// LCOV\_EXCL\_LINE}}
\DoxyCodeLine{1584             \}}
\DoxyCodeLine{1585 }
\DoxyCodeLine{1586             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ad9966ecb59667235a57b4b999a649eef}{value\_t::number\_float}}:}
\DoxyCodeLine{1587                 \textcolor{keywordflow}{return} get\_ubjson\_float\_prefix(j.m\_value.number\_float);}
\DoxyCodeLine{1588 }
\DoxyCodeLine{1589             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632ab45cffe084dd3d20d928bee85e7b0f21}{value\_t::string}}:}
\DoxyCodeLine{1590                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'S'};}
\DoxyCodeLine{1591 }
\DoxyCodeLine{1592             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632af1f713c9e000f5d3f280adbd124df4f5}{value\_t::array}}: \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{1593             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a9d7183f16acce70658f686ae7f1a4d20}{value\_t::binary}}:}
\DoxyCodeLine{1594                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'['};}
\DoxyCodeLine{1595 }
\DoxyCodeLine{1596             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632aa8cfde6331bd59eb2ac96f8911c4b666}{value\_t::object}}:}
\DoxyCodeLine{1597                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'\{'};}
\DoxyCodeLine{1598 }
\DoxyCodeLine{1599             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacedetail_a917c3efabea8a20dc72d9ae2c673d632a94708897ec9db8647dfe695714c98e46}{value\_t::discarded}}:}
\DoxyCodeLine{1600             \textcolor{keywordflow}{default}:  \textcolor{comment}{// discarded values}}
\DoxyCodeLine{1601                 \textcolor{keywordflow}{return} \textcolor{charliteral}{'N'};}
\DoxyCodeLine{1602         \}}
\DoxyCodeLine{1603     \}}
\DoxyCodeLine{1604 }
\DoxyCodeLine{1605     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_ubjson\_float\_prefix(\textcolor{keywordtype}{float} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1606     \{}
\DoxyCodeLine{1607         \textcolor{keywordflow}{return} \textcolor{charliteral}{'d'};  \textcolor{comment}{// float 32}}
\DoxyCodeLine{1608     \}}
\DoxyCodeLine{1609 }
\DoxyCodeLine{1610     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType get\_ubjson\_float\_prefix(\textcolor{keywordtype}{double} \textcolor{comment}{/*unused*/})}
\DoxyCodeLine{1611     \{}
\DoxyCodeLine{1612         \textcolor{keywordflow}{return} \textcolor{charliteral}{'D'};  \textcolor{comment}{// float 64}}
\DoxyCodeLine{1613     \}}
\DoxyCodeLine{1614 }
\DoxyCodeLine{1618     \textcolor{keywordtype}{bool} write\_bjdata\_ndarray(\textcolor{keyword}{const} \textcolor{keyword}{typename} BasicJsonType::object\_t\& value, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_count, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_type)}
\DoxyCodeLine{1619     \{}
\DoxyCodeLine{1620         std::map<string\_t, CharType> bjdtype = \{\{\textcolor{stringliteral}{"{}uint8"{}}, \textcolor{charliteral}{'U'}\},  \{\textcolor{stringliteral}{"{}int8"{}}, \textcolor{charliteral}{'i'}\},  \{\textcolor{stringliteral}{"{}uint16"{}}, \textcolor{charliteral}{'u'}\}, \{\textcolor{stringliteral}{"{}int16"{}}, \textcolor{charliteral}{'I'}\},}
\DoxyCodeLine{1621             \{\textcolor{stringliteral}{"{}uint32"{}}, \textcolor{charliteral}{'m'}\}, \{\textcolor{stringliteral}{"{}int32"{}}, \textcolor{charliteral}{'l'}\}, \{\textcolor{stringliteral}{"{}uint64"{}}, \textcolor{charliteral}{'M'}\}, \{\textcolor{stringliteral}{"{}int64"{}}, \textcolor{charliteral}{'L'}\}, \{\textcolor{stringliteral}{"{}single"{}}, \textcolor{charliteral}{'d'}\}, \{\textcolor{stringliteral}{"{}double"{}}, \textcolor{charliteral}{'D'}\}, \{\textcolor{stringliteral}{"{}char"{}}, \textcolor{charliteral}{'C'}\}}
\DoxyCodeLine{1622         \};}
\DoxyCodeLine{1623 }
\DoxyCodeLine{1624         string\_t \mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}} = \textcolor{stringliteral}{"{}\_ArrayType\_"{}};}
\DoxyCodeLine{1625         \textcolor{keyword}{auto} it = bjdtype.find(\textcolor{keyword}{static\_cast<}string\_t\textcolor{keyword}{>}(value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}})));}
\DoxyCodeLine{1626         \textcolor{keywordflow}{if} (it == bjdtype.end())}
\DoxyCodeLine{1627         \{}
\DoxyCodeLine{1628             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1629         \}}
\DoxyCodeLine{1630         CharType dtype = it-\/>second;}
\DoxyCodeLine{1631 }
\DoxyCodeLine{1632         \mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}} = \textcolor{stringliteral}{"{}\_ArraySize\_"{}};}
\DoxyCodeLine{1633         std::size\_t len = (value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}).empty() ? 0 : 1);}
\DoxyCodeLine{1634         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1635         \{}
\DoxyCodeLine{1636             len *= \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(el.m\_value.number\_unsigned);}
\DoxyCodeLine{1637         \}}
\DoxyCodeLine{1638 }
\DoxyCodeLine{1639         \mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}} = \textcolor{stringliteral}{"{}\_ArrayData\_"{}};}
\DoxyCodeLine{1640         \textcolor{keywordflow}{if} (value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}).size() != len)}
\DoxyCodeLine{1641         \{}
\DoxyCodeLine{1642             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1643         \}}
\DoxyCodeLine{1644 }
\DoxyCodeLine{1645         oa-\/>write\_character(\textcolor{charliteral}{'['});}
\DoxyCodeLine{1646         oa-\/>write\_character(\textcolor{charliteral}{'\$'});}
\DoxyCodeLine{1647         oa-\/>write\_character(dtype);}
\DoxyCodeLine{1648         oa-\/>write\_character(\textcolor{charliteral}{'\#'});}
\DoxyCodeLine{1649 }
\DoxyCodeLine{1650         \mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}} = \textcolor{stringliteral}{"{}\_ArraySize\_"{}};}
\DoxyCodeLine{1651         \mbox{\hyperlink{classdetail_1_1binary__writer_a972bec9688cbc5673bb482bbe9543e2a}{write\_ubjson}}(value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}), use\_count, use\_type, \textcolor{keyword}{true},  \textcolor{keyword}{true});}
\DoxyCodeLine{1652 }
\DoxyCodeLine{1653         \mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}} = \textcolor{stringliteral}{"{}\_ArrayData\_"{}};}
\DoxyCodeLine{1654         \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'U'} || dtype == \textcolor{charliteral}{'C'})}
\DoxyCodeLine{1655         \{}
\DoxyCodeLine{1656             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1657             \{}
\DoxyCodeLine{1658                 write\_number(\textcolor{keyword}{static\_cast<}std::uint8\_t\textcolor{keyword}{>}(el.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1659             \}}
\DoxyCodeLine{1660         \}}
\DoxyCodeLine{1661         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'i'})}
\DoxyCodeLine{1662         \{}
\DoxyCodeLine{1663             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1664             \{}
\DoxyCodeLine{1665                 write\_number(\textcolor{keyword}{static\_cast<}std::int8\_t\textcolor{keyword}{>}(el.m\_value.number\_integer), \textcolor{keyword}{true});}
\DoxyCodeLine{1666             \}}
\DoxyCodeLine{1667         \}}
\DoxyCodeLine{1668         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'u'})}
\DoxyCodeLine{1669         \{}
\DoxyCodeLine{1670             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1671             \{}
\DoxyCodeLine{1672                 write\_number(\textcolor{keyword}{static\_cast<}std::uint16\_t\textcolor{keyword}{>}(el.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1673             \}}
\DoxyCodeLine{1674         \}}
\DoxyCodeLine{1675         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'I'})}
\DoxyCodeLine{1676         \{}
\DoxyCodeLine{1677             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1678             \{}
\DoxyCodeLine{1679                 write\_number(\textcolor{keyword}{static\_cast<}std::int16\_t\textcolor{keyword}{>}(el.m\_value.number\_integer), \textcolor{keyword}{true});}
\DoxyCodeLine{1680             \}}
\DoxyCodeLine{1681         \}}
\DoxyCodeLine{1682         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'m'})}
\DoxyCodeLine{1683         \{}
\DoxyCodeLine{1684             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1685             \{}
\DoxyCodeLine{1686                 write\_number(\textcolor{keyword}{static\_cast<}std::uint32\_t\textcolor{keyword}{>}(el.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1687             \}}
\DoxyCodeLine{1688         \}}
\DoxyCodeLine{1689         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'l'})}
\DoxyCodeLine{1690         \{}
\DoxyCodeLine{1691             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1692             \{}
\DoxyCodeLine{1693                 write\_number(\textcolor{keyword}{static\_cast<}std::int32\_t\textcolor{keyword}{>}(el.m\_value.number\_integer), \textcolor{keyword}{true});}
\DoxyCodeLine{1694             \}}
\DoxyCodeLine{1695         \}}
\DoxyCodeLine{1696         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'M'})}
\DoxyCodeLine{1697         \{}
\DoxyCodeLine{1698             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1699             \{}
\DoxyCodeLine{1700                 write\_number(\textcolor{keyword}{static\_cast<}std::uint64\_t\textcolor{keyword}{>}(el.m\_value.number\_unsigned), \textcolor{keyword}{true});}
\DoxyCodeLine{1701             \}}
\DoxyCodeLine{1702         \}}
\DoxyCodeLine{1703         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'L'})}
\DoxyCodeLine{1704         \{}
\DoxyCodeLine{1705             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1706             \{}
\DoxyCodeLine{1707                 write\_number(\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(el.m\_value.number\_integer), \textcolor{keyword}{true});}
\DoxyCodeLine{1708             \}}
\DoxyCodeLine{1709         \}}
\DoxyCodeLine{1710         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'d'})}
\DoxyCodeLine{1711         \{}
\DoxyCodeLine{1712             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1713             \{}
\DoxyCodeLine{1714                 write\_number(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(el.m\_value.number\_float), \textcolor{keyword}{true});}
\DoxyCodeLine{1715             \}}
\DoxyCodeLine{1716         \}}
\DoxyCodeLine{1717         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dtype == \textcolor{charliteral}{'D'})}
\DoxyCodeLine{1718         \{}
\DoxyCodeLine{1719             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& el : value.at(\mbox{\hyperlink{namespacedetail_a47b1bb0bbd3596589ed9187059c312efa3c6e0b8a9c15224a8228b9a98ca1531d}{key}}))}
\DoxyCodeLine{1720             \{}
\DoxyCodeLine{1721                 write\_number(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(el.m\_value.number\_float), \textcolor{keyword}{true});}
\DoxyCodeLine{1722             \}}
\DoxyCodeLine{1723         \}}
\DoxyCodeLine{1724         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1725     \}}
\DoxyCodeLine{1726 }
\DoxyCodeLine{1728     \textcolor{comment}{// Utility functions //}}
\DoxyCodeLine{1730 \textcolor{comment}{}}
\DoxyCodeLine{1731     \textcolor{comment}{/*}}
\DoxyCodeLine{1732 \textcolor{comment}{    @brief write a number to output input}}
\DoxyCodeLine{1733 \textcolor{comment}{    @param[in] n number of type @a NumberType}}
\DoxyCodeLine{1734 \textcolor{comment}{    @param[in] OutputIsLittleEndian Set to true if output data is}}
\DoxyCodeLine{1735 \textcolor{comment}{                                 required to be little endian}}
\DoxyCodeLine{1736 \textcolor{comment}{    @tparam NumberType the type of the number}}
\DoxyCodeLine{1737 \textcolor{comment}{}}
\DoxyCodeLine{1738 \textcolor{comment}{    @note This function needs to respect the system's endianness, because bytes}}
\DoxyCodeLine{1739 \textcolor{comment}{          in CBOR, MessagePack, and UBJSON are stored in network order (big}}
\DoxyCodeLine{1740 \textcolor{comment}{          endian) and therefore need reordering on little endian systems.}}
\DoxyCodeLine{1741 \textcolor{comment}{          On the other hand, BSON and BJData use little endian and should reorder}}
\DoxyCodeLine{1742 \textcolor{comment}{          on big endian systems.}}
\DoxyCodeLine{1743 \textcolor{comment}{    */}}
\DoxyCodeLine{1744     \textcolor{keyword}{template}<\textcolor{keyword}{typename} NumberType>}
\DoxyCodeLine{1745     \textcolor{keywordtype}{void} write\_number(\textcolor{keyword}{const} NumberType n, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} OutputIsLittleEndian = \textcolor{keyword}{false})}
\DoxyCodeLine{1746     \{}
\DoxyCodeLine{1747         \textcolor{comment}{// step 1: write number to array of length NumberType}}
\DoxyCodeLine{1748         std::array<CharType, \textcolor{keyword}{sizeof}(NumberType)> vec\{\};}
\DoxyCodeLine{1749         std::memcpy(vec.data(), \&n, \textcolor{keyword}{sizeof}(NumberType));}
\DoxyCodeLine{1750 }
\DoxyCodeLine{1751         \textcolor{comment}{// step 2: write array to output (with possible reordering)}}
\DoxyCodeLine{1752         \textcolor{keywordflow}{if} (is\_little\_endian != OutputIsLittleEndian)}
\DoxyCodeLine{1753         \{}
\DoxyCodeLine{1754             \textcolor{comment}{// reverse byte order prior to conversion if necessary}}
\DoxyCodeLine{1755             std::reverse(vec.begin(), vec.end());}
\DoxyCodeLine{1756         \}}
\DoxyCodeLine{1757 }
\DoxyCodeLine{1758         oa-\/>write\_characters(vec.data(), \textcolor{keyword}{sizeof}(NumberType));}
\DoxyCodeLine{1759     \}}
\DoxyCodeLine{1760 }
\DoxyCodeLine{1761     \textcolor{keywordtype}{void} write\_compact\_float(\textcolor{keyword}{const} number\_float\_t n, \mbox{\hyperlink{namespacedetail_a0ab3b338d0eadc6890b72cccef0ea04f}{detail::input\_format\_t}} format)}
\DoxyCodeLine{1762     \{}
\DoxyCodeLine{1763 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{1764 \textcolor{preprocessor}{\#pragma GCC diagnostic push}}
\DoxyCodeLine{1765 \textcolor{preprocessor}{\#pragma GCC diagnostic ignored "{}-\/Wfloat-\/equal"{}}}
\DoxyCodeLine{1766 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1767         \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(n) >= \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(std::numeric\_limits<float>::lowest()) \&\&}
\DoxyCodeLine{1768                 \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(n) <= \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}((std::numeric\_limits<float>::max)()) \&\&}
\DoxyCodeLine{1769                 \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(n)) == \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(n))}
\DoxyCodeLine{1770         \{}
\DoxyCodeLine{1771             oa-\/>write\_character(format == detail::input\_format\_t::cbor}
\DoxyCodeLine{1772                                 ? get\_cbor\_float\_prefix(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(n))}
\DoxyCodeLine{1773                                 : get\_msgpack\_float\_prefix(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(n)));}
\DoxyCodeLine{1774             write\_number(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(n));}
\DoxyCodeLine{1775         \}}
\DoxyCodeLine{1776         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1777         \{}
\DoxyCodeLine{1778             oa-\/>write\_character(format == detail::input\_format\_t::cbor}
\DoxyCodeLine{1779                                 ? get\_cbor\_float\_prefix(n)}
\DoxyCodeLine{1780                                 : get\_msgpack\_float\_prefix(n));}
\DoxyCodeLine{1781             write\_number(n);}
\DoxyCodeLine{1782         \}}
\DoxyCodeLine{1783 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{1784 \textcolor{preprocessor}{\#pragma GCC diagnostic pop}}
\DoxyCodeLine{1785 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1786     \}}
\DoxyCodeLine{1787 }
\DoxyCodeLine{1788   \textcolor{keyword}{public}:}
\DoxyCodeLine{1789     \textcolor{comment}{// The following to\_char\_type functions are implement the conversion}}
\DoxyCodeLine{1790     \textcolor{comment}{// between uint8\_t and CharType. In case CharType is not unsigned,}}
\DoxyCodeLine{1791     \textcolor{comment}{// such a conversion is required to allow values greater than 128.}}
\DoxyCodeLine{1792     \textcolor{comment}{// See <https://github.com/nlohmann/json/issues/1286> for a discussion.}}
\DoxyCodeLine{1793     \textcolor{keyword}{template} < \textcolor{keyword}{typename} C = CharType,}
\DoxyCodeLine{1794                enable\_if\_t < std::is\_signed<C>::value \&\& std::is\_signed<char>::value > * = \textcolor{keyword}{nullptr} >}
\DoxyCodeLine{1795     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType to\_char\_type(std::uint8\_t x) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1796     \{}
\DoxyCodeLine{1797         \textcolor{keywordflow}{return} *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&x);}
\DoxyCodeLine{1798     \}}
\DoxyCodeLine{1799 }
\DoxyCodeLine{1800     \textcolor{keyword}{template} < \textcolor{keyword}{typename} C = CharType,}
\DoxyCodeLine{1801                enable\_if\_t < std::is\_signed<C>::value \&\& std::is\_unsigned<char>::value > * = \textcolor{keyword}{nullptr} >}
\DoxyCodeLine{1802     \textcolor{keyword}{static} CharType to\_char\_type(std::uint8\_t x) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1803     \{}
\DoxyCodeLine{1804         \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(std::uint8\_t) == \textcolor{keyword}{sizeof}(CharType), \textcolor{stringliteral}{"{}size of CharType must be equal to std::uint8\_t"{}});}
\DoxyCodeLine{1805         \textcolor{keyword}{static\_assert}(std::is\_trivial<CharType>::value, \textcolor{stringliteral}{"{}CharType must be trivial"{}});}
\DoxyCodeLine{1806         CharType result;}
\DoxyCodeLine{1807         std::memcpy(\&result, \&x, \textcolor{keyword}{sizeof}(x));}
\DoxyCodeLine{1808         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1809     \}}
\DoxyCodeLine{1810 }
\DoxyCodeLine{1811     \textcolor{keyword}{template}<\textcolor{keyword}{typename} C = CharType,}
\DoxyCodeLine{1812              enable\_if\_t<std::is\_unsigned<C>::value>* = \textcolor{keyword}{nullptr}>}
\DoxyCodeLine{1813     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType to\_char\_type(std::uint8\_t x) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1814     \{}
\DoxyCodeLine{1815         \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{1816     \}}
\DoxyCodeLine{1817 }
\DoxyCodeLine{1818     \textcolor{keyword}{template} < \textcolor{keyword}{typename} InputCharType, \textcolor{keyword}{typename} C = CharType,}
\DoxyCodeLine{1819                enable\_if\_t <}
\DoxyCodeLine{1820                    std::is\_signed<C>::value \&\&}
\DoxyCodeLine{1821                    std::is\_signed<char>::value \&\&}
\DoxyCodeLine{1822                    std::is\_same<char, typename std::remove\_cv<InputCharType>::type>::value}
\DoxyCodeLine{1823                    > * = \textcolor{keyword}{nullptr} >}
\DoxyCodeLine{1824     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} CharType to\_char\_type(InputCharType x) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1825     \{}
\DoxyCodeLine{1826         \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{1827     \}}
\DoxyCodeLine{1828 }
\DoxyCodeLine{1829   \textcolor{keyword}{private}:}
\DoxyCodeLine{1831     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_little\_endian = little\_endianness();}
\DoxyCodeLine{1832 }
\DoxyCodeLine{1834     output\_adapter\_t<CharType> oa = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{1835 \};}
\DoxyCodeLine{1836 }
\DoxyCodeLine{1837 \}  \textcolor{comment}{// namespace detail}}
\DoxyCodeLine{1838 NLOHMANN\_JSON\_NAMESPACE\_END}

\end{DoxyCode}
