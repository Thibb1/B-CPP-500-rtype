\hypertarget{dr__flac_8h_source}{}\doxysection{dr\+\_\+flac.\+h}
\label{dr__flac_8h_source}\index{build/\_deps/raylib-\/src/src/external/dr\_flac.h@{build/\_deps/raylib-\/src/src/external/dr\_flac.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{FLAC audio decoder. Choice of public domain or MIT-\/0. See license statements at the end of this file.}}
\DoxyCodeLine{3 \textcolor{comment}{dr\_flac -\/ v0.12.31 -\/ 2021-\/08-\/16}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{David Reid -\/ mackron@gmail.com}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{GitHub: https://github.com/mackron/dr\_libs}}
\DoxyCodeLine{8 \textcolor{comment}{*/}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{comment}{/*}}
\DoxyCodeLine{11 \textcolor{comment}{RELEASE NOTES -\/ v0.12.0}}
\DoxyCodeLine{12 \textcolor{comment}{=======================}}
\DoxyCodeLine{13 \textcolor{comment}{Version 0.12.0 has breaking API changes including changes to the existing API and the removal of deprecated APIs.}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{Improved Client-\/Defined Memory Allocation}}
\DoxyCodeLine{17 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{18 \textcolor{comment}{The main change with this release is the addition of a more flexible way of implementing custom memory allocation routines. The}}
\DoxyCodeLine{19 \textcolor{comment}{existing system of DRFLAC\_MALLOC, DRFLAC\_REALLOC and DRFLAC\_FREE are still in place and will be used by default when no custom}}
\DoxyCodeLine{20 \textcolor{comment}{allocation callbacks are specified.}}
\DoxyCodeLine{21 \textcolor{comment}{}}
\DoxyCodeLine{22 \textcolor{comment}{To use the new system, you pass in a pointer to a drflac\_allocation\_callbacks object to drflac\_open() and family, like this:}}
\DoxyCodeLine{23 \textcolor{comment}{}}
\DoxyCodeLine{24 \textcolor{comment}{    void* my\_malloc(size\_t sz, void* pUserData)}}
\DoxyCodeLine{25 \textcolor{comment}{    \{}}
\DoxyCodeLine{26 \textcolor{comment}{        return malloc(sz);}}
\DoxyCodeLine{27 \textcolor{comment}{    \}}}
\DoxyCodeLine{28 \textcolor{comment}{    void* my\_realloc(void* p, size\_t sz, void* pUserData)}}
\DoxyCodeLine{29 \textcolor{comment}{    \{}}
\DoxyCodeLine{30 \textcolor{comment}{        return realloc(p, sz);}}
\DoxyCodeLine{31 \textcolor{comment}{    \}}}
\DoxyCodeLine{32 \textcolor{comment}{    void my\_free(void* p, void* pUserData)}}
\DoxyCodeLine{33 \textcolor{comment}{    \{}}
\DoxyCodeLine{34 \textcolor{comment}{        free(p);}}
\DoxyCodeLine{35 \textcolor{comment}{    \}}}
\DoxyCodeLine{36 \textcolor{comment}{}}
\DoxyCodeLine{37 \textcolor{comment}{    ...}}
\DoxyCodeLine{38 \textcolor{comment}{}}
\DoxyCodeLine{39 \textcolor{comment}{    drflac\_allocation\_callbacks allocationCallbacks;}}
\DoxyCodeLine{40 \textcolor{comment}{    allocationCallbacks.pUserData = \&myData;}}
\DoxyCodeLine{41 \textcolor{comment}{    allocationCallbacks.onMalloc  = my\_malloc;}}
\DoxyCodeLine{42 \textcolor{comment}{    allocationCallbacks.onRealloc = my\_realloc;}}
\DoxyCodeLine{43 \textcolor{comment}{    allocationCallbacks.onFree    = my\_free;}}
\DoxyCodeLine{44 \textcolor{comment}{    drflac* pFlac = drflac\_open\_file("{}my\_file.flac"{}, \&allocationCallbacks);}}
\DoxyCodeLine{45 \textcolor{comment}{}}
\DoxyCodeLine{46 \textcolor{comment}{The advantage of this new system is that it allows you to specify user data which will be passed in to the allocation routines.}}
\DoxyCodeLine{47 \textcolor{comment}{}}
\DoxyCodeLine{48 \textcolor{comment}{Passing in null for the allocation callbacks object will cause dr\_flac to use defaults which is the same as DRFLAC\_MALLOC,}}
\DoxyCodeLine{49 \textcolor{comment}{DRFLAC\_REALLOC and DRFLAC\_FREE and the equivalent of how it worked in previous versions.}}
\DoxyCodeLine{50 \textcolor{comment}{}}
\DoxyCodeLine{51 \textcolor{comment}{Every API that opens a drflac object now takes this extra parameter. These include the following:}}
\DoxyCodeLine{52 \textcolor{comment}{}}
\DoxyCodeLine{53 \textcolor{comment}{    drflac\_open()}}
\DoxyCodeLine{54 \textcolor{comment}{    drflac\_open\_relaxed()}}
\DoxyCodeLine{55 \textcolor{comment}{    drflac\_open\_with\_metadata()}}
\DoxyCodeLine{56 \textcolor{comment}{    drflac\_open\_with\_metadata\_relaxed()}}
\DoxyCodeLine{57 \textcolor{comment}{    drflac\_open\_file()}}
\DoxyCodeLine{58 \textcolor{comment}{    drflac\_open\_file\_with\_metadata()}}
\DoxyCodeLine{59 \textcolor{comment}{    drflac\_open\_memory()}}
\DoxyCodeLine{60 \textcolor{comment}{    drflac\_open\_memory\_with\_metadata()}}
\DoxyCodeLine{61 \textcolor{comment}{    drflac\_open\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{62 \textcolor{comment}{    drflac\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{63 \textcolor{comment}{    drflac\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{64 \textcolor{comment}{    drflac\_open\_file\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{65 \textcolor{comment}{    drflac\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{66 \textcolor{comment}{    drflac\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{67 \textcolor{comment}{    drflac\_open\_memory\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{68 \textcolor{comment}{    drflac\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{69 \textcolor{comment}{    drflac\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{70 \textcolor{comment}{}}
\DoxyCodeLine{71 \textcolor{comment}{}}
\DoxyCodeLine{72 \textcolor{comment}{}}
\DoxyCodeLine{73 \textcolor{comment}{Optimizations}}
\DoxyCodeLine{74 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{75 \textcolor{comment}{Seeking performance has been greatly improved. A new binary search based seeking algorithm has been introduced which significantly}}
\DoxyCodeLine{76 \textcolor{comment}{improves performance over the brute force method which was used when no seek table was present. Seek table based seeking also takes}}
\DoxyCodeLine{77 \textcolor{comment}{advantage of the new binary search seeking system to further improve performance there as well. Note that this depends on CRC which}}
\DoxyCodeLine{78 \textcolor{comment}{means it will be disabled when DR\_FLAC\_NO\_CRC is used.}}
\DoxyCodeLine{79 \textcolor{comment}{}}
\DoxyCodeLine{80 \textcolor{comment}{The SSE4.1 pipeline has been cleaned up and optimized. You should see some improvements with decoding speed of 24-\/bit files in}}
\DoxyCodeLine{81 \textcolor{comment}{particular. 16-\/bit streams should also see some improvement.}}
\DoxyCodeLine{82 \textcolor{comment}{}}
\DoxyCodeLine{83 \textcolor{comment}{drflac\_read\_pcm\_frames\_s16() has been optimized. Previously this sat on top of drflac\_read\_pcm\_frames\_s32() and performed it's s32}}
\DoxyCodeLine{84 \textcolor{comment}{to s16 conversion in a second pass. This is now all done in a single pass. This includes SSE2 and ARM NEON optimized paths.}}
\DoxyCodeLine{85 \textcolor{comment}{}}
\DoxyCodeLine{86 \textcolor{comment}{A minor optimization has been implemented for drflac\_read\_pcm\_frames\_s32(). This will now use an SSE2 optimized pipeline for stereo}}
\DoxyCodeLine{87 \textcolor{comment}{channel reconstruction which is the last part of the decoding process.}}
\DoxyCodeLine{88 \textcolor{comment}{}}
\DoxyCodeLine{89 \textcolor{comment}{The ARM build has seen a few improvements. The CLZ (count leading zeroes) and REV (byte swap) instructions are now used when}}
\DoxyCodeLine{90 \textcolor{comment}{compiling with GCC and Clang which is achieved using inline assembly. The CLZ instruction requires ARM architecture version 5 at}}
\DoxyCodeLine{91 \textcolor{comment}{compile time and the REV instruction requires ARM architecture version 6.}}
\DoxyCodeLine{92 \textcolor{comment}{}}
\DoxyCodeLine{93 \textcolor{comment}{An ARM NEON optimized pipeline has been implemented. To enable this you'll need to add -\/mfpu=neon to the command line when compiling.}}
\DoxyCodeLine{94 \textcolor{comment}{}}
\DoxyCodeLine{95 \textcolor{comment}{}}
\DoxyCodeLine{96 \textcolor{comment}{Removed APIs}}
\DoxyCodeLine{97 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{98 \textcolor{comment}{The following APIs were deprecated in version 0.11.0 and have been completely removed in version 0.12.0:}}
\DoxyCodeLine{99 \textcolor{comment}{}}
\DoxyCodeLine{100 \textcolor{comment}{    drflac\_read\_s32()                   -\/> drflac\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{101 \textcolor{comment}{    drflac\_read\_s16()                   -\/> drflac\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{102 \textcolor{comment}{    drflac\_read\_f32()                   -\/> drflac\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{103 \textcolor{comment}{    drflac\_seek\_to\_sample()             -\/> drflac\_seek\_to\_pcm\_frame()}}
\DoxyCodeLine{104 \textcolor{comment}{    drflac\_open\_and\_decode\_s32()        -\/> drflac\_open\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{105 \textcolor{comment}{    drflac\_open\_and\_decode\_s16()        -\/> drflac\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{106 \textcolor{comment}{    drflac\_open\_and\_decode\_f32()        -\/> drflac\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{107 \textcolor{comment}{    drflac\_open\_and\_decode\_file\_s32()   -\/> drflac\_open\_file\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{108 \textcolor{comment}{    drflac\_open\_and\_decode\_file\_s16()   -\/> drflac\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{109 \textcolor{comment}{    drflac\_open\_and\_decode\_file\_f32()   -\/> drflac\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{110 \textcolor{comment}{    drflac\_open\_and\_decode\_memory\_s32() -\/> drflac\_open\_memory\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{111 \textcolor{comment}{    drflac\_open\_and\_decode\_memory\_s16() -\/> drflac\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{112 \textcolor{comment}{    drflac\_open\_and\_decode\_memory\_f32() -\/> drflac\_open\_memroy\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{113 \textcolor{comment}{}}
\DoxyCodeLine{114 \textcolor{comment}{Prior versions of dr\_flac operated on a per-\/sample basis whereas now it operates on PCM frames. The removed APIs all relate}}
\DoxyCodeLine{115 \textcolor{comment}{to the old per-\/sample APIs. You now need to use the "{}pcm\_frame"{} versions.}}
\DoxyCodeLine{116 \textcolor{comment}{*/}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 }
\DoxyCodeLine{119 \textcolor{comment}{/*}}
\DoxyCodeLine{120 \textcolor{comment}{Introduction}}
\DoxyCodeLine{121 \textcolor{comment}{============}}
\DoxyCodeLine{122 \textcolor{comment}{dr\_flac is a single file library. To use it, do something like the following in one .c file.}}
\DoxyCodeLine{123 \textcolor{comment}{}}
\DoxyCodeLine{124 \textcolor{comment}{    ```c}}
\DoxyCodeLine{125 \textcolor{comment}{    \#define DR\_FLAC\_IMPLEMENTATION}}
\DoxyCodeLine{126 \textcolor{comment}{    \#include "{}dr\_flac.h"{}}}
\DoxyCodeLine{127 \textcolor{comment}{    ```}}
\DoxyCodeLine{128 \textcolor{comment}{}}
\DoxyCodeLine{129 \textcolor{comment}{You can then \#include this file in other parts of the program as you would with any other header file. To decode audio data, do something like the following:}}
\DoxyCodeLine{130 \textcolor{comment}{}}
\DoxyCodeLine{131 \textcolor{comment}{    ```c}}
\DoxyCodeLine{132 \textcolor{comment}{    drflac* pFlac = drflac\_open\_file("{}MySong.flac"{}, NULL);}}
\DoxyCodeLine{133 \textcolor{comment}{    if (pFlac == NULL) \{}}
\DoxyCodeLine{134 \textcolor{comment}{        // Failed to open FLAC file}}
\DoxyCodeLine{135 \textcolor{comment}{    \}}}
\DoxyCodeLine{136 \textcolor{comment}{}}
\DoxyCodeLine{137 \textcolor{comment}{    drflac\_int32* pSamples = malloc(pFlac-\/>totalPCMFrameCount * pFlac-\/>channels * sizeof(drflac\_int32));}}
\DoxyCodeLine{138 \textcolor{comment}{    drflac\_uint64 numberOfInterleavedSamplesActuallyRead = drflac\_read\_pcm\_frames\_s32(pFlac, pFlac-\/>totalPCMFrameCount, pSamples);}}
\DoxyCodeLine{139 \textcolor{comment}{    ```}}
\DoxyCodeLine{140 \textcolor{comment}{}}
\DoxyCodeLine{141 \textcolor{comment}{The drflac object represents the decoder. It is a transparent type so all the information you need, such as the number of channels and the bits per sample,}}
\DoxyCodeLine{142 \textcolor{comment}{should be directly accessible -\/ just make sure you don't change their values. Samples are always output as interleaved signed 32-\/bit PCM. In the example above}}
\DoxyCodeLine{143 \textcolor{comment}{a native FLAC stream was opened, however dr\_flac has seamless support for Ogg encapsulated FLAC streams as well.}}
\DoxyCodeLine{144 \textcolor{comment}{}}
\DoxyCodeLine{145 \textcolor{comment}{You do not need to decode the entire stream in one go -\/ you just specify how many samples you'd like at any given time and the decoder will give you as many}}
\DoxyCodeLine{146 \textcolor{comment}{samples as it can, up to the amount requested. Later on when you need the next batch of samples, just call it again. Example:}}
\DoxyCodeLine{147 \textcolor{comment}{}}
\DoxyCodeLine{148 \textcolor{comment}{    ```c}}
\DoxyCodeLine{149 \textcolor{comment}{    while (drflac\_read\_pcm\_frames\_s32(pFlac, chunkSizeInPCMFrames, pChunkSamples) > 0) \{}}
\DoxyCodeLine{150 \textcolor{comment}{        do\_something();}}
\DoxyCodeLine{151 \textcolor{comment}{    \}}}
\DoxyCodeLine{152 \textcolor{comment}{    ```}}
\DoxyCodeLine{153 \textcolor{comment}{}}
\DoxyCodeLine{154 \textcolor{comment}{You can seek to a specific PCM frame with `drflac\_seek\_to\_pcm\_frame()`.}}
\DoxyCodeLine{155 \textcolor{comment}{}}
\DoxyCodeLine{156 \textcolor{comment}{If you just want to quickly decode an entire FLAC file in one go you can do something like this:}}
\DoxyCodeLine{157 \textcolor{comment}{}}
\DoxyCodeLine{158 \textcolor{comment}{    ```c}}
\DoxyCodeLine{159 \textcolor{comment}{    unsigned int channels;}}
\DoxyCodeLine{160 \textcolor{comment}{    unsigned int sampleRate;}}
\DoxyCodeLine{161 \textcolor{comment}{    drflac\_uint64 totalPCMFrameCount;}}
\DoxyCodeLine{162 \textcolor{comment}{    drflac\_int32* pSampleData = drflac\_open\_file\_and\_read\_pcm\_frames\_s32("{}MySong.flac"{}, \&channels, \&sampleRate, \&totalPCMFrameCount, NULL);}}
\DoxyCodeLine{163 \textcolor{comment}{    if (pSampleData == NULL) \{}}
\DoxyCodeLine{164 \textcolor{comment}{        // Failed to open and decode FLAC file.}}
\DoxyCodeLine{165 \textcolor{comment}{    \}}}
\DoxyCodeLine{166 \textcolor{comment}{}}
\DoxyCodeLine{167 \textcolor{comment}{    ...}}
\DoxyCodeLine{168 \textcolor{comment}{}}
\DoxyCodeLine{169 \textcolor{comment}{    drflac\_free(pSampleData, NULL);}}
\DoxyCodeLine{170 \textcolor{comment}{    ```}}
\DoxyCodeLine{171 \textcolor{comment}{}}
\DoxyCodeLine{172 \textcolor{comment}{You can read samples as signed 16-\/bit integer and 32-\/bit floating-\/point PCM with the *\_s16() and *\_f32() family of APIs respectively, but note that these}}
\DoxyCodeLine{173 \textcolor{comment}{should be considered lossy.}}
\DoxyCodeLine{174 \textcolor{comment}{}}
\DoxyCodeLine{175 \textcolor{comment}{}}
\DoxyCodeLine{176 \textcolor{comment}{If you need access to metadata (album art, etc.), use `drflac\_open\_with\_metadata()`, `drflac\_open\_file\_with\_metdata()` or `drflac\_open\_memory\_with\_metadata()`.}}
\DoxyCodeLine{177 \textcolor{comment}{The rationale for keeping these APIs separate is that they're slightly slower than the normal versions and also just a little bit harder to use. dr\_flac}}
\DoxyCodeLine{178 \textcolor{comment}{reports metadata to the application through the use of a callback, and every metadata block is reported before `drflac\_open\_with\_metdata()` returns.}}
\DoxyCodeLine{179 \textcolor{comment}{}}
\DoxyCodeLine{180 \textcolor{comment}{The main opening APIs (`drflac\_open()`, etc.) will fail if the header is not present. The presents a problem in certain scenarios such as broadcast style}}
\DoxyCodeLine{181 \textcolor{comment}{streams or internet radio where the header may not be present because the user has started playback mid-\/stream. To handle this, use the relaxed APIs:}}
\DoxyCodeLine{182 \textcolor{comment}{    }}
\DoxyCodeLine{183 \textcolor{comment}{    `drflac\_open\_relaxed()`}}
\DoxyCodeLine{184 \textcolor{comment}{    `drflac\_open\_with\_metadata\_relaxed()`}}
\DoxyCodeLine{185 \textcolor{comment}{}}
\DoxyCodeLine{186 \textcolor{comment}{It is not recommended to use these APIs for file based streams because a missing header would usually indicate a corrupt or perverse file. In addition, these}}
\DoxyCodeLine{187 \textcolor{comment}{APIs can take a long time to initialize because they may need to spend a lot of time finding the first frame.}}
\DoxyCodeLine{188 \textcolor{comment}{}}
\DoxyCodeLine{189 \textcolor{comment}{}}
\DoxyCodeLine{190 \textcolor{comment}{}}
\DoxyCodeLine{191 \textcolor{comment}{Build Options}}
\DoxyCodeLine{192 \textcolor{comment}{=============}}
\DoxyCodeLine{193 \textcolor{comment}{\#define these options before including this file.}}
\DoxyCodeLine{194 \textcolor{comment}{}}
\DoxyCodeLine{195 \textcolor{comment}{\#define DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{196 \textcolor{comment}{  Disable `drflac\_open\_file()` and family.}}
\DoxyCodeLine{197 \textcolor{comment}{}}
\DoxyCodeLine{198 \textcolor{comment}{\#define DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{199 \textcolor{comment}{  Disables support for Ogg/FLAC streams.}}
\DoxyCodeLine{200 \textcolor{comment}{}}
\DoxyCodeLine{201 \textcolor{comment}{\#define DR\_FLAC\_BUFFER\_SIZE <number>}}
\DoxyCodeLine{202 \textcolor{comment}{  Defines the size of the internal buffer to store data from onRead(). This buffer is used to reduce the number of calls back to the client for more data.}}
\DoxyCodeLine{203 \textcolor{comment}{  Larger values means more memory, but better performance. My tests show diminishing returns after about 4KB (which is the default). Consider reducing this if}}
\DoxyCodeLine{204 \textcolor{comment}{  you have a very efficient implementation of onRead(), or increase it if it's very inefficient. Must be a multiple of 8.}}
\DoxyCodeLine{205 \textcolor{comment}{}}
\DoxyCodeLine{206 \textcolor{comment}{\#define DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{207 \textcolor{comment}{  Disables CRC checks. This will offer a performance boost when CRC is unnecessary. This will disable binary search seeking. When seeking, the seek table will}}
\DoxyCodeLine{208 \textcolor{comment}{  be used if available. Otherwise the seek will be performed using brute force.}}
\DoxyCodeLine{209 \textcolor{comment}{}}
\DoxyCodeLine{210 \textcolor{comment}{\#define DR\_FLAC\_NO\_SIMD}}
\DoxyCodeLine{211 \textcolor{comment}{  Disables SIMD optimizations (SSE on x86/x64 architectures, NEON on ARM architectures). Use this if you are having compatibility issues with your compiler.}}
\DoxyCodeLine{212 \textcolor{comment}{}}
\DoxyCodeLine{213 \textcolor{comment}{}}
\DoxyCodeLine{214 \textcolor{comment}{}}
\DoxyCodeLine{215 \textcolor{comment}{Notes}}
\DoxyCodeLine{216 \textcolor{comment}{=====}}
\DoxyCodeLine{217 \textcolor{comment}{-\/ dr\_flac does not support changing the sample rate nor channel count mid stream.}}
\DoxyCodeLine{218 \textcolor{comment}{-\/ dr\_flac is not thread-\/safe, but its APIs can be called from any thread so long as you do your own synchronization.}}
\DoxyCodeLine{219 \textcolor{comment}{-\/ When using Ogg encapsulation, a corrupted metadata block will result in `drflac\_open\_with\_metadata()` and `drflac\_open()` returning inconsistent samples due}}
\DoxyCodeLine{220 \textcolor{comment}{  to differences in corrupted stream recorvery logic between the two APIs.}}
\DoxyCodeLine{221 \textcolor{comment}{*/}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223 \textcolor{preprocessor}{\#ifndef dr\_flac\_h}}
\DoxyCodeLine{224 \textcolor{preprocessor}{\#define dr\_flac\_h}}
\DoxyCodeLine{225 }
\DoxyCodeLine{226 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{227 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{228 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{229 }
\DoxyCodeLine{230 \textcolor{preprocessor}{\#define DRFLAC\_STRINGIFY(x)      \#x}}
\DoxyCodeLine{231 \textcolor{preprocessor}{\#define DRFLAC\_XSTRINGIFY(x)     DRFLAC\_STRINGIFY(x)}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{preprocessor}{\#define DRFLAC\_VERSION\_MAJOR     0}}
\DoxyCodeLine{234 \textcolor{preprocessor}{\#define DRFLAC\_VERSION\_MINOR     12}}
\DoxyCodeLine{235 \textcolor{preprocessor}{\#define DRFLAC\_VERSION\_REVISION  31}}
\DoxyCodeLine{236 \textcolor{preprocessor}{\#define DRFLAC\_VERSION\_STRING    DRFLAC\_XSTRINGIFY(DRFLAC\_VERSION\_MAJOR) "{}."{}} DRFLAC\_XSTRINGIFY(DRFLAC\_VERSION\_MINOR) "{}."{} DRFLAC\_XSTRINGIFY(DRFLAC\_VERSION\_REVISION)}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 \textcolor{preprocessor}{\#include <stddef.h>} \textcolor{comment}{/* For size\_t. */}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 \textcolor{comment}{/* Sized types. */}}
\DoxyCodeLine{241 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char}           drflac\_int8;}
\DoxyCodeLine{242 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}           drflac\_uint8;}
\DoxyCodeLine{243 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{short}          drflac\_int16;}
\DoxyCodeLine{244 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}          drflac\_uint16;}
\DoxyCodeLine{245 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{int}            drflac\_int32;}
\DoxyCodeLine{246 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}            drflac\_uint32;}
\DoxyCodeLine{247 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{248     \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \_\_int64    drflac\_int64;}
\DoxyCodeLine{249     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \_\_int64    drflac\_uint64;}
\DoxyCodeLine{250 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{251 \textcolor{preprocessor}{    \#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{252 \textcolor{preprocessor}{        \#pragma GCC diagnostic push}}
\DoxyCodeLine{253 \textcolor{preprocessor}{        \#pragma GCC diagnostic ignored "{}-\/Wlong-\/long"{}}}
\DoxyCodeLine{254 \textcolor{preprocessor}{        \#if defined(\_\_clang\_\_)}}
\DoxyCodeLine{255 \textcolor{preprocessor}{            \#pragma GCC diagnostic ignored "{}-\/Wc++11-\/long-\/long"{}}}
\DoxyCodeLine{256 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{257 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{258     \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  drflac\_int64;}
\DoxyCodeLine{259     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  drflac\_uint64;}
\DoxyCodeLine{260 \textcolor{preprocessor}{    \#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{261 \textcolor{preprocessor}{        \#pragma GCC diagnostic pop}}
\DoxyCodeLine{262 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{263 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{264 \textcolor{preprocessor}{\#if defined(\_\_LP64\_\_) || defined(\_WIN64) || (defined(\_\_x86\_64\_\_) \&\& !defined(\_\_ILP32\_\_)) || defined(\_M\_X64) || defined(\_\_ia64) || defined (\_M\_IA64) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64) || defined(\_\_powerpc64\_\_)}}
\DoxyCodeLine{265     \textcolor{keyword}{typedef} drflac\_uint64       drflac\_uintptr;}
\DoxyCodeLine{266 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{267     \textcolor{keyword}{typedef} drflac\_uint32       drflac\_uintptr;}
\DoxyCodeLine{268 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{269 \textcolor{keyword}{typedef} drflac\_uint8            drflac\_bool8;}
\DoxyCodeLine{270 \textcolor{keyword}{typedef} drflac\_uint32           drflac\_bool32;}
\DoxyCodeLine{271 \textcolor{preprocessor}{\#define DRFLAC\_TRUE             1}}
\DoxyCodeLine{272 \textcolor{preprocessor}{\#define DRFLAC\_FALSE            0}}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{preprocessor}{\#if !defined(DRFLAC\_API)}}
\DoxyCodeLine{275 \textcolor{preprocessor}{    \#if defined(DRFLAC\_DLL)}}
\DoxyCodeLine{276 \textcolor{preprocessor}{        \#if defined(\_WIN32)}}
\DoxyCodeLine{277 \textcolor{preprocessor}{            \#define DRFLAC\_DLL\_IMPORT  \_\_declspec(dllimport)}}
\DoxyCodeLine{278 \textcolor{preprocessor}{            \#define DRFLAC\_DLL\_EXPORT  \_\_declspec(dllexport)}}
\DoxyCodeLine{279 \textcolor{preprocessor}{            \#define DRFLAC\_DLL\_PRIVATE static}}
\DoxyCodeLine{280 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{281 \textcolor{preprocessor}{            \#if defined(\_\_GNUC\_\_) \&\& \_\_GNUC\_\_ >= 4}}
\DoxyCodeLine{282 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_IMPORT  \_\_attribute\_\_((visibility("{}default"{}})))}
\DoxyCodeLine{283 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_EXPORT  \_\_attribute\_\_((visibility("{}default"{}})))}
\DoxyCodeLine{284 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_PRIVATE \_\_attribute\_\_((visibility("{}hidden"{}})))}
\DoxyCodeLine{285 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{286 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_IMPORT}}
\DoxyCodeLine{287 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_EXPORT}}
\DoxyCodeLine{288 \textcolor{preprocessor}{                \#define DRFLAC\_DLL\_PRIVATE static}}
\DoxyCodeLine{289 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{290 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{291 }
\DoxyCodeLine{292 \textcolor{preprocessor}{        \#if defined(DR\_FLAC\_IMPLEMENTATION) || defined(DRFLAC\_IMPLEMENTATION)}}
\DoxyCodeLine{293 \textcolor{preprocessor}{            \#define DRFLAC\_API  DRFLAC\_DLL\_EXPORT}}
\DoxyCodeLine{294 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{295 \textcolor{preprocessor}{            \#define DRFLAC\_API  DRFLAC\_DLL\_IMPORT}}
\DoxyCodeLine{296 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{297 \textcolor{preprocessor}{        \#define DRFLAC\_PRIVATE DRFLAC\_DLL\_PRIVATE}}
\DoxyCodeLine{298 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{299 \textcolor{preprocessor}{        \#define DRFLAC\_API extern}}
\DoxyCodeLine{300 \textcolor{preprocessor}{        \#define DRFLAC\_PRIVATE static}}
\DoxyCodeLine{301 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{302 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1700   }\textcolor{comment}{/* Visual Studio 2012 */}\textcolor{preprocessor}{}}
\DoxyCodeLine{305 \textcolor{preprocessor}{    \#define DRFLAC\_DEPRECATED       \_\_declspec(deprecated)}}
\DoxyCodeLine{306 \textcolor{preprocessor}{\#elif (defined(\_\_GNUC\_\_) \&\& \_\_GNUC\_\_ >= 4)  }\textcolor{comment}{/* GCC 4 */}\textcolor{preprocessor}{}}
\DoxyCodeLine{307 \textcolor{preprocessor}{    \#define DRFLAC\_DEPRECATED       \_\_attribute\_\_((deprecated))}}
\DoxyCodeLine{308 \textcolor{preprocessor}{\#elif defined(\_\_has\_feature)                }\textcolor{comment}{/* Clang */}\textcolor{preprocessor}{}}
\DoxyCodeLine{309 \textcolor{preprocessor}{    \#if \_\_has\_feature(attribute\_deprecated)}}
\DoxyCodeLine{310 \textcolor{preprocessor}{        \#define DRFLAC\_DEPRECATED   \_\_attribute\_\_((deprecated))}}
\DoxyCodeLine{311 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{312 \textcolor{preprocessor}{        \#define DRFLAC\_DEPRECATED}}
\DoxyCodeLine{313 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{314 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{315 \textcolor{preprocessor}{    \#define DRFLAC\_DEPRECATED}}
\DoxyCodeLine{316 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{317 }
\DoxyCodeLine{318 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_version(drflac\_uint32* pMajor, drflac\_uint32* pMinor, drflac\_uint32* pRevision);}
\DoxyCodeLine{319 DRFLAC\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drflac\_version\_string(\textcolor{keywordtype}{void});}
\DoxyCodeLine{320 }
\DoxyCodeLine{321 \textcolor{comment}{/*}}
\DoxyCodeLine{322 \textcolor{comment}{As data is read from the client it is placed into an internal buffer for fast access. This controls the size of that buffer. Larger values means more speed,}}
\DoxyCodeLine{323 \textcolor{comment}{but also more memory. In my testing there is diminishing returns after about 4KB, but you can fiddle with this to suit your own needs. Must be a multiple of 8.}}
\DoxyCodeLine{324 \textcolor{comment}{*/}}
\DoxyCodeLine{325 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_BUFFER\_SIZE}}
\DoxyCodeLine{326 \textcolor{preprocessor}{\#define DR\_FLAC\_BUFFER\_SIZE   4096}}
\DoxyCodeLine{327 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{328 }
\DoxyCodeLine{329 \textcolor{comment}{/* Check if we can enable 64-\/bit optimizations. */}}
\DoxyCodeLine{330 \textcolor{preprocessor}{\#if defined(\_WIN64) || defined(\_LP64) || defined(\_\_LP64\_\_)}}
\DoxyCodeLine{331 \textcolor{preprocessor}{\#define DRFLAC\_64BIT}}
\DoxyCodeLine{332 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{333 }
\DoxyCodeLine{334 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{335 \textcolor{keyword}{typedef} drflac\_uint64 drflac\_cache\_t;}
\DoxyCodeLine{336 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{337 \textcolor{keyword}{typedef} drflac\_uint32 drflac\_cache\_t;}
\DoxyCodeLine{338 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{339 }
\DoxyCodeLine{340 \textcolor{comment}{/* The various metadata block types. */}}
\DoxyCodeLine{341 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_STREAMINFO       0}}
\DoxyCodeLine{342 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_PADDING          1}}
\DoxyCodeLine{343 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_APPLICATION      2}}
\DoxyCodeLine{344 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_SEEKTABLE        3}}
\DoxyCodeLine{345 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_VORBIS\_COMMENT   4}}
\DoxyCodeLine{346 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_CUESHEET         5}}
\DoxyCodeLine{347 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_PICTURE          6}}
\DoxyCodeLine{348 \textcolor{preprocessor}{\#define DRFLAC\_METADATA\_BLOCK\_TYPE\_INVALID          127}}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 \textcolor{comment}{/* The various picture types specified in the PICTURE block. */}}
\DoxyCodeLine{351 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_OTHER                   0}}
\DoxyCodeLine{352 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_FILE\_ICON               1}}
\DoxyCodeLine{353 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_OTHER\_FILE\_ICON         2}}
\DoxyCodeLine{354 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_COVER\_FRONT             3}}
\DoxyCodeLine{355 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_COVER\_BACK              4}}
\DoxyCodeLine{356 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_LEAFLET\_PAGE            5}}
\DoxyCodeLine{357 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_MEDIA                   6}}
\DoxyCodeLine{358 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_LEAD\_ARTIST             7}}
\DoxyCodeLine{359 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_ARTIST                  8}}
\DoxyCodeLine{360 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_CONDUCTOR               9}}
\DoxyCodeLine{361 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_BAND                    10}}
\DoxyCodeLine{362 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_COMPOSER                11}}
\DoxyCodeLine{363 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_LYRICIST                12}}
\DoxyCodeLine{364 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_RECORDING\_LOCATION      13}}
\DoxyCodeLine{365 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_DURING\_RECORDING        14}}
\DoxyCodeLine{366 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_DURING\_PERFORMANCE      15}}
\DoxyCodeLine{367 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_SCREEN\_CAPTURE          16}}
\DoxyCodeLine{368 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_BRIGHT\_COLORED\_FISH     17}}
\DoxyCodeLine{369 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_ILLUSTRATION            18}}
\DoxyCodeLine{370 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_BAND\_LOGOTYPE           19}}
\DoxyCodeLine{371 \textcolor{preprocessor}{\#define DRFLAC\_PICTURE\_TYPE\_PUBLISHER\_LOGOTYPE      20}}
\DoxyCodeLine{372 }
\DoxyCodeLine{373 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{374 \{}
\DoxyCodeLine{375     drflac\_container\_native,}
\DoxyCodeLine{376     drflac\_container\_ogg,}
\DoxyCodeLine{377     drflac\_container\_unknown}
\DoxyCodeLine{378 \} drflac\_container;}
\DoxyCodeLine{379 }
\DoxyCodeLine{380 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{381 \{}
\DoxyCodeLine{382     drflac\_seek\_origin\_start,}
\DoxyCodeLine{383     drflac\_seek\_origin\_current}
\DoxyCodeLine{384 \} drflac\_seek\_origin;}
\DoxyCodeLine{385 }
\DoxyCodeLine{386 \textcolor{comment}{/* Packing is important on this structure because we map this directly to the raw data within the SEEKTABLE metadata block. */}}
\DoxyCodeLine{387 \textcolor{preprocessor}{\#pragma pack(2)}}
\DoxyCodeLine{388 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{389 \{}
\DoxyCodeLine{390     drflac\_uint64 firstPCMFrame;}
\DoxyCodeLine{391     drflac\_uint64 flacFrameOffset;   \textcolor{comment}{/* The offset from the first byte of the header of the first frame. */}}
\DoxyCodeLine{392     drflac\_uint16 pcmFrameCount;}
\DoxyCodeLine{393 \} \mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}};}
\DoxyCodeLine{394 \textcolor{preprocessor}{\#pragma pack()}}
\DoxyCodeLine{395 }
\DoxyCodeLine{396 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{397 \{}
\DoxyCodeLine{398     drflac\_uint16 minBlockSizeInPCMFrames;}
\DoxyCodeLine{399     drflac\_uint16 maxBlockSizeInPCMFrames;}
\DoxyCodeLine{400     drflac\_uint32 minFrameSizeInPCMFrames;}
\DoxyCodeLine{401     drflac\_uint32 maxFrameSizeInPCMFrames;}
\DoxyCodeLine{402     drflac\_uint32 sampleRate;}
\DoxyCodeLine{403     drflac\_uint8  channels;}
\DoxyCodeLine{404     drflac\_uint8  bitsPerSample;}
\DoxyCodeLine{405     drflac\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{406     drflac\_uint8  md5[16];}
\DoxyCodeLine{407 \} \mbox{\hyperlink{structdrflac__streaminfo}{drflac\_streaminfo}};}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{410 \{}
\DoxyCodeLine{411     \textcolor{comment}{/*}}
\DoxyCodeLine{412 \textcolor{comment}{    The metadata type. Use this to know how to interpret the data below. Will be set to one of the}}
\DoxyCodeLine{413 \textcolor{comment}{    DRFLAC\_METADATA\_BLOCK\_TYPE\_* tokens.}}
\DoxyCodeLine{414 \textcolor{comment}{    */}}
\DoxyCodeLine{415     drflac\_uint32 type;}
\DoxyCodeLine{416 }
\DoxyCodeLine{417     \textcolor{comment}{/*}}
\DoxyCodeLine{418 \textcolor{comment}{    A pointer to the raw data. This points to a temporary buffer so don't hold on to it. It's best to}}
\DoxyCodeLine{419 \textcolor{comment}{    not modify the contents of this buffer. Use the structures below for more meaningful and structured}}
\DoxyCodeLine{420 \textcolor{comment}{    information about the metadata. It's possible for this to be null.}}
\DoxyCodeLine{421 \textcolor{comment}{    */}}
\DoxyCodeLine{422     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pRawData;}
\DoxyCodeLine{423 }
\DoxyCodeLine{424     \textcolor{comment}{/* The size in bytes of the block and the buffer pointed to by pRawData if it's non-\/NULL. */}}
\DoxyCodeLine{425     drflac\_uint32 rawDataSize;}
\DoxyCodeLine{426 }
\DoxyCodeLine{427     \textcolor{keyword}{union}}
\DoxyCodeLine{428     \{}
\DoxyCodeLine{429         \mbox{\hyperlink{structdrflac__streaminfo}{drflac\_streaminfo}} streaminfo;}
\DoxyCodeLine{430 }
\DoxyCodeLine{431         \textcolor{keyword}{struct}}
\DoxyCodeLine{432         \{}
\DoxyCodeLine{433             \textcolor{keywordtype}{int} unused;}
\DoxyCodeLine{434         \} padding;}
\DoxyCodeLine{435 }
\DoxyCodeLine{436         \textcolor{keyword}{struct}}
\DoxyCodeLine{437         \{}
\DoxyCodeLine{438             drflac\_uint32 id;}
\DoxyCodeLine{439             \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData;}
\DoxyCodeLine{440             drflac\_uint32 dataSize;}
\DoxyCodeLine{441         \} application;}
\DoxyCodeLine{442 }
\DoxyCodeLine{443         \textcolor{keyword}{struct}}
\DoxyCodeLine{444         \{}
\DoxyCodeLine{445             drflac\_uint32 seekpointCount;}
\DoxyCodeLine{446             \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}* pSeekpoints;}
\DoxyCodeLine{447         \} seektable;}
\DoxyCodeLine{448 }
\DoxyCodeLine{449         \textcolor{keyword}{struct}}
\DoxyCodeLine{450         \{}
\DoxyCodeLine{451             drflac\_uint32 vendorLength;}
\DoxyCodeLine{452             \textcolor{keyword}{const} \textcolor{keywordtype}{char}* vendor;}
\DoxyCodeLine{453             drflac\_uint32 commentCount;}
\DoxyCodeLine{454             \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pComments;}
\DoxyCodeLine{455         \} vorbis\_comment;}
\DoxyCodeLine{456 }
\DoxyCodeLine{457         \textcolor{keyword}{struct}}
\DoxyCodeLine{458         \{}
\DoxyCodeLine{459             \textcolor{keywordtype}{char} catalog[128];}
\DoxyCodeLine{460             drflac\_uint64 leadInSampleCount;}
\DoxyCodeLine{461             drflac\_bool32 isCD;}
\DoxyCodeLine{462             drflac\_uint8 trackCount;}
\DoxyCodeLine{463             \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pTrackData;}
\DoxyCodeLine{464         \} cuesheet;}
\DoxyCodeLine{465 }
\DoxyCodeLine{466         \textcolor{keyword}{struct}}
\DoxyCodeLine{467         \{}
\DoxyCodeLine{468             drflac\_uint32 type;}
\DoxyCodeLine{469             drflac\_uint32 mimeLength;}
\DoxyCodeLine{470             \textcolor{keyword}{const} \textcolor{keywordtype}{char}* mime;}
\DoxyCodeLine{471             drflac\_uint32 descriptionLength;}
\DoxyCodeLine{472             \textcolor{keyword}{const} \textcolor{keywordtype}{char}* description;}
\DoxyCodeLine{473             drflac\_uint32 width;}
\DoxyCodeLine{474             drflac\_uint32 height;}
\DoxyCodeLine{475             drflac\_uint32 colorDepth;}
\DoxyCodeLine{476             drflac\_uint32 indexColorCount;}
\DoxyCodeLine{477             drflac\_uint32 pictureDataSize;}
\DoxyCodeLine{478             \textcolor{keyword}{const} drflac\_uint8* pPictureData;}
\DoxyCodeLine{479         \} picture;}
\DoxyCodeLine{480     \} data;}
\DoxyCodeLine{481 \} \mbox{\hyperlink{structdrflac__metadata}{drflac\_metadata}};}
\DoxyCodeLine{482 }
\DoxyCodeLine{483 }
\DoxyCodeLine{484 \textcolor{comment}{/*}}
\DoxyCodeLine{485 \textcolor{comment}{Callback for when data needs to be read from the client.}}
\DoxyCodeLine{486 \textcolor{comment}{}}
\DoxyCodeLine{487 \textcolor{comment}{}}
\DoxyCodeLine{488 \textcolor{comment}{Parameters}}
\DoxyCodeLine{489 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{490 \textcolor{comment}{pUserData (in)}}
\DoxyCodeLine{491 \textcolor{comment}{    The user data that was passed to drflac\_open() and family.}}
\DoxyCodeLine{492 \textcolor{comment}{}}
\DoxyCodeLine{493 \textcolor{comment}{pBufferOut (out)}}
\DoxyCodeLine{494 \textcolor{comment}{    The output buffer.}}
\DoxyCodeLine{495 \textcolor{comment}{}}
\DoxyCodeLine{496 \textcolor{comment}{bytesToRead (in)}}
\DoxyCodeLine{497 \textcolor{comment}{    The number of bytes to read.}}
\DoxyCodeLine{498 \textcolor{comment}{}}
\DoxyCodeLine{499 \textcolor{comment}{}}
\DoxyCodeLine{500 \textcolor{comment}{Return Value}}
\DoxyCodeLine{501 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{502 \textcolor{comment}{The number of bytes actually read.}}
\DoxyCodeLine{503 \textcolor{comment}{}}
\DoxyCodeLine{504 \textcolor{comment}{}}
\DoxyCodeLine{505 \textcolor{comment}{Remarks}}
\DoxyCodeLine{506 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{507 \textcolor{comment}{A return value of less than bytesToRead indicates the end of the stream. Do \_not\_ return from this callback until either the entire bytesToRead is filled or}}
\DoxyCodeLine{508 \textcolor{comment}{you have reached the end of the stream.}}
\DoxyCodeLine{509 \textcolor{comment}{*/}}
\DoxyCodeLine{510 \textcolor{keyword}{typedef} size\_t (* drflac\_read\_proc)(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pBufferOut, \textcolor{keywordtype}{size\_t} bytesToRead);}
\DoxyCodeLine{511 }
\DoxyCodeLine{512 \textcolor{comment}{/*}}
\DoxyCodeLine{513 \textcolor{comment}{Callback for when data needs to be seeked.}}
\DoxyCodeLine{514 \textcolor{comment}{}}
\DoxyCodeLine{515 \textcolor{comment}{}}
\DoxyCodeLine{516 \textcolor{comment}{Parameters}}
\DoxyCodeLine{517 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{518 \textcolor{comment}{pUserData (in)}}
\DoxyCodeLine{519 \textcolor{comment}{    The user data that was passed to drflac\_open() and family.}}
\DoxyCodeLine{520 \textcolor{comment}{}}
\DoxyCodeLine{521 \textcolor{comment}{offset (in)}}
\DoxyCodeLine{522 \textcolor{comment}{    The number of bytes to move, relative to the origin. Will never be negative.}}
\DoxyCodeLine{523 \textcolor{comment}{}}
\DoxyCodeLine{524 \textcolor{comment}{origin (in)}}
\DoxyCodeLine{525 \textcolor{comment}{    The origin of the seek -\/ the current position or the start of the stream.}}
\DoxyCodeLine{526 \textcolor{comment}{}}
\DoxyCodeLine{527 \textcolor{comment}{}}
\DoxyCodeLine{528 \textcolor{comment}{Return Value}}
\DoxyCodeLine{529 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{530 \textcolor{comment}{Whether or not the seek was successful.}}
\DoxyCodeLine{531 \textcolor{comment}{}}
\DoxyCodeLine{532 \textcolor{comment}{}}
\DoxyCodeLine{533 \textcolor{comment}{Remarks}}
\DoxyCodeLine{534 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{535 \textcolor{comment}{The offset will never be negative. Whether or not it is relative to the beginning or current position is determined by the "{}origin"{} parameter which will be}}
\DoxyCodeLine{536 \textcolor{comment}{either drflac\_seek\_origin\_start or drflac\_seek\_origin\_current.}}
\DoxyCodeLine{537 \textcolor{comment}{}}
\DoxyCodeLine{538 \textcolor{comment}{When seeking to a PCM frame using drflac\_seek\_to\_pcm\_frame(), dr\_flac may call this with an offset beyond the end of the FLAC stream. This needs to be detected}}
\DoxyCodeLine{539 \textcolor{comment}{and handled by returning DRFLAC\_FALSE.}}
\DoxyCodeLine{540 \textcolor{comment}{*/}}
\DoxyCodeLine{541 \textcolor{keyword}{typedef} drflac\_bool32 (* drflac\_seek\_proc)(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drflac\_seek\_origin origin);}
\DoxyCodeLine{542 }
\DoxyCodeLine{543 \textcolor{comment}{/*}}
\DoxyCodeLine{544 \textcolor{comment}{Callback for when a metadata block is read.}}
\DoxyCodeLine{545 \textcolor{comment}{}}
\DoxyCodeLine{546 \textcolor{comment}{}}
\DoxyCodeLine{547 \textcolor{comment}{Parameters}}
\DoxyCodeLine{548 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{549 \textcolor{comment}{pUserData (in)}}
\DoxyCodeLine{550 \textcolor{comment}{    The user data that was passed to drflac\_open() and family.}}
\DoxyCodeLine{551 \textcolor{comment}{}}
\DoxyCodeLine{552 \textcolor{comment}{pMetadata (in)}}
\DoxyCodeLine{553 \textcolor{comment}{    A pointer to a structure containing the data of the metadata block.}}
\DoxyCodeLine{554 \textcolor{comment}{}}
\DoxyCodeLine{555 \textcolor{comment}{}}
\DoxyCodeLine{556 \textcolor{comment}{Remarks}}
\DoxyCodeLine{557 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{558 \textcolor{comment}{Use pMetadata-\/>type to determine which metadata block is being handled and how to read the data. This}}
\DoxyCodeLine{559 \textcolor{comment}{will be set to one of the DRFLAC\_METADATA\_BLOCK\_TYPE\_* tokens.}}
\DoxyCodeLine{560 \textcolor{comment}{*/}}
\DoxyCodeLine{561 \textcolor{keyword}{typedef} void (* drflac\_meta\_proc)(\textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrflac__metadata}{drflac\_metadata}}* pMetadata);}
\DoxyCodeLine{562 }
\DoxyCodeLine{563 }
\DoxyCodeLine{564 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{565 \{}
\DoxyCodeLine{566     \textcolor{keywordtype}{void}* pUserData;}
\DoxyCodeLine{567     \textcolor{keywordtype}{void}* (* onMalloc)(\textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{568     \textcolor{keywordtype}{void}* (* onRealloc)(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{569     void  (* onFree)(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{570 \} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}};}
\DoxyCodeLine{571 }
\DoxyCodeLine{572 \textcolor{comment}{/* Structure for internal use. Only used for decoders opened with drflac\_open\_memory. */}}
\DoxyCodeLine{573 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{574 \{}
\DoxyCodeLine{575     \textcolor{keyword}{const} drflac\_uint8* data;}
\DoxyCodeLine{576     \textcolor{keywordtype}{size\_t} dataSize;}
\DoxyCodeLine{577     \textcolor{keywordtype}{size\_t} currentReadPos;}
\DoxyCodeLine{578 \} \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}};}
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \textcolor{comment}{/* Structure for internal use. Used for bit streaming. */}}
\DoxyCodeLine{581 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{582 \{}
\DoxyCodeLine{583     \textcolor{comment}{/* The function to call when more data needs to be read. */}}
\DoxyCodeLine{584     drflac\_read\_proc onRead;}
\DoxyCodeLine{585 }
\DoxyCodeLine{586     \textcolor{comment}{/* The function to call when the current read position needs to be moved. */}}
\DoxyCodeLine{587     drflac\_seek\_proc onSeek;}
\DoxyCodeLine{588 }
\DoxyCodeLine{589     \textcolor{comment}{/* The user data to pass around to onRead and onSeek. */}}
\DoxyCodeLine{590     \textcolor{keywordtype}{void}* pUserData;}
\DoxyCodeLine{591 }
\DoxyCodeLine{592 }
\DoxyCodeLine{593     \textcolor{comment}{/*}}
\DoxyCodeLine{594 \textcolor{comment}{    The number of unaligned bytes in the L2 cache. This will always be 0 until the end of the stream is hit. At the end of the}}
\DoxyCodeLine{595 \textcolor{comment}{    stream there will be a number of bytes that don't cleanly fit in an L1 cache line, so we use this variable to know whether}}
\DoxyCodeLine{596 \textcolor{comment}{    or not the bistreamer needs to run on a slower path to read those last bytes. This will never be more than sizeof(drflac\_cache\_t).}}
\DoxyCodeLine{597 \textcolor{comment}{    */}}
\DoxyCodeLine{598     \textcolor{keywordtype}{size\_t} unalignedByteCount;}
\DoxyCodeLine{599 }
\DoxyCodeLine{600     \textcolor{comment}{/* The content of the unaligned bytes. */}}
\DoxyCodeLine{601     drflac\_cache\_t unalignedCache;}
\DoxyCodeLine{602 }
\DoxyCodeLine{603     \textcolor{comment}{/* The index of the next valid cache line in the "{}L2"{} cache. */}}
\DoxyCodeLine{604     drflac\_uint32 nextL2Line;}
\DoxyCodeLine{605 }
\DoxyCodeLine{606     \textcolor{comment}{/* The number of bits that have been consumed by the cache. This is used to determine how many valid bits are remaining. */}}
\DoxyCodeLine{607     drflac\_uint32 consumedBits;}
\DoxyCodeLine{608 }
\DoxyCodeLine{609     \textcolor{comment}{/*}}
\DoxyCodeLine{610 \textcolor{comment}{    The cached data which was most recently read from the client. There are two levels of cache. Data flows as such:}}
\DoxyCodeLine{611 \textcolor{comment}{    Client -\/> L2 -\/> L1. The L2 -\/> L1 movement is aligned and runs on a fast path in just a few instructions.}}
\DoxyCodeLine{612 \textcolor{comment}{    */}}
\DoxyCodeLine{613     drflac\_cache\_t cacheL2[DR\_FLAC\_BUFFER\_SIZE/\textcolor{keyword}{sizeof}(drflac\_cache\_t)];}
\DoxyCodeLine{614     drflac\_cache\_t cache;}
\DoxyCodeLine{615 }
\DoxyCodeLine{616     \textcolor{comment}{/*}}
\DoxyCodeLine{617 \textcolor{comment}{    CRC-\/16. This is updated whenever bits are read from the bit stream. Manually set this to 0 to reset the CRC. For FLAC, this}}
\DoxyCodeLine{618 \textcolor{comment}{    is reset to 0 at the beginning of each frame.}}
\DoxyCodeLine{619 \textcolor{comment}{    */}}
\DoxyCodeLine{620     drflac\_uint16 crc16;}
\DoxyCodeLine{621     drflac\_cache\_t crc16Cache;              \textcolor{comment}{/* A cache for optimizing CRC calculations. This is filled when when the L1 cache is reloaded. */}}
\DoxyCodeLine{622     drflac\_uint32 crc16CacheIgnoredBytes;   \textcolor{comment}{/* The number of bytes to ignore when updating the CRC-\/16 from the CRC-\/16 cache. */}}
\DoxyCodeLine{623 \} \mbox{\hyperlink{structdrflac__bs}{drflac\_bs}};}
\DoxyCodeLine{624 }
\DoxyCodeLine{625 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{626 \{}
\DoxyCodeLine{627     \textcolor{comment}{/* The type of the subframe: SUBFRAME\_CONSTANT, SUBFRAME\_VERBATIM, SUBFRAME\_FIXED or SUBFRAME\_LPC. */}}
\DoxyCodeLine{628     drflac\_uint8 subframeType;}
\DoxyCodeLine{629 }
\DoxyCodeLine{630     \textcolor{comment}{/* The number of wasted bits per sample as specified by the sub-\/frame header. */}}
\DoxyCodeLine{631     drflac\_uint8 wastedBitsPerSample;}
\DoxyCodeLine{632 }
\DoxyCodeLine{633     \textcolor{comment}{/* The order to use for the prediction stage for SUBFRAME\_FIXED and SUBFRAME\_LPC. */}}
\DoxyCodeLine{634     drflac\_uint8 lpcOrder;}
\DoxyCodeLine{635 }
\DoxyCodeLine{636     \textcolor{comment}{/* A pointer to the buffer containing the decoded samples in the subframe. This pointer is an offset from drflac::pExtraData. */}}
\DoxyCodeLine{637     drflac\_int32* pSamplesS32;}
\DoxyCodeLine{638 \} \mbox{\hyperlink{structdrflac__subframe}{drflac\_subframe}};}
\DoxyCodeLine{639 }
\DoxyCodeLine{640 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{641 \{}
\DoxyCodeLine{642     \textcolor{comment}{/*}}
\DoxyCodeLine{643 \textcolor{comment}{    If the stream uses variable block sizes, this will be set to the index of the first PCM frame. If fixed block sizes are used, this will}}
\DoxyCodeLine{644 \textcolor{comment}{    always be set to 0. This is 64-\/bit because the decoded PCM frame number will be 36 bits.}}
\DoxyCodeLine{645 \textcolor{comment}{    */}}
\DoxyCodeLine{646     drflac\_uint64 pcmFrameNumber;}
\DoxyCodeLine{647 }
\DoxyCodeLine{648     \textcolor{comment}{/*}}
\DoxyCodeLine{649 \textcolor{comment}{    If the stream uses fixed block sizes, this will be set to the frame number. If variable block sizes are used, this will always be 0. This}}
\DoxyCodeLine{650 \textcolor{comment}{    is 32-\/bit because in fixed block sizes, the maximum frame number will be 31 bits.}}
\DoxyCodeLine{651 \textcolor{comment}{    */}}
\DoxyCodeLine{652     drflac\_uint32 flacFrameNumber;}
\DoxyCodeLine{653 }
\DoxyCodeLine{654     \textcolor{comment}{/* The sample rate of this frame. */}}
\DoxyCodeLine{655     drflac\_uint32 sampleRate;}
\DoxyCodeLine{656 }
\DoxyCodeLine{657     \textcolor{comment}{/* The number of PCM frames in each sub-\/frame within this frame. */}}
\DoxyCodeLine{658     drflac\_uint16 blockSizeInPCMFrames;}
\DoxyCodeLine{659 }
\DoxyCodeLine{660     \textcolor{comment}{/*}}
\DoxyCodeLine{661 \textcolor{comment}{    The channel assignment of this frame. This is not always set to the channel count. If interchannel decorrelation is being used this}}
\DoxyCodeLine{662 \textcolor{comment}{    will be set to DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE, DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE or DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE.}}
\DoxyCodeLine{663 \textcolor{comment}{    */}}
\DoxyCodeLine{664     drflac\_uint8 channelAssignment;}
\DoxyCodeLine{665 }
\DoxyCodeLine{666     \textcolor{comment}{/* The number of bits per sample within this frame. */}}
\DoxyCodeLine{667     drflac\_uint8 bitsPerSample;}
\DoxyCodeLine{668 }
\DoxyCodeLine{669     \textcolor{comment}{/* The frame's CRC. */}}
\DoxyCodeLine{670     drflac\_uint8 crc8;}
\DoxyCodeLine{671 \} \mbox{\hyperlink{structdrflac__frame__header}{drflac\_frame\_header}};}
\DoxyCodeLine{672 }
\DoxyCodeLine{673 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{674 \{}
\DoxyCodeLine{675     \textcolor{comment}{/* The header. */}}
\DoxyCodeLine{676     \mbox{\hyperlink{structdrflac__frame__header}{drflac\_frame\_header}} header;}
\DoxyCodeLine{677 }
\DoxyCodeLine{678     \textcolor{comment}{/*}}
\DoxyCodeLine{679 \textcolor{comment}{    The number of PCM frames left to be read in this FLAC frame. This is initially set to the block size. As PCM frames are read,}}
\DoxyCodeLine{680 \textcolor{comment}{    this will be decremented. When it reaches 0, the decoder will see this frame as fully consumed and load the next frame.}}
\DoxyCodeLine{681 \textcolor{comment}{    */}}
\DoxyCodeLine{682     drflac\_uint32 pcmFramesRemaining;}
\DoxyCodeLine{683 }
\DoxyCodeLine{684     \textcolor{comment}{/* The list of sub-\/frames within the frame. There is one sub-\/frame for each channel, and there's a maximum of 8 channels. */}}
\DoxyCodeLine{685     \mbox{\hyperlink{structdrflac__subframe}{drflac\_subframe}} subframes[8];}
\DoxyCodeLine{686 \} \mbox{\hyperlink{structdrflac__frame}{drflac\_frame}};}
\DoxyCodeLine{687 }
\DoxyCodeLine{688 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{689 \{}
\DoxyCodeLine{690     \textcolor{comment}{/* The function to call when a metadata block is read. */}}
\DoxyCodeLine{691     drflac\_meta\_proc onMeta;}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     \textcolor{comment}{/* The user data posted to the metadata callback function. */}}
\DoxyCodeLine{694     \textcolor{keywordtype}{void}* pUserDataMD;}
\DoxyCodeLine{695 }
\DoxyCodeLine{696     \textcolor{comment}{/* Memory allocation callbacks. */}}
\DoxyCodeLine{697     \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}} allocationCallbacks;}
\DoxyCodeLine{698 }
\DoxyCodeLine{699 }
\DoxyCodeLine{700     \textcolor{comment}{/* The sample rate. Will be set to something like 44100. */}}
\DoxyCodeLine{701     drflac\_uint32 sampleRate;}
\DoxyCodeLine{702 }
\DoxyCodeLine{703     \textcolor{comment}{/*}}
\DoxyCodeLine{704 \textcolor{comment}{    The number of channels. This will be set to 1 for monaural streams, 2 for stereo, etc. Maximum 8. This is set based on the}}
\DoxyCodeLine{705 \textcolor{comment}{    value specified in the STREAMINFO block.}}
\DoxyCodeLine{706 \textcolor{comment}{    */}}
\DoxyCodeLine{707     drflac\_uint8 channels;}
\DoxyCodeLine{708 }
\DoxyCodeLine{709     \textcolor{comment}{/* The bits per sample. Will be set to something like 16, 24, etc. */}}
\DoxyCodeLine{710     drflac\_uint8 bitsPerSample;}
\DoxyCodeLine{711 }
\DoxyCodeLine{712     \textcolor{comment}{/* The maximum block size, in samples. This number represents the number of samples in each channel (not combined). */}}
\DoxyCodeLine{713     drflac\_uint16 maxBlockSizeInPCMFrames;}
\DoxyCodeLine{714 }
\DoxyCodeLine{715     \textcolor{comment}{/*}}
\DoxyCodeLine{716 \textcolor{comment}{    The total number of PCM Frames making up the stream. Can be 0 in which case it's still a valid stream, but just means}}
\DoxyCodeLine{717 \textcolor{comment}{    the total PCM frame count is unknown. Likely the case with streams like internet radio.}}
\DoxyCodeLine{718 \textcolor{comment}{    */}}
\DoxyCodeLine{719     drflac\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{720 }
\DoxyCodeLine{721 }
\DoxyCodeLine{722     \textcolor{comment}{/* The container type. This is set based on whether or not the decoder was opened from a native or Ogg stream. */}}
\DoxyCodeLine{723     drflac\_container container;}
\DoxyCodeLine{724 }
\DoxyCodeLine{725     \textcolor{comment}{/* The number of seekpoints in the seektable. */}}
\DoxyCodeLine{726     drflac\_uint32 seekpointCount;}
\DoxyCodeLine{727 }
\DoxyCodeLine{728 }
\DoxyCodeLine{729     \textcolor{comment}{/* Information about the frame the decoder is currently sitting on. */}}
\DoxyCodeLine{730     \mbox{\hyperlink{structdrflac__frame}{drflac\_frame}} currentFLACFrame;}
\DoxyCodeLine{731 }
\DoxyCodeLine{732 }
\DoxyCodeLine{733     \textcolor{comment}{/* The index of the PCM frame the decoder is currently sitting on. This is only used for seeking. */}}
\DoxyCodeLine{734     drflac\_uint64 currentPCMFrame;}
\DoxyCodeLine{735 }
\DoxyCodeLine{736     \textcolor{comment}{/* The position of the first FLAC frame in the stream. This is only ever used for seeking. */}}
\DoxyCodeLine{737     drflac\_uint64 firstFLACFramePosInBytes;}
\DoxyCodeLine{738 }
\DoxyCodeLine{739 }
\DoxyCodeLine{740     \textcolor{comment}{/* A hack to avoid a malloc() when opening a decoder with drflac\_open\_memory(). */}}
\DoxyCodeLine{741     \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}} memoryStream;}
\DoxyCodeLine{742 }
\DoxyCodeLine{743 }
\DoxyCodeLine{744     \textcolor{comment}{/* A pointer to the decoded sample data. This is an offset of pExtraData. */}}
\DoxyCodeLine{745     drflac\_int32* pDecodedSamples;}
\DoxyCodeLine{746 }
\DoxyCodeLine{747     \textcolor{comment}{/* A pointer to the seek table. This is an offset of pExtraData, or NULL if there is no seek table. */}}
\DoxyCodeLine{748     \mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}* pSeekpoints;}
\DoxyCodeLine{749 }
\DoxyCodeLine{750     \textcolor{comment}{/* Internal use only. Only used with Ogg containers. Points to a drflac\_oggbs object. This is an offset of pExtraData. */}}
\DoxyCodeLine{751     \textcolor{keywordtype}{void}* \_oggbs;}
\DoxyCodeLine{752 }
\DoxyCodeLine{753     \textcolor{comment}{/* Internal use only. Used for profiling and testing different seeking modes. */}}
\DoxyCodeLine{754     drflac\_bool32 \_noSeekTableSeek    : 1;}
\DoxyCodeLine{755     drflac\_bool32 \_noBinarySearchSeek : 1;}
\DoxyCodeLine{756     drflac\_bool32 \_noBruteForceSeek   : 1;}
\DoxyCodeLine{757 }
\DoxyCodeLine{758     \textcolor{comment}{/* The bit streamer. The raw FLAC data is fed through this object. */}}
\DoxyCodeLine{759     \mbox{\hyperlink{structdrflac__bs}{drflac\_bs}} bs;}
\DoxyCodeLine{760 }
\DoxyCodeLine{761     \textcolor{comment}{/* Variable length extra data. We attach this to the end of the object so we can avoid unnecessary mallocs. */}}
\DoxyCodeLine{762     drflac\_uint8 pExtraData[1];}
\DoxyCodeLine{763 \} \mbox{\hyperlink{structdrflac}{drflac}};}
\DoxyCodeLine{764 }
\DoxyCodeLine{765 }
\DoxyCodeLine{766 \textcolor{comment}{/*}}
\DoxyCodeLine{767 \textcolor{comment}{Opens a FLAC decoder.}}
\DoxyCodeLine{768 \textcolor{comment}{}}
\DoxyCodeLine{769 \textcolor{comment}{}}
\DoxyCodeLine{770 \textcolor{comment}{Parameters}}
\DoxyCodeLine{771 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{772 \textcolor{comment}{onRead (in)}}
\DoxyCodeLine{773 \textcolor{comment}{    The function to call when data needs to be read from the client.}}
\DoxyCodeLine{774 \textcolor{comment}{}}
\DoxyCodeLine{775 \textcolor{comment}{onSeek (in)}}
\DoxyCodeLine{776 \textcolor{comment}{    The function to call when the read position of the client data needs to move.}}
\DoxyCodeLine{777 \textcolor{comment}{}}
\DoxyCodeLine{778 \textcolor{comment}{pUserData (in, optional)}}
\DoxyCodeLine{779 \textcolor{comment}{    A pointer to application defined data that will be passed to onRead and onSeek.}}
\DoxyCodeLine{780 \textcolor{comment}{}}
\DoxyCodeLine{781 \textcolor{comment}{pAllocationCallbacks (in, optional)}}
\DoxyCodeLine{782 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{783 \textcolor{comment}{}}
\DoxyCodeLine{784 \textcolor{comment}{}}
\DoxyCodeLine{785 \textcolor{comment}{Return Value}}
\DoxyCodeLine{786 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{787 \textcolor{comment}{Returns a pointer to an object representing the decoder.}}
\DoxyCodeLine{788 \textcolor{comment}{}}
\DoxyCodeLine{789 \textcolor{comment}{}}
\DoxyCodeLine{790 \textcolor{comment}{Remarks}}
\DoxyCodeLine{791 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{792 \textcolor{comment}{Close the decoder with `drflac\_close()`.}}
\DoxyCodeLine{793 \textcolor{comment}{}}
\DoxyCodeLine{794 \textcolor{comment}{`pAllocationCallbacks` can be NULL in which case it will use `DRFLAC\_MALLOC`, `DRFLAC\_REALLOC` and `DRFLAC\_FREE`.}}
\DoxyCodeLine{795 \textcolor{comment}{}}
\DoxyCodeLine{796 \textcolor{comment}{This function will automatically detect whether or not you are attempting to open a native or Ogg encapsulated FLAC, both of which should work seamlessly}}
\DoxyCodeLine{797 \textcolor{comment}{without any manual intervention. Ogg encapsulation also works with multiplexed streams which basically means it can play FLAC encoded audio tracks in videos.}}
\DoxyCodeLine{798 \textcolor{comment}{}}
\DoxyCodeLine{799 \textcolor{comment}{This is the lowest level function for opening a FLAC stream. You can also use `drflac\_open\_file()` and `drflac\_open\_memory()` to open the stream from a file or}}
\DoxyCodeLine{800 \textcolor{comment}{from a block of memory respectively.}}
\DoxyCodeLine{801 \textcolor{comment}{}}
\DoxyCodeLine{802 \textcolor{comment}{The STREAMINFO block must be present for this to succeed. Use `drflac\_open\_relaxed()` to open a FLAC stream where the header may not be present.}}
\DoxyCodeLine{803 \textcolor{comment}{}}
\DoxyCodeLine{804 \textcolor{comment}{Use `drflac\_open\_with\_metadata()` if you need access to metadata.}}
\DoxyCodeLine{805 \textcolor{comment}{}}
\DoxyCodeLine{806 \textcolor{comment}{}}
\DoxyCodeLine{807 \textcolor{comment}{Seek Also}}
\DoxyCodeLine{808 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{809 \textcolor{comment}{drflac\_open\_file()}}
\DoxyCodeLine{810 \textcolor{comment}{drflac\_open\_memory()}}
\DoxyCodeLine{811 \textcolor{comment}{drflac\_open\_with\_metadata()}}
\DoxyCodeLine{812 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{813 \textcolor{comment}{*/}}
\DoxyCodeLine{814 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{815 }
\DoxyCodeLine{816 \textcolor{comment}{/*}}
\DoxyCodeLine{817 \textcolor{comment}{Opens a FLAC stream with relaxed validation of the header block.}}
\DoxyCodeLine{818 \textcolor{comment}{}}
\DoxyCodeLine{819 \textcolor{comment}{}}
\DoxyCodeLine{820 \textcolor{comment}{Parameters}}
\DoxyCodeLine{821 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{822 \textcolor{comment}{onRead (in)}}
\DoxyCodeLine{823 \textcolor{comment}{    The function to call when data needs to be read from the client.}}
\DoxyCodeLine{824 \textcolor{comment}{}}
\DoxyCodeLine{825 \textcolor{comment}{onSeek (in)}}
\DoxyCodeLine{826 \textcolor{comment}{    The function to call when the read position of the client data needs to move.}}
\DoxyCodeLine{827 \textcolor{comment}{}}
\DoxyCodeLine{828 \textcolor{comment}{container (in)}}
\DoxyCodeLine{829 \textcolor{comment}{    Whether or not the FLAC stream is encapsulated using standard FLAC encapsulation or Ogg encapsulation.}}
\DoxyCodeLine{830 \textcolor{comment}{}}
\DoxyCodeLine{831 \textcolor{comment}{pUserData (in, optional)}}
\DoxyCodeLine{832 \textcolor{comment}{    A pointer to application defined data that will be passed to onRead and onSeek.}}
\DoxyCodeLine{833 \textcolor{comment}{}}
\DoxyCodeLine{834 \textcolor{comment}{pAllocationCallbacks (in, optional)}}
\DoxyCodeLine{835 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{836 \textcolor{comment}{}}
\DoxyCodeLine{837 \textcolor{comment}{}}
\DoxyCodeLine{838 \textcolor{comment}{Return Value}}
\DoxyCodeLine{839 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{840 \textcolor{comment}{A pointer to an object representing the decoder.}}
\DoxyCodeLine{841 \textcolor{comment}{}}
\DoxyCodeLine{842 \textcolor{comment}{}}
\DoxyCodeLine{843 \textcolor{comment}{Remarks}}
\DoxyCodeLine{844 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{845 \textcolor{comment}{The same as drflac\_open(), except attempts to open the stream even when a header block is not present.}}
\DoxyCodeLine{846 \textcolor{comment}{}}
\DoxyCodeLine{847 \textcolor{comment}{Because the header is not necessarily available, the caller must explicitly define the container (Native or Ogg). Do not set this to `drflac\_container\_unknown`}}
\DoxyCodeLine{848 \textcolor{comment}{as that is for internal use only.}}
\DoxyCodeLine{849 \textcolor{comment}{}}
\DoxyCodeLine{850 \textcolor{comment}{Opening in relaxed mode will continue reading data from onRead until it finds a valid frame. If a frame is never found it will continue forever. To abort,}}
\DoxyCodeLine{851 \textcolor{comment}{force your `onRead` callback to return 0, which dr\_flac will use as an indicator that the end of the stream was found.}}
\DoxyCodeLine{852 \textcolor{comment}{}}
\DoxyCodeLine{853 \textcolor{comment}{Use `drflac\_open\_with\_metadata\_relaxed()` if you need access to metadata.}}
\DoxyCodeLine{854 \textcolor{comment}{*/}}
\DoxyCodeLine{855 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_relaxed(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{856 }
\DoxyCodeLine{857 \textcolor{comment}{/*}}
\DoxyCodeLine{858 \textcolor{comment}{Opens a FLAC decoder and notifies the caller of the metadata chunks (album art, etc.).}}
\DoxyCodeLine{859 \textcolor{comment}{}}
\DoxyCodeLine{860 \textcolor{comment}{}}
\DoxyCodeLine{861 \textcolor{comment}{Parameters}}
\DoxyCodeLine{862 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{863 \textcolor{comment}{onRead (in)}}
\DoxyCodeLine{864 \textcolor{comment}{    The function to call when data needs to be read from the client.}}
\DoxyCodeLine{865 \textcolor{comment}{}}
\DoxyCodeLine{866 \textcolor{comment}{onSeek (in)}}
\DoxyCodeLine{867 \textcolor{comment}{    The function to call when the read position of the client data needs to move.}}
\DoxyCodeLine{868 \textcolor{comment}{}}
\DoxyCodeLine{869 \textcolor{comment}{onMeta (in)}}
\DoxyCodeLine{870 \textcolor{comment}{    The function to call for every metadata block.}}
\DoxyCodeLine{871 \textcolor{comment}{}}
\DoxyCodeLine{872 \textcolor{comment}{pUserData (in, optional)}}
\DoxyCodeLine{873 \textcolor{comment}{    A pointer to application defined data that will be passed to onRead, onSeek and onMeta.}}
\DoxyCodeLine{874 \textcolor{comment}{}}
\DoxyCodeLine{875 \textcolor{comment}{pAllocationCallbacks (in, optional)}}
\DoxyCodeLine{876 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{877 \textcolor{comment}{}}
\DoxyCodeLine{878 \textcolor{comment}{}}
\DoxyCodeLine{879 \textcolor{comment}{Return Value}}
\DoxyCodeLine{880 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{881 \textcolor{comment}{A pointer to an object representing the decoder.}}
\DoxyCodeLine{882 \textcolor{comment}{}}
\DoxyCodeLine{883 \textcolor{comment}{}}
\DoxyCodeLine{884 \textcolor{comment}{Remarks}}
\DoxyCodeLine{885 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{886 \textcolor{comment}{Close the decoder with `drflac\_close()`.}}
\DoxyCodeLine{887 \textcolor{comment}{}}
\DoxyCodeLine{888 \textcolor{comment}{`pAllocationCallbacks` can be NULL in which case it will use `DRFLAC\_MALLOC`, `DRFLAC\_REALLOC` and `DRFLAC\_FREE`.}}
\DoxyCodeLine{889 \textcolor{comment}{}}
\DoxyCodeLine{890 \textcolor{comment}{This is slower than `drflac\_open()`, so avoid this one if you don't need metadata. Internally, this will allocate and free memory on the heap for every}}
\DoxyCodeLine{891 \textcolor{comment}{metadata block except for STREAMINFO and PADDING blocks.}}
\DoxyCodeLine{892 \textcolor{comment}{}}
\DoxyCodeLine{893 \textcolor{comment}{The caller is notified of the metadata via the `onMeta` callback. All metadata blocks will be handled before the function returns. This callback takes a}}
\DoxyCodeLine{894 \textcolor{comment}{pointer to a `drflac\_metadata` object which is a union containing the data of all relevant metadata blocks. Use the `type` member to discriminate against}}
\DoxyCodeLine{895 \textcolor{comment}{the different metadata types.}}
\DoxyCodeLine{896 \textcolor{comment}{}}
\DoxyCodeLine{897 \textcolor{comment}{The STREAMINFO block must be present for this to succeed. Use `drflac\_open\_with\_metadata\_relaxed()` to open a FLAC stream where the header may not be present.}}
\DoxyCodeLine{898 \textcolor{comment}{}}
\DoxyCodeLine{899 \textcolor{comment}{Note that this will behave inconsistently with `drflac\_open()` if the stream is an Ogg encapsulated stream and a metadata block is corrupted. This is due to}}
\DoxyCodeLine{900 \textcolor{comment}{the way the Ogg stream recovers from corrupted pages. When `drflac\_open\_with\_metadata()` is being used, the open routine will try to read the contents of the}}
\DoxyCodeLine{901 \textcolor{comment}{metadata block, whereas `drflac\_open()` will simply seek past it (for the sake of efficiency). This inconsistency can result in different samples being}}
\DoxyCodeLine{902 \textcolor{comment}{returned depending on whether or not the stream is being opened with metadata.}}
\DoxyCodeLine{903 \textcolor{comment}{}}
\DoxyCodeLine{904 \textcolor{comment}{}}
\DoxyCodeLine{905 \textcolor{comment}{Seek Also}}
\DoxyCodeLine{906 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{907 \textcolor{comment}{drflac\_open\_file\_with\_metadata()}}
\DoxyCodeLine{908 \textcolor{comment}{drflac\_open\_memory\_with\_metadata()}}
\DoxyCodeLine{909 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{910 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{911 \textcolor{comment}{*/}}
\DoxyCodeLine{912 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_with\_metadata(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{913 }
\DoxyCodeLine{914 \textcolor{comment}{/*}}
\DoxyCodeLine{915 \textcolor{comment}{The same as drflac\_open\_with\_metadata(), except attempts to open the stream even when a header block is not present.}}
\DoxyCodeLine{916 \textcolor{comment}{}}
\DoxyCodeLine{917 \textcolor{comment}{See Also}}
\DoxyCodeLine{918 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{919 \textcolor{comment}{drflac\_open\_with\_metadata()}}
\DoxyCodeLine{920 \textcolor{comment}{drflac\_open\_relaxed()}}
\DoxyCodeLine{921 \textcolor{comment}{*/}}
\DoxyCodeLine{922 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_with\_metadata\_relaxed(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{923 }
\DoxyCodeLine{924 \textcolor{comment}{/*}}
\DoxyCodeLine{925 \textcolor{comment}{Closes the given FLAC decoder.}}
\DoxyCodeLine{926 \textcolor{comment}{}}
\DoxyCodeLine{927 \textcolor{comment}{}}
\DoxyCodeLine{928 \textcolor{comment}{Parameters}}
\DoxyCodeLine{929 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{930 \textcolor{comment}{pFlac (in)}}
\DoxyCodeLine{931 \textcolor{comment}{    The decoder to close.}}
\DoxyCodeLine{932 \textcolor{comment}{}}
\DoxyCodeLine{933 \textcolor{comment}{}}
\DoxyCodeLine{934 \textcolor{comment}{Remarks}}
\DoxyCodeLine{935 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{936 \textcolor{comment}{This will destroy the decoder object.}}
\DoxyCodeLine{937 \textcolor{comment}{}}
\DoxyCodeLine{938 \textcolor{comment}{}}
\DoxyCodeLine{939 \textcolor{comment}{See Also}}
\DoxyCodeLine{940 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{941 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{942 \textcolor{comment}{drflac\_open\_with\_metadata()}}
\DoxyCodeLine{943 \textcolor{comment}{drflac\_open\_file()}}
\DoxyCodeLine{944 \textcolor{comment}{drflac\_open\_file\_w()}}
\DoxyCodeLine{945 \textcolor{comment}{drflac\_open\_file\_with\_metadata()}}
\DoxyCodeLine{946 \textcolor{comment}{drflac\_open\_file\_with\_metadata\_w()}}
\DoxyCodeLine{947 \textcolor{comment}{drflac\_open\_memory()}}
\DoxyCodeLine{948 \textcolor{comment}{drflac\_open\_memory\_with\_metadata()}}
\DoxyCodeLine{949 \textcolor{comment}{*/}}
\DoxyCodeLine{950 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_close(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac);}
\DoxyCodeLine{951 }
\DoxyCodeLine{952 }
\DoxyCodeLine{953 \textcolor{comment}{/*}}
\DoxyCodeLine{954 \textcolor{comment}{Reads sample data from the given FLAC decoder, output as interleaved signed 32-\/bit PCM.}}
\DoxyCodeLine{955 \textcolor{comment}{}}
\DoxyCodeLine{956 \textcolor{comment}{}}
\DoxyCodeLine{957 \textcolor{comment}{Parameters}}
\DoxyCodeLine{958 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{959 \textcolor{comment}{pFlac (in)}}
\DoxyCodeLine{960 \textcolor{comment}{    The decoder.}}
\DoxyCodeLine{961 \textcolor{comment}{}}
\DoxyCodeLine{962 \textcolor{comment}{framesToRead (in)}}
\DoxyCodeLine{963 \textcolor{comment}{    The number of PCM frames to read.}}
\DoxyCodeLine{964 \textcolor{comment}{}}
\DoxyCodeLine{965 \textcolor{comment}{pBufferOut (out, optional)}}
\DoxyCodeLine{966 \textcolor{comment}{    A pointer to the buffer that will receive the decoded samples.}}
\DoxyCodeLine{967 \textcolor{comment}{}}
\DoxyCodeLine{968 \textcolor{comment}{}}
\DoxyCodeLine{969 \textcolor{comment}{Return Value}}
\DoxyCodeLine{970 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{971 \textcolor{comment}{Returns the number of PCM frames actually read. If the return value is less than `framesToRead` it has reached the end.}}
\DoxyCodeLine{972 \textcolor{comment}{}}
\DoxyCodeLine{973 \textcolor{comment}{}}
\DoxyCodeLine{974 \textcolor{comment}{Remarks}}
\DoxyCodeLine{975 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{976 \textcolor{comment}{pBufferOut can be null, in which case the call will act as a seek, and the return value will be the number of frames seeked.}}
\DoxyCodeLine{977 \textcolor{comment}{*/}}
\DoxyCodeLine{978 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_s32(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, drflac\_int32* pBufferOut);}
\DoxyCodeLine{979 }
\DoxyCodeLine{980 }
\DoxyCodeLine{981 \textcolor{comment}{/*}}
\DoxyCodeLine{982 \textcolor{comment}{Reads sample data from the given FLAC decoder, output as interleaved signed 16-\/bit PCM.}}
\DoxyCodeLine{983 \textcolor{comment}{}}
\DoxyCodeLine{984 \textcolor{comment}{}}
\DoxyCodeLine{985 \textcolor{comment}{Parameters}}
\DoxyCodeLine{986 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{987 \textcolor{comment}{pFlac (in)}}
\DoxyCodeLine{988 \textcolor{comment}{    The decoder.}}
\DoxyCodeLine{989 \textcolor{comment}{}}
\DoxyCodeLine{990 \textcolor{comment}{framesToRead (in)}}
\DoxyCodeLine{991 \textcolor{comment}{    The number of PCM frames to read.}}
\DoxyCodeLine{992 \textcolor{comment}{}}
\DoxyCodeLine{993 \textcolor{comment}{pBufferOut (out, optional)}}
\DoxyCodeLine{994 \textcolor{comment}{    A pointer to the buffer that will receive the decoded samples.}}
\DoxyCodeLine{995 \textcolor{comment}{}}
\DoxyCodeLine{996 \textcolor{comment}{}}
\DoxyCodeLine{997 \textcolor{comment}{Return Value}}
\DoxyCodeLine{998 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{999 \textcolor{comment}{Returns the number of PCM frames actually read. If the return value is less than `framesToRead` it has reached the end.}}
\DoxyCodeLine{1000 \textcolor{comment}{}}
\DoxyCodeLine{1001 \textcolor{comment}{}}
\DoxyCodeLine{1002 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1003 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1004 \textcolor{comment}{pBufferOut can be null, in which case the call will act as a seek, and the return value will be the number of frames seeked.}}
\DoxyCodeLine{1005 \textcolor{comment}{}}
\DoxyCodeLine{1006 \textcolor{comment}{Note that this is lossy for streams where the bits per sample is larger than 16.}}
\DoxyCodeLine{1007 \textcolor{comment}{*/}}
\DoxyCodeLine{1008 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_s16(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, drflac\_int16* pBufferOut);}
\DoxyCodeLine{1009 }
\DoxyCodeLine{1010 \textcolor{comment}{/*}}
\DoxyCodeLine{1011 \textcolor{comment}{Reads sample data from the given FLAC decoder, output as interleaved 32-\/bit floating point PCM.}}
\DoxyCodeLine{1012 \textcolor{comment}{}}
\DoxyCodeLine{1013 \textcolor{comment}{}}
\DoxyCodeLine{1014 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1015 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1016 \textcolor{comment}{pFlac (in)}}
\DoxyCodeLine{1017 \textcolor{comment}{    The decoder.}}
\DoxyCodeLine{1018 \textcolor{comment}{}}
\DoxyCodeLine{1019 \textcolor{comment}{framesToRead (in)}}
\DoxyCodeLine{1020 \textcolor{comment}{    The number of PCM frames to read.}}
\DoxyCodeLine{1021 \textcolor{comment}{}}
\DoxyCodeLine{1022 \textcolor{comment}{pBufferOut (out, optional)}}
\DoxyCodeLine{1023 \textcolor{comment}{    A pointer to the buffer that will receive the decoded samples.}}
\DoxyCodeLine{1024 \textcolor{comment}{}}
\DoxyCodeLine{1025 \textcolor{comment}{}}
\DoxyCodeLine{1026 \textcolor{comment}{Return Value}}
\DoxyCodeLine{1027 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1028 \textcolor{comment}{Returns the number of PCM frames actually read. If the return value is less than `framesToRead` it has reached the end.}}
\DoxyCodeLine{1029 \textcolor{comment}{}}
\DoxyCodeLine{1030 \textcolor{comment}{}}
\DoxyCodeLine{1031 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1032 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1033 \textcolor{comment}{pBufferOut can be null, in which case the call will act as a seek, and the return value will be the number of frames seeked.}}
\DoxyCodeLine{1034 \textcolor{comment}{}}
\DoxyCodeLine{1035 \textcolor{comment}{Note that this should be considered lossy due to the nature of floating point numbers not being able to exactly represent every possible number.}}
\DoxyCodeLine{1036 \textcolor{comment}{*/}}
\DoxyCodeLine{1037 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_f32(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, \textcolor{keywordtype}{float}* pBufferOut);}
\DoxyCodeLine{1038 }
\DoxyCodeLine{1039 \textcolor{comment}{/*}}
\DoxyCodeLine{1040 \textcolor{comment}{Seeks to the PCM frame at the given index.}}
\DoxyCodeLine{1041 \textcolor{comment}{}}
\DoxyCodeLine{1042 \textcolor{comment}{}}
\DoxyCodeLine{1043 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1044 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1045 \textcolor{comment}{pFlac (in)}}
\DoxyCodeLine{1046 \textcolor{comment}{    The decoder.}}
\DoxyCodeLine{1047 \textcolor{comment}{}}
\DoxyCodeLine{1048 \textcolor{comment}{pcmFrameIndex (in)}}
\DoxyCodeLine{1049 \textcolor{comment}{    The index of the PCM frame to seek to. See notes below.}}
\DoxyCodeLine{1050 \textcolor{comment}{}}
\DoxyCodeLine{1051 \textcolor{comment}{}}
\DoxyCodeLine{1052 \textcolor{comment}{Return Value}}
\DoxyCodeLine{1053 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1054 \textcolor{comment}{`DRFLAC\_TRUE` if successful; `DRFLAC\_FALSE` otherwise.}}
\DoxyCodeLine{1055 \textcolor{comment}{*/}}
\DoxyCodeLine{1056 DRFLAC\_API drflac\_bool32 drflac\_seek\_to\_pcm\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex);}
\DoxyCodeLine{1057 }
\DoxyCodeLine{1058 }
\DoxyCodeLine{1059 }
\DoxyCodeLine{1060 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{1061 \textcolor{comment}{/*}}
\DoxyCodeLine{1062 \textcolor{comment}{Opens a FLAC decoder from the file at the given path.}}
\DoxyCodeLine{1063 \textcolor{comment}{}}
\DoxyCodeLine{1064 \textcolor{comment}{}}
\DoxyCodeLine{1065 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1066 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1067 \textcolor{comment}{pFileName (in)}}
\DoxyCodeLine{1068 \textcolor{comment}{    The path of the file to open, either absolute or relative to the current directory.}}
\DoxyCodeLine{1069 \textcolor{comment}{}}
\DoxyCodeLine{1070 \textcolor{comment}{pAllocationCallbacks (in, optional)}}
\DoxyCodeLine{1071 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{1072 \textcolor{comment}{}}
\DoxyCodeLine{1073 \textcolor{comment}{}}
\DoxyCodeLine{1074 \textcolor{comment}{Return Value}}
\DoxyCodeLine{1075 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1076 \textcolor{comment}{A pointer to an object representing the decoder.}}
\DoxyCodeLine{1077 \textcolor{comment}{}}
\DoxyCodeLine{1078 \textcolor{comment}{}}
\DoxyCodeLine{1079 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1080 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1081 \textcolor{comment}{Close the decoder with drflac\_close().}}
\DoxyCodeLine{1082 \textcolor{comment}{}}
\DoxyCodeLine{1083 \textcolor{comment}{}}
\DoxyCodeLine{1084 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1085 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1086 \textcolor{comment}{This will hold a handle to the file until the decoder is closed with drflac\_close(). Some platforms will restrict the number of files a process can have open}}
\DoxyCodeLine{1087 \textcolor{comment}{at any given time, so keep this mind if you have many decoders open at the same time.}}
\DoxyCodeLine{1088 \textcolor{comment}{}}
\DoxyCodeLine{1089 \textcolor{comment}{}}
\DoxyCodeLine{1090 \textcolor{comment}{See Also}}
\DoxyCodeLine{1091 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1092 \textcolor{comment}{drflac\_open\_file\_with\_metadata()}}
\DoxyCodeLine{1093 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{1094 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{1095 \textcolor{comment}{*/}}
\DoxyCodeLine{1096 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFileName, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1097 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_w(\textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFileName, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1098 }
\DoxyCodeLine{1099 \textcolor{comment}{/*}}
\DoxyCodeLine{1100 \textcolor{comment}{Opens a FLAC decoder from the file at the given path and notifies the caller of the metadata chunks (album art, etc.)}}
\DoxyCodeLine{1101 \textcolor{comment}{}}
\DoxyCodeLine{1102 \textcolor{comment}{}}
\DoxyCodeLine{1103 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1104 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1105 \textcolor{comment}{pFileName (in)}}
\DoxyCodeLine{1106 \textcolor{comment}{    The path of the file to open, either absolute or relative to the current directory.}}
\DoxyCodeLine{1107 \textcolor{comment}{}}
\DoxyCodeLine{1108 \textcolor{comment}{pAllocationCallbacks (in, optional)}}
\DoxyCodeLine{1109 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{1110 \textcolor{comment}{}}
\DoxyCodeLine{1111 \textcolor{comment}{onMeta (in)}}
\DoxyCodeLine{1112 \textcolor{comment}{    The callback to fire for each metadata block.}}
\DoxyCodeLine{1113 \textcolor{comment}{}}
\DoxyCodeLine{1114 \textcolor{comment}{pUserData (in)}}
\DoxyCodeLine{1115 \textcolor{comment}{    A pointer to the user data to pass to the metadata callback.}}
\DoxyCodeLine{1116 \textcolor{comment}{}}
\DoxyCodeLine{1117 \textcolor{comment}{pAllocationCallbacks (in)}}
\DoxyCodeLine{1118 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{1119 \textcolor{comment}{}}
\DoxyCodeLine{1120 \textcolor{comment}{}}
\DoxyCodeLine{1121 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1122 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1123 \textcolor{comment}{Look at the documentation for drflac\_open\_with\_metadata() for more information on how metadata is handled.}}
\DoxyCodeLine{1124 \textcolor{comment}{}}
\DoxyCodeLine{1125 \textcolor{comment}{}}
\DoxyCodeLine{1126 \textcolor{comment}{See Also}}
\DoxyCodeLine{1127 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1128 \textcolor{comment}{drflac\_open\_with\_metadata()}}
\DoxyCodeLine{1129 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{1130 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{1131 \textcolor{comment}{*/}}
\DoxyCodeLine{1132 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_with\_metadata(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFileName, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1133 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_with\_metadata\_w(\textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFileName, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1134 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1135 }
\DoxyCodeLine{1136 \textcolor{comment}{/*}}
\DoxyCodeLine{1137 \textcolor{comment}{Opens a FLAC decoder from a pre-\/allocated block of memory}}
\DoxyCodeLine{1138 \textcolor{comment}{}}
\DoxyCodeLine{1139 \textcolor{comment}{}}
\DoxyCodeLine{1140 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1141 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1142 \textcolor{comment}{pData (in)}}
\DoxyCodeLine{1143 \textcolor{comment}{    A pointer to the raw encoded FLAC data.}}
\DoxyCodeLine{1144 \textcolor{comment}{}}
\DoxyCodeLine{1145 \textcolor{comment}{dataSize (in)}}
\DoxyCodeLine{1146 \textcolor{comment}{    The size in bytes of `data`.}}
\DoxyCodeLine{1147 \textcolor{comment}{}}
\DoxyCodeLine{1148 \textcolor{comment}{pAllocationCallbacks (in)}}
\DoxyCodeLine{1149 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{1150 \textcolor{comment}{}}
\DoxyCodeLine{1151 \textcolor{comment}{}}
\DoxyCodeLine{1152 \textcolor{comment}{Return Value}}
\DoxyCodeLine{1153 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1154 \textcolor{comment}{A pointer to an object representing the decoder.}}
\DoxyCodeLine{1155 \textcolor{comment}{}}
\DoxyCodeLine{1156 \textcolor{comment}{}}
\DoxyCodeLine{1157 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1158 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1159 \textcolor{comment}{This does not create a copy of the data. It is up to the application to ensure the buffer remains valid for the lifetime of the decoder.}}
\DoxyCodeLine{1160 \textcolor{comment}{}}
\DoxyCodeLine{1161 \textcolor{comment}{}}
\DoxyCodeLine{1162 \textcolor{comment}{See Also}}
\DoxyCodeLine{1163 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1164 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{1165 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{1166 \textcolor{comment}{*/}}
\DoxyCodeLine{1167 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_memory(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1168 }
\DoxyCodeLine{1169 \textcolor{comment}{/*}}
\DoxyCodeLine{1170 \textcolor{comment}{Opens a FLAC decoder from a pre-\/allocated block of memory and notifies the caller of the metadata chunks (album art, etc.)}}
\DoxyCodeLine{1171 \textcolor{comment}{}}
\DoxyCodeLine{1172 \textcolor{comment}{}}
\DoxyCodeLine{1173 \textcolor{comment}{Parameters}}
\DoxyCodeLine{1174 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1175 \textcolor{comment}{pData (in)}}
\DoxyCodeLine{1176 \textcolor{comment}{    A pointer to the raw encoded FLAC data.}}
\DoxyCodeLine{1177 \textcolor{comment}{}}
\DoxyCodeLine{1178 \textcolor{comment}{dataSize (in)}}
\DoxyCodeLine{1179 \textcolor{comment}{    The size in bytes of `data`.}}
\DoxyCodeLine{1180 \textcolor{comment}{}}
\DoxyCodeLine{1181 \textcolor{comment}{onMeta (in)}}
\DoxyCodeLine{1182 \textcolor{comment}{    The callback to fire for each metadata block.}}
\DoxyCodeLine{1183 \textcolor{comment}{}}
\DoxyCodeLine{1184 \textcolor{comment}{pUserData (in)}}
\DoxyCodeLine{1185 \textcolor{comment}{    A pointer to the user data to pass to the metadata callback.}}
\DoxyCodeLine{1186 \textcolor{comment}{}}
\DoxyCodeLine{1187 \textcolor{comment}{pAllocationCallbacks (in)}}
\DoxyCodeLine{1188 \textcolor{comment}{    A pointer to application defined callbacks for managing memory allocations.}}
\DoxyCodeLine{1189 \textcolor{comment}{}}
\DoxyCodeLine{1190 \textcolor{comment}{}}
\DoxyCodeLine{1191 \textcolor{comment}{Remarks}}
\DoxyCodeLine{1192 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1193 \textcolor{comment}{Look at the documentation for drflac\_open\_with\_metadata() for more information on how metadata is handled.}}
\DoxyCodeLine{1194 \textcolor{comment}{}}
\DoxyCodeLine{1195 \textcolor{comment}{}}
\DoxyCodeLine{1196 \textcolor{comment}{See Also}}
\DoxyCodeLine{1197 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1198 \textcolor{comment}{drflac\_open\_with\_metadata()}}
\DoxyCodeLine{1199 \textcolor{comment}{drflac\_open()}}
\DoxyCodeLine{1200 \textcolor{comment}{drflac\_close()}}
\DoxyCodeLine{1201 \textcolor{comment}{*/}}
\DoxyCodeLine{1202 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_memory\_with\_metadata(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1203 }
\DoxyCodeLine{1204 }
\DoxyCodeLine{1205 }
\DoxyCodeLine{1206 \textcolor{comment}{/* High Level APIs */}}
\DoxyCodeLine{1207 }
\DoxyCodeLine{1208 \textcolor{comment}{/*}}
\DoxyCodeLine{1209 \textcolor{comment}{Opens a FLAC stream from the given callbacks and fully decodes it in a single operation. The return value is a}}
\DoxyCodeLine{1210 \textcolor{comment}{pointer to the sample data as interleaved signed 32-\/bit PCM. The returned data must be freed with drflac\_free().}}
\DoxyCodeLine{1211 \textcolor{comment}{}}
\DoxyCodeLine{1212 \textcolor{comment}{You can pass in custom memory allocation callbacks via the pAllocationCallbacks parameter. This can be NULL in which}}
\DoxyCodeLine{1213 \textcolor{comment}{case it will use DRFLAC\_MALLOC, DRFLAC\_REALLOC and DRFLAC\_FREE.}}
\DoxyCodeLine{1214 \textcolor{comment}{}}
\DoxyCodeLine{1215 \textcolor{comment}{Sometimes a FLAC file won't keep track of the total sample count. In this situation the function will continuously}}
\DoxyCodeLine{1216 \textcolor{comment}{read samples into a dynamically sized buffer on the heap until no samples are left.}}
\DoxyCodeLine{1217 \textcolor{comment}{}}
\DoxyCodeLine{1218 \textcolor{comment}{Do not call this function on a broadcast type of stream (like internet radio streams and whatnot).}}
\DoxyCodeLine{1219 \textcolor{comment}{*/}}
\DoxyCodeLine{1220 DRFLAC\_API drflac\_int32* drflac\_open\_and\_read\_pcm\_frames\_s32(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1221 }
\DoxyCodeLine{1222 \textcolor{comment}{/* Same as drflac\_open\_and\_read\_pcm\_frames\_s32(), except returns signed 16-\/bit integer samples. */}}
\DoxyCodeLine{1223 DRFLAC\_API drflac\_int16* drflac\_open\_and\_read\_pcm\_frames\_s16(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1224 }
\DoxyCodeLine{1225 \textcolor{comment}{/* Same as drflac\_open\_and\_read\_pcm\_frames\_s32(), except returns 32-\/bit floating-\/point samples. */}}
\DoxyCodeLine{1226 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_and\_read\_pcm\_frames\_f32(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1227 }
\DoxyCodeLine{1228 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{1229 \textcolor{comment}{/* Same as drflac\_open\_and\_read\_pcm\_frames\_s32() except opens the decoder from a file. */}}
\DoxyCodeLine{1230 DRFLAC\_API drflac\_int32* drflac\_open\_file\_and\_read\_pcm\_frames\_s32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232 \textcolor{comment}{/* Same as drflac\_open\_file\_and\_read\_pcm\_frames\_s32(), except returns signed 16-\/bit integer samples. */}}
\DoxyCodeLine{1233 DRFLAC\_API drflac\_int16* drflac\_open\_file\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235 \textcolor{comment}{/* Same as drflac\_open\_file\_and\_read\_pcm\_frames\_s32(), except returns 32-\/bit floating-\/point samples. */}}
\DoxyCodeLine{1236 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_file\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1237 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1238 }
\DoxyCodeLine{1239 \textcolor{comment}{/* Same as drflac\_open\_and\_read\_pcm\_frames\_s32() except opens the decoder from a block of memory. */}}
\DoxyCodeLine{1240 DRFLAC\_API drflac\_int32* drflac\_open\_memory\_and\_read\_pcm\_frames\_s32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1241 }
\DoxyCodeLine{1242 \textcolor{comment}{/* Same as drflac\_open\_memory\_and\_read\_pcm\_frames\_s32(), except returns signed 16-\/bit integer samples. */}}
\DoxyCodeLine{1243 DRFLAC\_API drflac\_int16* drflac\_open\_memory\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1244 }
\DoxyCodeLine{1245 \textcolor{comment}{/* Same as drflac\_open\_memory\_and\_read\_pcm\_frames\_s32(), except returns 32-\/bit floating-\/point samples. */}}
\DoxyCodeLine{1246 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_memory\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1247 }
\DoxyCodeLine{1248 \textcolor{comment}{/*}}
\DoxyCodeLine{1249 \textcolor{comment}{Frees memory that was allocated internally by dr\_flac.}}
\DoxyCodeLine{1250 \textcolor{comment}{}}
\DoxyCodeLine{1251 \textcolor{comment}{Set pAllocationCallbacks to the same object that was passed to drflac\_open\_*\_and\_read\_pcm\_frames\_*(). If you originally passed in NULL, pass in NULL for this.}}
\DoxyCodeLine{1252 \textcolor{comment}{*/}}
\DoxyCodeLine{1253 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_free(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{1254 }
\DoxyCodeLine{1255 }
\DoxyCodeLine{1256 \textcolor{comment}{/* Structure representing an iterator for vorbis comments in a VORBIS\_COMMENT metadata block. */}}
\DoxyCodeLine{1257 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1258 \{}
\DoxyCodeLine{1259     drflac\_uint32 countRemaining;}
\DoxyCodeLine{1260     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{1261 \} \mbox{\hyperlink{structdrflac__vorbis__comment__iterator}{drflac\_vorbis\_comment\_iterator}};}
\DoxyCodeLine{1262 }
\DoxyCodeLine{1263 \textcolor{comment}{/*}}
\DoxyCodeLine{1264 \textcolor{comment}{Initializes a vorbis comment iterator. This can be used for iterating over the vorbis comments in a VORBIS\_COMMENT}}
\DoxyCodeLine{1265 \textcolor{comment}{metadata block.}}
\DoxyCodeLine{1266 \textcolor{comment}{*/}}
\DoxyCodeLine{1267 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_init\_vorbis\_comment\_iterator(\mbox{\hyperlink{structdrflac__vorbis__comment__iterator}{drflac\_vorbis\_comment\_iterator}}* pIter, drflac\_uint32 commentCount, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pComments);}
\DoxyCodeLine{1268 }
\DoxyCodeLine{1269 \textcolor{comment}{/*}}
\DoxyCodeLine{1270 \textcolor{comment}{Goes to the next vorbis comment in the given iterator. If null is returned it means there are no more comments. The}}
\DoxyCodeLine{1271 \textcolor{comment}{returned string is NOT null terminated.}}
\DoxyCodeLine{1272 \textcolor{comment}{*/}}
\DoxyCodeLine{1273 DRFLAC\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drflac\_next\_vorbis\_comment(\mbox{\hyperlink{structdrflac__vorbis__comment__iterator}{drflac\_vorbis\_comment\_iterator}}* pIter, drflac\_uint32* pCommentLengthOut);}
\DoxyCodeLine{1274 }
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276 \textcolor{comment}{/* Structure representing an iterator for cuesheet tracks in a CUESHEET metadata block. */}}
\DoxyCodeLine{1277 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1278 \{}
\DoxyCodeLine{1279     drflac\_uint32 countRemaining;}
\DoxyCodeLine{1280     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{1281 \} \mbox{\hyperlink{structdrflac__cuesheet__track__iterator}{drflac\_cuesheet\_track\_iterator}};}
\DoxyCodeLine{1282 }
\DoxyCodeLine{1283 \textcolor{comment}{/* Packing is important on this structure because we map this directly to the raw data within the CUESHEET metadata block. */}}
\DoxyCodeLine{1284 \textcolor{preprocessor}{\#pragma pack(4)}}
\DoxyCodeLine{1285 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1286 \{}
\DoxyCodeLine{1287     drflac\_uint64 offset;}
\DoxyCodeLine{1288     drflac\_uint8 index;}
\DoxyCodeLine{1289     drflac\_uint8 reserved[3];}
\DoxyCodeLine{1290 \} \mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}};}
\DoxyCodeLine{1291 \textcolor{preprocessor}{\#pragma pack()}}
\DoxyCodeLine{1292 }
\DoxyCodeLine{1293 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1294 \{}
\DoxyCodeLine{1295     drflac\_uint64 offset;}
\DoxyCodeLine{1296     drflac\_uint8 trackNumber;}
\DoxyCodeLine{1297     \textcolor{keywordtype}{char} ISRC[12];}
\DoxyCodeLine{1298     drflac\_bool8 isAudio;}
\DoxyCodeLine{1299     drflac\_bool8 preEmphasis;}
\DoxyCodeLine{1300     drflac\_uint8 indexCount;}
\DoxyCodeLine{1301     \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}}* pIndexPoints;}
\DoxyCodeLine{1302 \} \mbox{\hyperlink{structdrflac__cuesheet__track}{drflac\_cuesheet\_track}};}
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304 \textcolor{comment}{/*}}
\DoxyCodeLine{1305 \textcolor{comment}{Initializes a cuesheet track iterator. This can be used for iterating over the cuesheet tracks in a CUESHEET metadata}}
\DoxyCodeLine{1306 \textcolor{comment}{block.}}
\DoxyCodeLine{1307 \textcolor{comment}{*/}}
\DoxyCodeLine{1308 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_init\_cuesheet\_track\_iterator(\mbox{\hyperlink{structdrflac__cuesheet__track__iterator}{drflac\_cuesheet\_track\_iterator}}* pIter, drflac\_uint32 trackCount, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pTrackData);}
\DoxyCodeLine{1309 }
\DoxyCodeLine{1310 \textcolor{comment}{/* Goes to the next cuesheet track in the given iterator. If DRFLAC\_FALSE is returned it means there are no more comments. */}}
\DoxyCodeLine{1311 DRFLAC\_API drflac\_bool32 drflac\_next\_cuesheet\_track(\mbox{\hyperlink{structdrflac__cuesheet__track__iterator}{drflac\_cuesheet\_track\_iterator}}* pIter, \mbox{\hyperlink{structdrflac__cuesheet__track}{drflac\_cuesheet\_track}}* pCuesheetTrack);}
\DoxyCodeLine{1312 }
\DoxyCodeLine{1313 }
\DoxyCodeLine{1314 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{1315 \}}
\DoxyCodeLine{1316 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1317 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* dr\_flac\_h */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1318 }
\DoxyCodeLine{1319 }
\DoxyCodeLine{1320 \textcolor{comment}{/************************************************************************************************************************************************************}}
\DoxyCodeLine{1321 \textcolor{comment}{ ************************************************************************************************************************************************************}}
\DoxyCodeLine{1322 \textcolor{comment}{}}
\DoxyCodeLine{1323 \textcolor{comment}{ IMPLEMENTATION}}
\DoxyCodeLine{1324 \textcolor{comment}{}}
\DoxyCodeLine{1325 \textcolor{comment}{ ************************************************************************************************************************************************************}}
\DoxyCodeLine{1326 \textcolor{comment}{ ************************************************************************************************************************************************************/}}
\DoxyCodeLine{1327 \textcolor{preprocessor}{\#if defined(DR\_FLAC\_IMPLEMENTATION) || defined(DRFLAC\_IMPLEMENTATION)}}
\DoxyCodeLine{1328 \textcolor{preprocessor}{\#ifndef dr\_flac\_c}}
\DoxyCodeLine{1329 \textcolor{preprocessor}{\#define dr\_flac\_c}}
\DoxyCodeLine{1330 }
\DoxyCodeLine{1331 \textcolor{comment}{/* Disable some annoying warnings. */}}
\DoxyCodeLine{1332 \textcolor{preprocessor}{\#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{1333 \textcolor{preprocessor}{    \#pragma GCC diagnostic push}}
\DoxyCodeLine{1334 \textcolor{preprocessor}{    \#if \_\_GNUC\_\_ >= 7}}
\DoxyCodeLine{1335 \textcolor{preprocessor}{    \#pragma GCC diagnostic ignored "{}-\/Wimplicit-\/fallthrough"{}}}
\DoxyCodeLine{1336 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1337 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1338 }
\DoxyCodeLine{1339 \textcolor{preprocessor}{\#ifdef \_\_linux\_\_}}
\DoxyCodeLine{1340 \textcolor{preprocessor}{    \#ifndef \_BSD\_SOURCE}}
\DoxyCodeLine{1341 \textcolor{preprocessor}{        \#define \_BSD\_SOURCE}}
\DoxyCodeLine{1342 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1343 \textcolor{preprocessor}{    \#ifndef \_DEFAULT\_SOURCE}}
\DoxyCodeLine{1344 \textcolor{preprocessor}{        \#define \_DEFAULT\_SOURCE}}
\DoxyCodeLine{1345 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1346 \textcolor{preprocessor}{    \#ifndef \_\_USE\_BSD}}
\DoxyCodeLine{1347 \textcolor{preprocessor}{        \#define \_\_USE\_BSD}}
\DoxyCodeLine{1348 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1349 \textcolor{preprocessor}{    \#include <endian.h>}}
\DoxyCodeLine{1350 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1351 }
\DoxyCodeLine{1352 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{1353 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{1354 }
\DoxyCodeLine{1355 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{1356 \textcolor{preprocessor}{    \#define DRFLAC\_INLINE \_\_forceinline}}
\DoxyCodeLine{1357 \textcolor{preprocessor}{\#elif defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{1358     \textcolor{comment}{/*}}
\DoxyCodeLine{1359 \textcolor{comment}{    I've had a bug report where GCC is emitting warnings about functions possibly not being inlineable. This warning happens when}}
\DoxyCodeLine{1360 \textcolor{comment}{    the \_\_attribute\_\_((always\_inline)) attribute is defined without an "{}inline"{} statement. I think therefore there must be some}}
\DoxyCodeLine{1361 \textcolor{comment}{    case where "{}\_\_inline\_\_"{} is not always defined, thus the compiler emitting these warnings. When using -\/std=c89 or -\/ansi on the}}
\DoxyCodeLine{1362 \textcolor{comment}{    command line, we cannot use the "{}inline"{} keyword and instead need to use "{}\_\_inline\_\_"{}. In an attempt to work around this issue}}
\DoxyCodeLine{1363 \textcolor{comment}{    I am using "{}\_\_inline\_\_"{} only when we're compiling in strict ANSI mode.}}
\DoxyCodeLine{1364 \textcolor{comment}{    */}}
\DoxyCodeLine{1365 \textcolor{preprocessor}{    \#if defined(\_\_STRICT\_ANSI\_\_)}}
\DoxyCodeLine{1366 \textcolor{preprocessor}{        \#define DRFLAC\_INLINE \_\_inline\_\_ \_\_attribute\_\_((always\_inline))}}
\DoxyCodeLine{1367 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1368 \textcolor{preprocessor}{        \#define DRFLAC\_INLINE inline \_\_attribute\_\_((always\_inline))}}
\DoxyCodeLine{1369 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1370 \textcolor{preprocessor}{\#elif defined(\_\_WATCOMC\_\_)}}
\DoxyCodeLine{1371 \textcolor{preprocessor}{    \#define DRFLAC\_INLINE \_\_inline}}
\DoxyCodeLine{1372 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1373 \textcolor{preprocessor}{    \#define DRFLAC\_INLINE}}
\DoxyCodeLine{1374 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1375 }
\DoxyCodeLine{1376 \textcolor{comment}{/* CPU architecture. */}}
\DoxyCodeLine{1377 \textcolor{preprocessor}{\#if defined(\_\_x86\_64\_\_) || defined(\_M\_X64)}}
\DoxyCodeLine{1378 \textcolor{preprocessor}{    \#define DRFLAC\_X64}}
\DoxyCodeLine{1379 \textcolor{preprocessor}{\#elif defined(\_\_i386) || defined(\_M\_IX86)}}
\DoxyCodeLine{1380 \textcolor{preprocessor}{    \#define DRFLAC\_X86}}
\DoxyCodeLine{1381 \textcolor{preprocessor}{\#elif defined(\_\_arm\_\_) || defined(\_M\_ARM) || defined(\_M\_ARM64)}}
\DoxyCodeLine{1382 \textcolor{preprocessor}{    \#define DRFLAC\_ARM}}
\DoxyCodeLine{1383 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1384 }
\DoxyCodeLine{1385 \textcolor{comment}{/*}}
\DoxyCodeLine{1386 \textcolor{comment}{Intrinsics Support}}
\DoxyCodeLine{1387 \textcolor{comment}{}}
\DoxyCodeLine{1388 \textcolor{comment}{There's a bug in GCC 4.2.x which results in an incorrect compilation error when using \_mm\_slli\_epi32() where it complains with}}
\DoxyCodeLine{1389 \textcolor{comment}{}}
\DoxyCodeLine{1390 \textcolor{comment}{    "{}error: shift must be an immediate"{}}}
\DoxyCodeLine{1391 \textcolor{comment}{}}
\DoxyCodeLine{1392 \textcolor{comment}{Unfortuantely dr\_flac depends on this for a few things so we're just going to disable SSE on GCC 4.2 and below.}}
\DoxyCodeLine{1393 \textcolor{comment}{*/}}
\DoxyCodeLine{1394 \textcolor{preprocessor}{\#if !defined(DR\_FLAC\_NO\_SIMD)}}
\DoxyCodeLine{1395 \textcolor{preprocessor}{    \#if defined(DRFLAC\_X64) || defined(DRFLAC\_X86)}}
\DoxyCodeLine{1396 \textcolor{preprocessor}{        \#if defined(\_MSC\_VER) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1397             \textcolor{comment}{/* MSVC. */}}
\DoxyCodeLine{1398 \textcolor{preprocessor}{            \#if \_MSC\_VER >= 1400 \&\& !defined(DRFLAC\_NO\_SSE2)    }\textcolor{comment}{/* 2005 */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1399 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE2}}
\DoxyCodeLine{1400 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1401 \textcolor{preprocessor}{            \#if \_MSC\_VER >= 1600 \&\& !defined(DRFLAC\_NO\_SSE41)   }\textcolor{comment}{/* 2010 */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1402 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE41}}
\DoxyCodeLine{1403 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1404 \textcolor{preprocessor}{        \#elif defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 3)))}}
\DoxyCodeLine{1405             \textcolor{comment}{/* Assume GNUC-\/style. */}}
\DoxyCodeLine{1406 \textcolor{preprocessor}{            \#if defined(\_\_SSE2\_\_) \&\& !defined(DRFLAC\_NO\_SSE2)}}
\DoxyCodeLine{1407 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE2}}
\DoxyCodeLine{1408 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1409 \textcolor{preprocessor}{            \#if defined(\_\_SSE4\_1\_\_) \&\& !defined(DRFLAC\_NO\_SSE41)}}
\DoxyCodeLine{1410 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE41}}
\DoxyCodeLine{1411 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1412 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1413 }
\DoxyCodeLine{1414         \textcolor{comment}{/* If at this point we still haven't determined compiler support for the intrinsics just fall back to \_\_has\_include. */}}
\DoxyCodeLine{1415 \textcolor{preprocessor}{        \#if !defined(\_\_GNUC\_\_) \&\& !defined(\_\_clang\_\_) \&\& defined(\_\_has\_include)}}
\DoxyCodeLine{1416 \textcolor{preprocessor}{            \#if !defined(DRFLAC\_SUPPORT\_SSE2) \&\& !defined(DRFLAC\_NO\_SSE2) \&\& \_\_has\_include(<emmintrin.h>)}}
\DoxyCodeLine{1417 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE2}}
\DoxyCodeLine{1418 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1419 \textcolor{preprocessor}{            \#if !defined(DRFLAC\_SUPPORT\_SSE41) \&\& !defined(DRFLAC\_NO\_SSE41) \&\& \_\_has\_include(<smmintrin.h>)}}
\DoxyCodeLine{1420 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_SSE41}}
\DoxyCodeLine{1421 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1422 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1423 }
\DoxyCodeLine{1424 \textcolor{preprocessor}{        \#if defined(DRFLAC\_SUPPORT\_SSE41)}}
\DoxyCodeLine{1425 \textcolor{preprocessor}{            \#include <smmintrin.h>}}
\DoxyCodeLine{1426 \textcolor{preprocessor}{        \#elif defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{1427 \textcolor{preprocessor}{            \#include <emmintrin.h>}}
\DoxyCodeLine{1428 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1429 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1430 }
\DoxyCodeLine{1431 \textcolor{preprocessor}{    \#if defined(DRFLAC\_ARM)}}
\DoxyCodeLine{1432 \textcolor{preprocessor}{        \#if !defined(DRFLAC\_NO\_NEON) \&\& (defined(\_\_ARM\_NEON) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64))}}
\DoxyCodeLine{1433 \textcolor{preprocessor}{            \#define DRFLAC\_SUPPORT\_NEON}}
\DoxyCodeLine{1434 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436         \textcolor{comment}{/* Fall back to looking for the \#include file. */}}
\DoxyCodeLine{1437 \textcolor{preprocessor}{        \#if !defined(\_\_GNUC\_\_) \&\& !defined(\_\_clang\_\_) \&\& defined(\_\_has\_include)}}
\DoxyCodeLine{1438 \textcolor{preprocessor}{            \#if !defined(DRFLAC\_SUPPORT\_NEON) \&\& !defined(DRFLAC\_NO\_NEON) \&\& \_\_has\_include(<arm\_neon.h>)}}
\DoxyCodeLine{1439 \textcolor{preprocessor}{                \#define DRFLAC\_SUPPORT\_NEON}}
\DoxyCodeLine{1440 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1441 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1442 }
\DoxyCodeLine{1443 \textcolor{preprocessor}{        \#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{1444 \textcolor{preprocessor}{            \#include <arm\_neon.h>}}
\DoxyCodeLine{1445 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1446 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1447 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1448 }
\DoxyCodeLine{1449 \textcolor{comment}{/* Compile-\/time CPU feature support. */}}
\DoxyCodeLine{1450 \textcolor{preprocessor}{\#if !defined(DR\_FLAC\_NO\_SIMD) \&\& (defined(DRFLAC\_X86) || defined(DRFLAC\_X64))}}
\DoxyCodeLine{1451 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1452 \textcolor{preprocessor}{        \#if \_MSC\_VER >= 1400}}
\DoxyCodeLine{1453 \textcolor{preprocessor}{            \#include <intrin.h>}}
\DoxyCodeLine{1454             \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_cpuid(\textcolor{keywordtype}{int} info[4], \textcolor{keywordtype}{int} fid)}
\DoxyCodeLine{1455             \{}
\DoxyCodeLine{1456                 \_\_cpuid(info, fid);}
\DoxyCodeLine{1457             \}}
\DoxyCodeLine{1458 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1459 \textcolor{preprocessor}{            \#define DRFLAC\_NO\_CPUID}}
\DoxyCodeLine{1460 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1461 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1462 \textcolor{preprocessor}{        \#if defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{1463             \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_cpuid(\textcolor{keywordtype}{int} info[4], \textcolor{keywordtype}{int} fid)}
\DoxyCodeLine{1464             \{}
\DoxyCodeLine{1465                 \textcolor{comment}{/*}}
\DoxyCodeLine{1466 \textcolor{comment}{                It looks like the -\/fPIC option uses the ebx register which GCC complains about. We can work around this by just using a different register, the}}
\DoxyCodeLine{1467 \textcolor{comment}{                specific register of which I'm letting the compiler decide on. The "{}k"{} prefix is used to specify a 32-\/bit register. The \{...\} syntax is for}}
\DoxyCodeLine{1468 \textcolor{comment}{                supporting different assembly dialects.}}
\DoxyCodeLine{1469 \textcolor{comment}{}}
\DoxyCodeLine{1470 \textcolor{comment}{                What's basically happening is that we're saving and restoring the ebx register manually.}}
\DoxyCodeLine{1471 \textcolor{comment}{                */}}
\DoxyCodeLine{1472 \textcolor{preprocessor}{                \#if defined(DRFLAC\_X86) \&\& defined(\_\_PIC\_\_)}}
\DoxyCodeLine{1473                     \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{1474                         \textcolor{stringliteral}{"{}xchg\{l\} \{\%\%\}ebx, \%k1;"{}}}
\DoxyCodeLine{1475                         \textcolor{stringliteral}{"{}cpuid;"{}}}
\DoxyCodeLine{1476                         \textcolor{stringliteral}{"{}xchg\{l\} \{\%\%\}ebx, \%k1;"{}}}
\DoxyCodeLine{1477                         : \textcolor{stringliteral}{"{}=a"{}}(info[0]), \textcolor{stringliteral}{"{}=\&r"{}}(info[1]), \textcolor{stringliteral}{"{}=c"{}}(info[2]), \textcolor{stringliteral}{"{}=d"{}}(info[3]) : \textcolor{stringliteral}{"{}a"{}}(fid), \textcolor{stringliteral}{"{}c"{}}(0)}
\DoxyCodeLine{1478                     );}
\DoxyCodeLine{1479 \textcolor{preprocessor}{                \#else}}
\DoxyCodeLine{1480                     \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{1481                         \textcolor{stringliteral}{"{}cpuid"{}} : \textcolor{stringliteral}{"{}=a"{}}(info[0]), \textcolor{stringliteral}{"{}=b"{}}(info[1]), \textcolor{stringliteral}{"{}=c"{}}(info[2]), \textcolor{stringliteral}{"{}=d"{}}(info[3]) : \textcolor{stringliteral}{"{}a"{}}(fid), \textcolor{stringliteral}{"{}c"{}}(0)}
\DoxyCodeLine{1482                     );}
\DoxyCodeLine{1483 \textcolor{preprocessor}{                \#endif}}
\DoxyCodeLine{1484             \}}
\DoxyCodeLine{1485 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1486 \textcolor{preprocessor}{            \#define DRFLAC\_NO\_CPUID}}
\DoxyCodeLine{1487 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1488 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1489 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1490 \textcolor{preprocessor}{    \#define DRFLAC\_NO\_CPUID}}
\DoxyCodeLine{1491 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1492 }
\DoxyCodeLine{1493 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_has\_sse2(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1494 \{}
\DoxyCodeLine{1495 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{1496 \textcolor{preprocessor}{    \#if (defined(DRFLAC\_X64) || defined(DRFLAC\_X86)) \&\& !defined(DRFLAC\_NO\_SSE2)}}
\DoxyCodeLine{1497 \textcolor{preprocessor}{        \#if defined(DRFLAC\_X64)}}
\DoxyCodeLine{1498             \textcolor{keywordflow}{return} DRFLAC\_TRUE;    \textcolor{comment}{/* 64-\/bit targets always support SSE2. */}}
\DoxyCodeLine{1499 \textcolor{preprocessor}{        \#elif (defined(\_M\_IX86\_FP) \&\& \_M\_IX86\_FP == 2) || defined(\_\_SSE2\_\_)}}
\DoxyCodeLine{1500             \textcolor{keywordflow}{return} DRFLAC\_TRUE;    \textcolor{comment}{/* If the compiler is allowed to freely generate SSE2 code we can assume support. */}}
\DoxyCodeLine{1501 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1502 \textcolor{preprocessor}{            \#if defined(DRFLAC\_NO\_CPUID)}}
\DoxyCodeLine{1503                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{1504 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{1505                 \textcolor{keywordtype}{int} info[4];}
\DoxyCodeLine{1506                 drflac\_\_cpuid(info, 1);}
\DoxyCodeLine{1507                 \textcolor{keywordflow}{return} (info[3] \& (1 << 26)) != 0;}
\DoxyCodeLine{1508 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1509 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1510 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1511         \textcolor{keywordflow}{return} DRFLAC\_FALSE;       \textcolor{comment}{/* SSE2 is only supported on x86 and x64 architectures. */}}
\DoxyCodeLine{1512 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1513 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1514     \textcolor{keywordflow}{return} DRFLAC\_FALSE;           \textcolor{comment}{/* No compiler support. */}}
\DoxyCodeLine{1515 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1516 \}}
\DoxyCodeLine{1517 }
\DoxyCodeLine{1518 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_has\_sse41(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1519 \{}
\DoxyCodeLine{1520 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE41)}}
\DoxyCodeLine{1521 \textcolor{preprocessor}{    \#if (defined(DRFLAC\_X64) || defined(DRFLAC\_X86)) \&\& !defined(DRFLAC\_NO\_SSE41)}}
\DoxyCodeLine{1522 \textcolor{preprocessor}{        \#if defined(DRFLAC\_X64)}}
\DoxyCodeLine{1523             \textcolor{keywordflow}{return} DRFLAC\_TRUE;    \textcolor{comment}{/* 64-\/bit targets always support SSE4.1. */}}
\DoxyCodeLine{1524 \textcolor{preprocessor}{        \#elif (defined(\_M\_IX86\_FP) \&\& \_M\_IX86\_FP == 2) || defined(\_\_SSE4\_1\_\_)}}
\DoxyCodeLine{1525             \textcolor{keywordflow}{return} DRFLAC\_TRUE;    \textcolor{comment}{/* If the compiler is allowed to freely generate SSE41 code we can assume support. */}}
\DoxyCodeLine{1526 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1527 \textcolor{preprocessor}{            \#if defined(DRFLAC\_NO\_CPUID)}}
\DoxyCodeLine{1528                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{1529 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{1530                 \textcolor{keywordtype}{int} info[4];}
\DoxyCodeLine{1531                 drflac\_\_cpuid(info, 1);}
\DoxyCodeLine{1532                 \textcolor{keywordflow}{return} (info[2] \& (1 << 19)) != 0;}
\DoxyCodeLine{1533 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1534 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1535 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1536         \textcolor{keywordflow}{return} DRFLAC\_FALSE;       \textcolor{comment}{/* SSE41 is only supported on x86 and x64 architectures. */}}
\DoxyCodeLine{1537 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1538 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1539     \textcolor{keywordflow}{return} DRFLAC\_FALSE;           \textcolor{comment}{/* No compiler support. */}}
\DoxyCodeLine{1540 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1541 \}}
\DoxyCodeLine{1542 }
\DoxyCodeLine{1543 }
\DoxyCodeLine{1544 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1500 \&\& (defined(DRFLAC\_X86) || defined(DRFLAC\_X64)) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1545 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_LZCNT\_INTRINSIC}}
\DoxyCodeLine{1546 \textcolor{preprocessor}{\#elif (defined(\_\_GNUC\_\_) \&\& ((\_\_GNUC\_\_ > 4) || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 7)))}}
\DoxyCodeLine{1547 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_LZCNT\_INTRINSIC}}
\DoxyCodeLine{1548 \textcolor{preprocessor}{\#elif defined(\_\_clang\_\_)}}
\DoxyCodeLine{1549 \textcolor{preprocessor}{    \#if defined(\_\_has\_builtin)}}
\DoxyCodeLine{1550 \textcolor{preprocessor}{        \#if \_\_has\_builtin(\_\_builtin\_clzll) || \_\_has\_builtin(\_\_builtin\_clzl)}}
\DoxyCodeLine{1551 \textcolor{preprocessor}{            \#define DRFLAC\_HAS\_LZCNT\_INTRINSIC}}
\DoxyCodeLine{1552 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1553 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1554 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1555 }
\DoxyCodeLine{1556 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400 \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1557 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP16\_INTRINSIC}}
\DoxyCodeLine{1558 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP32\_INTRINSIC}}
\DoxyCodeLine{1559 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP64\_INTRINSIC}}
\DoxyCodeLine{1560 \textcolor{preprocessor}{\#elif defined(\_\_clang\_\_)}}
\DoxyCodeLine{1561 \textcolor{preprocessor}{    \#if defined(\_\_has\_builtin)}}
\DoxyCodeLine{1562 \textcolor{preprocessor}{        \#if \_\_has\_builtin(\_\_builtin\_bswap16)}}
\DoxyCodeLine{1563 \textcolor{preprocessor}{            \#define DRFLAC\_HAS\_BYTESWAP16\_INTRINSIC}}
\DoxyCodeLine{1564 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1565 \textcolor{preprocessor}{        \#if \_\_has\_builtin(\_\_builtin\_bswap32)}}
\DoxyCodeLine{1566 \textcolor{preprocessor}{            \#define DRFLAC\_HAS\_BYTESWAP32\_INTRINSIC}}
\DoxyCodeLine{1567 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1568 \textcolor{preprocessor}{        \#if \_\_has\_builtin(\_\_builtin\_bswap64)}}
\DoxyCodeLine{1569 \textcolor{preprocessor}{            \#define DRFLAC\_HAS\_BYTESWAP64\_INTRINSIC}}
\DoxyCodeLine{1570 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1571 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1572 \textcolor{preprocessor}{\#elif defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{1573 \textcolor{preprocessor}{    \#if ((\_\_GNUC\_\_ > 4) || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 3))}}
\DoxyCodeLine{1574 \textcolor{preprocessor}{        \#define DRFLAC\_HAS\_BYTESWAP32\_INTRINSIC}}
\DoxyCodeLine{1575 \textcolor{preprocessor}{        \#define DRFLAC\_HAS\_BYTESWAP64\_INTRINSIC}}
\DoxyCodeLine{1576 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1577 \textcolor{preprocessor}{    \#if ((\_\_GNUC\_\_ > 4) || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 8))}}
\DoxyCodeLine{1578 \textcolor{preprocessor}{        \#define DRFLAC\_HAS\_BYTESWAP16\_INTRINSIC}}
\DoxyCodeLine{1579 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1580 \textcolor{preprocessor}{\#elif defined(\_\_WATCOMC\_\_) \&\& defined(\_\_386\_\_)}}
\DoxyCodeLine{1581 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP16\_INTRINSIC}}
\DoxyCodeLine{1582 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP32\_INTRINSIC}}
\DoxyCodeLine{1583 \textcolor{preprocessor}{    \#define DRFLAC\_HAS\_BYTESWAP64\_INTRINSIC}}
\DoxyCodeLine{1584     \textcolor{keyword}{extern} \_\_inline drflac\_uint16 \_watcom\_bswap16(drflac\_uint16);}
\DoxyCodeLine{1585     \textcolor{keyword}{extern} \_\_inline drflac\_uint32 \_watcom\_bswap32(drflac\_uint32);}
\DoxyCodeLine{1586     \textcolor{keyword}{extern} \_\_inline drflac\_uint64 \_watcom\_bswap64(drflac\_uint64);}
\DoxyCodeLine{1587 \textcolor{preprocessor}{\#pragma aux \_watcom\_bswap16 = \(\backslash\)}}
\DoxyCodeLine{1588 \textcolor{preprocessor}{    "{}xchg al, ah"{}} \(\backslash\)}
\DoxyCodeLine{1589     parm   [ax]   \(\backslash\)}
\DoxyCodeLine{1590     modify [ax];}
\DoxyCodeLine{1591 \textcolor{preprocessor}{\#pragma aux \_watcom\_bswap32 = \(\backslash\)}}
\DoxyCodeLine{1592 \textcolor{preprocessor}{    "{}bswap eax"{}}  \(\backslash\)}
\DoxyCodeLine{1593     parm   [eax] \(\backslash\)}
\DoxyCodeLine{1594     modify [eax];}
\DoxyCodeLine{1595 \textcolor{preprocessor}{\#pragma aux \_watcom\_bswap64 = \(\backslash\)}}
\DoxyCodeLine{1596 \textcolor{preprocessor}{    "{}bswap eax"{}}     \(\backslash\)}
\DoxyCodeLine{1597     "{}bswap edx"{}     \(\backslash\)}
\DoxyCodeLine{1598     "{}xchg eax,edx"{}  \(\backslash\)}
\DoxyCodeLine{1599     parm [eax edx]  \(\backslash\)}
\DoxyCodeLine{1600     modify [eax edx];}
\DoxyCodeLine{1601 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1602 }
\DoxyCodeLine{1603 }
\DoxyCodeLine{1604 \textcolor{comment}{/* Standard library stuff. */}}
\DoxyCodeLine{1605 \textcolor{preprocessor}{\#ifndef DRFLAC\_ASSERT}}
\DoxyCodeLine{1606 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{1607 \textcolor{preprocessor}{\#define DRFLAC\_ASSERT(expression)           assert(expression)}}
\DoxyCodeLine{1608 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1609 \textcolor{preprocessor}{\#ifndef DRFLAC\_MALLOC}}
\DoxyCodeLine{1610 \textcolor{preprocessor}{\#define DRFLAC\_MALLOC(sz)                   malloc((sz))}}
\DoxyCodeLine{1611 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1612 \textcolor{preprocessor}{\#ifndef DRFLAC\_REALLOC}}
\DoxyCodeLine{1613 \textcolor{preprocessor}{\#define DRFLAC\_REALLOC(p, sz)               realloc((p), (sz))}}
\DoxyCodeLine{1614 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1615 \textcolor{preprocessor}{\#ifndef DRFLAC\_FREE}}
\DoxyCodeLine{1616 \textcolor{preprocessor}{\#define DRFLAC\_FREE(p)                      free((p))}}
\DoxyCodeLine{1617 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1618 \textcolor{preprocessor}{\#ifndef DRFLAC\_COPY\_MEMORY}}
\DoxyCodeLine{1619 \textcolor{preprocessor}{\#define DRFLAC\_COPY\_MEMORY(dst, src, sz)    memcpy((dst), (src), (sz))}}
\DoxyCodeLine{1620 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1621 \textcolor{preprocessor}{\#ifndef DRFLAC\_ZERO\_MEMORY}}
\DoxyCodeLine{1622 \textcolor{preprocessor}{\#define DRFLAC\_ZERO\_MEMORY(p, sz)           memset((p), 0, (sz))}}
\DoxyCodeLine{1623 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1624 \textcolor{preprocessor}{\#ifndef DRFLAC\_ZERO\_OBJECT}}
\DoxyCodeLine{1625 \textcolor{preprocessor}{\#define DRFLAC\_ZERO\_OBJECT(p)               DRFLAC\_ZERO\_MEMORY((p), sizeof(*(p)))}}
\DoxyCodeLine{1626 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1627 }
\DoxyCodeLine{1628 \textcolor{preprocessor}{\#define DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE                     64  }\textcolor{comment}{/* 64 for AVX-\/512 in the future. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1629 }
\DoxyCodeLine{1630 \textcolor{keyword}{typedef} drflac\_int32 drflac\_result;}
\DoxyCodeLine{1631 \textcolor{preprocessor}{\#define DRFLAC\_SUCCESS                                   0}}
\DoxyCodeLine{1632 \textcolor{preprocessor}{\#define DRFLAC\_ERROR                                    -\/1   }\textcolor{comment}{/* A generic error. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1633 \textcolor{preprocessor}{\#define DRFLAC\_INVALID\_ARGS                             -\/2}}
\DoxyCodeLine{1634 \textcolor{preprocessor}{\#define DRFLAC\_INVALID\_OPERATION                        -\/3}}
\DoxyCodeLine{1635 \textcolor{preprocessor}{\#define DRFLAC\_OUT\_OF\_MEMORY                            -\/4}}
\DoxyCodeLine{1636 \textcolor{preprocessor}{\#define DRFLAC\_OUT\_OF\_RANGE                             -\/5}}
\DoxyCodeLine{1637 \textcolor{preprocessor}{\#define DRFLAC\_ACCESS\_DENIED                            -\/6}}
\DoxyCodeLine{1638 \textcolor{preprocessor}{\#define DRFLAC\_DOES\_NOT\_EXIST                           -\/7}}
\DoxyCodeLine{1639 \textcolor{preprocessor}{\#define DRFLAC\_ALREADY\_EXISTS                           -\/8}}
\DoxyCodeLine{1640 \textcolor{preprocessor}{\#define DRFLAC\_TOO\_MANY\_OPEN\_FILES                      -\/9}}
\DoxyCodeLine{1641 \textcolor{preprocessor}{\#define DRFLAC\_INVALID\_FILE                             -\/10}}
\DoxyCodeLine{1642 \textcolor{preprocessor}{\#define DRFLAC\_TOO\_BIG                                  -\/11}}
\DoxyCodeLine{1643 \textcolor{preprocessor}{\#define DRFLAC\_PATH\_TOO\_LONG                            -\/12}}
\DoxyCodeLine{1644 \textcolor{preprocessor}{\#define DRFLAC\_NAME\_TOO\_LONG                            -\/13}}
\DoxyCodeLine{1645 \textcolor{preprocessor}{\#define DRFLAC\_NOT\_DIRECTORY                            -\/14}}
\DoxyCodeLine{1646 \textcolor{preprocessor}{\#define DRFLAC\_IS\_DIRECTORY                             -\/15}}
\DoxyCodeLine{1647 \textcolor{preprocessor}{\#define DRFLAC\_DIRECTORY\_NOT\_EMPTY                      -\/16}}
\DoxyCodeLine{1648 \textcolor{preprocessor}{\#define DRFLAC\_END\_OF\_FILE                              -\/17}}
\DoxyCodeLine{1649 \textcolor{preprocessor}{\#define DRFLAC\_NO\_SPACE                                 -\/18}}
\DoxyCodeLine{1650 \textcolor{preprocessor}{\#define DRFLAC\_BUSY                                     -\/19}}
\DoxyCodeLine{1651 \textcolor{preprocessor}{\#define DRFLAC\_IO\_ERROR                                 -\/20}}
\DoxyCodeLine{1652 \textcolor{preprocessor}{\#define DRFLAC\_INTERRUPT                                -\/21}}
\DoxyCodeLine{1653 \textcolor{preprocessor}{\#define DRFLAC\_UNAVAILABLE                              -\/22}}
\DoxyCodeLine{1654 \textcolor{preprocessor}{\#define DRFLAC\_ALREADY\_IN\_USE                           -\/23}}
\DoxyCodeLine{1655 \textcolor{preprocessor}{\#define DRFLAC\_BAD\_ADDRESS                              -\/24}}
\DoxyCodeLine{1656 \textcolor{preprocessor}{\#define DRFLAC\_BAD\_SEEK                                 -\/25}}
\DoxyCodeLine{1657 \textcolor{preprocessor}{\#define DRFLAC\_BAD\_PIPE                                 -\/26}}
\DoxyCodeLine{1658 \textcolor{preprocessor}{\#define DRFLAC\_DEADLOCK                                 -\/27}}
\DoxyCodeLine{1659 \textcolor{preprocessor}{\#define DRFLAC\_TOO\_MANY\_LINKS                           -\/28}}
\DoxyCodeLine{1660 \textcolor{preprocessor}{\#define DRFLAC\_NOT\_IMPLEMENTED                          -\/29}}
\DoxyCodeLine{1661 \textcolor{preprocessor}{\#define DRFLAC\_NO\_MESSAGE                               -\/30}}
\DoxyCodeLine{1662 \textcolor{preprocessor}{\#define DRFLAC\_BAD\_MESSAGE                              -\/31}}
\DoxyCodeLine{1663 \textcolor{preprocessor}{\#define DRFLAC\_NO\_DATA\_AVAILABLE                        -\/32}}
\DoxyCodeLine{1664 \textcolor{preprocessor}{\#define DRFLAC\_INVALID\_DATA                             -\/33}}
\DoxyCodeLine{1665 \textcolor{preprocessor}{\#define DRFLAC\_TIMEOUT                                  -\/34}}
\DoxyCodeLine{1666 \textcolor{preprocessor}{\#define DRFLAC\_NO\_NETWORK                               -\/35}}
\DoxyCodeLine{1667 \textcolor{preprocessor}{\#define DRFLAC\_NOT\_UNIQUE                               -\/36}}
\DoxyCodeLine{1668 \textcolor{preprocessor}{\#define DRFLAC\_NOT\_SOCKET                               -\/37}}
\DoxyCodeLine{1669 \textcolor{preprocessor}{\#define DRFLAC\_NO\_ADDRESS                               -\/38}}
\DoxyCodeLine{1670 \textcolor{preprocessor}{\#define DRFLAC\_BAD\_PROTOCOL                             -\/39}}
\DoxyCodeLine{1671 \textcolor{preprocessor}{\#define DRFLAC\_PROTOCOL\_UNAVAILABLE                     -\/40}}
\DoxyCodeLine{1672 \textcolor{preprocessor}{\#define DRFLAC\_PROTOCOL\_NOT\_SUPPORTED                   -\/41}}
\DoxyCodeLine{1673 \textcolor{preprocessor}{\#define DRFLAC\_PROTOCOL\_FAMILY\_NOT\_SUPPORTED            -\/42}}
\DoxyCodeLine{1674 \textcolor{preprocessor}{\#define DRFLAC\_ADDRESS\_FAMILY\_NOT\_SUPPORTED             -\/43}}
\DoxyCodeLine{1675 \textcolor{preprocessor}{\#define DRFLAC\_SOCKET\_NOT\_SUPPORTED                     -\/44}}
\DoxyCodeLine{1676 \textcolor{preprocessor}{\#define DRFLAC\_CONNECTION\_RESET                         -\/45}}
\DoxyCodeLine{1677 \textcolor{preprocessor}{\#define DRFLAC\_ALREADY\_CONNECTED                        -\/46}}
\DoxyCodeLine{1678 \textcolor{preprocessor}{\#define DRFLAC\_NOT\_CONNECTED                            -\/47}}
\DoxyCodeLine{1679 \textcolor{preprocessor}{\#define DRFLAC\_CONNECTION\_REFUSED                       -\/48}}
\DoxyCodeLine{1680 \textcolor{preprocessor}{\#define DRFLAC\_NO\_HOST                                  -\/49}}
\DoxyCodeLine{1681 \textcolor{preprocessor}{\#define DRFLAC\_IN\_PROGRESS                              -\/50}}
\DoxyCodeLine{1682 \textcolor{preprocessor}{\#define DRFLAC\_CANCELLED                                -\/51}}
\DoxyCodeLine{1683 \textcolor{preprocessor}{\#define DRFLAC\_MEMORY\_ALREADY\_MAPPED                    -\/52}}
\DoxyCodeLine{1684 \textcolor{preprocessor}{\#define DRFLAC\_AT\_END                                   -\/53}}
\DoxyCodeLine{1685 \textcolor{preprocessor}{\#define DRFLAC\_CRC\_MISMATCH                             -\/128}}
\DoxyCodeLine{1686 }
\DoxyCodeLine{1687 \textcolor{preprocessor}{\#define DRFLAC\_SUBFRAME\_CONSTANT                        0}}
\DoxyCodeLine{1688 \textcolor{preprocessor}{\#define DRFLAC\_SUBFRAME\_VERBATIM                        1}}
\DoxyCodeLine{1689 \textcolor{preprocessor}{\#define DRFLAC\_SUBFRAME\_FIXED                           8}}
\DoxyCodeLine{1690 \textcolor{preprocessor}{\#define DRFLAC\_SUBFRAME\_LPC                             32}}
\DoxyCodeLine{1691 \textcolor{preprocessor}{\#define DRFLAC\_SUBFRAME\_RESERVED                        255}}
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693 \textcolor{preprocessor}{\#define DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE  0}}
\DoxyCodeLine{1694 \textcolor{preprocessor}{\#define DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE2 1}}
\DoxyCodeLine{1695 }
\DoxyCodeLine{1696 \textcolor{preprocessor}{\#define DRFLAC\_CHANNEL\_ASSIGNMENT\_INDEPENDENT           0}}
\DoxyCodeLine{1697 \textcolor{preprocessor}{\#define DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE             8}}
\DoxyCodeLine{1698 \textcolor{preprocessor}{\#define DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE            9}}
\DoxyCodeLine{1699 \textcolor{preprocessor}{\#define DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE              10}}
\DoxyCodeLine{1700 }
\DoxyCodeLine{1701 \textcolor{preprocessor}{\#define drflac\_align(x, a)                              ((((x) + (a) -\/ 1) / (a)) * (a))}}
\DoxyCodeLine{1702 }
\DoxyCodeLine{1703 }
\DoxyCodeLine{1704 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_version(drflac\_uint32* pMajor, drflac\_uint32* pMinor, drflac\_uint32* pRevision)}
\DoxyCodeLine{1705 \{}
\DoxyCodeLine{1706     \textcolor{keywordflow}{if} (pMajor) \{}
\DoxyCodeLine{1707         *pMajor = DRFLAC\_VERSION\_MAJOR;}
\DoxyCodeLine{1708     \}}
\DoxyCodeLine{1709 }
\DoxyCodeLine{1710     \textcolor{keywordflow}{if} (pMinor) \{}
\DoxyCodeLine{1711         *pMinor = DRFLAC\_VERSION\_MINOR;}
\DoxyCodeLine{1712     \}}
\DoxyCodeLine{1713 }
\DoxyCodeLine{1714     \textcolor{keywordflow}{if} (pRevision) \{}
\DoxyCodeLine{1715         *pRevision = DRFLAC\_VERSION\_REVISION;}
\DoxyCodeLine{1716     \}}
\DoxyCodeLine{1717 \}}
\DoxyCodeLine{1718 }
\DoxyCodeLine{1719 DRFLAC\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drflac\_version\_string(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1720 \{}
\DoxyCodeLine{1721     \textcolor{keywordflow}{return} DRFLAC\_VERSION\_STRING;}
\DoxyCodeLine{1722 \}}
\DoxyCodeLine{1723 }
\DoxyCodeLine{1724 }
\DoxyCodeLine{1725 \textcolor{comment}{/* CPU caps. */}}
\DoxyCodeLine{1726 \textcolor{preprocessor}{\#if defined(\_\_has\_feature)}}
\DoxyCodeLine{1727 \textcolor{preprocessor}{    \#if \_\_has\_feature(thread\_sanitizer)}}
\DoxyCodeLine{1728 \textcolor{preprocessor}{        \#define DRFLAC\_NO\_THREAD\_SANITIZE \_\_attribute\_\_((no\_sanitize("{}thread"{}})))}
\DoxyCodeLine{1729 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1730 \textcolor{preprocessor}{        \#define DRFLAC\_NO\_THREAD\_SANITIZE}}
\DoxyCodeLine{1731 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1733 \textcolor{preprocessor}{    \#define DRFLAC\_NO\_THREAD\_SANITIZE}}
\DoxyCodeLine{1734 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1735 }
\DoxyCodeLine{1736 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_LZCNT\_INTRINSIC)}}
\DoxyCodeLine{1737 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_gIsLZCNTSupported = DRFLAC\_FALSE;}
\DoxyCodeLine{1738 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1739 }
\DoxyCodeLine{1740 \textcolor{preprocessor}{\#ifndef DRFLAC\_NO\_CPUID}}
\DoxyCodeLine{1741 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_gIsSSE2Supported  = DRFLAC\_FALSE;}
\DoxyCodeLine{1742 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_gIsSSE41Supported = DRFLAC\_FALSE;}
\DoxyCodeLine{1743 }
\DoxyCodeLine{1744 \textcolor{comment}{/*}}
\DoxyCodeLine{1745 \textcolor{comment}{I've had a bug report that Clang's ThreadSanitizer presents a warning in this function. Having reviewed this, this does}}
\DoxyCodeLine{1746 \textcolor{comment}{actually make sense. However, since CPU caps should never differ for a running process, I don't think the trade off of}}
\DoxyCodeLine{1747 \textcolor{comment}{complicating internal API's by passing around CPU caps versus just disabling the warnings is worthwhile. I'm therefore}}
\DoxyCodeLine{1748 \textcolor{comment}{just going to disable these warnings. This is disabled via the DRFLAC\_NO\_THREAD\_SANITIZE attribute.}}
\DoxyCodeLine{1749 \textcolor{comment}{*/}}
\DoxyCodeLine{1750 DRFLAC\_NO\_THREAD\_SANITIZE \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_init\_cpu\_caps(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1751 \{}
\DoxyCodeLine{1752     \textcolor{keyword}{static} drflac\_bool32 isCPUCapsInitialized = DRFLAC\_FALSE;}
\DoxyCodeLine{1753 }
\DoxyCodeLine{1754     \textcolor{keywordflow}{if} (!isCPUCapsInitialized) \{}
\DoxyCodeLine{1755         \textcolor{comment}{/* LZCNT */}}
\DoxyCodeLine{1756 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_LZCNT\_INTRINSIC)}}
\DoxyCodeLine{1757         \textcolor{keywordtype}{int} info[4] = \{0\};}
\DoxyCodeLine{1758         drflac\_\_cpuid(info, 0x80000001);}
\DoxyCodeLine{1759         drflac\_\_gIsLZCNTSupported = (info[2] \& (1 << 5)) != 0;}
\DoxyCodeLine{1760 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1761 }
\DoxyCodeLine{1762         \textcolor{comment}{/* SSE2 */}}
\DoxyCodeLine{1763         drflac\_\_gIsSSE2Supported = drflac\_has\_sse2();}
\DoxyCodeLine{1764 }
\DoxyCodeLine{1765         \textcolor{comment}{/* SSE4.1 */}}
\DoxyCodeLine{1766         drflac\_\_gIsSSE41Supported = drflac\_has\_sse41();}
\DoxyCodeLine{1767 }
\DoxyCodeLine{1768         \textcolor{comment}{/* Initialized. */}}
\DoxyCodeLine{1769         isCPUCapsInitialized = DRFLAC\_TRUE;}
\DoxyCodeLine{1770     \}}
\DoxyCodeLine{1771 \}}
\DoxyCodeLine{1772 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1773 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_gIsNEONSupported  = DRFLAC\_FALSE;}
\DoxyCodeLine{1774 }
\DoxyCodeLine{1775 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_has\_neon(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1776 \{}
\DoxyCodeLine{1777 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{1778 \textcolor{preprocessor}{    \#if defined(DRFLAC\_ARM) \&\& !defined(DRFLAC\_NO\_NEON)}}
\DoxyCodeLine{1779 \textcolor{preprocessor}{        \#if (defined(\_\_ARM\_NEON) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64))}}
\DoxyCodeLine{1780             \textcolor{keywordflow}{return} DRFLAC\_TRUE;    \textcolor{comment}{/* If the compiler is allowed to freely generate NEON code we can assume support. */}}
\DoxyCodeLine{1781 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1782             \textcolor{comment}{/* TODO: Runtime check. */}}
\DoxyCodeLine{1783             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{1784 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1785 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1786         \textcolor{keywordflow}{return} DRFLAC\_FALSE;       \textcolor{comment}{/* NEON is only supported on ARM architectures. */}}
\DoxyCodeLine{1787 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1788 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1789     \textcolor{keywordflow}{return} DRFLAC\_FALSE;           \textcolor{comment}{/* No compiler support. */}}
\DoxyCodeLine{1790 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1791 \}}
\DoxyCodeLine{1792 }
\DoxyCodeLine{1793 DRFLAC\_NO\_THREAD\_SANITIZE \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_init\_cpu\_caps(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1794 \{}
\DoxyCodeLine{1795     drflac\_\_gIsNEONSupported = drflac\_\_has\_neon();}
\DoxyCodeLine{1796 }
\DoxyCodeLine{1797 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_LZCNT\_INTRINSIC) \&\& defined(DRFLAC\_ARM) \&\& (defined(\_\_ARM\_ARCH) \&\& \_\_ARM\_ARCH >= 5)}}
\DoxyCodeLine{1798     drflac\_\_gIsLZCNTSupported = DRFLAC\_TRUE;}
\DoxyCodeLine{1799 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1800 \}}
\DoxyCodeLine{1801 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1802 }
\DoxyCodeLine{1803 }
\DoxyCodeLine{1804 \textcolor{comment}{/* Endian Management */}}
\DoxyCodeLine{1805 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_is\_little\_endian(\textcolor{keywordtype}{void})}
\DoxyCodeLine{1806 \{}
\DoxyCodeLine{1807 \textcolor{preprocessor}{\#if defined(DRFLAC\_X86) || defined(DRFLAC\_X64)}}
\DoxyCodeLine{1808     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{1809 \textcolor{preprocessor}{\#elif defined(\_\_BYTE\_ORDER) \&\& defined(\_\_LITTLE\_ENDIAN) \&\& \_\_BYTE\_ORDER == \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{1810     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{1811 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1812     \textcolor{keywordtype}{int} n = 1;}
\DoxyCodeLine{1813     \textcolor{keywordflow}{return} (*(\textcolor{keywordtype}{char}*)\&n) == 1;}
\DoxyCodeLine{1814 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1815 \}}
\DoxyCodeLine{1816 }
\DoxyCodeLine{1817 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_\_swap\_endian\_uint16(drflac\_uint16 n)}
\DoxyCodeLine{1818 \{}
\DoxyCodeLine{1819 \textcolor{preprocessor}{\#ifdef DRFLAC\_HAS\_BYTESWAP16\_INTRINSIC}}
\DoxyCodeLine{1820 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1821         \textcolor{keywordflow}{return} \_byteswap\_ushort(n);}
\DoxyCodeLine{1822 \textcolor{preprocessor}{    \#elif defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{1823         \textcolor{keywordflow}{return} \_\_builtin\_bswap16(n);}
\DoxyCodeLine{1824 \textcolor{preprocessor}{    \#elif defined(\_\_WATCOMC\_\_) \&\& defined(\_\_386\_\_)}}
\DoxyCodeLine{1825         \textcolor{keywordflow}{return} \_watcom\_bswap16(n);}
\DoxyCodeLine{1826 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1827 \textcolor{preprocessor}{        \#error "{}This compiler does not support the byte swap intrinsic."{}}}
\DoxyCodeLine{1828 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1829 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1830     \textcolor{keywordflow}{return} ((n \& 0xFF00) >> 8) |}
\DoxyCodeLine{1831            ((n \& 0x00FF) << 8);}
\DoxyCodeLine{1832 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1833 \}}
\DoxyCodeLine{1834 }
\DoxyCodeLine{1835 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_swap\_endian\_uint32(drflac\_uint32 n)}
\DoxyCodeLine{1836 \{}
\DoxyCodeLine{1837 \textcolor{preprocessor}{\#ifdef DRFLAC\_HAS\_BYTESWAP32\_INTRINSIC}}
\DoxyCodeLine{1838 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1839         \textcolor{keywordflow}{return} \_byteswap\_ulong(n);}
\DoxyCodeLine{1840 \textcolor{preprocessor}{    \#elif defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{1841 \textcolor{preprocessor}{        \#if defined(DRFLAC\_ARM) \&\& (defined(\_\_ARM\_ARCH) \&\& \_\_ARM\_ARCH >= 6) \&\& !defined(DRFLAC\_64BIT)   }\textcolor{comment}{/* <-\/-\/ 64-\/bit inline assembly has not been tested, so disabling for now. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{1842             \textcolor{comment}{/* Inline assembly optimized implementation for ARM. In my testing, GCC does not generate optimized code with \_\_builtin\_bswap32(). */}}
\DoxyCodeLine{1843             drflac\_uint32 r;}
\DoxyCodeLine{1844             \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{1845             \#\textcolor{keywordflow}{if} defined(DRFLAC\_64BIT)}
\DoxyCodeLine{1846                 \textcolor{stringliteral}{"{}rev \%w[out], \%w[in]"{}} : [out]\textcolor{stringliteral}{"{}=r"{}}(r) : [in]\textcolor{stringliteral}{"{}r"{}}(n)   \textcolor{comment}{/* <-\/-\/ This is untested. If someone in the community could test this, that would be appreciated! */}}
\DoxyCodeLine{1847             \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{1848                 \textcolor{stringliteral}{"{}rev \%[out], \%[in]"{}} : [out]\textcolor{stringliteral}{"{}=r"{}}(r) : [in]\textcolor{stringliteral}{"{}r"{}}(n)}
\DoxyCodeLine{1849             \#endif}
\DoxyCodeLine{1850             );}
\DoxyCodeLine{1851             \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{1852 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{1853             \textcolor{keywordflow}{return} \_\_builtin\_bswap32(n);}
\DoxyCodeLine{1854 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{1855 \textcolor{preprocessor}{    \#elif defined(\_\_WATCOMC\_\_) \&\& defined(\_\_386\_\_)}}
\DoxyCodeLine{1856         \textcolor{keywordflow}{return} \_watcom\_bswap32(n);}
\DoxyCodeLine{1857 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1858 \textcolor{preprocessor}{        \#error "{}This compiler does not support the byte swap intrinsic."{}}}
\DoxyCodeLine{1859 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1860 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1861     \textcolor{keywordflow}{return} ((n \& 0xFF000000) >> 24) |}
\DoxyCodeLine{1862            ((n \& 0x00FF0000) >>  8) |}
\DoxyCodeLine{1863            ((n \& 0x0000FF00) <<  8) |}
\DoxyCodeLine{1864            ((n \& 0x000000FF) << 24);}
\DoxyCodeLine{1865 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1866 \}}
\DoxyCodeLine{1867 }
\DoxyCodeLine{1868 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint64 drflac\_\_swap\_endian\_uint64(drflac\_uint64 n)}
\DoxyCodeLine{1869 \{}
\DoxyCodeLine{1870 \textcolor{preprocessor}{\#ifdef DRFLAC\_HAS\_BYTESWAP64\_INTRINSIC}}
\DoxyCodeLine{1871 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{1872         \textcolor{keywordflow}{return} \_byteswap\_uint64(n);}
\DoxyCodeLine{1873 \textcolor{preprocessor}{    \#elif defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{1874         \textcolor{keywordflow}{return} \_\_builtin\_bswap64(n);}
\DoxyCodeLine{1875 \textcolor{preprocessor}{    \#elif defined(\_\_WATCOMC\_\_) \&\& defined(\_\_386\_\_)}}
\DoxyCodeLine{1876         \textcolor{keywordflow}{return} \_watcom\_bswap64(n);}
\DoxyCodeLine{1877 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{1878 \textcolor{preprocessor}{        \#error "{}This compiler does not support the byte swap intrinsic."{}}}
\DoxyCodeLine{1879 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1880 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1881     \textcolor{comment}{/* Weird "{}<< 32"{} bitshift is required for C89 because it doesn't support 64-\/bit constants. Should be optimized out by a good compiler. */}}
\DoxyCodeLine{1882     \textcolor{keywordflow}{return} ((n \& ((drflac\_uint64)0xFF000000 << 32)) >> 56) |}
\DoxyCodeLine{1883            ((n \& ((drflac\_uint64)0x00FF0000 << 32)) >> 40) |}
\DoxyCodeLine{1884            ((n \& ((drflac\_uint64)0x0000FF00 << 32)) >> 24) |}
\DoxyCodeLine{1885            ((n \& ((drflac\_uint64)0x000000FF << 32)) >>  8) |}
\DoxyCodeLine{1886            ((n \& ((drflac\_uint64)0xFF000000      )) <<  8) |}
\DoxyCodeLine{1887            ((n \& ((drflac\_uint64)0x00FF0000      )) << 24) |}
\DoxyCodeLine{1888            ((n \& ((drflac\_uint64)0x0000FF00      )) << 40) |}
\DoxyCodeLine{1889            ((n \& ((drflac\_uint64)0x000000FF      )) << 56);}
\DoxyCodeLine{1890 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1891 \}}
\DoxyCodeLine{1892 }
\DoxyCodeLine{1893 }
\DoxyCodeLine{1894 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_\_be2host\_16(drflac\_uint16 n)}
\DoxyCodeLine{1895 \{}
\DoxyCodeLine{1896     \textcolor{keywordflow}{if} (drflac\_\_is\_little\_endian()) \{}
\DoxyCodeLine{1897         \textcolor{keywordflow}{return} drflac\_\_swap\_endian\_uint16(n);}
\DoxyCodeLine{1898     \}}
\DoxyCodeLine{1899 }
\DoxyCodeLine{1900     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{1901 \}}
\DoxyCodeLine{1902 }
\DoxyCodeLine{1903 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_be2host\_32(drflac\_uint32 n)}
\DoxyCodeLine{1904 \{}
\DoxyCodeLine{1905     \textcolor{keywordflow}{if} (drflac\_\_is\_little\_endian()) \{}
\DoxyCodeLine{1906         \textcolor{keywordflow}{return} drflac\_\_swap\_endian\_uint32(n);}
\DoxyCodeLine{1907     \}}
\DoxyCodeLine{1908 }
\DoxyCodeLine{1909     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{1910 \}}
\DoxyCodeLine{1911 }
\DoxyCodeLine{1912 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint64 drflac\_\_be2host\_64(drflac\_uint64 n)}
\DoxyCodeLine{1913 \{}
\DoxyCodeLine{1914     \textcolor{keywordflow}{if} (drflac\_\_is\_little\_endian()) \{}
\DoxyCodeLine{1915         \textcolor{keywordflow}{return} drflac\_\_swap\_endian\_uint64(n);}
\DoxyCodeLine{1916     \}}
\DoxyCodeLine{1917 }
\DoxyCodeLine{1918     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{1919 \}}
\DoxyCodeLine{1920 }
\DoxyCodeLine{1921 }
\DoxyCodeLine{1922 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_le2host\_32(drflac\_uint32 n)}
\DoxyCodeLine{1923 \{}
\DoxyCodeLine{1924     \textcolor{keywordflow}{if} (!drflac\_\_is\_little\_endian()) \{}
\DoxyCodeLine{1925         \textcolor{keywordflow}{return} drflac\_\_swap\_endian\_uint32(n);}
\DoxyCodeLine{1926     \}}
\DoxyCodeLine{1927 }
\DoxyCodeLine{1928     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{1929 \}}
\DoxyCodeLine{1930 }
\DoxyCodeLine{1931 }
\DoxyCodeLine{1932 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_unsynchsafe\_32(drflac\_uint32 n)}
\DoxyCodeLine{1933 \{}
\DoxyCodeLine{1934     drflac\_uint32 result = 0;}
\DoxyCodeLine{1935     result |= (n \& 0x7F000000) >> 3;}
\DoxyCodeLine{1936     result |= (n \& 0x007F0000) >> 2;}
\DoxyCodeLine{1937     result |= (n \& 0x00007F00) >> 1;}
\DoxyCodeLine{1938     result |= (n \& 0x0000007F) >> 0;}
\DoxyCodeLine{1939 }
\DoxyCodeLine{1940     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1941 \}}
\DoxyCodeLine{1942 }
\DoxyCodeLine{1943 }
\DoxyCodeLine{1944 }
\DoxyCodeLine{1945 \textcolor{comment}{/* The CRC code below is based on this document: http://zlib.net/crc\_v3.txt */}}
\DoxyCodeLine{1946 \textcolor{keyword}{static} drflac\_uint8 drflac\_\_crc8\_table[] = \{}
\DoxyCodeLine{1947     0x00, 0x07, 0x0E, 0x09, 0x1C, 0x1B, 0x12, 0x15, 0x38, 0x3F, 0x36, 0x31, 0x24, 0x23, 0x2A, 0x2D,}
\DoxyCodeLine{1948     0x70, 0x77, 0x7E, 0x79, 0x6C, 0x6B, 0x62, 0x65, 0x48, 0x4F, 0x46, 0x41, 0x54, 0x53, 0x5A, 0x5D,}
\DoxyCodeLine{1949     0xE0, 0xE7, 0xEE, 0xE9, 0xFC, 0xFB, 0xF2, 0xF5, 0xD8, 0xDF, 0xD6, 0xD1, 0xC4, 0xC3, 0xCA, 0xCD,}
\DoxyCodeLine{1950     0x90, 0x97, 0x9E, 0x99, 0x8C, 0x8B, 0x82, 0x85, 0xA8, 0xAF, 0xA6, 0xA1, 0xB4, 0xB3, 0xBA, 0xBD,}
\DoxyCodeLine{1951     0xC7, 0xC0, 0xC9, 0xCE, 0xDB, 0xDC, 0xD5, 0xD2, 0xFF, 0xF8, 0xF1, 0xF6, 0xE3, 0xE4, 0xED, 0xEA,}
\DoxyCodeLine{1952     0xB7, 0xB0, 0xB9, 0xBE, 0xAB, 0xAC, 0xA5, 0xA2, 0x8F, 0x88, 0x81, 0x86, 0x93, 0x94, 0x9D, 0x9A,}
\DoxyCodeLine{1953     0x27, 0x20, 0x29, 0x2E, 0x3B, 0x3C, 0x35, 0x32, 0x1F, 0x18, 0x11, 0x16, 0x03, 0x04, 0x0D, 0x0A,}
\DoxyCodeLine{1954     0x57, 0x50, 0x59, 0x5E, 0x4B, 0x4C, 0x45, 0x42, 0x6F, 0x68, 0x61, 0x66, 0x73, 0x74, 0x7D, 0x7A,}
\DoxyCodeLine{1955     0x89, 0x8E, 0x87, 0x80, 0x95, 0x92, 0x9B, 0x9C, 0xB1, 0xB6, 0xBF, 0xB8, 0xAD, 0xAA, 0xA3, 0xA4,}
\DoxyCodeLine{1956     0xF9, 0xFE, 0xF7, 0xF0, 0xE5, 0xE2, 0xEB, 0xEC, 0xC1, 0xC6, 0xCF, 0xC8, 0xDD, 0xDA, 0xD3, 0xD4,}
\DoxyCodeLine{1957     0x69, 0x6E, 0x67, 0x60, 0x75, 0x72, 0x7B, 0x7C, 0x51, 0x56, 0x5F, 0x58, 0x4D, 0x4A, 0x43, 0x44,}
\DoxyCodeLine{1958     0x19, 0x1E, 0x17, 0x10, 0x05, 0x02, 0x0B, 0x0C, 0x21, 0x26, 0x2F, 0x28, 0x3D, 0x3A, 0x33, 0x34,}
\DoxyCodeLine{1959     0x4E, 0x49, 0x40, 0x47, 0x52, 0x55, 0x5C, 0x5B, 0x76, 0x71, 0x78, 0x7F, 0x6A, 0x6D, 0x64, 0x63,}
\DoxyCodeLine{1960     0x3E, 0x39, 0x30, 0x37, 0x22, 0x25, 0x2C, 0x2B, 0x06, 0x01, 0x08, 0x0F, 0x1A, 0x1D, 0x14, 0x13,}
\DoxyCodeLine{1961     0xAE, 0xA9, 0xA0, 0xA7, 0xB2, 0xB5, 0xBC, 0xBB, 0x96, 0x91, 0x98, 0x9F, 0x8A, 0x8D, 0x84, 0x83,}
\DoxyCodeLine{1962     0xDE, 0xD9, 0xD0, 0xD7, 0xC2, 0xC5, 0xCC, 0xCB, 0xE6, 0xE1, 0xE8, 0xEF, 0xFA, 0xFD, 0xF4, 0xF3}
\DoxyCodeLine{1963 \};}
\DoxyCodeLine{1964 }
\DoxyCodeLine{1965 \textcolor{keyword}{static} drflac\_uint16 drflac\_\_crc16\_table[] = \{}
\DoxyCodeLine{1966     0x0000, 0x8005, 0x800F, 0x000A, 0x801B, 0x001E, 0x0014, 0x8011,}
\DoxyCodeLine{1967     0x8033, 0x0036, 0x003C, 0x8039, 0x0028, 0x802D, 0x8027, 0x0022,}
\DoxyCodeLine{1968     0x8063, 0x0066, 0x006C, 0x8069, 0x0078, 0x807D, 0x8077, 0x0072,}
\DoxyCodeLine{1969     0x0050, 0x8055, 0x805F, 0x005A, 0x804B, 0x004E, 0x0044, 0x8041,}
\DoxyCodeLine{1970     0x80C3, 0x00C6, 0x00CC, 0x80C9, 0x00D8, 0x80DD, 0x80D7, 0x00D2,}
\DoxyCodeLine{1971     0x00F0, 0x80F5, 0x80FF, 0x00FA, 0x80EB, 0x00EE, 0x00E4, 0x80E1,}
\DoxyCodeLine{1972     0x00A0, 0x80A5, 0x80AF, 0x00AA, 0x80BB, 0x00BE, 0x00B4, 0x80B1,}
\DoxyCodeLine{1973     0x8093, 0x0096, 0x009C, 0x8099, 0x0088, 0x808D, 0x8087, 0x0082,}
\DoxyCodeLine{1974     0x8183, 0x0186, 0x018C, 0x8189, 0x0198, 0x819D, 0x8197, 0x0192,}
\DoxyCodeLine{1975     0x01B0, 0x81B5, 0x81BF, 0x01BA, 0x81AB, 0x01AE, 0x01A4, 0x81A1,}
\DoxyCodeLine{1976     0x01E0, 0x81E5, 0x81EF, 0x01EA, 0x81FB, 0x01FE, 0x01F4, 0x81F1,}
\DoxyCodeLine{1977     0x81D3, 0x01D6, 0x01DC, 0x81D9, 0x01C8, 0x81CD, 0x81C7, 0x01C2,}
\DoxyCodeLine{1978     0x0140, 0x8145, 0x814F, 0x014A, 0x815B, 0x015E, 0x0154, 0x8151,}
\DoxyCodeLine{1979     0x8173, 0x0176, 0x017C, 0x8179, 0x0168, 0x816D, 0x8167, 0x0162,}
\DoxyCodeLine{1980     0x8123, 0x0126, 0x012C, 0x8129, 0x0138, 0x813D, 0x8137, 0x0132,}
\DoxyCodeLine{1981     0x0110, 0x8115, 0x811F, 0x011A, 0x810B, 0x010E, 0x0104, 0x8101,}
\DoxyCodeLine{1982     0x8303, 0x0306, 0x030C, 0x8309, 0x0318, 0x831D, 0x8317, 0x0312,}
\DoxyCodeLine{1983     0x0330, 0x8335, 0x833F, 0x033A, 0x832B, 0x032E, 0x0324, 0x8321,}
\DoxyCodeLine{1984     0x0360, 0x8365, 0x836F, 0x036A, 0x837B, 0x037E, 0x0374, 0x8371,}
\DoxyCodeLine{1985     0x8353, 0x0356, 0x035C, 0x8359, 0x0348, 0x834D, 0x8347, 0x0342,}
\DoxyCodeLine{1986     0x03C0, 0x83C5, 0x83CF, 0x03CA, 0x83DB, 0x03DE, 0x03D4, 0x83D1,}
\DoxyCodeLine{1987     0x83F3, 0x03F6, 0x03FC, 0x83F9, 0x03E8, 0x83ED, 0x83E7, 0x03E2,}
\DoxyCodeLine{1988     0x83A3, 0x03A6, 0x03AC, 0x83A9, 0x03B8, 0x83BD, 0x83B7, 0x03B2,}
\DoxyCodeLine{1989     0x0390, 0x8395, 0x839F, 0x039A, 0x838B, 0x038E, 0x0384, 0x8381,}
\DoxyCodeLine{1990     0x0280, 0x8285, 0x828F, 0x028A, 0x829B, 0x029E, 0x0294, 0x8291,}
\DoxyCodeLine{1991     0x82B3, 0x02B6, 0x02BC, 0x82B9, 0x02A8, 0x82AD, 0x82A7, 0x02A2,}
\DoxyCodeLine{1992     0x82E3, 0x02E6, 0x02EC, 0x82E9, 0x02F8, 0x82FD, 0x82F7, 0x02F2,}
\DoxyCodeLine{1993     0x02D0, 0x82D5, 0x82DF, 0x02DA, 0x82CB, 0x02CE, 0x02C4, 0x82C1,}
\DoxyCodeLine{1994     0x8243, 0x0246, 0x024C, 0x8249, 0x0258, 0x825D, 0x8257, 0x0252,}
\DoxyCodeLine{1995     0x0270, 0x8275, 0x827F, 0x027A, 0x826B, 0x026E, 0x0264, 0x8261,}
\DoxyCodeLine{1996     0x0220, 0x8225, 0x822F, 0x022A, 0x823B, 0x023E, 0x0234, 0x8231,}
\DoxyCodeLine{1997     0x8213, 0x0216, 0x021C, 0x8219, 0x0208, 0x820D, 0x8207, 0x0202}
\DoxyCodeLine{1998 \};}
\DoxyCodeLine{1999 }
\DoxyCodeLine{2000 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint8 drflac\_crc8\_byte(drflac\_uint8 crc, drflac\_uint8 data)}
\DoxyCodeLine{2001 \{}
\DoxyCodeLine{2002     \textcolor{keywordflow}{return} drflac\_\_crc8\_table[crc \string^ data];}
\DoxyCodeLine{2003 \}}
\DoxyCodeLine{2004 }
\DoxyCodeLine{2005 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint8 drflac\_crc8(drflac\_uint8 crc, drflac\_uint32 data, drflac\_uint32 count)}
\DoxyCodeLine{2006 \{}
\DoxyCodeLine{2007 \textcolor{preprocessor}{\#ifdef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2008     (void)crc;}
\DoxyCodeLine{2009     (void)data;}
\DoxyCodeLine{2010     (void)count;}
\DoxyCodeLine{2011     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2012 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2013 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2014     \textcolor{comment}{/* REFERENCE (use of this implementation requires an explicit flush by doing "{}drflac\_crc8(crc, 0, 8);"{}) */}}
\DoxyCodeLine{2015     drflac\_uint8 p = 0x07;}
\DoxyCodeLine{2016     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = count-\/1; i >= 0; -\/-\/i) \{}
\DoxyCodeLine{2017         drflac\_uint8 bit = (data \& (1 << i)) >> i;}
\DoxyCodeLine{2018         \textcolor{keywordflow}{if} (crc \& 0x80) \{}
\DoxyCodeLine{2019             crc = ((crc << 1) | bit) \string^ p;}
\DoxyCodeLine{2020         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2021             crc = ((crc << 1) | bit);}
\DoxyCodeLine{2022         \}}
\DoxyCodeLine{2023     \}}
\DoxyCodeLine{2024     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2025 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2026     drflac\_uint32 wholeBytes;}
\DoxyCodeLine{2027     drflac\_uint32 leftoverBits;}
\DoxyCodeLine{2028     drflac\_uint64 leftoverDataMask;}
\DoxyCodeLine{2029 }
\DoxyCodeLine{2030     \textcolor{keyword}{static} drflac\_uint64 leftoverDataMaskTable[8] = \{}
\DoxyCodeLine{2031         0x00, 0x01, 0x03, 0x07, 0x0F, 0x1F, 0x3F, 0x7F}
\DoxyCodeLine{2032     \};}
\DoxyCodeLine{2033 }
\DoxyCodeLine{2034     DRFLAC\_ASSERT(count <= 32);}
\DoxyCodeLine{2035 }
\DoxyCodeLine{2036     wholeBytes = count >> 3;}
\DoxyCodeLine{2037     leftoverBits = count -\/ (wholeBytes*8);}
\DoxyCodeLine{2038     leftoverDataMask = leftoverDataMaskTable[leftoverBits];}
\DoxyCodeLine{2039 }
\DoxyCodeLine{2040     \textcolor{keywordflow}{switch} (wholeBytes) \{}
\DoxyCodeLine{2041         \textcolor{keywordflow}{case} 4: crc = drflac\_crc8\_byte(crc, (drflac\_uint8)((data \& (0xFF000000UL << leftoverBits)) >> (24 + leftoverBits)));}
\DoxyCodeLine{2042         \textcolor{keywordflow}{case} 3: crc = drflac\_crc8\_byte(crc, (drflac\_uint8)((data \& (0x00FF0000UL << leftoverBits)) >> (16 + leftoverBits)));}
\DoxyCodeLine{2043         \textcolor{keywordflow}{case} 2: crc = drflac\_crc8\_byte(crc, (drflac\_uint8)((data \& (0x0000FF00UL << leftoverBits)) >> ( 8 + leftoverBits)));}
\DoxyCodeLine{2044         \textcolor{keywordflow}{case} 1: crc = drflac\_crc8\_byte(crc, (drflac\_uint8)((data \& (0x000000FFUL << leftoverBits)) >> ( 0 + leftoverBits)));}
\DoxyCodeLine{2045         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{if} (leftoverBits > 0) crc = (drflac\_uint8)((crc << leftoverBits) \string^ drflac\_\_crc8\_table[(crc >> (8 -\/ leftoverBits)) \string^ (data \& leftoverDataMask)]);}
\DoxyCodeLine{2046     \}}
\DoxyCodeLine{2047     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2048 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2049 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2050 \}}
\DoxyCodeLine{2051 }
\DoxyCodeLine{2052 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16\_byte(drflac\_uint16 crc, drflac\_uint8 data)}
\DoxyCodeLine{2053 \{}
\DoxyCodeLine{2054     \textcolor{keywordflow}{return} (crc << 8) \string^ drflac\_\_crc16\_table[(drflac\_uint8)(crc >> 8) \string^ data];}
\DoxyCodeLine{2055 \}}
\DoxyCodeLine{2056 }
\DoxyCodeLine{2057 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16\_cache(drflac\_uint16 crc, drflac\_cache\_t data)}
\DoxyCodeLine{2058 \{}
\DoxyCodeLine{2059 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2060     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 56) \& 0xFF));}
\DoxyCodeLine{2061     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 48) \& 0xFF));}
\DoxyCodeLine{2062     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 40) \& 0xFF));}
\DoxyCodeLine{2063     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 32) \& 0xFF));}
\DoxyCodeLine{2064 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2065     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 24) \& 0xFF));}
\DoxyCodeLine{2066     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 16) \& 0xFF));}
\DoxyCodeLine{2067     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >>  8) \& 0xFF));}
\DoxyCodeLine{2068     crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >>  0) \& 0xFF));}
\DoxyCodeLine{2069 }
\DoxyCodeLine{2070     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2071 \}}
\DoxyCodeLine{2072 }
\DoxyCodeLine{2073 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16\_bytes(drflac\_uint16 crc, drflac\_cache\_t data, drflac\_uint32 byteCount)}
\DoxyCodeLine{2074 \{}
\DoxyCodeLine{2075     \textcolor{keywordflow}{switch} (byteCount)}
\DoxyCodeLine{2076     \{}
\DoxyCodeLine{2077 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2078     \textcolor{keywordflow}{case} 8: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 56) \& 0xFF));}
\DoxyCodeLine{2079     \textcolor{keywordflow}{case} 7: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 48) \& 0xFF));}
\DoxyCodeLine{2080     \textcolor{keywordflow}{case} 6: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 40) \& 0xFF));}
\DoxyCodeLine{2081     \textcolor{keywordflow}{case} 5: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 32) \& 0xFF));}
\DoxyCodeLine{2082 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2083     \textcolor{keywordflow}{case} 4: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 24) \& 0xFF));}
\DoxyCodeLine{2084     \textcolor{keywordflow}{case} 3: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >> 16) \& 0xFF));}
\DoxyCodeLine{2085     \textcolor{keywordflow}{case} 2: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >>  8) \& 0xFF));}
\DoxyCodeLine{2086     \textcolor{keywordflow}{case} 1: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data >>  0) \& 0xFF));}
\DoxyCodeLine{2087     \}}
\DoxyCodeLine{2088 }
\DoxyCodeLine{2089     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2090 \}}
\DoxyCodeLine{2091 }
\DoxyCodeLine{2092 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2093 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16\_\_32bit(drflac\_uint16 crc, drflac\_uint32 data, drflac\_uint32 count)}
\DoxyCodeLine{2094 \{}
\DoxyCodeLine{2095 \textcolor{preprocessor}{\#ifdef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2096     (void)crc;}
\DoxyCodeLine{2097     (void)data;}
\DoxyCodeLine{2098     (void)count;}
\DoxyCodeLine{2099     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2100 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2101 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2102     \textcolor{comment}{/* REFERENCE (use of this implementation requires an explicit flush by doing "{}drflac\_crc16(crc, 0, 16);"{}) */}}
\DoxyCodeLine{2103     drflac\_uint16 p = 0x8005;}
\DoxyCodeLine{2104     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = count-\/1; i >= 0; -\/-\/i) \{}
\DoxyCodeLine{2105         drflac\_uint16 bit = (data \& (1ULL << i)) >> i;}
\DoxyCodeLine{2106         \textcolor{keywordflow}{if} (r \& 0x8000) \{}
\DoxyCodeLine{2107             r = ((r << 1) | bit) \string^ p;}
\DoxyCodeLine{2108         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2109             r = ((r << 1) | bit);}
\DoxyCodeLine{2110         \}}
\DoxyCodeLine{2111     \}}
\DoxyCodeLine{2112 }
\DoxyCodeLine{2113     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2114 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2115     drflac\_uint32 wholeBytes;}
\DoxyCodeLine{2116     drflac\_uint32 leftoverBits;}
\DoxyCodeLine{2117     drflac\_uint64 leftoverDataMask;}
\DoxyCodeLine{2118 }
\DoxyCodeLine{2119     \textcolor{keyword}{static} drflac\_uint64 leftoverDataMaskTable[8] = \{}
\DoxyCodeLine{2120         0x00, 0x01, 0x03, 0x07, 0x0F, 0x1F, 0x3F, 0x7F}
\DoxyCodeLine{2121     \};}
\DoxyCodeLine{2122 }
\DoxyCodeLine{2123     DRFLAC\_ASSERT(count <= 64);}
\DoxyCodeLine{2124 }
\DoxyCodeLine{2125     wholeBytes = count >> 3;}
\DoxyCodeLine{2126     leftoverBits = count \& 7;}
\DoxyCodeLine{2127     leftoverDataMask = leftoverDataMaskTable[leftoverBits];}
\DoxyCodeLine{2128 }
\DoxyCodeLine{2129     \textcolor{keywordflow}{switch} (wholeBytes) \{}
\DoxyCodeLine{2130         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{2131         \textcolor{keywordflow}{case} 4: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (0xFF000000UL << leftoverBits)) >> (24 + leftoverBits)));}
\DoxyCodeLine{2132         \textcolor{keywordflow}{case} 3: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (0x00FF0000UL << leftoverBits)) >> (16 + leftoverBits)));}
\DoxyCodeLine{2133         \textcolor{keywordflow}{case} 2: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (0x0000FF00UL << leftoverBits)) >> ( 8 + leftoverBits)));}
\DoxyCodeLine{2134         \textcolor{keywordflow}{case} 1: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (0x000000FFUL << leftoverBits)) >> ( 0 + leftoverBits)));}
\DoxyCodeLine{2135         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{if} (leftoverBits > 0) crc = (crc << leftoverBits) \string^ drflac\_\_crc16\_table[(crc >> (16 -\/ leftoverBits)) \string^ (data \& leftoverDataMask)];}
\DoxyCodeLine{2136     \}}
\DoxyCodeLine{2137     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2138 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2139 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2140 \}}
\DoxyCodeLine{2141 }
\DoxyCodeLine{2142 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16\_\_64bit(drflac\_uint16 crc, drflac\_uint64 data, drflac\_uint32 count)}
\DoxyCodeLine{2143 \{}
\DoxyCodeLine{2144 \textcolor{preprocessor}{\#ifdef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2145     (void)crc;}
\DoxyCodeLine{2146     (void)data;}
\DoxyCodeLine{2147     (void)count;}
\DoxyCodeLine{2148     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2149 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2150     drflac\_uint32 wholeBytes;}
\DoxyCodeLine{2151     drflac\_uint32 leftoverBits;}
\DoxyCodeLine{2152     drflac\_uint64 leftoverDataMask;}
\DoxyCodeLine{2153 }
\DoxyCodeLine{2154     \textcolor{keyword}{static} drflac\_uint64 leftoverDataMaskTable[8] = \{}
\DoxyCodeLine{2155         0x00, 0x01, 0x03, 0x07, 0x0F, 0x1F, 0x3F, 0x7F}
\DoxyCodeLine{2156     \};}
\DoxyCodeLine{2157 }
\DoxyCodeLine{2158     DRFLAC\_ASSERT(count <= 64);}
\DoxyCodeLine{2159 }
\DoxyCodeLine{2160     wholeBytes = count >> 3;}
\DoxyCodeLine{2161     leftoverBits = count \& 7;}
\DoxyCodeLine{2162     leftoverDataMask = leftoverDataMaskTable[leftoverBits];}
\DoxyCodeLine{2163 }
\DoxyCodeLine{2164     \textcolor{keywordflow}{switch} (wholeBytes) \{}
\DoxyCodeLine{2165         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{2166         \textcolor{keywordflow}{case} 8: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0xFF000000 << 32) << leftoverBits)) >> (56 + leftoverBits)));    \textcolor{comment}{/* Weird "{}<< 32"{} bitshift is required for C89 because it doesn't support 64-\/bit constants. Should be optimized out by a good compiler. */}}
\DoxyCodeLine{2167         \textcolor{keywordflow}{case} 7: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x00FF0000 << 32) << leftoverBits)) >> (48 + leftoverBits)));}
\DoxyCodeLine{2168         \textcolor{keywordflow}{case} 6: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x0000FF00 << 32) << leftoverBits)) >> (40 + leftoverBits)));}
\DoxyCodeLine{2169         \textcolor{keywordflow}{case} 5: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x000000FF << 32) << leftoverBits)) >> (32 + leftoverBits)));}
\DoxyCodeLine{2170         \textcolor{keywordflow}{case} 4: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0xFF000000      ) << leftoverBits)) >> (24 + leftoverBits)));}
\DoxyCodeLine{2171         \textcolor{keywordflow}{case} 3: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x00FF0000      ) << leftoverBits)) >> (16 + leftoverBits)));}
\DoxyCodeLine{2172         \textcolor{keywordflow}{case} 2: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x0000FF00      ) << leftoverBits)) >> ( 8 + leftoverBits)));}
\DoxyCodeLine{2173         \textcolor{keywordflow}{case} 1: crc = drflac\_crc16\_byte(crc, (drflac\_uint8)((data \& (((drflac\_uint64)0x000000FF      ) << leftoverBits)) >> ( 0 + leftoverBits)));}
\DoxyCodeLine{2174         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{if} (leftoverBits > 0) crc = (crc << leftoverBits) \string^ drflac\_\_crc16\_table[(crc >> (16 -\/ leftoverBits)) \string^ (data \& leftoverDataMask)];}
\DoxyCodeLine{2175     \}}
\DoxyCodeLine{2176     \textcolor{keywordflow}{return} crc;}
\DoxyCodeLine{2177 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2178 \}}
\DoxyCodeLine{2179 }
\DoxyCodeLine{2180 }
\DoxyCodeLine{2181 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_crc16(drflac\_uint16 crc, drflac\_cache\_t data, drflac\_uint32 count)}
\DoxyCodeLine{2182 \{}
\DoxyCodeLine{2183 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2184     \textcolor{keywordflow}{return} drflac\_crc16\_\_64bit(crc, data, count);}
\DoxyCodeLine{2185 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2186     \textcolor{keywordflow}{return} drflac\_crc16\_\_32bit(crc, data, count);}
\DoxyCodeLine{2187 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2188 \}}
\DoxyCodeLine{2189 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2190 }
\DoxyCodeLine{2191 }
\DoxyCodeLine{2192 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2193 \textcolor{preprocessor}{\#define drflac\_\_be2host\_\_cache\_line drflac\_\_be2host\_64}}
\DoxyCodeLine{2194 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2195 \textcolor{preprocessor}{\#define drflac\_\_be2host\_\_cache\_line drflac\_\_be2host\_32}}
\DoxyCodeLine{2196 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2197 }
\DoxyCodeLine{2198 \textcolor{comment}{/*}}
\DoxyCodeLine{2199 \textcolor{comment}{BIT READING ATTEMPT \#2}}
\DoxyCodeLine{2200 \textcolor{comment}{}}
\DoxyCodeLine{2201 \textcolor{comment}{This uses a 32-\/ or 64-\/bit bit-\/shifted cache -\/ as bits are read, the cache is shifted such that the first valid bit is sitting}}
\DoxyCodeLine{2202 \textcolor{comment}{on the most significant bit. It uses the notion of an L1 and L2 cache (borrowed from CPU architecture), where the L1 cache}}
\DoxyCodeLine{2203 \textcolor{comment}{is a 32-\/ or 64-\/bit unsigned integer (depending on whether or not a 32-\/ or 64-\/bit build is being compiled) and the L2 is an}}
\DoxyCodeLine{2204 \textcolor{comment}{array of "{}cache lines"{}, with each cache line being the same size as the L1. The L2 is a buffer of about 4KB and is where data}}
\DoxyCodeLine{2205 \textcolor{comment}{from onRead() is read into.}}
\DoxyCodeLine{2206 \textcolor{comment}{*/}}
\DoxyCodeLine{2207 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs)                      (sizeof((bs)-\/>cache))}}
\DoxyCodeLine{2208 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)                       (sizeof((bs)-\/>cache)*8)}}
\DoxyCodeLine{2209 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs)                  (DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs) -\/ (bs)-\/>consumedBits)}}
\DoxyCodeLine{2210 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SELECTION\_MASK(\_bitCount)           (\string~((\string~(drflac\_cache\_t)0) >> (\_bitCount)))}}
\DoxyCodeLine{2211 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT(bs, \_bitCount)      (DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs) -\/ (\_bitCount))}}
\DoxyCodeLine{2212 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SELECT(bs, \_bitCount)               (((bs)-\/>cache) \& DRFLAC\_CACHE\_L1\_SELECTION\_MASK(\_bitCount))}}
\DoxyCodeLine{2213 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, \_bitCount)     (DRFLAC\_CACHE\_L1\_SELECT((bs), (\_bitCount)) >>  DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT((bs), (\_bitCount)))}}
\DoxyCodeLine{2214 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT\_SAFE(bs, \_bitCount)(DRFLAC\_CACHE\_L1\_SELECT((bs), (\_bitCount)) >> (DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT((bs), (\_bitCount)) \& (DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)-\/1)))}}
\DoxyCodeLine{2215 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L2\_SIZE\_BYTES(bs)                      (sizeof((bs)-\/>cacheL2))}}
\DoxyCodeLine{2216 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)                      (DRFLAC\_CACHE\_L2\_SIZE\_BYTES(bs) / sizeof((bs)-\/>cacheL2[0]))}}
\DoxyCodeLine{2217 \textcolor{preprocessor}{\#define DRFLAC\_CACHE\_L2\_LINES\_REMAINING(bs)                 (DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs) -\/ (bs)-\/>nextL2Line)}}
\DoxyCodeLine{2218 }
\DoxyCodeLine{2219 }
\DoxyCodeLine{2220 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2221 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_reset\_crc16(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2222 \{}
\DoxyCodeLine{2223     bs-\/>crc16 = 0;}
\DoxyCodeLine{2224     bs-\/>crc16CacheIgnoredBytes = bs-\/>consumedBits >> 3;}
\DoxyCodeLine{2225 \}}
\DoxyCodeLine{2226 }
\DoxyCodeLine{2227 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_update\_crc16(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2228 \{}
\DoxyCodeLine{2229     \textcolor{keywordflow}{if} (bs-\/>crc16CacheIgnoredBytes == 0) \{}
\DoxyCodeLine{2230         bs-\/>crc16 = drflac\_crc16\_cache(bs-\/>crc16, bs-\/>crc16Cache);}
\DoxyCodeLine{2231     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2232         bs-\/>crc16 = drflac\_crc16\_bytes(bs-\/>crc16, bs-\/>crc16Cache, DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs) -\/ bs-\/>crc16CacheIgnoredBytes);}
\DoxyCodeLine{2233         bs-\/>crc16CacheIgnoredBytes = 0;}
\DoxyCodeLine{2234     \}}
\DoxyCodeLine{2235 \}}
\DoxyCodeLine{2236 }
\DoxyCodeLine{2237 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint16 drflac\_\_flush\_crc16(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2238 \{}
\DoxyCodeLine{2239     \textcolor{comment}{/* We should never be flushing in a situation where we are not aligned on a byte boundary. */}}
\DoxyCodeLine{2240     DRFLAC\_ASSERT((DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs) \& 7) == 0);}
\DoxyCodeLine{2241 }
\DoxyCodeLine{2242     \textcolor{comment}{/*}}
\DoxyCodeLine{2243 \textcolor{comment}{    The bits that were read from the L1 cache need to be accumulated. The number of bytes needing to be accumulated is determined}}
\DoxyCodeLine{2244 \textcolor{comment}{    by the number of bits that have been consumed.}}
\DoxyCodeLine{2245 \textcolor{comment}{    */}}
\DoxyCodeLine{2246     \textcolor{keywordflow}{if} (DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs) == 0) \{}
\DoxyCodeLine{2247         drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{2248     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2249         \textcolor{comment}{/* We only accumulate the consumed bits. */}}
\DoxyCodeLine{2250         bs-\/>crc16 = drflac\_crc16\_bytes(bs-\/>crc16, bs-\/>crc16Cache >> DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs), (bs-\/>consumedBits >> 3) -\/ bs-\/>crc16CacheIgnoredBytes);}
\DoxyCodeLine{2251 }
\DoxyCodeLine{2252         \textcolor{comment}{/*}}
\DoxyCodeLine{2253 \textcolor{comment}{        The bits that we just accumulated should never be accumulated again. We need to keep track of how many bytes were accumulated}}
\DoxyCodeLine{2254 \textcolor{comment}{        so we can handle that later.}}
\DoxyCodeLine{2255 \textcolor{comment}{        */}}
\DoxyCodeLine{2256         bs-\/>crc16CacheIgnoredBytes = bs-\/>consumedBits >> 3;}
\DoxyCodeLine{2257     \}}
\DoxyCodeLine{2258 }
\DoxyCodeLine{2259     \textcolor{keywordflow}{return} bs-\/>crc16;}
\DoxyCodeLine{2260 \}}
\DoxyCodeLine{2261 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2262 }
\DoxyCodeLine{2263 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_reload\_l1\_cache\_from\_l2(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2264 \{}
\DoxyCodeLine{2265     \textcolor{keywordtype}{size\_t} bytesRead;}
\DoxyCodeLine{2266     \textcolor{keywordtype}{size\_t} alignedL1LineCount;}
\DoxyCodeLine{2267 }
\DoxyCodeLine{2268     \textcolor{comment}{/* Fast path. Try loading straight from L2. */}}
\DoxyCodeLine{2269     \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{2270         bs-\/>cache = bs-\/>cacheL2[bs-\/>nextL2Line++];}
\DoxyCodeLine{2271         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2272     \}}
\DoxyCodeLine{2273 }
\DoxyCodeLine{2274     \textcolor{comment}{/*}}
\DoxyCodeLine{2275 \textcolor{comment}{    If we get here it means we've run out of data in the L2 cache. We'll need to fetch more from the client, if there's}}
\DoxyCodeLine{2276 \textcolor{comment}{    any left.}}
\DoxyCodeLine{2277 \textcolor{comment}{    */}}
\DoxyCodeLine{2278     \textcolor{keywordflow}{if} (bs-\/>unalignedByteCount > 0) \{}
\DoxyCodeLine{2279         \textcolor{keywordflow}{return} DRFLAC\_FALSE;   \textcolor{comment}{/* If we have any unaligned bytes it means there's no more aligned bytes left in the client. */}}
\DoxyCodeLine{2280     \}}
\DoxyCodeLine{2281 }
\DoxyCodeLine{2282     bytesRead = bs-\/>onRead(bs-\/>pUserData, bs-\/>cacheL2, DRFLAC\_CACHE\_L2\_SIZE\_BYTES(bs));}
\DoxyCodeLine{2283 }
\DoxyCodeLine{2284     bs-\/>nextL2Line = 0;}
\DoxyCodeLine{2285     \textcolor{keywordflow}{if} (bytesRead == DRFLAC\_CACHE\_L2\_SIZE\_BYTES(bs)) \{}
\DoxyCodeLine{2286         bs-\/>cache = bs-\/>cacheL2[bs-\/>nextL2Line++];}
\DoxyCodeLine{2287         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2288     \}}
\DoxyCodeLine{2289 }
\DoxyCodeLine{2290 }
\DoxyCodeLine{2291     \textcolor{comment}{/*}}
\DoxyCodeLine{2292 \textcolor{comment}{    If we get here it means we were unable to retrieve enough data to fill the entire L2 cache. It probably}}
\DoxyCodeLine{2293 \textcolor{comment}{    means we've just reached the end of the file. We need to move the valid data down to the end of the buffer}}
\DoxyCodeLine{2294 \textcolor{comment}{    and adjust the index of the next line accordingly. Also keep in mind that the L2 cache must be aligned to}}
\DoxyCodeLine{2295 \textcolor{comment}{    the size of the L1 so we'll need to seek backwards by any misaligned bytes.}}
\DoxyCodeLine{2296 \textcolor{comment}{    */}}
\DoxyCodeLine{2297     alignedL1LineCount = bytesRead / DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs);}
\DoxyCodeLine{2298 }
\DoxyCodeLine{2299     \textcolor{comment}{/* We need to keep track of any unaligned bytes for later use. */}}
\DoxyCodeLine{2300     bs-\/>unalignedByteCount = bytesRead -\/ (alignedL1LineCount * DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs));}
\DoxyCodeLine{2301     \textcolor{keywordflow}{if} (bs-\/>unalignedByteCount > 0) \{}
\DoxyCodeLine{2302         bs-\/>unalignedCache = bs-\/>cacheL2[alignedL1LineCount];}
\DoxyCodeLine{2303     \}}
\DoxyCodeLine{2304 }
\DoxyCodeLine{2305     \textcolor{keywordflow}{if} (alignedL1LineCount > 0) \{}
\DoxyCodeLine{2306         \textcolor{keywordtype}{size\_t} offset = DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs) -\/ alignedL1LineCount;}
\DoxyCodeLine{2307         \textcolor{keywordtype}{size\_t} i;}
\DoxyCodeLine{2308         \textcolor{keywordflow}{for} (i = alignedL1LineCount; i > 0; -\/-\/i) \{}
\DoxyCodeLine{2309             bs-\/>cacheL2[i-\/1 + offset] = bs-\/>cacheL2[i-\/1];}
\DoxyCodeLine{2310         \}}
\DoxyCodeLine{2311 }
\DoxyCodeLine{2312         bs-\/>nextL2Line = (drflac\_uint32)offset;}
\DoxyCodeLine{2313         bs-\/>cache = bs-\/>cacheL2[bs-\/>nextL2Line++];}
\DoxyCodeLine{2314         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2315     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2316         \textcolor{comment}{/* If we get into this branch it means we weren't able to load any L1-\/aligned data. */}}
\DoxyCodeLine{2317         bs-\/>nextL2Line = DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs);}
\DoxyCodeLine{2318         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2319     \}}
\DoxyCodeLine{2320 \}}
\DoxyCodeLine{2321 }
\DoxyCodeLine{2322 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_reload\_cache(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2323 \{}
\DoxyCodeLine{2324     \textcolor{keywordtype}{size\_t} bytesRead;}
\DoxyCodeLine{2325 }
\DoxyCodeLine{2326 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2327     drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{2328 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2329 }
\DoxyCodeLine{2330     \textcolor{comment}{/* Fast path. Try just moving the next value in the L2 cache to the L1 cache. */}}
\DoxyCodeLine{2331     \textcolor{keywordflow}{if} (drflac\_\_reload\_l1\_cache\_from\_l2(bs)) \{}
\DoxyCodeLine{2332         bs-\/>cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cache);}
\DoxyCodeLine{2333         bs-\/>consumedBits = 0;}
\DoxyCodeLine{2334 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2335         bs-\/>crc16Cache = bs-\/>cache;}
\DoxyCodeLine{2336 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2337         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2338     \}}
\DoxyCodeLine{2339 }
\DoxyCodeLine{2340     \textcolor{comment}{/* Slow path. */}}
\DoxyCodeLine{2341 }
\DoxyCodeLine{2342     \textcolor{comment}{/*}}
\DoxyCodeLine{2343 \textcolor{comment}{    If we get here it means we have failed to load the L1 cache from the L2. Likely we've just reached the end of the stream and the last}}
\DoxyCodeLine{2344 \textcolor{comment}{    few bytes did not meet the alignment requirements for the L2 cache. In this case we need to fall back to a slower path and read the}}
\DoxyCodeLine{2345 \textcolor{comment}{    data from the unaligned cache.}}
\DoxyCodeLine{2346 \textcolor{comment}{    */}}
\DoxyCodeLine{2347     bytesRead = bs-\/>unalignedByteCount;}
\DoxyCodeLine{2348     \textcolor{keywordflow}{if} (bytesRead == 0) \{}
\DoxyCodeLine{2349         bs-\/>consumedBits = DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);   \textcolor{comment}{/* <-\/-\/ The stream has been exhausted, so marked the bits as consumed. */}}
\DoxyCodeLine{2350         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2351     \}}
\DoxyCodeLine{2352 }
\DoxyCodeLine{2353     DRFLAC\_ASSERT(bytesRead < DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs));}
\DoxyCodeLine{2354     bs-\/>consumedBits = (drflac\_uint32)(DRFLAC\_CACHE\_L1\_SIZE\_BYTES(bs) -\/ bytesRead) * 8;}
\DoxyCodeLine{2355 }
\DoxyCodeLine{2356     bs-\/>cache = drflac\_\_be2host\_\_cache\_line(bs-\/>unalignedCache);}
\DoxyCodeLine{2357     bs-\/>cache \&= DRFLAC\_CACHE\_L1\_SELECTION\_MASK(DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs));    \textcolor{comment}{/* <-\/-\/ Make sure the consumed bits are always set to zero. Other parts of the library depend on this property. */}}
\DoxyCodeLine{2358     bs-\/>unalignedByteCount = 0;     \textcolor{comment}{/* <-\/-\/ At this point the unaligned bytes have been moved into the cache and we thus have no more unaligned bytes. */}}
\DoxyCodeLine{2359 }
\DoxyCodeLine{2360 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2361     bs-\/>crc16Cache = bs-\/>cache >> bs-\/>consumedBits;}
\DoxyCodeLine{2362     bs-\/>crc16CacheIgnoredBytes = bs-\/>consumedBits >> 3;}
\DoxyCodeLine{2363 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2364     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2365 \}}
\DoxyCodeLine{2366 }
\DoxyCodeLine{2367 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_reset\_cache(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2368 \{}
\DoxyCodeLine{2369     bs-\/>nextL2Line   = DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs);  \textcolor{comment}{/* <-\/-\/ This clears the L2 cache. */}}
\DoxyCodeLine{2370     bs-\/>consumedBits = DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);   \textcolor{comment}{/* <-\/-\/ This clears the L1 cache. */}}
\DoxyCodeLine{2371     bs-\/>cache = 0;}
\DoxyCodeLine{2372     bs-\/>unalignedByteCount = 0;                         \textcolor{comment}{/* <-\/-\/ This clears the trailing unaligned bytes. */}}
\DoxyCodeLine{2373     bs-\/>unalignedCache = 0;}
\DoxyCodeLine{2374 }
\DoxyCodeLine{2375 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2376     bs-\/>crc16Cache = 0;}
\DoxyCodeLine{2377     bs-\/>crc16CacheIgnoredBytes = 0;}
\DoxyCodeLine{2378 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2379 \}}
\DoxyCodeLine{2380 }
\DoxyCodeLine{2381 }
\DoxyCodeLine{2382 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_read\_uint32(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_uint32* pResultOut)}
\DoxyCodeLine{2383 \{}
\DoxyCodeLine{2384     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2385     DRFLAC\_ASSERT(pResultOut != NULL);}
\DoxyCodeLine{2386     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2387     DRFLAC\_ASSERT(bitCount <= 32);}
\DoxyCodeLine{2388 }
\DoxyCodeLine{2389     \textcolor{keywordflow}{if} (bs-\/>consumedBits == DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)) \{}
\DoxyCodeLine{2390         \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{2391             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2392         \}}
\DoxyCodeLine{2393     \}}
\DoxyCodeLine{2394 }
\DoxyCodeLine{2395     \textcolor{keywordflow}{if} (bitCount <= DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs)) \{}
\DoxyCodeLine{2396         \textcolor{comment}{/*}}
\DoxyCodeLine{2397 \textcolor{comment}{        If we want to load all 32-\/bits from a 32-\/bit cache we need to do it slightly differently because we can't do}}
\DoxyCodeLine{2398 \textcolor{comment}{        a 32-\/bit shift on a 32-\/bit integer. This will never be the case on 64-\/bit caches, so we can have a slightly}}
\DoxyCodeLine{2399 \textcolor{comment}{        more optimal solution for this.}}
\DoxyCodeLine{2400 \textcolor{comment}{        */}}
\DoxyCodeLine{2401 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2402         *pResultOut = (drflac\_uint32)DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, bitCount);}
\DoxyCodeLine{2403         bs-\/>consumedBits += bitCount;}
\DoxyCodeLine{2404         bs-\/>cache <<= bitCount;}
\DoxyCodeLine{2405 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2406         \textcolor{keywordflow}{if} (bitCount < DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)) \{}
\DoxyCodeLine{2407             *pResultOut = (drflac\_uint32)DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, bitCount);}
\DoxyCodeLine{2408             bs-\/>consumedBits += bitCount;}
\DoxyCodeLine{2409             bs-\/>cache <<= bitCount;}
\DoxyCodeLine{2410         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2411             \textcolor{comment}{/* Cannot shift by 32-\/bits, so need to do it differently. */}}
\DoxyCodeLine{2412             *pResultOut = (drflac\_uint32)bs-\/>cache;}
\DoxyCodeLine{2413             bs-\/>consumedBits = DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);}
\DoxyCodeLine{2414             bs-\/>cache = 0;}
\DoxyCodeLine{2415         \}}
\DoxyCodeLine{2416 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2417 }
\DoxyCodeLine{2418         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2419     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2420         \textcolor{comment}{/* It straddles the cached data. It will never cover more than the next chunk. We just read the number in two parts and combine them. */}}
\DoxyCodeLine{2421         drflac\_uint32 bitCountHi = DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs);}
\DoxyCodeLine{2422         drflac\_uint32 bitCountLo = bitCount -\/ bitCountHi;}
\DoxyCodeLine{2423         drflac\_uint32 resultHi;}
\DoxyCodeLine{2424 }
\DoxyCodeLine{2425         DRFLAC\_ASSERT(bitCountHi > 0);}
\DoxyCodeLine{2426         DRFLAC\_ASSERT(bitCountHi < 32);}
\DoxyCodeLine{2427         resultHi = (drflac\_uint32)DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, bitCountHi);}
\DoxyCodeLine{2428 }
\DoxyCodeLine{2429         \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{2430             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2431         \}}
\DoxyCodeLine{2432 }
\DoxyCodeLine{2433         *pResultOut = (resultHi << bitCountLo) | (drflac\_uint32)DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, bitCountLo);}
\DoxyCodeLine{2434         bs-\/>consumedBits += bitCountLo;}
\DoxyCodeLine{2435         bs-\/>cache <<= bitCountLo;}
\DoxyCodeLine{2436         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2437     \}}
\DoxyCodeLine{2438 \}}
\DoxyCodeLine{2439 }
\DoxyCodeLine{2440 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_int32(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_int32* pResult)}
\DoxyCodeLine{2441 \{}
\DoxyCodeLine{2442     drflac\_uint32 result;}
\DoxyCodeLine{2443 }
\DoxyCodeLine{2444     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2445     DRFLAC\_ASSERT(pResult != NULL);}
\DoxyCodeLine{2446     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2447     DRFLAC\_ASSERT(bitCount <= 32);}
\DoxyCodeLine{2448 }
\DoxyCodeLine{2449     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2450         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2451     \}}
\DoxyCodeLine{2452 }
\DoxyCodeLine{2453     \textcolor{comment}{/* Do not attempt to shift by 32 as it's undefined. */}}
\DoxyCodeLine{2454     \textcolor{keywordflow}{if} (bitCount < 32) \{}
\DoxyCodeLine{2455         drflac\_uint32 signbit;}
\DoxyCodeLine{2456         signbit = ((result >> (bitCount-\/1)) \& 0x01);}
\DoxyCodeLine{2457         result |= (\string~signbit + 1) << bitCount;}
\DoxyCodeLine{2458     \}}
\DoxyCodeLine{2459 }
\DoxyCodeLine{2460     *pResult = (drflac\_int32)result;}
\DoxyCodeLine{2461     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2462 \}}
\DoxyCodeLine{2463 }
\DoxyCodeLine{2464 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2465 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_uint64(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_uint64* pResultOut)}
\DoxyCodeLine{2466 \{}
\DoxyCodeLine{2467     drflac\_uint32 resultHi;}
\DoxyCodeLine{2468     drflac\_uint32 resultLo;}
\DoxyCodeLine{2469 }
\DoxyCodeLine{2470     DRFLAC\_ASSERT(bitCount <= 64);}
\DoxyCodeLine{2471     DRFLAC\_ASSERT(bitCount >  32);}
\DoxyCodeLine{2472 }
\DoxyCodeLine{2473     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, bitCount -\/ 32, \&resultHi)) \{}
\DoxyCodeLine{2474         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2475     \}}
\DoxyCodeLine{2476 }
\DoxyCodeLine{2477     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, 32, \&resultLo)) \{}
\DoxyCodeLine{2478         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2479     \}}
\DoxyCodeLine{2480 }
\DoxyCodeLine{2481     *pResultOut = (((drflac\_uint64)resultHi) << 32) | ((drflac\_uint64)resultLo);}
\DoxyCodeLine{2482     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2483 \}}
\DoxyCodeLine{2484 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2485 }
\DoxyCodeLine{2486 \textcolor{comment}{/* Function below is unused, but leaving it here in case I need to quickly add it again. */}}
\DoxyCodeLine{2487 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2488 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_int64(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_int64* pResultOut)}
\DoxyCodeLine{2489 \{}
\DoxyCodeLine{2490     drflac\_uint64 result;}
\DoxyCodeLine{2491     drflac\_uint64 signbit;}
\DoxyCodeLine{2492 }
\DoxyCodeLine{2493     DRFLAC\_ASSERT(bitCount <= 64);}
\DoxyCodeLine{2494 }
\DoxyCodeLine{2495     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint64(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2496         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2497     \}}
\DoxyCodeLine{2498 }
\DoxyCodeLine{2499     signbit = ((result >> (bitCount-\/1)) \& 0x01);}
\DoxyCodeLine{2500     result |= (\string~signbit + 1) << bitCount;}
\DoxyCodeLine{2501 }
\DoxyCodeLine{2502     *pResultOut = (drflac\_int64)result;}
\DoxyCodeLine{2503     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2504 \}}
\DoxyCodeLine{2505 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2506 }
\DoxyCodeLine{2507 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_uint16(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_uint16* pResult)}
\DoxyCodeLine{2508 \{}
\DoxyCodeLine{2509     drflac\_uint32 result;}
\DoxyCodeLine{2510 }
\DoxyCodeLine{2511     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2512     DRFLAC\_ASSERT(pResult != NULL);}
\DoxyCodeLine{2513     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2514     DRFLAC\_ASSERT(bitCount <= 16);}
\DoxyCodeLine{2515 }
\DoxyCodeLine{2516     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2517         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2518     \}}
\DoxyCodeLine{2519 }
\DoxyCodeLine{2520     *pResult = (drflac\_uint16)result;}
\DoxyCodeLine{2521     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2522 \}}
\DoxyCodeLine{2523 }
\DoxyCodeLine{2524 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2525 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_int16(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_int16* pResult)}
\DoxyCodeLine{2526 \{}
\DoxyCodeLine{2527     drflac\_int32 result;}
\DoxyCodeLine{2528 }
\DoxyCodeLine{2529     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2530     DRFLAC\_ASSERT(pResult != NULL);}
\DoxyCodeLine{2531     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2532     DRFLAC\_ASSERT(bitCount <= 16);}
\DoxyCodeLine{2533 }
\DoxyCodeLine{2534     \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2535         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2536     \}}
\DoxyCodeLine{2537 }
\DoxyCodeLine{2538     *pResult = (drflac\_int16)result;}
\DoxyCodeLine{2539     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2540 \}}
\DoxyCodeLine{2541 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2542 }
\DoxyCodeLine{2543 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_uint8(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_uint8* pResult)}
\DoxyCodeLine{2544 \{}
\DoxyCodeLine{2545     drflac\_uint32 result;}
\DoxyCodeLine{2546 }
\DoxyCodeLine{2547     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2548     DRFLAC\_ASSERT(pResult != NULL);}
\DoxyCodeLine{2549     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2550     DRFLAC\_ASSERT(bitCount <= 8);}
\DoxyCodeLine{2551 }
\DoxyCodeLine{2552     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2553         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2554     \}}
\DoxyCodeLine{2555 }
\DoxyCodeLine{2556     *pResult = (drflac\_uint8)result;}
\DoxyCodeLine{2557     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2558 \}}
\DoxyCodeLine{2559 }
\DoxyCodeLine{2560 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_int8(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitCount, drflac\_int8* pResult)}
\DoxyCodeLine{2561 \{}
\DoxyCodeLine{2562     drflac\_int32 result;}
\DoxyCodeLine{2563 }
\DoxyCodeLine{2564     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2565     DRFLAC\_ASSERT(pResult != NULL);}
\DoxyCodeLine{2566     DRFLAC\_ASSERT(bitCount > 0);}
\DoxyCodeLine{2567     DRFLAC\_ASSERT(bitCount <= 8);}
\DoxyCodeLine{2568 }
\DoxyCodeLine{2569     \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, bitCount, \&result)) \{}
\DoxyCodeLine{2570         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2571     \}}
\DoxyCodeLine{2572 }
\DoxyCodeLine{2573     *pResult = (drflac\_int8)result;}
\DoxyCodeLine{2574     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2575 \}}
\DoxyCodeLine{2576 }
\DoxyCodeLine{2577 }
\DoxyCodeLine{2578 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_bits(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{size\_t} bitsToSeek)}
\DoxyCodeLine{2579 \{}
\DoxyCodeLine{2580     \textcolor{keywordflow}{if} (bitsToSeek <= DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs)) \{}
\DoxyCodeLine{2581         bs-\/>consumedBits += (drflac\_uint32)bitsToSeek;}
\DoxyCodeLine{2582         bs-\/>cache <<= bitsToSeek;}
\DoxyCodeLine{2583         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2584     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2585         \textcolor{comment}{/* It straddles the cached data. This function isn't called too frequently so I'm favouring simplicity here. */}}
\DoxyCodeLine{2586         bitsToSeek       -\/= DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs);}
\DoxyCodeLine{2587         bs-\/>consumedBits += DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs);}
\DoxyCodeLine{2588         bs-\/>cache         = 0;}
\DoxyCodeLine{2589 }
\DoxyCodeLine{2590         \textcolor{comment}{/* Simple case. Seek in groups of the same number as bits that fit within a cache line. */}}
\DoxyCodeLine{2591 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2592         \textcolor{keywordflow}{while} (bitsToSeek >= DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)) \{}
\DoxyCodeLine{2593             drflac\_uint64 bin;}
\DoxyCodeLine{2594             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint64(bs, DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs), \&bin)) \{}
\DoxyCodeLine{2595                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2596             \}}
\DoxyCodeLine{2597             bitsToSeek -\/= DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);}
\DoxyCodeLine{2598         \}}
\DoxyCodeLine{2599 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2600         \textcolor{keywordflow}{while} (bitsToSeek >= DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)) \{}
\DoxyCodeLine{2601             drflac\_uint32 bin;}
\DoxyCodeLine{2602             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs), \&bin)) \{}
\DoxyCodeLine{2603                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2604             \}}
\DoxyCodeLine{2605             bitsToSeek -\/= DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);}
\DoxyCodeLine{2606         \}}
\DoxyCodeLine{2607 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2608 }
\DoxyCodeLine{2609         \textcolor{comment}{/* Whole leftover bytes. */}}
\DoxyCodeLine{2610         \textcolor{keywordflow}{while} (bitsToSeek >= 8) \{}
\DoxyCodeLine{2611             drflac\_uint8 bin;}
\DoxyCodeLine{2612             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, \&bin)) \{}
\DoxyCodeLine{2613                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2614             \}}
\DoxyCodeLine{2615             bitsToSeek -\/= 8;}
\DoxyCodeLine{2616         \}}
\DoxyCodeLine{2617 }
\DoxyCodeLine{2618         \textcolor{comment}{/* Leftover bits. */}}
\DoxyCodeLine{2619         \textcolor{keywordflow}{if} (bitsToSeek > 0) \{}
\DoxyCodeLine{2620             drflac\_uint8 bin;}
\DoxyCodeLine{2621             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, (drflac\_uint32)bitsToSeek, \&bin)) \{}
\DoxyCodeLine{2622                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2623             \}}
\DoxyCodeLine{2624             bitsToSeek = 0; \textcolor{comment}{/* <-\/-\/ Necessary for the assert below. */}}
\DoxyCodeLine{2625         \}}
\DoxyCodeLine{2626 }
\DoxyCodeLine{2627         DRFLAC\_ASSERT(bitsToSeek == 0);}
\DoxyCodeLine{2628         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2629     \}}
\DoxyCodeLine{2630 \}}
\DoxyCodeLine{2631 }
\DoxyCodeLine{2632 }
\DoxyCodeLine{2633 \textcolor{comment}{/* This function moves the bit streamer to the first bit after the sync code (bit 15 of the of the frame header). It will also update the CRC-\/16. */}}
\DoxyCodeLine{2634 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_find\_and\_seek\_to\_next\_sync\_code(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs)}
\DoxyCodeLine{2635 \{}
\DoxyCodeLine{2636     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2637 }
\DoxyCodeLine{2638     \textcolor{comment}{/*}}
\DoxyCodeLine{2639 \textcolor{comment}{    The sync code is always aligned to 8 bits. This is convenient for us because it means we can do byte-\/aligned movements. The first}}
\DoxyCodeLine{2640 \textcolor{comment}{    thing to do is align to the next byte.}}
\DoxyCodeLine{2641 \textcolor{comment}{    */}}
\DoxyCodeLine{2642     \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs) \& 7)) \{}
\DoxyCodeLine{2643         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2644     \}}
\DoxyCodeLine{2645 }
\DoxyCodeLine{2646     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{2647         drflac\_uint8 hi;}
\DoxyCodeLine{2648 }
\DoxyCodeLine{2649 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{2650         drflac\_\_reset\_crc16(bs);}
\DoxyCodeLine{2651 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2652 }
\DoxyCodeLine{2653         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, \&hi)) \{}
\DoxyCodeLine{2654             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2655         \}}
\DoxyCodeLine{2656 }
\DoxyCodeLine{2657         \textcolor{keywordflow}{if} (hi == 0xFF) \{}
\DoxyCodeLine{2658             drflac\_uint8 lo;}
\DoxyCodeLine{2659             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 6, \&lo)) \{}
\DoxyCodeLine{2660                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2661             \}}
\DoxyCodeLine{2662 }
\DoxyCodeLine{2663             \textcolor{keywordflow}{if} (lo == 0x3E) \{}
\DoxyCodeLine{2664                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2665             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2666                 \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs) \& 7)) \{}
\DoxyCodeLine{2667                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2668                 \}}
\DoxyCodeLine{2669             \}}
\DoxyCodeLine{2670         \}}
\DoxyCodeLine{2671     \}}
\DoxyCodeLine{2672 }
\DoxyCodeLine{2673     \textcolor{comment}{/* Should never get here. */}}
\DoxyCodeLine{2674     \textcolor{comment}{/*return DRFLAC\_FALSE;*/}}
\DoxyCodeLine{2675 \}}
\DoxyCodeLine{2676 }
\DoxyCodeLine{2677 }
\DoxyCodeLine{2678 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_LZCNT\_INTRINSIC)}}
\DoxyCodeLine{2679 \textcolor{preprocessor}{\#define DRFLAC\_IMPLEMENT\_CLZ\_LZCNT}}
\DoxyCodeLine{2680 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2681 \textcolor{preprocessor}{\#if  defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400 \&\& (defined(DRFLAC\_X64) || defined(DRFLAC\_X86)) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{2682 \textcolor{preprocessor}{\#define DRFLAC\_IMPLEMENT\_CLZ\_MSVC}}
\DoxyCodeLine{2683 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2684 \textcolor{preprocessor}{\#if  defined(\_\_WATCOMC\_\_) \&\& defined(\_\_386\_\_)}}
\DoxyCodeLine{2685 \textcolor{preprocessor}{\#define DRFLAC\_IMPLEMENT\_CLZ\_WATCOM}}
\DoxyCodeLine{2686 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2687 }
\DoxyCodeLine{2688 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_clz\_software(drflac\_cache\_t x)}
\DoxyCodeLine{2689 \{}
\DoxyCodeLine{2690     drflac\_uint32 n;}
\DoxyCodeLine{2691     \textcolor{keyword}{static} drflac\_uint32 clz\_table\_4[] = \{}
\DoxyCodeLine{2692         0,}
\DoxyCodeLine{2693         4,}
\DoxyCodeLine{2694         3, 3,}
\DoxyCodeLine{2695         2, 2, 2, 2,}
\DoxyCodeLine{2696         1, 1, 1, 1, 1, 1, 1, 1}
\DoxyCodeLine{2697     \};}
\DoxyCodeLine{2698 }
\DoxyCodeLine{2699     \textcolor{keywordflow}{if} (x == 0) \{}
\DoxyCodeLine{2700         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(x)*8;}
\DoxyCodeLine{2701     \}}
\DoxyCodeLine{2702 }
\DoxyCodeLine{2703     n = clz\_table\_4[x >> (\textcolor{keyword}{sizeof}(x)*8 -\/ 4)];}
\DoxyCodeLine{2704     \textcolor{keywordflow}{if} (n == 0) \{}
\DoxyCodeLine{2705 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2706         \textcolor{keywordflow}{if} ((x \& ((drflac\_uint64)0xFFFFFFFF << 32)) == 0) \{ n  = 32; x <<= 32; \}}
\DoxyCodeLine{2707         \textcolor{keywordflow}{if} ((x \& ((drflac\_uint64)0xFFFF0000 << 32)) == 0) \{ n += 16; x <<= 16; \}}
\DoxyCodeLine{2708         \textcolor{keywordflow}{if} ((x \& ((drflac\_uint64)0xFF000000 << 32)) == 0) \{ n += 8;  x <<= 8;  \}}
\DoxyCodeLine{2709         \textcolor{keywordflow}{if} ((x \& ((drflac\_uint64)0xF0000000 << 32)) == 0) \{ n += 4;  x <<= 4;  \}}
\DoxyCodeLine{2710 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2711         \textcolor{keywordflow}{if} ((x \& 0xFFFF0000) == 0) \{ n  = 16; x <<= 16; \}}
\DoxyCodeLine{2712         \textcolor{keywordflow}{if} ((x \& 0xFF000000) == 0) \{ n += 8;  x <<= 8;  \}}
\DoxyCodeLine{2713         \textcolor{keywordflow}{if} ((x \& 0xF0000000) == 0) \{ n += 4;  x <<= 4;  \}}
\DoxyCodeLine{2714 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2715         n += clz\_table\_4[x >> (\textcolor{keyword}{sizeof}(x)*8 -\/ 4)];}
\DoxyCodeLine{2716     \}}
\DoxyCodeLine{2717 }
\DoxyCodeLine{2718     \textcolor{keywordflow}{return} n -\/ 1;}
\DoxyCodeLine{2719 \}}
\DoxyCodeLine{2720 }
\DoxyCodeLine{2721 \textcolor{preprocessor}{\#ifdef DRFLAC\_IMPLEMENT\_CLZ\_LZCNT}}
\DoxyCodeLine{2722 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_is\_lzcnt\_supported(\textcolor{keywordtype}{void})}
\DoxyCodeLine{2723 \{}
\DoxyCodeLine{2724     \textcolor{comment}{/* Fast compile time check for ARM. */}}
\DoxyCodeLine{2725 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_LZCNT\_INTRINSIC) \&\& defined(DRFLAC\_ARM) \&\& (defined(\_\_ARM\_ARCH) \&\& \_\_ARM\_ARCH >= 5)}}
\DoxyCodeLine{2726     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2727 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2728     \textcolor{comment}{/* If the compiler itself does not support the intrinsic then we'll need to return false. */}}
\DoxyCodeLine{2729 \textcolor{preprocessor}{    \#ifdef DRFLAC\_HAS\_LZCNT\_INTRINSIC}}
\DoxyCodeLine{2730         \textcolor{keywordflow}{return} drflac\_\_gIsLZCNTSupported;}
\DoxyCodeLine{2731 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{2732         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2733 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2734 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2735 \}}
\DoxyCodeLine{2736 }
\DoxyCodeLine{2737 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_clz\_lzcnt(drflac\_cache\_t x)}
\DoxyCodeLine{2738 \{}
\DoxyCodeLine{2739     \textcolor{comment}{/*}}
\DoxyCodeLine{2740 \textcolor{comment}{    It's critical for competitive decoding performance that this function be highly optimal. With MSVC we can use the \_\_lzcnt64() and \_\_lzcnt() intrinsics}}
\DoxyCodeLine{2741 \textcolor{comment}{    to achieve good performance, however on GCC and Clang it's a little bit more annoying. The \_\_builtin\_clzl() and \_\_builtin\_clzll() intrinsics leave}}
\DoxyCodeLine{2742 \textcolor{comment}{    it undefined as to the return value when `x` is 0. We need this to be well defined as returning 32 or 64, depending on whether or not it's a 32-\/ or}}
\DoxyCodeLine{2743 \textcolor{comment}{    64-\/bit build. To work around this we would need to add a conditional to check for the x = 0 case, but this creates unnecessary inefficiency. To work}}
\DoxyCodeLine{2744 \textcolor{comment}{    around this problem I have written some inline assembly to emit the LZCNT (x86) or CLZ (ARM) instruction directly which removes the need to include}}
\DoxyCodeLine{2745 \textcolor{comment}{    the conditional. This has worked well in the past, but for some reason Clang's MSVC compatible driver, clang-\/cl, does not seem to be handling this}}
\DoxyCodeLine{2746 \textcolor{comment}{    in the same way as the normal Clang driver. It seems that `clang-\/cl` is just outputting the wrong results sometimes, maybe due to some register}}
\DoxyCodeLine{2747 \textcolor{comment}{    getting clobbered?}}
\DoxyCodeLine{2748 \textcolor{comment}{}}
\DoxyCodeLine{2749 \textcolor{comment}{    I'm not sure if this is a bug with dr\_flac's inlined assembly (most likely), a bug in `clang-\/cl` or just a misunderstanding on my part with inline}}
\DoxyCodeLine{2750 \textcolor{comment}{    assembly rules for `clang-\/cl`. If somebody can identify an error in dr\_flac's inlined assembly I'm happy to get that fixed.}}
\DoxyCodeLine{2751 \textcolor{comment}{}}
\DoxyCodeLine{2752 \textcolor{comment}{    Fortunately there is an easy workaround for this. Clang implements MSVC-\/specific intrinsics for compatibility. It also defines \_MSC\_VER for extra}}
\DoxyCodeLine{2753 \textcolor{comment}{    compatibility. We can therefore just check for \_MSC\_VER and use the MSVC intrinsic which, fortunately for us, Clang supports. It would still be nice}}
\DoxyCodeLine{2754 \textcolor{comment}{    to know how to fix the inlined assembly for correctness sake, however.}}
\DoxyCodeLine{2755 \textcolor{comment}{    */}}
\DoxyCodeLine{2756 }
\DoxyCodeLine{2757 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) }\textcolor{comment}{/*\&\& !defined(\_\_clang\_\_)*/}\textcolor{preprocessor}{    }\textcolor{comment}{/* <-\/-\/ Intentionally wanting Clang to use the MSVC \_\_lzcnt64/\_\_lzcnt intrinsics due to above \string^. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{2758 \textcolor{preprocessor}{    \#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2759         \textcolor{keywordflow}{return} (drflac\_uint32)\_\_lzcnt64(x);}
\DoxyCodeLine{2760 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{2761         \textcolor{keywordflow}{return} (drflac\_uint32)\_\_lzcnt(x);}
\DoxyCodeLine{2762 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2763 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2764 \textcolor{preprocessor}{    \#if defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{2765 \textcolor{preprocessor}{        \#if defined(DRFLAC\_X64)}}
\DoxyCodeLine{2766             \{}
\DoxyCodeLine{2767                 drflac\_uint64 r;}
\DoxyCodeLine{2768                 \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{2769                     \textcolor{stringliteral}{"{}lzcnt\{ \%1, \%0| \%0, \%1\}"{}} : \textcolor{stringliteral}{"{}=r"{}}(r) : \textcolor{stringliteral}{"{}r"{}}(x) : \textcolor{stringliteral}{"{}cc"{}}}
\DoxyCodeLine{2770                 );}
\DoxyCodeLine{2771 }
\DoxyCodeLine{2772                 \textcolor{keywordflow}{return} (drflac\_uint32)r;}
\DoxyCodeLine{2773             \}}
\DoxyCodeLine{2774 \textcolor{preprocessor}{        \#elif defined(DRFLAC\_X86)}}
\DoxyCodeLine{2775             \{}
\DoxyCodeLine{2776                 drflac\_uint32 r;}
\DoxyCodeLine{2777                 \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{2778                     \textcolor{stringliteral}{"{}lzcnt\{l \%1, \%0| \%0, \%1\}"{}} : \textcolor{stringliteral}{"{}=r"{}}(r) : \textcolor{stringliteral}{"{}r"{}}(x) : \textcolor{stringliteral}{"{}cc"{}}}
\DoxyCodeLine{2779                 );}
\DoxyCodeLine{2780 }
\DoxyCodeLine{2781                 \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{2782             \}}
\DoxyCodeLine{2783 \textcolor{preprocessor}{        \#elif defined(DRFLAC\_ARM) \&\& (defined(\_\_ARM\_ARCH) \&\& \_\_ARM\_ARCH >= 5) \&\& !defined(DRFLAC\_64BIT)   }\textcolor{comment}{/* <-\/-\/ I haven't tested 64-\/bit inline assembly, so only enabling this for the 32-\/bit build for now. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{2784             \{}
\DoxyCodeLine{2785                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{2786                 \_\_asm\_\_ \_\_volatile\_\_ (}
\DoxyCodeLine{2787                 \#\textcolor{keywordflow}{if} defined(DRFLAC\_64BIT)}
\DoxyCodeLine{2788                     \textcolor{stringliteral}{"{}clz \%w[out], \%w[in]"{}} : [out]\textcolor{stringliteral}{"{}=r"{}}(r) : [in]\textcolor{stringliteral}{"{}r"{}}(x)   \textcolor{comment}{/* <-\/-\/ This is untested. If someone in the community could test this, that would be appreciated! */}}
\DoxyCodeLine{2789                 \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{2790                     \textcolor{stringliteral}{"{}clz \%[out], \%[in]"{}} : [out]\textcolor{stringliteral}{"{}=r"{}}(r) : [in]\textcolor{stringliteral}{"{}r"{}}(x)}
\DoxyCodeLine{2791                 \#endif}
\DoxyCodeLine{2792                 );}
\DoxyCodeLine{2793 }
\DoxyCodeLine{2794                 \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{2795             \}}
\DoxyCodeLine{2796 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{2797             \textcolor{keywordflow}{if} (x == 0) \{}
\DoxyCodeLine{2798                 \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(x)*8;}
\DoxyCodeLine{2799             \}}
\DoxyCodeLine{2800 \textcolor{preprocessor}{            \#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2801                 \textcolor{keywordflow}{return} (drflac\_uint32)\_\_builtin\_clzll((drflac\_uint64)x);}
\DoxyCodeLine{2802 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{2803                 \textcolor{keywordflow}{return} (drflac\_uint32)\_\_builtin\_clzl((drflac\_uint32)x);}
\DoxyCodeLine{2804 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{2805 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{2806 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{2807         \textcolor{comment}{/* Unsupported compiler. */}}
\DoxyCodeLine{2808 \textcolor{preprocessor}{        \#error "{}This compiler does not support the lzcnt intrinsic."{}}}
\DoxyCodeLine{2809 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2810 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2811 \}}
\DoxyCodeLine{2812 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2813 }
\DoxyCodeLine{2814 \textcolor{preprocessor}{\#ifdef DRFLAC\_IMPLEMENT\_CLZ\_MSVC}}
\DoxyCodeLine{2815 \textcolor{preprocessor}{\#include <intrin.h>} \textcolor{comment}{/* For BitScanReverse(). */}}
\DoxyCodeLine{2816 }
\DoxyCodeLine{2817 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_clz\_msvc(drflac\_cache\_t x)}
\DoxyCodeLine{2818 \{}
\DoxyCodeLine{2819     drflac\_uint32 n;}
\DoxyCodeLine{2820 }
\DoxyCodeLine{2821     \textcolor{keywordflow}{if} (x == 0) \{}
\DoxyCodeLine{2822         \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(x)*8;}
\DoxyCodeLine{2823     \}}
\DoxyCodeLine{2824 }
\DoxyCodeLine{2825 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{2826     \_BitScanReverse64((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}*)\&n, x);}
\DoxyCodeLine{2827 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2828     \_BitScanReverse((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}*)\&n, x);}
\DoxyCodeLine{2829 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2830     \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(x)*8 -\/ n -\/ 1;}
\DoxyCodeLine{2831 \}}
\DoxyCodeLine{2832 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2833 }
\DoxyCodeLine{2834 \textcolor{preprocessor}{\#ifdef DRFLAC\_IMPLEMENT\_CLZ\_WATCOM}}
\DoxyCodeLine{2835 \textcolor{keyword}{static} \_\_inline drflac\_uint32 drflac\_\_clz\_watcom (drflac\_uint32);}
\DoxyCodeLine{2836 \textcolor{preprocessor}{\#pragma aux drflac\_\_clz\_watcom = \(\backslash\)}}
\DoxyCodeLine{2837 \textcolor{preprocessor}{    "{}bsr eax, eax"{}} \(\backslash\)}
\DoxyCodeLine{2838     "{}xor eax, 31"{} \(\backslash\)}
\DoxyCodeLine{2839     parm [eax] nomemory \(\backslash\)}
\DoxyCodeLine{2840     value [eax] \(\backslash\)}
\DoxyCodeLine{2841     modify exact [eax] nomemory;}
\DoxyCodeLine{2842 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2843 }
\DoxyCodeLine{2844 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_\_clz(drflac\_cache\_t x)}
\DoxyCodeLine{2845 \{}
\DoxyCodeLine{2846 \textcolor{preprocessor}{\#ifdef DRFLAC\_IMPLEMENT\_CLZ\_LZCNT}}
\DoxyCodeLine{2847     \textcolor{keywordflow}{if} (drflac\_\_is\_lzcnt\_supported()) \{}
\DoxyCodeLine{2848         \textcolor{keywordflow}{return} drflac\_\_clz\_lzcnt(x);}
\DoxyCodeLine{2849     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{2850 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2851     \{}
\DoxyCodeLine{2852 \textcolor{preprocessor}{\#ifdef DRFLAC\_IMPLEMENT\_CLZ\_MSVC}}
\DoxyCodeLine{2853         \textcolor{keywordflow}{return} drflac\_\_clz\_msvc(x);}
\DoxyCodeLine{2854 \textcolor{preprocessor}{\#elif defined(DRFLAC\_IMPLEMENT\_CLZ\_WATCOM)}}
\DoxyCodeLine{2855         \textcolor{keywordflow}{return} (x == 0) ? \textcolor{keyword}{sizeof}(x)*8 : drflac\_\_clz\_watcom(x);}
\DoxyCodeLine{2856 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2857         \textcolor{keywordflow}{return} drflac\_\_clz\_software(x);}
\DoxyCodeLine{2858 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2859     \}}
\DoxyCodeLine{2860 \}}
\DoxyCodeLine{2861 }
\DoxyCodeLine{2862 }
\DoxyCodeLine{2863 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_seek\_past\_next\_set\_bit(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* pOffsetOut)}
\DoxyCodeLine{2864 \{}
\DoxyCodeLine{2865     drflac\_uint32 zeroCounter = 0;}
\DoxyCodeLine{2866     drflac\_uint32 setBitOffsetPlus1;}
\DoxyCodeLine{2867 }
\DoxyCodeLine{2868     \textcolor{keywordflow}{while} (bs-\/>cache == 0) \{}
\DoxyCodeLine{2869         zeroCounter += (drflac\_uint32)DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs);}
\DoxyCodeLine{2870         \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{2871             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2872         \}}
\DoxyCodeLine{2873     \}}
\DoxyCodeLine{2874 }
\DoxyCodeLine{2875     setBitOffsetPlus1 = drflac\_\_clz(bs-\/>cache);}
\DoxyCodeLine{2876     setBitOffsetPlus1 += 1;}
\DoxyCodeLine{2877 }
\DoxyCodeLine{2878     bs-\/>consumedBits += setBitOffsetPlus1;}
\DoxyCodeLine{2879     bs-\/>cache <<= setBitOffsetPlus1;}
\DoxyCodeLine{2880 }
\DoxyCodeLine{2881     *pOffsetOut = zeroCounter + setBitOffsetPlus1 -\/ 1;}
\DoxyCodeLine{2882     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2883 \}}
\DoxyCodeLine{2884 }
\DoxyCodeLine{2885 }
\DoxyCodeLine{2886 }
\DoxyCodeLine{2887 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_byte(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint64 offsetFromStart)}
\DoxyCodeLine{2888 \{}
\DoxyCodeLine{2889     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2890     DRFLAC\_ASSERT(offsetFromStart > 0);}
\DoxyCodeLine{2891 }
\DoxyCodeLine{2892     \textcolor{comment}{/*}}
\DoxyCodeLine{2893 \textcolor{comment}{    Seeking from the start is not quite as trivial as it sounds because the onSeek callback takes a signed 32-\/bit integer (which}}
\DoxyCodeLine{2894 \textcolor{comment}{    is intentional because it simplifies the implementation of the onSeek callbacks), however offsetFromStart is unsigned 64-\/bit.}}
\DoxyCodeLine{2895 \textcolor{comment}{    To resolve we just need to do an initial seek from the start, and then a series of offset seeks to make up the remainder.}}
\DoxyCodeLine{2896 \textcolor{comment}{    */}}
\DoxyCodeLine{2897     \textcolor{keywordflow}{if} (offsetFromStart > 0x7FFFFFFF) \{}
\DoxyCodeLine{2898         drflac\_uint64 bytesRemaining = offsetFromStart;}
\DoxyCodeLine{2899         \textcolor{keywordflow}{if} (!bs-\/>onSeek(bs-\/>pUserData, 0x7FFFFFFF, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{2900             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2901         \}}
\DoxyCodeLine{2902         bytesRemaining -\/= 0x7FFFFFFF;}
\DoxyCodeLine{2903 }
\DoxyCodeLine{2904         \textcolor{keywordflow}{while} (bytesRemaining > 0x7FFFFFFF) \{}
\DoxyCodeLine{2905             \textcolor{keywordflow}{if} (!bs-\/>onSeek(bs-\/>pUserData, 0x7FFFFFFF, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{2906                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2907             \}}
\DoxyCodeLine{2908             bytesRemaining -\/= 0x7FFFFFFF;}
\DoxyCodeLine{2909         \}}
\DoxyCodeLine{2910 }
\DoxyCodeLine{2911         \textcolor{keywordflow}{if} (bytesRemaining > 0) \{}
\DoxyCodeLine{2912             \textcolor{keywordflow}{if} (!bs-\/>onSeek(bs-\/>pUserData, (\textcolor{keywordtype}{int})bytesRemaining, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{2913                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2914             \}}
\DoxyCodeLine{2915         \}}
\DoxyCodeLine{2916     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2917         \textcolor{keywordflow}{if} (!bs-\/>onSeek(bs-\/>pUserData, (\textcolor{keywordtype}{int})offsetFromStart, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{2918             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{2919         \}}
\DoxyCodeLine{2920     \}}
\DoxyCodeLine{2921 }
\DoxyCodeLine{2922     \textcolor{comment}{/* The cache should be reset to force a reload of fresh data from the client. */}}
\DoxyCodeLine{2923     drflac\_\_reset\_cache(bs);}
\DoxyCodeLine{2924     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{2925 \}}
\DoxyCodeLine{2926 }
\DoxyCodeLine{2927 }
\DoxyCodeLine{2928 \textcolor{keyword}{static} drflac\_result drflac\_\_read\_utf8\_coded\_number(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint64* pNumberOut, drflac\_uint8* pCRCOut)}
\DoxyCodeLine{2929 \{}
\DoxyCodeLine{2930     drflac\_uint8 crc;}
\DoxyCodeLine{2931     drflac\_uint64 result;}
\DoxyCodeLine{2932     drflac\_uint8 utf8[7] = \{0\};}
\DoxyCodeLine{2933     \textcolor{keywordtype}{int} byteCount;}
\DoxyCodeLine{2934     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{2935 }
\DoxyCodeLine{2936     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{2937     DRFLAC\_ASSERT(pNumberOut != NULL);}
\DoxyCodeLine{2938     DRFLAC\_ASSERT(pCRCOut != NULL);}
\DoxyCodeLine{2939 }
\DoxyCodeLine{2940     crc = *pCRCOut;}
\DoxyCodeLine{2941 }
\DoxyCodeLine{2942     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, utf8)) \{}
\DoxyCodeLine{2943         *pNumberOut = 0;}
\DoxyCodeLine{2944         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{2945     \}}
\DoxyCodeLine{2946     crc = drflac\_crc8(crc, utf8[0], 8);}
\DoxyCodeLine{2947 }
\DoxyCodeLine{2948     \textcolor{keywordflow}{if} ((utf8[0] \& 0x80) == 0) \{}
\DoxyCodeLine{2949         *pNumberOut = utf8[0];}
\DoxyCodeLine{2950         *pCRCOut = crc;}
\DoxyCodeLine{2951         \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{2952     \}}
\DoxyCodeLine{2953 }
\DoxyCodeLine{2954     \textcolor{comment}{/*byteCount = 1;*/}}
\DoxyCodeLine{2955     \textcolor{keywordflow}{if} ((utf8[0] \& 0xE0) == 0xC0) \{}
\DoxyCodeLine{2956         byteCount = 2;}
\DoxyCodeLine{2957     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((utf8[0] \& 0xF0) == 0xE0) \{}
\DoxyCodeLine{2958         byteCount = 3;}
\DoxyCodeLine{2959     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((utf8[0] \& 0xF8) == 0xF0) \{}
\DoxyCodeLine{2960         byteCount = 4;}
\DoxyCodeLine{2961     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((utf8[0] \& 0xFC) == 0xF8) \{}
\DoxyCodeLine{2962         byteCount = 5;}
\DoxyCodeLine{2963     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((utf8[0] \& 0xFE) == 0xFC) \{}
\DoxyCodeLine{2964         byteCount = 6;}
\DoxyCodeLine{2965     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((utf8[0] \& 0xFF) == 0xFE) \{}
\DoxyCodeLine{2966         byteCount = 7;}
\DoxyCodeLine{2967     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2968         *pNumberOut = 0;}
\DoxyCodeLine{2969         \textcolor{keywordflow}{return} DRFLAC\_CRC\_MISMATCH;     \textcolor{comment}{/* Bad UTF-\/8 encoding. */}}
\DoxyCodeLine{2970     \}}
\DoxyCodeLine{2971 }
\DoxyCodeLine{2972     \textcolor{comment}{/* Read extra bytes. */}}
\DoxyCodeLine{2973     DRFLAC\_ASSERT(byteCount > 1);}
\DoxyCodeLine{2974 }
\DoxyCodeLine{2975     result = (drflac\_uint64)(utf8[0] \& (0xFF >> (byteCount + 1)));}
\DoxyCodeLine{2976     \textcolor{keywordflow}{for} (i = 1; i < byteCount; ++i) \{}
\DoxyCodeLine{2977         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, utf8 + i)) \{}
\DoxyCodeLine{2978             *pNumberOut = 0;}
\DoxyCodeLine{2979             \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{2980         \}}
\DoxyCodeLine{2981         crc = drflac\_crc8(crc, utf8[i], 8);}
\DoxyCodeLine{2982 }
\DoxyCodeLine{2983         result = (result << 6) | (utf8[i] \& 0x3F);}
\DoxyCodeLine{2984     \}}
\DoxyCodeLine{2985 }
\DoxyCodeLine{2986     *pNumberOut = result;}
\DoxyCodeLine{2987     *pCRCOut = crc;}
\DoxyCodeLine{2988     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{2989 \}}
\DoxyCodeLine{2990 }
\DoxyCodeLine{2991 }
\DoxyCodeLine{2992 }
\DoxyCodeLine{2993 \textcolor{comment}{/*}}
\DoxyCodeLine{2994 \textcolor{comment}{The next two functions are responsible for calculating the prediction.}}
\DoxyCodeLine{2995 \textcolor{comment}{}}
\DoxyCodeLine{2996 \textcolor{comment}{When the bits per sample is >16 we need to use 64-\/bit integer arithmetic because otherwise we'll run out of precision. It's}}
\DoxyCodeLine{2997 \textcolor{comment}{safe to assume this will be slower on 32-\/bit platforms so we use a more optimal solution when the bits per sample is <=16.}}
\DoxyCodeLine{2998 \textcolor{comment}{*/}}
\DoxyCodeLine{2999 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_int32 drflac\_\_calculate\_prediction\_32(drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{3000 \{}
\DoxyCodeLine{3001     drflac\_int32 prediction = 0;}
\DoxyCodeLine{3002 }
\DoxyCodeLine{3003     DRFLAC\_ASSERT(order <= 32);}
\DoxyCodeLine{3004 }
\DoxyCodeLine{3005     \textcolor{comment}{/* 32-\/bit version. */}}
\DoxyCodeLine{3006 }
\DoxyCodeLine{3007     \textcolor{comment}{/* VC++ optimizes this to a single jmp. I've not yet verified this for other compilers. */}}
\DoxyCodeLine{3008     \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{3009     \{}
\DoxyCodeLine{3010     \textcolor{keywordflow}{case} 32: prediction += coefficients[31] * pDecodedSamples[-\/32];}
\DoxyCodeLine{3011     \textcolor{keywordflow}{case} 31: prediction += coefficients[30] * pDecodedSamples[-\/31];}
\DoxyCodeLine{3012     \textcolor{keywordflow}{case} 30: prediction += coefficients[29] * pDecodedSamples[-\/30];}
\DoxyCodeLine{3013     \textcolor{keywordflow}{case} 29: prediction += coefficients[28] * pDecodedSamples[-\/29];}
\DoxyCodeLine{3014     \textcolor{keywordflow}{case} 28: prediction += coefficients[27] * pDecodedSamples[-\/28];}
\DoxyCodeLine{3015     \textcolor{keywordflow}{case} 27: prediction += coefficients[26] * pDecodedSamples[-\/27];}
\DoxyCodeLine{3016     \textcolor{keywordflow}{case} 26: prediction += coefficients[25] * pDecodedSamples[-\/26];}
\DoxyCodeLine{3017     \textcolor{keywordflow}{case} 25: prediction += coefficients[24] * pDecodedSamples[-\/25];}
\DoxyCodeLine{3018     \textcolor{keywordflow}{case} 24: prediction += coefficients[23] * pDecodedSamples[-\/24];}
\DoxyCodeLine{3019     \textcolor{keywordflow}{case} 23: prediction += coefficients[22] * pDecodedSamples[-\/23];}
\DoxyCodeLine{3020     \textcolor{keywordflow}{case} 22: prediction += coefficients[21] * pDecodedSamples[-\/22];}
\DoxyCodeLine{3021     \textcolor{keywordflow}{case} 21: prediction += coefficients[20] * pDecodedSamples[-\/21];}
\DoxyCodeLine{3022     \textcolor{keywordflow}{case} 20: prediction += coefficients[19] * pDecodedSamples[-\/20];}
\DoxyCodeLine{3023     \textcolor{keywordflow}{case} 19: prediction += coefficients[18] * pDecodedSamples[-\/19];}
\DoxyCodeLine{3024     \textcolor{keywordflow}{case} 18: prediction += coefficients[17] * pDecodedSamples[-\/18];}
\DoxyCodeLine{3025     \textcolor{keywordflow}{case} 17: prediction += coefficients[16] * pDecodedSamples[-\/17];}
\DoxyCodeLine{3026     \textcolor{keywordflow}{case} 16: prediction += coefficients[15] * pDecodedSamples[-\/16];}
\DoxyCodeLine{3027     \textcolor{keywordflow}{case} 15: prediction += coefficients[14] * pDecodedSamples[-\/15];}
\DoxyCodeLine{3028     \textcolor{keywordflow}{case} 14: prediction += coefficients[13] * pDecodedSamples[-\/14];}
\DoxyCodeLine{3029     \textcolor{keywordflow}{case} 13: prediction += coefficients[12] * pDecodedSamples[-\/13];}
\DoxyCodeLine{3030     \textcolor{keywordflow}{case} 12: prediction += coefficients[11] * pDecodedSamples[-\/12];}
\DoxyCodeLine{3031     \textcolor{keywordflow}{case} 11: prediction += coefficients[10] * pDecodedSamples[-\/11];}
\DoxyCodeLine{3032     \textcolor{keywordflow}{case} 10: prediction += coefficients[ 9] * pDecodedSamples[-\/10];}
\DoxyCodeLine{3033     \textcolor{keywordflow}{case}  9: prediction += coefficients[ 8] * pDecodedSamples[-\/ 9];}
\DoxyCodeLine{3034     \textcolor{keywordflow}{case}  8: prediction += coefficients[ 7] * pDecodedSamples[-\/ 8];}
\DoxyCodeLine{3035     \textcolor{keywordflow}{case}  7: prediction += coefficients[ 6] * pDecodedSamples[-\/ 7];}
\DoxyCodeLine{3036     \textcolor{keywordflow}{case}  6: prediction += coefficients[ 5] * pDecodedSamples[-\/ 6];}
\DoxyCodeLine{3037     \textcolor{keywordflow}{case}  5: prediction += coefficients[ 4] * pDecodedSamples[-\/ 5];}
\DoxyCodeLine{3038     \textcolor{keywordflow}{case}  4: prediction += coefficients[ 3] * pDecodedSamples[-\/ 4];}
\DoxyCodeLine{3039     \textcolor{keywordflow}{case}  3: prediction += coefficients[ 2] * pDecodedSamples[-\/ 3];}
\DoxyCodeLine{3040     \textcolor{keywordflow}{case}  2: prediction += coefficients[ 1] * pDecodedSamples[-\/ 2];}
\DoxyCodeLine{3041     \textcolor{keywordflow}{case}  1: prediction += coefficients[ 0] * pDecodedSamples[-\/ 1];}
\DoxyCodeLine{3042     \}}
\DoxyCodeLine{3043 }
\DoxyCodeLine{3044     \textcolor{keywordflow}{return} (drflac\_int32)(prediction >> shift);}
\DoxyCodeLine{3045 \}}
\DoxyCodeLine{3046 }
\DoxyCodeLine{3047 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_int32 drflac\_\_calculate\_prediction\_64(drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{3048 \{}
\DoxyCodeLine{3049     drflac\_int64 prediction;}
\DoxyCodeLine{3050 }
\DoxyCodeLine{3051     DRFLAC\_ASSERT(order <= 32);}
\DoxyCodeLine{3052 }
\DoxyCodeLine{3053     \textcolor{comment}{/* 64-\/bit version. */}}
\DoxyCodeLine{3054 }
\DoxyCodeLine{3055     \textcolor{comment}{/* This method is faster on the 32-\/bit build when compiling with VC++. See note below. */}}
\DoxyCodeLine{3056 \textcolor{preprocessor}{\#ifndef DRFLAC\_64BIT}}
\DoxyCodeLine{3057     \textcolor{keywordflow}{if} (order == 8)}
\DoxyCodeLine{3058     \{}
\DoxyCodeLine{3059         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3060         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3061         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3062         prediction += coefficients[3] * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3063         prediction += coefficients[4] * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3064         prediction += coefficients[5] * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3065         prediction += coefficients[6] * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3066         prediction += coefficients[7] * (drflac\_int64)pDecodedSamples[-\/8];}
\DoxyCodeLine{3067     \}}
\DoxyCodeLine{3068     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 7)}
\DoxyCodeLine{3069     \{}
\DoxyCodeLine{3070         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3071         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3072         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3073         prediction += coefficients[3] * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3074         prediction += coefficients[4] * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3075         prediction += coefficients[5] * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3076         prediction += coefficients[6] * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3077     \}}
\DoxyCodeLine{3078     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 3)}
\DoxyCodeLine{3079     \{}
\DoxyCodeLine{3080         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3081         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3082         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3083     \}}
\DoxyCodeLine{3084     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 6)}
\DoxyCodeLine{3085     \{}
\DoxyCodeLine{3086         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3087         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3088         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3089         prediction += coefficients[3] * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3090         prediction += coefficients[4] * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3091         prediction += coefficients[5] * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3092     \}}
\DoxyCodeLine{3093     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 5)}
\DoxyCodeLine{3094     \{}
\DoxyCodeLine{3095         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3096         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3097         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3098         prediction += coefficients[3] * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3099         prediction += coefficients[4] * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3100     \}}
\DoxyCodeLine{3101     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 4)}
\DoxyCodeLine{3102     \{}
\DoxyCodeLine{3103         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3104         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3105         prediction += coefficients[2] * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3106         prediction += coefficients[3] * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3107     \}}
\DoxyCodeLine{3108     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 12)}
\DoxyCodeLine{3109     \{}
\DoxyCodeLine{3110         prediction  = coefficients[0]  * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3111         prediction += coefficients[1]  * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3112         prediction += coefficients[2]  * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3113         prediction += coefficients[3]  * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3114         prediction += coefficients[4]  * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3115         prediction += coefficients[5]  * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3116         prediction += coefficients[6]  * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3117         prediction += coefficients[7]  * (drflac\_int64)pDecodedSamples[-\/8];}
\DoxyCodeLine{3118         prediction += coefficients[8]  * (drflac\_int64)pDecodedSamples[-\/9];}
\DoxyCodeLine{3119         prediction += coefficients[9]  * (drflac\_int64)pDecodedSamples[-\/10];}
\DoxyCodeLine{3120         prediction += coefficients[10] * (drflac\_int64)pDecodedSamples[-\/11];}
\DoxyCodeLine{3121         prediction += coefficients[11] * (drflac\_int64)pDecodedSamples[-\/12];}
\DoxyCodeLine{3122     \}}
\DoxyCodeLine{3123     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 2)}
\DoxyCodeLine{3124     \{}
\DoxyCodeLine{3125         prediction  = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3126         prediction += coefficients[1] * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3127     \}}
\DoxyCodeLine{3128     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 1)}
\DoxyCodeLine{3129     \{}
\DoxyCodeLine{3130         prediction = coefficients[0] * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3131     \}}
\DoxyCodeLine{3132     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 10)}
\DoxyCodeLine{3133     \{}
\DoxyCodeLine{3134         prediction  = coefficients[0]  * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3135         prediction += coefficients[1]  * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3136         prediction += coefficients[2]  * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3137         prediction += coefficients[3]  * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3138         prediction += coefficients[4]  * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3139         prediction += coefficients[5]  * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3140         prediction += coefficients[6]  * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3141         prediction += coefficients[7]  * (drflac\_int64)pDecodedSamples[-\/8];}
\DoxyCodeLine{3142         prediction += coefficients[8]  * (drflac\_int64)pDecodedSamples[-\/9];}
\DoxyCodeLine{3143         prediction += coefficients[9]  * (drflac\_int64)pDecodedSamples[-\/10];}
\DoxyCodeLine{3144     \}}
\DoxyCodeLine{3145     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 9)}
\DoxyCodeLine{3146     \{}
\DoxyCodeLine{3147         prediction  = coefficients[0]  * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3148         prediction += coefficients[1]  * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3149         prediction += coefficients[2]  * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3150         prediction += coefficients[3]  * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3151         prediction += coefficients[4]  * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3152         prediction += coefficients[5]  * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3153         prediction += coefficients[6]  * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3154         prediction += coefficients[7]  * (drflac\_int64)pDecodedSamples[-\/8];}
\DoxyCodeLine{3155         prediction += coefficients[8]  * (drflac\_int64)pDecodedSamples[-\/9];}
\DoxyCodeLine{3156     \}}
\DoxyCodeLine{3157     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order == 11)}
\DoxyCodeLine{3158     \{}
\DoxyCodeLine{3159         prediction  = coefficients[0]  * (drflac\_int64)pDecodedSamples[-\/1];}
\DoxyCodeLine{3160         prediction += coefficients[1]  * (drflac\_int64)pDecodedSamples[-\/2];}
\DoxyCodeLine{3161         prediction += coefficients[2]  * (drflac\_int64)pDecodedSamples[-\/3];}
\DoxyCodeLine{3162         prediction += coefficients[3]  * (drflac\_int64)pDecodedSamples[-\/4];}
\DoxyCodeLine{3163         prediction += coefficients[4]  * (drflac\_int64)pDecodedSamples[-\/5];}
\DoxyCodeLine{3164         prediction += coefficients[5]  * (drflac\_int64)pDecodedSamples[-\/6];}
\DoxyCodeLine{3165         prediction += coefficients[6]  * (drflac\_int64)pDecodedSamples[-\/7];}
\DoxyCodeLine{3166         prediction += coefficients[7]  * (drflac\_int64)pDecodedSamples[-\/8];}
\DoxyCodeLine{3167         prediction += coefficients[8]  * (drflac\_int64)pDecodedSamples[-\/9];}
\DoxyCodeLine{3168         prediction += coefficients[9]  * (drflac\_int64)pDecodedSamples[-\/10];}
\DoxyCodeLine{3169         prediction += coefficients[10] * (drflac\_int64)pDecodedSamples[-\/11];}
\DoxyCodeLine{3170     \}}
\DoxyCodeLine{3171     \textcolor{keywordflow}{else}}
\DoxyCodeLine{3172     \{}
\DoxyCodeLine{3173         \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{3174 }
\DoxyCodeLine{3175         prediction = 0;}
\DoxyCodeLine{3176         \textcolor{keywordflow}{for} (j = 0; j < (int)order; ++j) \{}
\DoxyCodeLine{3177             prediction += coefficients[j] * (drflac\_int64)pDecodedSamples[-\/j-\/1];}
\DoxyCodeLine{3178         \}}
\DoxyCodeLine{3179     \}}
\DoxyCodeLine{3180 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3181 }
\DoxyCodeLine{3182     \textcolor{comment}{/*}}
\DoxyCodeLine{3183 \textcolor{comment}{    VC++ optimizes this to a single jmp instruction, but only the 64-\/bit build. The 32-\/bit build generates less efficient code for some}}
\DoxyCodeLine{3184 \textcolor{comment}{    reason. The ugly version above is faster so we'll just switch between the two depending on the target platform.}}
\DoxyCodeLine{3185 \textcolor{comment}{    */}}
\DoxyCodeLine{3186 \textcolor{preprocessor}{\#ifdef DRFLAC\_64BIT}}
\DoxyCodeLine{3187     prediction = 0;}
\DoxyCodeLine{3188     \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{3189     \{}
\DoxyCodeLine{3190     \textcolor{keywordflow}{case} 32: prediction += coefficients[31] * (drflac\_int64)pDecodedSamples[-\/32];}
\DoxyCodeLine{3191     \textcolor{keywordflow}{case} 31: prediction += coefficients[30] * (drflac\_int64)pDecodedSamples[-\/31];}
\DoxyCodeLine{3192     \textcolor{keywordflow}{case} 30: prediction += coefficients[29] * (drflac\_int64)pDecodedSamples[-\/30];}
\DoxyCodeLine{3193     \textcolor{keywordflow}{case} 29: prediction += coefficients[28] * (drflac\_int64)pDecodedSamples[-\/29];}
\DoxyCodeLine{3194     \textcolor{keywordflow}{case} 28: prediction += coefficients[27] * (drflac\_int64)pDecodedSamples[-\/28];}
\DoxyCodeLine{3195     \textcolor{keywordflow}{case} 27: prediction += coefficients[26] * (drflac\_int64)pDecodedSamples[-\/27];}
\DoxyCodeLine{3196     \textcolor{keywordflow}{case} 26: prediction += coefficients[25] * (drflac\_int64)pDecodedSamples[-\/26];}
\DoxyCodeLine{3197     \textcolor{keywordflow}{case} 25: prediction += coefficients[24] * (drflac\_int64)pDecodedSamples[-\/25];}
\DoxyCodeLine{3198     \textcolor{keywordflow}{case} 24: prediction += coefficients[23] * (drflac\_int64)pDecodedSamples[-\/24];}
\DoxyCodeLine{3199     \textcolor{keywordflow}{case} 23: prediction += coefficients[22] * (drflac\_int64)pDecodedSamples[-\/23];}
\DoxyCodeLine{3200     \textcolor{keywordflow}{case} 22: prediction += coefficients[21] * (drflac\_int64)pDecodedSamples[-\/22];}
\DoxyCodeLine{3201     \textcolor{keywordflow}{case} 21: prediction += coefficients[20] * (drflac\_int64)pDecodedSamples[-\/21];}
\DoxyCodeLine{3202     \textcolor{keywordflow}{case} 20: prediction += coefficients[19] * (drflac\_int64)pDecodedSamples[-\/20];}
\DoxyCodeLine{3203     \textcolor{keywordflow}{case} 19: prediction += coefficients[18] * (drflac\_int64)pDecodedSamples[-\/19];}
\DoxyCodeLine{3204     \textcolor{keywordflow}{case} 18: prediction += coefficients[17] * (drflac\_int64)pDecodedSamples[-\/18];}
\DoxyCodeLine{3205     \textcolor{keywordflow}{case} 17: prediction += coefficients[16] * (drflac\_int64)pDecodedSamples[-\/17];}
\DoxyCodeLine{3206     \textcolor{keywordflow}{case} 16: prediction += coefficients[15] * (drflac\_int64)pDecodedSamples[-\/16];}
\DoxyCodeLine{3207     \textcolor{keywordflow}{case} 15: prediction += coefficients[14] * (drflac\_int64)pDecodedSamples[-\/15];}
\DoxyCodeLine{3208     \textcolor{keywordflow}{case} 14: prediction += coefficients[13] * (drflac\_int64)pDecodedSamples[-\/14];}
\DoxyCodeLine{3209     \textcolor{keywordflow}{case} 13: prediction += coefficients[12] * (drflac\_int64)pDecodedSamples[-\/13];}
\DoxyCodeLine{3210     \textcolor{keywordflow}{case} 12: prediction += coefficients[11] * (drflac\_int64)pDecodedSamples[-\/12];}
\DoxyCodeLine{3211     \textcolor{keywordflow}{case} 11: prediction += coefficients[10] * (drflac\_int64)pDecodedSamples[-\/11];}
\DoxyCodeLine{3212     \textcolor{keywordflow}{case} 10: prediction += coefficients[ 9] * (drflac\_int64)pDecodedSamples[-\/10];}
\DoxyCodeLine{3213     \textcolor{keywordflow}{case}  9: prediction += coefficients[ 8] * (drflac\_int64)pDecodedSamples[-\/ 9];}
\DoxyCodeLine{3214     \textcolor{keywordflow}{case}  8: prediction += coefficients[ 7] * (drflac\_int64)pDecodedSamples[-\/ 8];}
\DoxyCodeLine{3215     \textcolor{keywordflow}{case}  7: prediction += coefficients[ 6] * (drflac\_int64)pDecodedSamples[-\/ 7];}
\DoxyCodeLine{3216     \textcolor{keywordflow}{case}  6: prediction += coefficients[ 5] * (drflac\_int64)pDecodedSamples[-\/ 6];}
\DoxyCodeLine{3217     \textcolor{keywordflow}{case}  5: prediction += coefficients[ 4] * (drflac\_int64)pDecodedSamples[-\/ 5];}
\DoxyCodeLine{3218     \textcolor{keywordflow}{case}  4: prediction += coefficients[ 3] * (drflac\_int64)pDecodedSamples[-\/ 4];}
\DoxyCodeLine{3219     \textcolor{keywordflow}{case}  3: prediction += coefficients[ 2] * (drflac\_int64)pDecodedSamples[-\/ 3];}
\DoxyCodeLine{3220     \textcolor{keywordflow}{case}  2: prediction += coefficients[ 1] * (drflac\_int64)pDecodedSamples[-\/ 2];}
\DoxyCodeLine{3221     \textcolor{keywordflow}{case}  1: prediction += coefficients[ 0] * (drflac\_int64)pDecodedSamples[-\/ 1];}
\DoxyCodeLine{3222     \}}
\DoxyCodeLine{3223 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3224 }
\DoxyCodeLine{3225     \textcolor{keywordflow}{return} (drflac\_int32)(prediction >> shift);}
\DoxyCodeLine{3226 \}}
\DoxyCodeLine{3227 }
\DoxyCodeLine{3228 }
\DoxyCodeLine{3229 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{3230 \textcolor{comment}{/*}}
\DoxyCodeLine{3231 \textcolor{comment}{Reference implementation for reading and decoding samples with residual. This is intentionally left unoptimized for the}}
\DoxyCodeLine{3232 \textcolor{comment}{sake of readability and should only be used as a reference.}}
\DoxyCodeLine{3233 \textcolor{comment}{*/}}
\DoxyCodeLine{3234 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_reference(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{3235 \{}
\DoxyCodeLine{3236     drflac\_uint32 i;}
\DoxyCodeLine{3237 }
\DoxyCodeLine{3238     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{3239     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{3240 }
\DoxyCodeLine{3241     \textcolor{keywordflow}{for} (i = 0; i < count; ++i) \{}
\DoxyCodeLine{3242         drflac\_uint32 zeroCounter = 0;}
\DoxyCodeLine{3243         \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3244             drflac\_uint8 bit;}
\DoxyCodeLine{3245             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 1, \&bit)) \{}
\DoxyCodeLine{3246                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3247             \}}
\DoxyCodeLine{3248 }
\DoxyCodeLine{3249             \textcolor{keywordflow}{if} (bit == 0) \{}
\DoxyCodeLine{3250                 zeroCounter += 1;}
\DoxyCodeLine{3251             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3252                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3253             \}}
\DoxyCodeLine{3254         \}}
\DoxyCodeLine{3255 }
\DoxyCodeLine{3256         drflac\_uint32 decodedRice;}
\DoxyCodeLine{3257         \textcolor{keywordflow}{if} (riceParam > 0) \{}
\DoxyCodeLine{3258             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, riceParam, \&decodedRice)) \{}
\DoxyCodeLine{3259                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3260             \}}
\DoxyCodeLine{3261         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3262             decodedRice = 0;}
\DoxyCodeLine{3263         \}}
\DoxyCodeLine{3264 }
\DoxyCodeLine{3265         decodedRice |= (zeroCounter << riceParam);}
\DoxyCodeLine{3266         \textcolor{keywordflow}{if} ((decodedRice \& 0x01)) \{}
\DoxyCodeLine{3267             decodedRice = \string~(decodedRice >> 1);}
\DoxyCodeLine{3268         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3269             decodedRice =  (decodedRice >> 1);}
\DoxyCodeLine{3270         \}}
\DoxyCodeLine{3271 }
\DoxyCodeLine{3272 }
\DoxyCodeLine{3273         \textcolor{keywordflow}{if} (bitsPerSample+shift >= 32) \{}
\DoxyCodeLine{3274             pSamplesOut[i] = decodedRice + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + i);}
\DoxyCodeLine{3275         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3276             pSamplesOut[i] = decodedRice + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + i);}
\DoxyCodeLine{3277         \}}
\DoxyCodeLine{3278     \}}
\DoxyCodeLine{3279 }
\DoxyCodeLine{3280     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3281 \}}
\DoxyCodeLine{3282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3283 }
\DoxyCodeLine{3284 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{3285 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_rice\_parts\_\_reference(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint8 riceParam, drflac\_uint32* pZeroCounterOut, drflac\_uint32* pRiceParamPartOut)}
\DoxyCodeLine{3286 \{}
\DoxyCodeLine{3287     drflac\_uint32 zeroCounter = 0;}
\DoxyCodeLine{3288     drflac\_uint32 decodedRice;}
\DoxyCodeLine{3289 }
\DoxyCodeLine{3290     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3291         drflac\_uint8 bit;}
\DoxyCodeLine{3292         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 1, \&bit)) \{}
\DoxyCodeLine{3293             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3294         \}}
\DoxyCodeLine{3295 }
\DoxyCodeLine{3296         \textcolor{keywordflow}{if} (bit == 0) \{}
\DoxyCodeLine{3297             zeroCounter += 1;}
\DoxyCodeLine{3298         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3299             \textcolor{keywordflow}{break};}
\DoxyCodeLine{3300         \}}
\DoxyCodeLine{3301     \}}
\DoxyCodeLine{3302 }
\DoxyCodeLine{3303     \textcolor{keywordflow}{if} (riceParam > 0) \{}
\DoxyCodeLine{3304         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, riceParam, \&decodedRice)) \{}
\DoxyCodeLine{3305             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3306         \}}
\DoxyCodeLine{3307     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3308         decodedRice = 0;}
\DoxyCodeLine{3309     \}}
\DoxyCodeLine{3310 }
\DoxyCodeLine{3311     *pZeroCounterOut = zeroCounter;}
\DoxyCodeLine{3312     *pRiceParamPartOut = decodedRice;}
\DoxyCodeLine{3313     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3314 \}}
\DoxyCodeLine{3315 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3316 }
\DoxyCodeLine{3317 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{3318 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_read\_rice\_parts(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint8 riceParam, drflac\_uint32* pZeroCounterOut, drflac\_uint32* pRiceParamPartOut)}
\DoxyCodeLine{3319 \{}
\DoxyCodeLine{3320     drflac\_cache\_t riceParamMask;}
\DoxyCodeLine{3321     drflac\_uint32 zeroCounter;}
\DoxyCodeLine{3322     drflac\_uint32 setBitOffsetPlus1;}
\DoxyCodeLine{3323     drflac\_uint32 riceParamPart;}
\DoxyCodeLine{3324     drflac\_uint32 riceLength;}
\DoxyCodeLine{3325 }
\DoxyCodeLine{3326     DRFLAC\_ASSERT(riceParam > 0);   \textcolor{comment}{/* <-\/-\/ riceParam should never be 0. drflac\_\_read\_rice\_parts\_\_param\_equals\_zero() should be used instead for this case. */}}
\DoxyCodeLine{3327 }
\DoxyCodeLine{3328     riceParamMask = DRFLAC\_CACHE\_L1\_SELECTION\_MASK(riceParam);}
\DoxyCodeLine{3329 }
\DoxyCodeLine{3330     zeroCounter = 0;}
\DoxyCodeLine{3331     \textcolor{keywordflow}{while} (bs-\/>cache == 0) \{}
\DoxyCodeLine{3332         zeroCounter += (drflac\_uint32)DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs);}
\DoxyCodeLine{3333         \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3334             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3335         \}}
\DoxyCodeLine{3336     \}}
\DoxyCodeLine{3337 }
\DoxyCodeLine{3338     setBitOffsetPlus1 = drflac\_\_clz(bs-\/>cache);}
\DoxyCodeLine{3339     zeroCounter += setBitOffsetPlus1;}
\DoxyCodeLine{3340     setBitOffsetPlus1 += 1;}
\DoxyCodeLine{3341 }
\DoxyCodeLine{3342     riceLength = setBitOffsetPlus1 + riceParam;}
\DoxyCodeLine{3343     \textcolor{keywordflow}{if} (riceLength < DRFLAC\_CACHE\_L1\_BITS\_REMAINING(bs)) \{}
\DoxyCodeLine{3344         riceParamPart = (drflac\_uint32)((bs-\/>cache \& (riceParamMask >> setBitOffsetPlus1)) >> DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT(bs, riceLength));}
\DoxyCodeLine{3345 }
\DoxyCodeLine{3346         bs-\/>consumedBits += riceLength;}
\DoxyCodeLine{3347         bs-\/>cache <<= riceLength;}
\DoxyCodeLine{3348     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3349         drflac\_uint32 bitCountLo;}
\DoxyCodeLine{3350         drflac\_cache\_t resultHi;}
\DoxyCodeLine{3351 }
\DoxyCodeLine{3352         bs-\/>consumedBits += riceLength;}
\DoxyCodeLine{3353         bs-\/>cache <<= setBitOffsetPlus1 \& (DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)-\/1);    \textcolor{comment}{/* <-\/-\/ Equivalent to "{}if (setBitOffsetPlus1 < DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs)) \{ bs-\/>cache <<= setBitOffsetPlus1; \}"{} */}}
\DoxyCodeLine{3354 }
\DoxyCodeLine{3355         \textcolor{comment}{/* It straddles the cached data. It will never cover more than the next chunk. We just read the number in two parts and combine them. */}}
\DoxyCodeLine{3356         bitCountLo = bs-\/>consumedBits -\/ DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs);}
\DoxyCodeLine{3357         resultHi = DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT(bs, riceParam);  \textcolor{comment}{/* <-\/-\/ Use DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT\_SAFE() if ever this function allows riceParam=0. */}}
\DoxyCodeLine{3358 }
\DoxyCodeLine{3359         \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{3360 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3361             drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{3362 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3363             bs-\/>cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cacheL2[bs-\/>nextL2Line++]);}
\DoxyCodeLine{3364             bs-\/>consumedBits = 0;}
\DoxyCodeLine{3365 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3366             bs-\/>crc16Cache = bs-\/>cache;}
\DoxyCodeLine{3367 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3368         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3369             \textcolor{comment}{/* Slow path. We need to fetch more data from the client. */}}
\DoxyCodeLine{3370             \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3371                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3372             \}}
\DoxyCodeLine{3373         \}}
\DoxyCodeLine{3374 }
\DoxyCodeLine{3375         riceParamPart = (drflac\_uint32)(resultHi | DRFLAC\_CACHE\_L1\_SELECT\_AND\_SHIFT\_SAFE(bs, bitCountLo));}
\DoxyCodeLine{3376 }
\DoxyCodeLine{3377         bs-\/>consumedBits += bitCountLo;}
\DoxyCodeLine{3378         bs-\/>cache <<= bitCountLo;}
\DoxyCodeLine{3379     \}}
\DoxyCodeLine{3380 }
\DoxyCodeLine{3381     pZeroCounterOut[0] = zeroCounter;}
\DoxyCodeLine{3382     pRiceParamPartOut[0] = riceParamPart;}
\DoxyCodeLine{3383 }
\DoxyCodeLine{3384     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3385 \}}
\DoxyCodeLine{3386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3387 }
\DoxyCodeLine{3388 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_read\_rice\_parts\_x1(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint8 riceParam, drflac\_uint32* pZeroCounterOut, drflac\_uint32* pRiceParamPartOut)}
\DoxyCodeLine{3389 \{}
\DoxyCodeLine{3390     drflac\_uint32  riceParamPlus1 = riceParam + 1;}
\DoxyCodeLine{3391     \textcolor{comment}{/*drflac\_cache\_t riceParamPlus1Mask  = DRFLAC\_CACHE\_L1\_SELECTION\_MASK(riceParamPlus1);*/}}
\DoxyCodeLine{3392     drflac\_uint32  riceParamPlus1Shift = DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT(bs, riceParamPlus1);}
\DoxyCodeLine{3393     drflac\_uint32  riceParamPlus1MaxConsumedBits = DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs) -\/ riceParamPlus1;}
\DoxyCodeLine{3394 }
\DoxyCodeLine{3395     \textcolor{comment}{/*}}
\DoxyCodeLine{3396 \textcolor{comment}{    The idea here is to use local variables for the cache in an attempt to encourage the compiler to store them in registers. I have}}
\DoxyCodeLine{3397 \textcolor{comment}{    no idea how this will work in practice...}}
\DoxyCodeLine{3398 \textcolor{comment}{    */}}
\DoxyCodeLine{3399     drflac\_cache\_t bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3400     drflac\_uint32  bs\_consumedBits = bs-\/>consumedBits;}
\DoxyCodeLine{3401 }
\DoxyCodeLine{3402     \textcolor{comment}{/* The first thing to do is find the first unset bit. Most likely a bit will be set in the current cache line. */}}
\DoxyCodeLine{3403     drflac\_uint32  lzcount = drflac\_\_clz(bs\_cache);}
\DoxyCodeLine{3404     \textcolor{keywordflow}{if} (lzcount < \textcolor{keyword}{sizeof}(bs\_cache)*8) \{}
\DoxyCodeLine{3405         pZeroCounterOut[0] = lzcount;}
\DoxyCodeLine{3406 }
\DoxyCodeLine{3407         \textcolor{comment}{/*}}
\DoxyCodeLine{3408 \textcolor{comment}{        It is most likely that the riceParam part (which comes after the zero counter) is also on this cache line. When extracting}}
\DoxyCodeLine{3409 \textcolor{comment}{        this, we include the set bit from the unary coded part because it simplifies cache management. This bit will be handled}}
\DoxyCodeLine{3410 \textcolor{comment}{        outside of this function at a higher level.}}
\DoxyCodeLine{3411 \textcolor{comment}{        */}}
\DoxyCodeLine{3412     extract\_rice\_param\_part:}
\DoxyCodeLine{3413         bs\_cache       <<= lzcount;}
\DoxyCodeLine{3414         bs\_consumedBits += lzcount;}
\DoxyCodeLine{3415 }
\DoxyCodeLine{3416         \textcolor{keywordflow}{if} (bs\_consumedBits <= riceParamPlus1MaxConsumedBits) \{}
\DoxyCodeLine{3417             \textcolor{comment}{/* Getting here means the rice parameter part is wholly contained within the current cache line. */}}
\DoxyCodeLine{3418             pRiceParamPartOut[0] = (drflac\_uint32)(bs\_cache >> riceParamPlus1Shift);}
\DoxyCodeLine{3419             bs\_cache       <<= riceParamPlus1;}
\DoxyCodeLine{3420             bs\_consumedBits += riceParamPlus1;}
\DoxyCodeLine{3421         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3422             drflac\_uint32 riceParamPartHi;}
\DoxyCodeLine{3423             drflac\_uint32 riceParamPartLo;}
\DoxyCodeLine{3424             drflac\_uint32 riceParamPartLoBitCount;}
\DoxyCodeLine{3425 }
\DoxyCodeLine{3426             \textcolor{comment}{/*}}
\DoxyCodeLine{3427 \textcolor{comment}{            Getting here means the rice parameter part straddles the cache line. We need to read from the tail of the current cache}}
\DoxyCodeLine{3428 \textcolor{comment}{            line, reload the cache, and then combine it with the head of the next cache line.}}
\DoxyCodeLine{3429 \textcolor{comment}{            */}}
\DoxyCodeLine{3430 }
\DoxyCodeLine{3431             \textcolor{comment}{/* Grab the high part of the rice parameter part. */}}
\DoxyCodeLine{3432             riceParamPartHi = (drflac\_uint32)(bs\_cache >> riceParamPlus1Shift);}
\DoxyCodeLine{3433 }
\DoxyCodeLine{3434             \textcolor{comment}{/* Before reloading the cache we need to grab the size in bits of the low part. */}}
\DoxyCodeLine{3435             riceParamPartLoBitCount = bs\_consumedBits -\/ riceParamPlus1MaxConsumedBits;}
\DoxyCodeLine{3436             DRFLAC\_ASSERT(riceParamPartLoBitCount > 0 \&\& riceParamPartLoBitCount < 32);}
\DoxyCodeLine{3437 }
\DoxyCodeLine{3438             \textcolor{comment}{/* Now reload the cache. */}}
\DoxyCodeLine{3439             \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{3440 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3441                 drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{3442 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3443                 bs\_cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cacheL2[bs-\/>nextL2Line++]);}
\DoxyCodeLine{3444                 bs\_consumedBits = riceParamPartLoBitCount;}
\DoxyCodeLine{3445 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3446                 bs-\/>crc16Cache = bs\_cache;}
\DoxyCodeLine{3447 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3448             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3449                 \textcolor{comment}{/* Slow path. We need to fetch more data from the client. */}}
\DoxyCodeLine{3450                 \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3451                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3452                 \}}
\DoxyCodeLine{3453 }
\DoxyCodeLine{3454                 bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3455                 bs\_consumedBits = bs-\/>consumedBits + riceParamPartLoBitCount;}
\DoxyCodeLine{3456             \}}
\DoxyCodeLine{3457 }
\DoxyCodeLine{3458             \textcolor{comment}{/* We should now have enough information to construct the rice parameter part. */}}
\DoxyCodeLine{3459             riceParamPartLo = (drflac\_uint32)(bs\_cache >> (DRFLAC\_CACHE\_L1\_SELECTION\_SHIFT(bs, riceParamPartLoBitCount)));}
\DoxyCodeLine{3460             pRiceParamPartOut[0] = riceParamPartHi | riceParamPartLo;}
\DoxyCodeLine{3461 }
\DoxyCodeLine{3462             bs\_cache <<= riceParamPartLoBitCount;}
\DoxyCodeLine{3463         \}}
\DoxyCodeLine{3464     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3465         \textcolor{comment}{/*}}
\DoxyCodeLine{3466 \textcolor{comment}{        Getting here means there are no bits set on the cache line. This is a less optimal case because we just wasted a call}}
\DoxyCodeLine{3467 \textcolor{comment}{        to drflac\_\_clz() and we need to reload the cache.}}
\DoxyCodeLine{3468 \textcolor{comment}{        */}}
\DoxyCodeLine{3469         drflac\_uint32 zeroCounter = (drflac\_uint32)(DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs) -\/ bs\_consumedBits);}
\DoxyCodeLine{3470         \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3471             \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{3472 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3473                 drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{3474 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3475                 bs\_cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cacheL2[bs-\/>nextL2Line++]);}
\DoxyCodeLine{3476                 bs\_consumedBits = 0;}
\DoxyCodeLine{3477 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3478                 bs-\/>crc16Cache = bs\_cache;}
\DoxyCodeLine{3479 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3480             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3481                 \textcolor{comment}{/* Slow path. We need to fetch more data from the client. */}}
\DoxyCodeLine{3482                 \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3483                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3484                 \}}
\DoxyCodeLine{3485 }
\DoxyCodeLine{3486                 bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3487                 bs\_consumedBits = bs-\/>consumedBits;}
\DoxyCodeLine{3488             \}}
\DoxyCodeLine{3489 }
\DoxyCodeLine{3490             lzcount = drflac\_\_clz(bs\_cache);}
\DoxyCodeLine{3491             zeroCounter += lzcount;}
\DoxyCodeLine{3492 }
\DoxyCodeLine{3493             \textcolor{keywordflow}{if} (lzcount < \textcolor{keyword}{sizeof}(bs\_cache)*8) \{}
\DoxyCodeLine{3494                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3495             \}}
\DoxyCodeLine{3496         \}}
\DoxyCodeLine{3497 }
\DoxyCodeLine{3498         pZeroCounterOut[0] = zeroCounter;}
\DoxyCodeLine{3499         \textcolor{keywordflow}{goto} extract\_rice\_param\_part;}
\DoxyCodeLine{3500     \}}
\DoxyCodeLine{3501 }
\DoxyCodeLine{3502     \textcolor{comment}{/* Make sure the cache is restored at the end of it all. */}}
\DoxyCodeLine{3503     bs-\/>cache = bs\_cache;}
\DoxyCodeLine{3504     bs-\/>consumedBits = bs\_consumedBits;}
\DoxyCodeLine{3505 }
\DoxyCodeLine{3506     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3507 \}}
\DoxyCodeLine{3508 }
\DoxyCodeLine{3509 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_seek\_rice\_parts(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint8 riceParam)}
\DoxyCodeLine{3510 \{}
\DoxyCodeLine{3511     drflac\_uint32  riceParamPlus1 = riceParam + 1;}
\DoxyCodeLine{3512     drflac\_uint32  riceParamPlus1MaxConsumedBits = DRFLAC\_CACHE\_L1\_SIZE\_BITS(bs) -\/ riceParamPlus1;}
\DoxyCodeLine{3513 }
\DoxyCodeLine{3514     \textcolor{comment}{/*}}
\DoxyCodeLine{3515 \textcolor{comment}{    The idea here is to use local variables for the cache in an attempt to encourage the compiler to store them in registers. I have}}
\DoxyCodeLine{3516 \textcolor{comment}{    no idea how this will work in practice...}}
\DoxyCodeLine{3517 \textcolor{comment}{    */}}
\DoxyCodeLine{3518     drflac\_cache\_t bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3519     drflac\_uint32  bs\_consumedBits = bs-\/>consumedBits;}
\DoxyCodeLine{3520 }
\DoxyCodeLine{3521     \textcolor{comment}{/* The first thing to do is find the first unset bit. Most likely a bit will be set in the current cache line. */}}
\DoxyCodeLine{3522     drflac\_uint32  lzcount = drflac\_\_clz(bs\_cache);}
\DoxyCodeLine{3523     \textcolor{keywordflow}{if} (lzcount < \textcolor{keyword}{sizeof}(bs\_cache)*8) \{}
\DoxyCodeLine{3524         \textcolor{comment}{/*}}
\DoxyCodeLine{3525 \textcolor{comment}{        It is most likely that the riceParam part (which comes after the zero counter) is also on this cache line. When extracting}}
\DoxyCodeLine{3526 \textcolor{comment}{        this, we include the set bit from the unary coded part because it simplifies cache management. This bit will be handled}}
\DoxyCodeLine{3527 \textcolor{comment}{        outside of this function at a higher level.}}
\DoxyCodeLine{3528 \textcolor{comment}{        */}}
\DoxyCodeLine{3529     extract\_rice\_param\_part:}
\DoxyCodeLine{3530         bs\_cache       <<= lzcount;}
\DoxyCodeLine{3531         bs\_consumedBits += lzcount;}
\DoxyCodeLine{3532 }
\DoxyCodeLine{3533         \textcolor{keywordflow}{if} (bs\_consumedBits <= riceParamPlus1MaxConsumedBits) \{}
\DoxyCodeLine{3534             \textcolor{comment}{/* Getting here means the rice parameter part is wholly contained within the current cache line. */}}
\DoxyCodeLine{3535             bs\_cache       <<= riceParamPlus1;}
\DoxyCodeLine{3536             bs\_consumedBits += riceParamPlus1;}
\DoxyCodeLine{3537         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3538             \textcolor{comment}{/*}}
\DoxyCodeLine{3539 \textcolor{comment}{            Getting here means the rice parameter part straddles the cache line. We need to read from the tail of the current cache}}
\DoxyCodeLine{3540 \textcolor{comment}{            line, reload the cache, and then combine it with the head of the next cache line.}}
\DoxyCodeLine{3541 \textcolor{comment}{            */}}
\DoxyCodeLine{3542 }
\DoxyCodeLine{3543             \textcolor{comment}{/* Before reloading the cache we need to grab the size in bits of the low part. */}}
\DoxyCodeLine{3544             drflac\_uint32 riceParamPartLoBitCount = bs\_consumedBits -\/ riceParamPlus1MaxConsumedBits;}
\DoxyCodeLine{3545             DRFLAC\_ASSERT(riceParamPartLoBitCount > 0 \&\& riceParamPartLoBitCount < 32);}
\DoxyCodeLine{3546 }
\DoxyCodeLine{3547             \textcolor{comment}{/* Now reload the cache. */}}
\DoxyCodeLine{3548             \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{3549 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3550                 drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{3551 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3552                 bs\_cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cacheL2[bs-\/>nextL2Line++]);}
\DoxyCodeLine{3553                 bs\_consumedBits = riceParamPartLoBitCount;}
\DoxyCodeLine{3554 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3555                 bs-\/>crc16Cache = bs\_cache;}
\DoxyCodeLine{3556 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3557             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3558                 \textcolor{comment}{/* Slow path. We need to fetch more data from the client. */}}
\DoxyCodeLine{3559                 \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3560                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3561                 \}}
\DoxyCodeLine{3562 }
\DoxyCodeLine{3563                 bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3564                 bs\_consumedBits = bs-\/>consumedBits + riceParamPartLoBitCount;}
\DoxyCodeLine{3565             \}}
\DoxyCodeLine{3566 }
\DoxyCodeLine{3567             bs\_cache <<= riceParamPartLoBitCount;}
\DoxyCodeLine{3568         \}}
\DoxyCodeLine{3569     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3570         \textcolor{comment}{/*}}
\DoxyCodeLine{3571 \textcolor{comment}{        Getting here means there are no bits set on the cache line. This is a less optimal case because we just wasted a call}}
\DoxyCodeLine{3572 \textcolor{comment}{        to drflac\_\_clz() and we need to reload the cache.}}
\DoxyCodeLine{3573 \textcolor{comment}{        */}}
\DoxyCodeLine{3574         \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3575             \textcolor{keywordflow}{if} (bs-\/>nextL2Line < DRFLAC\_CACHE\_L2\_LINE\_COUNT(bs)) \{}
\DoxyCodeLine{3576 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3577                 drflac\_\_update\_crc16(bs);}
\DoxyCodeLine{3578 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3579                 bs\_cache = drflac\_\_be2host\_\_cache\_line(bs-\/>cacheL2[bs-\/>nextL2Line++]);}
\DoxyCodeLine{3580                 bs\_consumedBits = 0;}
\DoxyCodeLine{3581 \textcolor{preprocessor}{            \#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{3582                 bs-\/>crc16Cache = bs\_cache;}
\DoxyCodeLine{3583 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{3584             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3585                 \textcolor{comment}{/* Slow path. We need to fetch more data from the client. */}}
\DoxyCodeLine{3586                 \textcolor{keywordflow}{if} (!drflac\_\_reload\_cache(bs)) \{}
\DoxyCodeLine{3587                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3588                 \}}
\DoxyCodeLine{3589 }
\DoxyCodeLine{3590                 bs\_cache = bs-\/>cache;}
\DoxyCodeLine{3591                 bs\_consumedBits = bs-\/>consumedBits;}
\DoxyCodeLine{3592             \}}
\DoxyCodeLine{3593 }
\DoxyCodeLine{3594             lzcount = drflac\_\_clz(bs\_cache);}
\DoxyCodeLine{3595             \textcolor{keywordflow}{if} (lzcount < \textcolor{keyword}{sizeof}(bs\_cache)*8) \{}
\DoxyCodeLine{3596                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3597             \}}
\DoxyCodeLine{3598         \}}
\DoxyCodeLine{3599 }
\DoxyCodeLine{3600         \textcolor{keywordflow}{goto} extract\_rice\_param\_part;}
\DoxyCodeLine{3601     \}}
\DoxyCodeLine{3602 }
\DoxyCodeLine{3603     \textcolor{comment}{/* Make sure the cache is restored at the end of it all. */}}
\DoxyCodeLine{3604     bs-\/>cache = bs\_cache;}
\DoxyCodeLine{3605     bs-\/>consumedBits = bs\_consumedBits;}
\DoxyCodeLine{3606 }
\DoxyCodeLine{3607     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3608 \}}
\DoxyCodeLine{3609 }
\DoxyCodeLine{3610 }
\DoxyCodeLine{3611 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar\_zeroorder(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{3612 \{}
\DoxyCodeLine{3613     drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{3614     drflac\_uint32 zeroCountPart0;}
\DoxyCodeLine{3615     drflac\_uint32 riceParamPart0;}
\DoxyCodeLine{3616     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{3617     drflac\_uint32 i;}
\DoxyCodeLine{3618 }
\DoxyCodeLine{3619     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{3620     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{3621 }
\DoxyCodeLine{3622     (void)bitsPerSample;}
\DoxyCodeLine{3623     (void)order;}
\DoxyCodeLine{3624     (void)shift;}
\DoxyCodeLine{3625     (void)coefficients;}
\DoxyCodeLine{3626 }
\DoxyCodeLine{3627     riceParamMask  = (drflac\_uint32)\string~((\string~0UL) << riceParam);}
\DoxyCodeLine{3628 }
\DoxyCodeLine{3629     i = 0;}
\DoxyCodeLine{3630     \textcolor{keywordflow}{while} (i < count) \{}
\DoxyCodeLine{3631         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{3632         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart0, \&riceParamPart0)) \{}
\DoxyCodeLine{3633             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3634         \}}
\DoxyCodeLine{3635 }
\DoxyCodeLine{3636         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{3637         riceParamPart0 \&= riceParamMask;}
\DoxyCodeLine{3638         riceParamPart0 |= (zeroCountPart0 << riceParam);}
\DoxyCodeLine{3639         riceParamPart0  = (riceParamPart0 >> 1) \string^ t[riceParamPart0 \& 0x01];}
\DoxyCodeLine{3640 }
\DoxyCodeLine{3641         pSamplesOut[i] = riceParamPart0;}
\DoxyCodeLine{3642 }
\DoxyCodeLine{3643         i += 1;}
\DoxyCodeLine{3644     \}}
\DoxyCodeLine{3645 }
\DoxyCodeLine{3646     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3647 \}}
\DoxyCodeLine{3648 }
\DoxyCodeLine{3649 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{3650 \{}
\DoxyCodeLine{3651     drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{3652     drflac\_uint32 zeroCountPart0 = 0;}
\DoxyCodeLine{3653     drflac\_uint32 zeroCountPart1 = 0;}
\DoxyCodeLine{3654     drflac\_uint32 zeroCountPart2 = 0;}
\DoxyCodeLine{3655     drflac\_uint32 zeroCountPart3 = 0;}
\DoxyCodeLine{3656     drflac\_uint32 riceParamPart0 = 0;}
\DoxyCodeLine{3657     drflac\_uint32 riceParamPart1 = 0;}
\DoxyCodeLine{3658     drflac\_uint32 riceParamPart2 = 0;}
\DoxyCodeLine{3659     drflac\_uint32 riceParamPart3 = 0;}
\DoxyCodeLine{3660     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{3661     \textcolor{keyword}{const} drflac\_int32* pSamplesOutEnd;}
\DoxyCodeLine{3662     drflac\_uint32 i;}
\DoxyCodeLine{3663 }
\DoxyCodeLine{3664     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{3665     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{3666 }
\DoxyCodeLine{3667     \textcolor{keywordflow}{if} (order == 0) \{}
\DoxyCodeLine{3668         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar\_zeroorder(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{3669     \}}
\DoxyCodeLine{3670 }
\DoxyCodeLine{3671     riceParamMask  = (drflac\_uint32)\string~((\string~0UL) << riceParam);}
\DoxyCodeLine{3672     pSamplesOutEnd = pSamplesOut + (count \& \string~3);}
\DoxyCodeLine{3673 }
\DoxyCodeLine{3674     \textcolor{keywordflow}{if} (bitsPerSample+shift > 32) \{}
\DoxyCodeLine{3675         \textcolor{keywordflow}{while} (pSamplesOut < pSamplesOutEnd) \{}
\DoxyCodeLine{3676             \textcolor{comment}{/*}}
\DoxyCodeLine{3677 \textcolor{comment}{            Rice extraction. It's faster to do this one at a time against local variables than it is to use the x4 version}}
\DoxyCodeLine{3678 \textcolor{comment}{            against an array. Not sure why, but perhaps it's making more efficient use of registers?}}
\DoxyCodeLine{3679 \textcolor{comment}{            */}}
\DoxyCodeLine{3680             \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart0, \&riceParamPart0) ||}
\DoxyCodeLine{3681                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart1, \&riceParamPart1) ||}
\DoxyCodeLine{3682                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart2, \&riceParamPart2) ||}
\DoxyCodeLine{3683                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart3, \&riceParamPart3)) \{}
\DoxyCodeLine{3684                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3685             \}}
\DoxyCodeLine{3686 }
\DoxyCodeLine{3687             riceParamPart0 \&= riceParamMask;}
\DoxyCodeLine{3688             riceParamPart1 \&= riceParamMask;}
\DoxyCodeLine{3689             riceParamPart2 \&= riceParamMask;}
\DoxyCodeLine{3690             riceParamPart3 \&= riceParamMask;}
\DoxyCodeLine{3691 }
\DoxyCodeLine{3692             riceParamPart0 |= (zeroCountPart0 << riceParam);}
\DoxyCodeLine{3693             riceParamPart1 |= (zeroCountPart1 << riceParam);}
\DoxyCodeLine{3694             riceParamPart2 |= (zeroCountPart2 << riceParam);}
\DoxyCodeLine{3695             riceParamPart3 |= (zeroCountPart3 << riceParam);}
\DoxyCodeLine{3696 }
\DoxyCodeLine{3697             riceParamPart0  = (riceParamPart0 >> 1) \string^ t[riceParamPart0 \& 0x01];}
\DoxyCodeLine{3698             riceParamPart1  = (riceParamPart1 >> 1) \string^ t[riceParamPart1 \& 0x01];}
\DoxyCodeLine{3699             riceParamPart2  = (riceParamPart2 >> 1) \string^ t[riceParamPart2 \& 0x01];}
\DoxyCodeLine{3700             riceParamPart3  = (riceParamPart3 >> 1) \string^ t[riceParamPart3 \& 0x01];}
\DoxyCodeLine{3701 }
\DoxyCodeLine{3702             pSamplesOut[0] = riceParamPart0 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + 0);}
\DoxyCodeLine{3703             pSamplesOut[1] = riceParamPart1 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + 1);}
\DoxyCodeLine{3704             pSamplesOut[2] = riceParamPart2 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + 2);}
\DoxyCodeLine{3705             pSamplesOut[3] = riceParamPart3 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + 3);}
\DoxyCodeLine{3706 }
\DoxyCodeLine{3707             pSamplesOut += 4;}
\DoxyCodeLine{3708         \}}
\DoxyCodeLine{3709     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3710         \textcolor{keywordflow}{while} (pSamplesOut < pSamplesOutEnd) \{}
\DoxyCodeLine{3711             \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart0, \&riceParamPart0) ||}
\DoxyCodeLine{3712                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart1, \&riceParamPart1) ||}
\DoxyCodeLine{3713                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart2, \&riceParamPart2) ||}
\DoxyCodeLine{3714                 !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart3, \&riceParamPart3)) \{}
\DoxyCodeLine{3715                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3716             \}}
\DoxyCodeLine{3717 }
\DoxyCodeLine{3718             riceParamPart0 \&= riceParamMask;}
\DoxyCodeLine{3719             riceParamPart1 \&= riceParamMask;}
\DoxyCodeLine{3720             riceParamPart2 \&= riceParamMask;}
\DoxyCodeLine{3721             riceParamPart3 \&= riceParamMask;}
\DoxyCodeLine{3722 }
\DoxyCodeLine{3723             riceParamPart0 |= (zeroCountPart0 << riceParam);}
\DoxyCodeLine{3724             riceParamPart1 |= (zeroCountPart1 << riceParam);}
\DoxyCodeLine{3725             riceParamPart2 |= (zeroCountPart2 << riceParam);}
\DoxyCodeLine{3726             riceParamPart3 |= (zeroCountPart3 << riceParam);}
\DoxyCodeLine{3727 }
\DoxyCodeLine{3728             riceParamPart0  = (riceParamPart0 >> 1) \string^ t[riceParamPart0 \& 0x01];}
\DoxyCodeLine{3729             riceParamPart1  = (riceParamPart1 >> 1) \string^ t[riceParamPart1 \& 0x01];}
\DoxyCodeLine{3730             riceParamPart2  = (riceParamPart2 >> 1) \string^ t[riceParamPart2 \& 0x01];}
\DoxyCodeLine{3731             riceParamPart3  = (riceParamPart3 >> 1) \string^ t[riceParamPart3 \& 0x01];}
\DoxyCodeLine{3732 }
\DoxyCodeLine{3733             pSamplesOut[0] = riceParamPart0 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + 0);}
\DoxyCodeLine{3734             pSamplesOut[1] = riceParamPart1 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + 1);}
\DoxyCodeLine{3735             pSamplesOut[2] = riceParamPart2 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + 2);}
\DoxyCodeLine{3736             pSamplesOut[3] = riceParamPart3 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + 3);}
\DoxyCodeLine{3737 }
\DoxyCodeLine{3738             pSamplesOut += 4;}
\DoxyCodeLine{3739         \}}
\DoxyCodeLine{3740     \}}
\DoxyCodeLine{3741 }
\DoxyCodeLine{3742     i = (count \& \string~3);}
\DoxyCodeLine{3743     \textcolor{keywordflow}{while} (i < count) \{}
\DoxyCodeLine{3744         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{3745         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountPart0, \&riceParamPart0)) \{}
\DoxyCodeLine{3746             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3747         \}}
\DoxyCodeLine{3748 }
\DoxyCodeLine{3749         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{3750         riceParamPart0 \&= riceParamMask;}
\DoxyCodeLine{3751         riceParamPart0 |= (zeroCountPart0 << riceParam);}
\DoxyCodeLine{3752         riceParamPart0  = (riceParamPart0 >> 1) \string^ t[riceParamPart0 \& 0x01];}
\DoxyCodeLine{3753         \textcolor{comment}{/*riceParamPart0  = (riceParamPart0 >> 1) \string^ (\string~(riceParamPart0 \& 0x01) + 1);*/}}
\DoxyCodeLine{3754 }
\DoxyCodeLine{3755         \textcolor{comment}{/* Sample reconstruction. */}}
\DoxyCodeLine{3756         \textcolor{keywordflow}{if} (bitsPerSample+shift > 32) \{}
\DoxyCodeLine{3757             pSamplesOut[0] = riceParamPart0 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + 0);}
\DoxyCodeLine{3758         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3759             pSamplesOut[0] = riceParamPart0 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + 0);}
\DoxyCodeLine{3760         \}}
\DoxyCodeLine{3761 }
\DoxyCodeLine{3762         i += 1;}
\DoxyCodeLine{3763         pSamplesOut += 1;}
\DoxyCodeLine{3764     \}}
\DoxyCodeLine{3765 }
\DoxyCodeLine{3766     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{3767 \}}
\DoxyCodeLine{3768 }
\DoxyCodeLine{3769 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{3770 \textcolor{keyword}{static} DRFLAC\_INLINE \_\_m128i drflac\_\_mm\_packs\_interleaved\_epi32(\_\_m128i a, \_\_m128i b)}
\DoxyCodeLine{3771 \{}
\DoxyCodeLine{3772     \_\_m128i r;}
\DoxyCodeLine{3773 }
\DoxyCodeLine{3774     \textcolor{comment}{/* Pack. */}}
\DoxyCodeLine{3775     r = \_mm\_packs\_epi32(a, b);}
\DoxyCodeLine{3776 }
\DoxyCodeLine{3777     \textcolor{comment}{/* a3a2 a1a0 b3b2 b1b0 -\/> a3a2 b3b2 a1a0 b1b0 */}}
\DoxyCodeLine{3778     r = \_mm\_shuffle\_epi32(r, \_MM\_SHUFFLE(3, 1, 2, 0));}
\DoxyCodeLine{3779 }
\DoxyCodeLine{3780     \textcolor{comment}{/* a3a2 b3b2 a1a0 b1b0 -\/> a3b3 a2b2 a1b1 a0b0 */}}
\DoxyCodeLine{3781     r = \_mm\_shufflehi\_epi16(r, \_MM\_SHUFFLE(3, 1, 2, 0));}
\DoxyCodeLine{3782     r = \_mm\_shufflelo\_epi16(r, \_MM\_SHUFFLE(3, 1, 2, 0));}
\DoxyCodeLine{3783 }
\DoxyCodeLine{3784     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{3785 \}}
\DoxyCodeLine{3786 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3787 }
\DoxyCodeLine{3788 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE41)}}
\DoxyCodeLine{3789 \textcolor{keyword}{static} DRFLAC\_INLINE \_\_m128i drflac\_\_mm\_not\_si128(\_\_m128i a)}
\DoxyCodeLine{3790 \{}
\DoxyCodeLine{3791     \textcolor{keywordflow}{return} \_mm\_xor\_si128(a, \_mm\_cmpeq\_epi32(\_mm\_setzero\_si128(), \_mm\_setzero\_si128()));}
\DoxyCodeLine{3792 \}}
\DoxyCodeLine{3793 }
\DoxyCodeLine{3794 \textcolor{keyword}{static} DRFLAC\_INLINE \_\_m128i drflac\_\_mm\_hadd\_epi32(\_\_m128i x)}
\DoxyCodeLine{3795 \{}
\DoxyCodeLine{3796     \_\_m128i x64 = \_mm\_add\_epi32(x, \_mm\_shuffle\_epi32(x, \_MM\_SHUFFLE(1, 0, 3, 2)));}
\DoxyCodeLine{3797     \_\_m128i x32 = \_mm\_shufflelo\_epi16(x64, \_MM\_SHUFFLE(1, 0, 3, 2));}
\DoxyCodeLine{3798     \textcolor{keywordflow}{return} \_mm\_add\_epi32(x64, x32);}
\DoxyCodeLine{3799 \}}
\DoxyCodeLine{3800 }
\DoxyCodeLine{3801 \textcolor{keyword}{static} DRFLAC\_INLINE \_\_m128i drflac\_\_mm\_hadd\_epi64(\_\_m128i x)}
\DoxyCodeLine{3802 \{}
\DoxyCodeLine{3803     \textcolor{keywordflow}{return} \_mm\_add\_epi64(x, \_mm\_shuffle\_epi32(x, \_MM\_SHUFFLE(1, 0, 3, 2)));}
\DoxyCodeLine{3804 \}}
\DoxyCodeLine{3805 }
\DoxyCodeLine{3806 \textcolor{keyword}{static} DRFLAC\_INLINE \_\_m128i drflac\_\_mm\_srai\_epi64(\_\_m128i x, \textcolor{keywordtype}{int} count)}
\DoxyCodeLine{3807 \{}
\DoxyCodeLine{3808     \textcolor{comment}{/*}}
\DoxyCodeLine{3809 \textcolor{comment}{    To simplify this we are assuming count < 32. This restriction allows us to work on a low side and a high side. The low side}}
\DoxyCodeLine{3810 \textcolor{comment}{    is shifted with zero bits, whereas the right side is shifted with sign bits.}}
\DoxyCodeLine{3811 \textcolor{comment}{    */}}
\DoxyCodeLine{3812     \_\_m128i lo = \_mm\_srli\_epi64(x, count);}
\DoxyCodeLine{3813     \_\_m128i hi = \_mm\_srai\_epi32(x, count);}
\DoxyCodeLine{3814 }
\DoxyCodeLine{3815     hi = \_mm\_and\_si128(hi, \_mm\_set\_epi32(0xFFFFFFFF, 0, 0xFFFFFFFF, 0));    \textcolor{comment}{/* The high part needs to have the low part cleared. */}}
\DoxyCodeLine{3816 }
\DoxyCodeLine{3817     \textcolor{keywordflow}{return} \_mm\_or\_si128(lo, hi);}
\DoxyCodeLine{3818 \}}
\DoxyCodeLine{3819 }
\DoxyCodeLine{3820 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41\_32(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{3821 \{}
\DoxyCodeLine{3822     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3823     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{3824     drflac\_int32* pDecodedSamples    = pSamplesOut;}
\DoxyCodeLine{3825     drflac\_int32* pDecodedSamplesEnd = pSamplesOut + (count \& \string~3);}
\DoxyCodeLine{3826     drflac\_uint32 zeroCountParts0 = 0;}
\DoxyCodeLine{3827     drflac\_uint32 zeroCountParts1 = 0;}
\DoxyCodeLine{3828     drflac\_uint32 zeroCountParts2 = 0;}
\DoxyCodeLine{3829     drflac\_uint32 zeroCountParts3 = 0;}
\DoxyCodeLine{3830     drflac\_uint32 riceParamParts0 = 0;}
\DoxyCodeLine{3831     drflac\_uint32 riceParamParts1 = 0;}
\DoxyCodeLine{3832     drflac\_uint32 riceParamParts2 = 0;}
\DoxyCodeLine{3833     drflac\_uint32 riceParamParts3 = 0;}
\DoxyCodeLine{3834     \_\_m128i coefficients128\_0;}
\DoxyCodeLine{3835     \_\_m128i coefficients128\_4;}
\DoxyCodeLine{3836     \_\_m128i coefficients128\_8;}
\DoxyCodeLine{3837     \_\_m128i samples128\_0;}
\DoxyCodeLine{3838     \_\_m128i samples128\_4;}
\DoxyCodeLine{3839     \_\_m128i samples128\_8;}
\DoxyCodeLine{3840     \_\_m128i riceParamMask128;}
\DoxyCodeLine{3841 }
\DoxyCodeLine{3842     \textcolor{keyword}{const} drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{3843 }
\DoxyCodeLine{3844     riceParamMask    = (drflac\_uint32)\string~((\string~0UL) << riceParam);}
\DoxyCodeLine{3845     riceParamMask128 = \_mm\_set1\_epi32(riceParamMask);}
\DoxyCodeLine{3846 }
\DoxyCodeLine{3847     \textcolor{comment}{/* Pre-\/load. */}}
\DoxyCodeLine{3848     coefficients128\_0 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3849     coefficients128\_4 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3850     coefficients128\_8 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3851 }
\DoxyCodeLine{3852     samples128\_0 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3853     samples128\_4 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3854     samples128\_8 = \_mm\_setzero\_si128();}
\DoxyCodeLine{3855 }
\DoxyCodeLine{3856     \textcolor{comment}{/*}}
\DoxyCodeLine{3857 \textcolor{comment}{    Pre-\/loading the coefficients and prior samples is annoying because we need to ensure we don't try reading more than}}
\DoxyCodeLine{3858 \textcolor{comment}{    what's available in the input buffers. It would be convenient to use a fall-\/through switch to do this, but this results}}
\DoxyCodeLine{3859 \textcolor{comment}{    in strict aliasing warnings with GCC. To work around this I'm just doing something hacky. This feels a bit convoluted}}
\DoxyCodeLine{3860 \textcolor{comment}{    so I think there's opportunity for this to be simplified.}}
\DoxyCodeLine{3861 \textcolor{comment}{    */}}
\DoxyCodeLine{3862 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{3863     \{}
\DoxyCodeLine{3864         \textcolor{keywordtype}{int} runningOrder = order;}
\DoxyCodeLine{3865 }
\DoxyCodeLine{3866         \textcolor{comment}{/* 0 -\/ 3. */}}
\DoxyCodeLine{3867         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{3868             coefficients128\_0 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 0));}
\DoxyCodeLine{3869             samples128\_0      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 4));}
\DoxyCodeLine{3870             runningOrder -\/= 4;}
\DoxyCodeLine{3871         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3872             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{3873                 \textcolor{keywordflow}{case} 3: coefficients128\_0 = \_mm\_set\_epi32(0, coefficients[2], coefficients[1], coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], pSamplesOut[-\/2], pSamplesOut[-\/3], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3874                 \textcolor{keywordflow}{case} 2: coefficients128\_0 = \_mm\_set\_epi32(0, 0,               coefficients[1], coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], pSamplesOut[-\/2], 0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3875                 \textcolor{keywordflow}{case} 1: coefficients128\_0 = \_mm\_set\_epi32(0, 0,               0,               coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], 0,               0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3876             \}}
\DoxyCodeLine{3877             runningOrder = 0;}
\DoxyCodeLine{3878         \}}
\DoxyCodeLine{3879 }
\DoxyCodeLine{3880         \textcolor{comment}{/* 4 -\/ 7 */}}
\DoxyCodeLine{3881         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{3882             coefficients128\_4 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 4));}
\DoxyCodeLine{3883             samples128\_4      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 8));}
\DoxyCodeLine{3884             runningOrder -\/= 4;}
\DoxyCodeLine{3885         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3886             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{3887                 \textcolor{keywordflow}{case} 3: coefficients128\_4 = \_mm\_set\_epi32(0, coefficients[6], coefficients[5], coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], pSamplesOut[-\/6], pSamplesOut[-\/7], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3888                 \textcolor{keywordflow}{case} 2: coefficients128\_4 = \_mm\_set\_epi32(0, 0,               coefficients[5], coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], pSamplesOut[-\/6], 0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3889                 \textcolor{keywordflow}{case} 1: coefficients128\_4 = \_mm\_set\_epi32(0, 0,               0,               coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], 0,               0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3890             \}}
\DoxyCodeLine{3891             runningOrder = 0;}
\DoxyCodeLine{3892         \}}
\DoxyCodeLine{3893 }
\DoxyCodeLine{3894         \textcolor{comment}{/* 8 -\/ 11 */}}
\DoxyCodeLine{3895         \textcolor{keywordflow}{if} (runningOrder == 4) \{}
\DoxyCodeLine{3896             coefficients128\_8 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 8));}
\DoxyCodeLine{3897             samples128\_8      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 12));}
\DoxyCodeLine{3898             runningOrder -\/= 4;}
\DoxyCodeLine{3899         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3900             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{3901                 \textcolor{keywordflow}{case} 3: coefficients128\_8 = \_mm\_set\_epi32(0, coefficients[10], coefficients[9], coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], pSamplesOut[-\/10], pSamplesOut[-\/11], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3902                 \textcolor{keywordflow}{case} 2: coefficients128\_8 = \_mm\_set\_epi32(0, 0,                coefficients[9], coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], pSamplesOut[-\/10], 0,                0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3903                 \textcolor{keywordflow}{case} 1: coefficients128\_8 = \_mm\_set\_epi32(0, 0,                0,               coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], 0,                0,                0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{3904             \}}
\DoxyCodeLine{3905             runningOrder = 0;}
\DoxyCodeLine{3906         \}}
\DoxyCodeLine{3907 }
\DoxyCodeLine{3908         \textcolor{comment}{/* Coefficients need to be shuffled for our streaming algorithm below to work. Samples are already in the correct order from the loading routine above. */}}
\DoxyCodeLine{3909         coefficients128\_0 = \_mm\_shuffle\_epi32(coefficients128\_0, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{3910         coefficients128\_4 = \_mm\_shuffle\_epi32(coefficients128\_4, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{3911         coefficients128\_8 = \_mm\_shuffle\_epi32(coefficients128\_8, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{3912     \}}
\DoxyCodeLine{3913 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3914     \textcolor{comment}{/* This causes strict-\/aliasing warnings with GCC. */}}
\DoxyCodeLine{3915     \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{3916     \{}
\DoxyCodeLine{3917     \textcolor{keywordflow}{case} 12: ((drflac\_int32*)\&coefficients128\_8)[0] = coefficients[11]; ((drflac\_int32*)\&samples128\_8)[0] = pDecodedSamples[-\/12];}
\DoxyCodeLine{3918     \textcolor{keywordflow}{case} 11: ((drflac\_int32*)\&coefficients128\_8)[1] = coefficients[10]; ((drflac\_int32*)\&samples128\_8)[1] = pDecodedSamples[-\/11];}
\DoxyCodeLine{3919     \textcolor{keywordflow}{case} 10: ((drflac\_int32*)\&coefficients128\_8)[2] = coefficients[ 9]; ((drflac\_int32*)\&samples128\_8)[2] = pDecodedSamples[-\/10];}
\DoxyCodeLine{3920     \textcolor{keywordflow}{case} 9:  ((drflac\_int32*)\&coefficients128\_8)[3] = coefficients[ 8]; ((drflac\_int32*)\&samples128\_8)[3] = pDecodedSamples[-\/ 9];}
\DoxyCodeLine{3921     \textcolor{keywordflow}{case} 8:  ((drflac\_int32*)\&coefficients128\_4)[0] = coefficients[ 7]; ((drflac\_int32*)\&samples128\_4)[0] = pDecodedSamples[-\/ 8];}
\DoxyCodeLine{3922     \textcolor{keywordflow}{case} 7:  ((drflac\_int32*)\&coefficients128\_4)[1] = coefficients[ 6]; ((drflac\_int32*)\&samples128\_4)[1] = pDecodedSamples[-\/ 7];}
\DoxyCodeLine{3923     \textcolor{keywordflow}{case} 6:  ((drflac\_int32*)\&coefficients128\_4)[2] = coefficients[ 5]; ((drflac\_int32*)\&samples128\_4)[2] = pDecodedSamples[-\/ 6];}
\DoxyCodeLine{3924     \textcolor{keywordflow}{case} 5:  ((drflac\_int32*)\&coefficients128\_4)[3] = coefficients[ 4]; ((drflac\_int32*)\&samples128\_4)[3] = pDecodedSamples[-\/ 5];}
\DoxyCodeLine{3925     \textcolor{keywordflow}{case} 4:  ((drflac\_int32*)\&coefficients128\_0)[0] = coefficients[ 3]; ((drflac\_int32*)\&samples128\_0)[0] = pDecodedSamples[-\/ 4];}
\DoxyCodeLine{3926     \textcolor{keywordflow}{case} 3:  ((drflac\_int32*)\&coefficients128\_0)[1] = coefficients[ 2]; ((drflac\_int32*)\&samples128\_0)[1] = pDecodedSamples[-\/ 3];}
\DoxyCodeLine{3927     \textcolor{keywordflow}{case} 2:  ((drflac\_int32*)\&coefficients128\_0)[2] = coefficients[ 1]; ((drflac\_int32*)\&samples128\_0)[2] = pDecodedSamples[-\/ 2];}
\DoxyCodeLine{3928     \textcolor{keywordflow}{case} 1:  ((drflac\_int32*)\&coefficients128\_0)[3] = coefficients[ 0]; ((drflac\_int32*)\&samples128\_0)[3] = pDecodedSamples[-\/ 1];}
\DoxyCodeLine{3929     \}}
\DoxyCodeLine{3930 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3931 }
\DoxyCodeLine{3932     \textcolor{comment}{/* For this version we are doing one sample at a time. */}}
\DoxyCodeLine{3933     \textcolor{keywordflow}{while} (pDecodedSamples < pDecodedSamplesEnd) \{}
\DoxyCodeLine{3934         \_\_m128i prediction128;}
\DoxyCodeLine{3935         \_\_m128i zeroCountPart128;}
\DoxyCodeLine{3936         \_\_m128i riceParamPart128;}
\DoxyCodeLine{3937 }
\DoxyCodeLine{3938         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts0, \&riceParamParts0) ||}
\DoxyCodeLine{3939             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts1, \&riceParamParts1) ||}
\DoxyCodeLine{3940             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts2, \&riceParamParts2) ||}
\DoxyCodeLine{3941             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts3, \&riceParamParts3)) \{}
\DoxyCodeLine{3942             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{3943         \}}
\DoxyCodeLine{3944 }
\DoxyCodeLine{3945         zeroCountPart128 = \_mm\_set\_epi32(zeroCountParts3, zeroCountParts2, zeroCountParts1, zeroCountParts0);}
\DoxyCodeLine{3946         riceParamPart128 = \_mm\_set\_epi32(riceParamParts3, riceParamParts2, riceParamParts1, riceParamParts0);}
\DoxyCodeLine{3947 }
\DoxyCodeLine{3948         riceParamPart128 = \_mm\_and\_si128(riceParamPart128, riceParamMask128);}
\DoxyCodeLine{3949         riceParamPart128 = \_mm\_or\_si128(riceParamPart128, \_mm\_slli\_epi32(zeroCountPart128, riceParam));}
\DoxyCodeLine{3950         riceParamPart128 = \_mm\_xor\_si128(\_mm\_srli\_epi32(riceParamPart128, 1), \_mm\_add\_epi32(drflac\_\_mm\_not\_si128(\_mm\_and\_si128(riceParamPart128, \_mm\_set1\_epi32(0x01))), \_mm\_set1\_epi32(0x01)));  \textcolor{comment}{/* <-\/-\/ SSE2 compatible */}}
\DoxyCodeLine{3951         \textcolor{comment}{/*riceParamPart128 = \_mm\_xor\_si128(\_mm\_srli\_epi32(riceParamPart128, 1), \_mm\_mullo\_epi32(\_mm\_and\_si128(riceParamPart128, \_mm\_set1\_epi32(0x01)), \_mm\_set1\_epi32(0xFFFFFFFF)));*/}   \textcolor{comment}{/* <-\/-\/ Only supported from SSE4.1 and is slower in my testing... */}}
\DoxyCodeLine{3952 }
\DoxyCodeLine{3953         \textcolor{keywordflow}{if} (order <= 4) \{}
\DoxyCodeLine{3954             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{3955                 prediction128 = \_mm\_mullo\_epi32(coefficients128\_0, samples128\_0);}
\DoxyCodeLine{3956 }
\DoxyCodeLine{3957                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{3958                 prediction128 = drflac\_\_mm\_hadd\_epi32(prediction128);}
\DoxyCodeLine{3959                 prediction128 = \_mm\_srai\_epi32(prediction128, shift);}
\DoxyCodeLine{3960                 prediction128 = \_mm\_add\_epi32(riceParamPart128, prediction128);}
\DoxyCodeLine{3961 }
\DoxyCodeLine{3962                 samples128\_0 = \_mm\_alignr\_epi8(prediction128, samples128\_0, 4);}
\DoxyCodeLine{3963                 riceParamPart128 = \_mm\_alignr\_epi8(\_mm\_setzero\_si128(), riceParamPart128, 4);}
\DoxyCodeLine{3964             \}}
\DoxyCodeLine{3965         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order <= 8) \{}
\DoxyCodeLine{3966             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{3967                 prediction128 =                              \_mm\_mullo\_epi32(coefficients128\_4, samples128\_4);}
\DoxyCodeLine{3968                 prediction128 = \_mm\_add\_epi32(prediction128, \_mm\_mullo\_epi32(coefficients128\_0, samples128\_0));}
\DoxyCodeLine{3969 }
\DoxyCodeLine{3970                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{3971                 prediction128 = drflac\_\_mm\_hadd\_epi32(prediction128);}
\DoxyCodeLine{3972                 prediction128 = \_mm\_srai\_epi32(prediction128, shift);}
\DoxyCodeLine{3973                 prediction128 = \_mm\_add\_epi32(riceParamPart128, prediction128);}
\DoxyCodeLine{3974 }
\DoxyCodeLine{3975                 samples128\_4 = \_mm\_alignr\_epi8(samples128\_0,  samples128\_4, 4);}
\DoxyCodeLine{3976                 samples128\_0 = \_mm\_alignr\_epi8(prediction128, samples128\_0, 4);}
\DoxyCodeLine{3977                 riceParamPart128 = \_mm\_alignr\_epi8(\_mm\_setzero\_si128(), riceParamPart128, 4);}
\DoxyCodeLine{3978             \}}
\DoxyCodeLine{3979         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3980             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{3981                 prediction128 =                              \_mm\_mullo\_epi32(coefficients128\_8, samples128\_8);}
\DoxyCodeLine{3982                 prediction128 = \_mm\_add\_epi32(prediction128, \_mm\_mullo\_epi32(coefficients128\_4, samples128\_4));}
\DoxyCodeLine{3983                 prediction128 = \_mm\_add\_epi32(prediction128, \_mm\_mullo\_epi32(coefficients128\_0, samples128\_0));}
\DoxyCodeLine{3984 }
\DoxyCodeLine{3985                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{3986                 prediction128 = drflac\_\_mm\_hadd\_epi32(prediction128);}
\DoxyCodeLine{3987                 prediction128 = \_mm\_srai\_epi32(prediction128, shift);}
\DoxyCodeLine{3988                 prediction128 = \_mm\_add\_epi32(riceParamPart128, prediction128);}
\DoxyCodeLine{3989 }
\DoxyCodeLine{3990                 samples128\_8 = \_mm\_alignr\_epi8(samples128\_4,  samples128\_8, 4);}
\DoxyCodeLine{3991                 samples128\_4 = \_mm\_alignr\_epi8(samples128\_0,  samples128\_4, 4);}
\DoxyCodeLine{3992                 samples128\_0 = \_mm\_alignr\_epi8(prediction128, samples128\_0, 4);}
\DoxyCodeLine{3993                 riceParamPart128 = \_mm\_alignr\_epi8(\_mm\_setzero\_si128(), riceParamPart128, 4);}
\DoxyCodeLine{3994             \}}
\DoxyCodeLine{3995         \}}
\DoxyCodeLine{3996 }
\DoxyCodeLine{3997         \textcolor{comment}{/* We store samples in groups of 4. */}}
\DoxyCodeLine{3998         \_mm\_storeu\_si128((\_\_m128i*)pDecodedSamples, samples128\_0);}
\DoxyCodeLine{3999         pDecodedSamples += 4;}
\DoxyCodeLine{4000     \}}
\DoxyCodeLine{4001 }
\DoxyCodeLine{4002     \textcolor{comment}{/* Make sure we process the last few samples. */}}
\DoxyCodeLine{4003     i = (count \& \string~3);}
\DoxyCodeLine{4004     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})count) \{}
\DoxyCodeLine{4005         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{4006         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts0, \&riceParamParts0)) \{}
\DoxyCodeLine{4007             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4008         \}}
\DoxyCodeLine{4009 }
\DoxyCodeLine{4010         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{4011         riceParamParts0 \&= riceParamMask;}
\DoxyCodeLine{4012         riceParamParts0 |= (zeroCountParts0 << riceParam);}
\DoxyCodeLine{4013         riceParamParts0  = (riceParamParts0 >> 1) \string^ t[riceParamParts0 \& 0x01];}
\DoxyCodeLine{4014 }
\DoxyCodeLine{4015         \textcolor{comment}{/* Sample reconstruction. */}}
\DoxyCodeLine{4016         pDecodedSamples[0] = riceParamParts0 + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pDecodedSamples);}
\DoxyCodeLine{4017 }
\DoxyCodeLine{4018         i += 1;}
\DoxyCodeLine{4019         pDecodedSamples += 1;}
\DoxyCodeLine{4020     \}}
\DoxyCodeLine{4021 }
\DoxyCodeLine{4022     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4023 \}}
\DoxyCodeLine{4024 }
\DoxyCodeLine{4025 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41\_64(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4026 \{}
\DoxyCodeLine{4027     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{4028     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{4029     drflac\_int32* pDecodedSamples    = pSamplesOut;}
\DoxyCodeLine{4030     drflac\_int32* pDecodedSamplesEnd = pSamplesOut + (count \& \string~3);}
\DoxyCodeLine{4031     drflac\_uint32 zeroCountParts0 = 0;}
\DoxyCodeLine{4032     drflac\_uint32 zeroCountParts1 = 0;}
\DoxyCodeLine{4033     drflac\_uint32 zeroCountParts2 = 0;}
\DoxyCodeLine{4034     drflac\_uint32 zeroCountParts3 = 0;}
\DoxyCodeLine{4035     drflac\_uint32 riceParamParts0 = 0;}
\DoxyCodeLine{4036     drflac\_uint32 riceParamParts1 = 0;}
\DoxyCodeLine{4037     drflac\_uint32 riceParamParts2 = 0;}
\DoxyCodeLine{4038     drflac\_uint32 riceParamParts3 = 0;}
\DoxyCodeLine{4039     \_\_m128i coefficients128\_0;}
\DoxyCodeLine{4040     \_\_m128i coefficients128\_4;}
\DoxyCodeLine{4041     \_\_m128i coefficients128\_8;}
\DoxyCodeLine{4042     \_\_m128i samples128\_0;}
\DoxyCodeLine{4043     \_\_m128i samples128\_4;}
\DoxyCodeLine{4044     \_\_m128i samples128\_8;}
\DoxyCodeLine{4045     \_\_m128i prediction128;}
\DoxyCodeLine{4046     \_\_m128i riceParamMask128;}
\DoxyCodeLine{4047 }
\DoxyCodeLine{4048     \textcolor{keyword}{const} drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{4049 }
\DoxyCodeLine{4050     DRFLAC\_ASSERT(order <= 12);}
\DoxyCodeLine{4051 }
\DoxyCodeLine{4052     riceParamMask    = (drflac\_uint32)\string~((\string~0UL) << riceParam);}
\DoxyCodeLine{4053     riceParamMask128 = \_mm\_set1\_epi32(riceParamMask);}
\DoxyCodeLine{4054 }
\DoxyCodeLine{4055     prediction128 = \_mm\_setzero\_si128();}
\DoxyCodeLine{4056 }
\DoxyCodeLine{4057     \textcolor{comment}{/* Pre-\/load. */}}
\DoxyCodeLine{4058     coefficients128\_0  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4059     coefficients128\_4  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4060     coefficients128\_8  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4061 }
\DoxyCodeLine{4062     samples128\_0  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4063     samples128\_4  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4064     samples128\_8  = \_mm\_setzero\_si128();}
\DoxyCodeLine{4065 }
\DoxyCodeLine{4066 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{4067     \{}
\DoxyCodeLine{4068         \textcolor{keywordtype}{int} runningOrder = order;}
\DoxyCodeLine{4069 }
\DoxyCodeLine{4070         \textcolor{comment}{/* 0 -\/ 3. */}}
\DoxyCodeLine{4071         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4072             coefficients128\_0 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 0));}
\DoxyCodeLine{4073             samples128\_0      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 4));}
\DoxyCodeLine{4074             runningOrder -\/= 4;}
\DoxyCodeLine{4075         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4076             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4077                 \textcolor{keywordflow}{case} 3: coefficients128\_0 = \_mm\_set\_epi32(0, coefficients[2], coefficients[1], coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], pSamplesOut[-\/2], pSamplesOut[-\/3], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4078                 \textcolor{keywordflow}{case} 2: coefficients128\_0 = \_mm\_set\_epi32(0, 0,               coefficients[1], coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], pSamplesOut[-\/2], 0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4079                 \textcolor{keywordflow}{case} 1: coefficients128\_0 = \_mm\_set\_epi32(0, 0,               0,               coefficients[0]); samples128\_0 = \_mm\_set\_epi32(pSamplesOut[-\/1], 0,               0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4080             \}}
\DoxyCodeLine{4081             runningOrder = 0;}
\DoxyCodeLine{4082         \}}
\DoxyCodeLine{4083 }
\DoxyCodeLine{4084         \textcolor{comment}{/* 4 -\/ 7 */}}
\DoxyCodeLine{4085         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4086             coefficients128\_4 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 4));}
\DoxyCodeLine{4087             samples128\_4      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 8));}
\DoxyCodeLine{4088             runningOrder -\/= 4;}
\DoxyCodeLine{4089         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4090             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4091                 \textcolor{keywordflow}{case} 3: coefficients128\_4 = \_mm\_set\_epi32(0, coefficients[6], coefficients[5], coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], pSamplesOut[-\/6], pSamplesOut[-\/7], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4092                 \textcolor{keywordflow}{case} 2: coefficients128\_4 = \_mm\_set\_epi32(0, 0,               coefficients[5], coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], pSamplesOut[-\/6], 0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4093                 \textcolor{keywordflow}{case} 1: coefficients128\_4 = \_mm\_set\_epi32(0, 0,               0,               coefficients[4]); samples128\_4 = \_mm\_set\_epi32(pSamplesOut[-\/5], 0,               0,               0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4094             \}}
\DoxyCodeLine{4095             runningOrder = 0;}
\DoxyCodeLine{4096         \}}
\DoxyCodeLine{4097 }
\DoxyCodeLine{4098         \textcolor{comment}{/* 8 -\/ 11 */}}
\DoxyCodeLine{4099         \textcolor{keywordflow}{if} (runningOrder == 4) \{}
\DoxyCodeLine{4100             coefficients128\_8 = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(coefficients + 8));}
\DoxyCodeLine{4101             samples128\_8      = \_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)(pSamplesOut  -\/ 12));}
\DoxyCodeLine{4102             runningOrder -\/= 4;}
\DoxyCodeLine{4103         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4104             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4105                 \textcolor{keywordflow}{case} 3: coefficients128\_8 = \_mm\_set\_epi32(0, coefficients[10], coefficients[9], coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], pSamplesOut[-\/10], pSamplesOut[-\/11], 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4106                 \textcolor{keywordflow}{case} 2: coefficients128\_8 = \_mm\_set\_epi32(0, 0,                coefficients[9], coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], pSamplesOut[-\/10], 0,                0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4107                 \textcolor{keywordflow}{case} 1: coefficients128\_8 = \_mm\_set\_epi32(0, 0,                0,               coefficients[8]); samples128\_8 = \_mm\_set\_epi32(pSamplesOut[-\/9], 0,                0,                0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4108             \}}
\DoxyCodeLine{4109             runningOrder = 0;}
\DoxyCodeLine{4110         \}}
\DoxyCodeLine{4111 }
\DoxyCodeLine{4112         \textcolor{comment}{/* Coefficients need to be shuffled for our streaming algorithm below to work. Samples are already in the correct order from the loading routine above. */}}
\DoxyCodeLine{4113         coefficients128\_0 = \_mm\_shuffle\_epi32(coefficients128\_0, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{4114         coefficients128\_4 = \_mm\_shuffle\_epi32(coefficients128\_4, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{4115         coefficients128\_8 = \_mm\_shuffle\_epi32(coefficients128\_8, \_MM\_SHUFFLE(0, 1, 2, 3));}
\DoxyCodeLine{4116     \}}
\DoxyCodeLine{4117 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{4118     \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{4119     \{}
\DoxyCodeLine{4120     \textcolor{keywordflow}{case} 12: ((drflac\_int32*)\&coefficients128\_8)[0] = coefficients[11]; ((drflac\_int32*)\&samples128\_8)[0] = pDecodedSamples[-\/12];}
\DoxyCodeLine{4121     \textcolor{keywordflow}{case} 11: ((drflac\_int32*)\&coefficients128\_8)[1] = coefficients[10]; ((drflac\_int32*)\&samples128\_8)[1] = pDecodedSamples[-\/11];}
\DoxyCodeLine{4122     \textcolor{keywordflow}{case} 10: ((drflac\_int32*)\&coefficients128\_8)[2] = coefficients[ 9]; ((drflac\_int32*)\&samples128\_8)[2] = pDecodedSamples[-\/10];}
\DoxyCodeLine{4123     \textcolor{keywordflow}{case} 9:  ((drflac\_int32*)\&coefficients128\_8)[3] = coefficients[ 8]; ((drflac\_int32*)\&samples128\_8)[3] = pDecodedSamples[-\/ 9];}
\DoxyCodeLine{4124     \textcolor{keywordflow}{case} 8:  ((drflac\_int32*)\&coefficients128\_4)[0] = coefficients[ 7]; ((drflac\_int32*)\&samples128\_4)[0] = pDecodedSamples[-\/ 8];}
\DoxyCodeLine{4125     \textcolor{keywordflow}{case} 7:  ((drflac\_int32*)\&coefficients128\_4)[1] = coefficients[ 6]; ((drflac\_int32*)\&samples128\_4)[1] = pDecodedSamples[-\/ 7];}
\DoxyCodeLine{4126     \textcolor{keywordflow}{case} 6:  ((drflac\_int32*)\&coefficients128\_4)[2] = coefficients[ 5]; ((drflac\_int32*)\&samples128\_4)[2] = pDecodedSamples[-\/ 6];}
\DoxyCodeLine{4127     \textcolor{keywordflow}{case} 5:  ((drflac\_int32*)\&coefficients128\_4)[3] = coefficients[ 4]; ((drflac\_int32*)\&samples128\_4)[3] = pDecodedSamples[-\/ 5];}
\DoxyCodeLine{4128     \textcolor{keywordflow}{case} 4:  ((drflac\_int32*)\&coefficients128\_0)[0] = coefficients[ 3]; ((drflac\_int32*)\&samples128\_0)[0] = pDecodedSamples[-\/ 4];}
\DoxyCodeLine{4129     \textcolor{keywordflow}{case} 3:  ((drflac\_int32*)\&coefficients128\_0)[1] = coefficients[ 2]; ((drflac\_int32*)\&samples128\_0)[1] = pDecodedSamples[-\/ 3];}
\DoxyCodeLine{4130     \textcolor{keywordflow}{case} 2:  ((drflac\_int32*)\&coefficients128\_0)[2] = coefficients[ 1]; ((drflac\_int32*)\&samples128\_0)[2] = pDecodedSamples[-\/ 2];}
\DoxyCodeLine{4131     \textcolor{keywordflow}{case} 1:  ((drflac\_int32*)\&coefficients128\_0)[3] = coefficients[ 0]; ((drflac\_int32*)\&samples128\_0)[3] = pDecodedSamples[-\/ 1];}
\DoxyCodeLine{4132     \}}
\DoxyCodeLine{4133 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4134 }
\DoxyCodeLine{4135     \textcolor{comment}{/* For this version we are doing one sample at a time. */}}
\DoxyCodeLine{4136     \textcolor{keywordflow}{while} (pDecodedSamples < pDecodedSamplesEnd) \{}
\DoxyCodeLine{4137         \_\_m128i zeroCountPart128;}
\DoxyCodeLine{4138         \_\_m128i riceParamPart128;}
\DoxyCodeLine{4139 }
\DoxyCodeLine{4140         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts0, \&riceParamParts0) ||}
\DoxyCodeLine{4141             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts1, \&riceParamParts1) ||}
\DoxyCodeLine{4142             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts2, \&riceParamParts2) ||}
\DoxyCodeLine{4143             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts3, \&riceParamParts3)) \{}
\DoxyCodeLine{4144             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4145         \}}
\DoxyCodeLine{4146 }
\DoxyCodeLine{4147         zeroCountPart128 = \_mm\_set\_epi32(zeroCountParts3, zeroCountParts2, zeroCountParts1, zeroCountParts0);}
\DoxyCodeLine{4148         riceParamPart128 = \_mm\_set\_epi32(riceParamParts3, riceParamParts2, riceParamParts1, riceParamParts0);}
\DoxyCodeLine{4149 }
\DoxyCodeLine{4150         riceParamPart128 = \_mm\_and\_si128(riceParamPart128, riceParamMask128);}
\DoxyCodeLine{4151         riceParamPart128 = \_mm\_or\_si128(riceParamPart128, \_mm\_slli\_epi32(zeroCountPart128, riceParam));}
\DoxyCodeLine{4152         riceParamPart128 = \_mm\_xor\_si128(\_mm\_srli\_epi32(riceParamPart128, 1), \_mm\_add\_epi32(drflac\_\_mm\_not\_si128(\_mm\_and\_si128(riceParamPart128, \_mm\_set1\_epi32(1))), \_mm\_set1\_epi32(1)));}
\DoxyCodeLine{4153 }
\DoxyCodeLine{4154         \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{4155             prediction128 = \_mm\_xor\_si128(prediction128, prediction128);    \textcolor{comment}{/* Reset to 0. */}}
\DoxyCodeLine{4156 }
\DoxyCodeLine{4157             \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{4158             \{}
\DoxyCodeLine{4159             \textcolor{keywordflow}{case} 12:}
\DoxyCodeLine{4160             \textcolor{keywordflow}{case} 11: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_8, \_MM\_SHUFFLE(1, 1, 0, 0)), \_mm\_shuffle\_epi32(samples128\_8, \_MM\_SHUFFLE(1, 1, 0, 0))));}
\DoxyCodeLine{4161             \textcolor{keywordflow}{case} 10:}
\DoxyCodeLine{4162             \textcolor{keywordflow}{case}  9: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_8, \_MM\_SHUFFLE(3, 3, 2, 2)), \_mm\_shuffle\_epi32(samples128\_8, \_MM\_SHUFFLE(3, 3, 2, 2))));}
\DoxyCodeLine{4163             \textcolor{keywordflow}{case}  8:}
\DoxyCodeLine{4164             \textcolor{keywordflow}{case}  7: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_4, \_MM\_SHUFFLE(1, 1, 0, 0)), \_mm\_shuffle\_epi32(samples128\_4, \_MM\_SHUFFLE(1, 1, 0, 0))));}
\DoxyCodeLine{4165             \textcolor{keywordflow}{case}  6:}
\DoxyCodeLine{4166             \textcolor{keywordflow}{case}  5: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_4, \_MM\_SHUFFLE(3, 3, 2, 2)), \_mm\_shuffle\_epi32(samples128\_4, \_MM\_SHUFFLE(3, 3, 2, 2))));}
\DoxyCodeLine{4167             \textcolor{keywordflow}{case}  4:}
\DoxyCodeLine{4168             \textcolor{keywordflow}{case}  3: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_0, \_MM\_SHUFFLE(1, 1, 0, 0)), \_mm\_shuffle\_epi32(samples128\_0, \_MM\_SHUFFLE(1, 1, 0, 0))));}
\DoxyCodeLine{4169             \textcolor{keywordflow}{case}  2:}
\DoxyCodeLine{4170             \textcolor{keywordflow}{case}  1: prediction128 = \_mm\_add\_epi64(prediction128, \_mm\_mul\_epi32(\_mm\_shuffle\_epi32(coefficients128\_0, \_MM\_SHUFFLE(3, 3, 2, 2)), \_mm\_shuffle\_epi32(samples128\_0, \_MM\_SHUFFLE(3, 3, 2, 2))));}
\DoxyCodeLine{4171             \}}
\DoxyCodeLine{4172 }
\DoxyCodeLine{4173             \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{4174             prediction128 = drflac\_\_mm\_hadd\_epi64(prediction128);}
\DoxyCodeLine{4175             prediction128 = drflac\_\_mm\_srai\_epi64(prediction128, shift);}
\DoxyCodeLine{4176             prediction128 = \_mm\_add\_epi32(riceParamPart128, prediction128);}
\DoxyCodeLine{4177 }
\DoxyCodeLine{4178             \textcolor{comment}{/* Our value should be sitting in prediction128[0]. We need to combine this with our SSE samples. */}}
\DoxyCodeLine{4179             samples128\_8 = \_mm\_alignr\_epi8(samples128\_4,  samples128\_8, 4);}
\DoxyCodeLine{4180             samples128\_4 = \_mm\_alignr\_epi8(samples128\_0,  samples128\_4, 4);}
\DoxyCodeLine{4181             samples128\_0 = \_mm\_alignr\_epi8(prediction128, samples128\_0, 4);}
\DoxyCodeLine{4182 }
\DoxyCodeLine{4183             \textcolor{comment}{/* Slide our rice parameter down so that the value in position 0 contains the next one to process. */}}
\DoxyCodeLine{4184             riceParamPart128 = \_mm\_alignr\_epi8(\_mm\_setzero\_si128(), riceParamPart128, 4);}
\DoxyCodeLine{4185         \}}
\DoxyCodeLine{4186 }
\DoxyCodeLine{4187         \textcolor{comment}{/* We store samples in groups of 4. */}}
\DoxyCodeLine{4188         \_mm\_storeu\_si128((\_\_m128i*)pDecodedSamples, samples128\_0);}
\DoxyCodeLine{4189         pDecodedSamples += 4;}
\DoxyCodeLine{4190     \}}
\DoxyCodeLine{4191 }
\DoxyCodeLine{4192     \textcolor{comment}{/* Make sure we process the last few samples. */}}
\DoxyCodeLine{4193     i = (count \& \string~3);}
\DoxyCodeLine{4194     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})count) \{}
\DoxyCodeLine{4195         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{4196         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts0, \&riceParamParts0)) \{}
\DoxyCodeLine{4197             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4198         \}}
\DoxyCodeLine{4199 }
\DoxyCodeLine{4200         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{4201         riceParamParts0 \&= riceParamMask;}
\DoxyCodeLine{4202         riceParamParts0 |= (zeroCountParts0 << riceParam);}
\DoxyCodeLine{4203         riceParamParts0  = (riceParamParts0 >> 1) \string^ t[riceParamParts0 \& 0x01];}
\DoxyCodeLine{4204 }
\DoxyCodeLine{4205         \textcolor{comment}{/* Sample reconstruction. */}}
\DoxyCodeLine{4206         pDecodedSamples[0] = riceParamParts0 + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pDecodedSamples);}
\DoxyCodeLine{4207 }
\DoxyCodeLine{4208         i += 1;}
\DoxyCodeLine{4209         pDecodedSamples += 1;}
\DoxyCodeLine{4210     \}}
\DoxyCodeLine{4211 }
\DoxyCodeLine{4212     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4213 \}}
\DoxyCodeLine{4214 }
\DoxyCodeLine{4215 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4216 \{}
\DoxyCodeLine{4217     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4218     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{4219 }
\DoxyCodeLine{4220     \textcolor{comment}{/* In my testing the order is rarely > 12, so in this case I'm going to simplify the SSE implementation by only handling order <= 12. */}}
\DoxyCodeLine{4221     \textcolor{keywordflow}{if} (order > 0 \&\& order <= 12) \{}
\DoxyCodeLine{4222         \textcolor{keywordflow}{if} (bitsPerSample+shift > 32) \{}
\DoxyCodeLine{4223             \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41\_64(bs, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4224         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4225             \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41\_32(bs, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4226         \}}
\DoxyCodeLine{4227     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4228         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4229     \}}
\DoxyCodeLine{4230 \}}
\DoxyCodeLine{4231 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4232 }
\DoxyCodeLine{4233 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{4234 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_vst2q\_s32(drflac\_int32* p, int32x4x2\_t x)}
\DoxyCodeLine{4235 \{}
\DoxyCodeLine{4236     vst1q\_s32(p+0, x.val[0]);}
\DoxyCodeLine{4237     vst1q\_s32(p+4, x.val[1]);}
\DoxyCodeLine{4238 \}}
\DoxyCodeLine{4239 }
\DoxyCodeLine{4240 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_vst2q\_u32(drflac\_uint32* p, uint32x4x2\_t x)}
\DoxyCodeLine{4241 \{}
\DoxyCodeLine{4242     vst1q\_u32(p+0, x.val[0]);}
\DoxyCodeLine{4243     vst1q\_u32(p+4, x.val[1]);}
\DoxyCodeLine{4244 \}}
\DoxyCodeLine{4245 }
\DoxyCodeLine{4246 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_vst2q\_f32(\textcolor{keywordtype}{float}* p, float32x4x2\_t x)}
\DoxyCodeLine{4247 \{}
\DoxyCodeLine{4248     vst1q\_f32(p+0, x.val[0]);}
\DoxyCodeLine{4249     vst1q\_f32(p+4, x.val[1]);}
\DoxyCodeLine{4250 \}}
\DoxyCodeLine{4251 }
\DoxyCodeLine{4252 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_vst2q\_s16(drflac\_int16* p, int16x4x2\_t x)}
\DoxyCodeLine{4253 \{}
\DoxyCodeLine{4254     vst1q\_s16(p, vcombine\_s16(x.val[0], x.val[1]));}
\DoxyCodeLine{4255 \}}
\DoxyCodeLine{4256 }
\DoxyCodeLine{4257 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_vst2q\_u16(drflac\_uint16* p, uint16x4x2\_t x)}
\DoxyCodeLine{4258 \{}
\DoxyCodeLine{4259     vst1q\_u16(p, vcombine\_u16(x.val[0], x.val[1]));}
\DoxyCodeLine{4260 \}}
\DoxyCodeLine{4261 }
\DoxyCodeLine{4262 \textcolor{keyword}{static} DRFLAC\_INLINE int32x4\_t drflac\_\_vdupq\_n\_s32x4(drflac\_int32 x3, drflac\_int32 x2, drflac\_int32 x1, drflac\_int32 x0)}
\DoxyCodeLine{4263 \{}
\DoxyCodeLine{4264     drflac\_int32 x[4];}
\DoxyCodeLine{4265     x[3] = x3;}
\DoxyCodeLine{4266     x[2] = x2;}
\DoxyCodeLine{4267     x[1] = x1;}
\DoxyCodeLine{4268     x[0] = x0;}
\DoxyCodeLine{4269     \textcolor{keywordflow}{return} vld1q\_s32(x);}
\DoxyCodeLine{4270 \}}
\DoxyCodeLine{4271 }
\DoxyCodeLine{4272 \textcolor{keyword}{static} DRFLAC\_INLINE int32x4\_t drflac\_\_valignrq\_s32\_1(int32x4\_t a, int32x4\_t b)}
\DoxyCodeLine{4273 \{}
\DoxyCodeLine{4274     \textcolor{comment}{/* Equivalent to SSE's \_mm\_alignr\_epi8(a, b, 4) */}}
\DoxyCodeLine{4275 }
\DoxyCodeLine{4276     \textcolor{comment}{/* Reference */}}
\DoxyCodeLine{4277     \textcolor{comment}{/*return drflac\_\_vdupq\_n\_s32x4(}}
\DoxyCodeLine{4278 \textcolor{comment}{        vgetq\_lane\_s32(a, 0),}}
\DoxyCodeLine{4279 \textcolor{comment}{        vgetq\_lane\_s32(b, 3),}}
\DoxyCodeLine{4280 \textcolor{comment}{        vgetq\_lane\_s32(b, 2),}}
\DoxyCodeLine{4281 \textcolor{comment}{        vgetq\_lane\_s32(b, 1)}}
\DoxyCodeLine{4282 \textcolor{comment}{    );*/}}
\DoxyCodeLine{4283 }
\DoxyCodeLine{4284     \textcolor{keywordflow}{return} vextq\_s32(b, a, 1);}
\DoxyCodeLine{4285 \}}
\DoxyCodeLine{4286 }
\DoxyCodeLine{4287 \textcolor{keyword}{static} DRFLAC\_INLINE uint32x4\_t drflac\_\_valignrq\_u32\_1(uint32x4\_t a, uint32x4\_t b)}
\DoxyCodeLine{4288 \{}
\DoxyCodeLine{4289     \textcolor{comment}{/* Equivalent to SSE's \_mm\_alignr\_epi8(a, b, 4) */}}
\DoxyCodeLine{4290 }
\DoxyCodeLine{4291     \textcolor{comment}{/* Reference */}}
\DoxyCodeLine{4292     \textcolor{comment}{/*return drflac\_\_vdupq\_n\_s32x4(}}
\DoxyCodeLine{4293 \textcolor{comment}{        vgetq\_lane\_s32(a, 0),}}
\DoxyCodeLine{4294 \textcolor{comment}{        vgetq\_lane\_s32(b, 3),}}
\DoxyCodeLine{4295 \textcolor{comment}{        vgetq\_lane\_s32(b, 2),}}
\DoxyCodeLine{4296 \textcolor{comment}{        vgetq\_lane\_s32(b, 1)}}
\DoxyCodeLine{4297 \textcolor{comment}{    );*/}}
\DoxyCodeLine{4298 }
\DoxyCodeLine{4299     \textcolor{keywordflow}{return} vextq\_u32(b, a, 1);}
\DoxyCodeLine{4300 \}}
\DoxyCodeLine{4301 }
\DoxyCodeLine{4302 \textcolor{keyword}{static} DRFLAC\_INLINE int32x2\_t drflac\_\_vhaddq\_s32(int32x4\_t x)}
\DoxyCodeLine{4303 \{}
\DoxyCodeLine{4304     \textcolor{comment}{/* The sum must end up in position 0. */}}
\DoxyCodeLine{4305 }
\DoxyCodeLine{4306     \textcolor{comment}{/* Reference */}}
\DoxyCodeLine{4307     \textcolor{comment}{/*return vdupq\_n\_s32(}}
\DoxyCodeLine{4308 \textcolor{comment}{        vgetq\_lane\_s32(x, 3) +}}
\DoxyCodeLine{4309 \textcolor{comment}{        vgetq\_lane\_s32(x, 2) +}}
\DoxyCodeLine{4310 \textcolor{comment}{        vgetq\_lane\_s32(x, 1) +}}
\DoxyCodeLine{4311 \textcolor{comment}{        vgetq\_lane\_s32(x, 0)}}
\DoxyCodeLine{4312 \textcolor{comment}{    );*/}}
\DoxyCodeLine{4313 }
\DoxyCodeLine{4314     int32x2\_t r = vadd\_s32(vget\_high\_s32(x), vget\_low\_s32(x));}
\DoxyCodeLine{4315     \textcolor{keywordflow}{return} vpadd\_s32(r, r);}
\DoxyCodeLine{4316 \}}
\DoxyCodeLine{4317 }
\DoxyCodeLine{4318 \textcolor{keyword}{static} DRFLAC\_INLINE int64x1\_t drflac\_\_vhaddq\_s64(int64x2\_t x)}
\DoxyCodeLine{4319 \{}
\DoxyCodeLine{4320     \textcolor{keywordflow}{return} vadd\_s64(vget\_high\_s64(x), vget\_low\_s64(x));}
\DoxyCodeLine{4321 \}}
\DoxyCodeLine{4322 }
\DoxyCodeLine{4323 \textcolor{keyword}{static} DRFLAC\_INLINE int32x4\_t drflac\_\_vrevq\_s32(int32x4\_t x)}
\DoxyCodeLine{4324 \{}
\DoxyCodeLine{4325     \textcolor{comment}{/* Reference */}}
\DoxyCodeLine{4326     \textcolor{comment}{/*return drflac\_\_vdupq\_n\_s32x4(}}
\DoxyCodeLine{4327 \textcolor{comment}{        vgetq\_lane\_s32(x, 0),}}
\DoxyCodeLine{4328 \textcolor{comment}{        vgetq\_lane\_s32(x, 1),}}
\DoxyCodeLine{4329 \textcolor{comment}{        vgetq\_lane\_s32(x, 2),}}
\DoxyCodeLine{4330 \textcolor{comment}{        vgetq\_lane\_s32(x, 3)}}
\DoxyCodeLine{4331 \textcolor{comment}{    );*/}}
\DoxyCodeLine{4332 }
\DoxyCodeLine{4333     \textcolor{keywordflow}{return} vrev64q\_s32(vcombine\_s32(vget\_high\_s32(x), vget\_low\_s32(x)));}
\DoxyCodeLine{4334 \}}
\DoxyCodeLine{4335 }
\DoxyCodeLine{4336 \textcolor{keyword}{static} DRFLAC\_INLINE int32x4\_t drflac\_\_vnotq\_s32(int32x4\_t x)}
\DoxyCodeLine{4337 \{}
\DoxyCodeLine{4338     \textcolor{keywordflow}{return} veorq\_s32(x, vdupq\_n\_s32(0xFFFFFFFF));}
\DoxyCodeLine{4339 \}}
\DoxyCodeLine{4340 }
\DoxyCodeLine{4341 \textcolor{keyword}{static} DRFLAC\_INLINE uint32x4\_t drflac\_\_vnotq\_u32(uint32x4\_t x)}
\DoxyCodeLine{4342 \{}
\DoxyCodeLine{4343     \textcolor{keywordflow}{return} veorq\_u32(x, vdupq\_n\_u32(0xFFFFFFFF));}
\DoxyCodeLine{4344 \}}
\DoxyCodeLine{4345 }
\DoxyCodeLine{4346 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon\_32(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4347 \{}
\DoxyCodeLine{4348     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{4349     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{4350     drflac\_int32* pDecodedSamples    = pSamplesOut;}
\DoxyCodeLine{4351     drflac\_int32* pDecodedSamplesEnd = pSamplesOut + (count \& \string~3);}
\DoxyCodeLine{4352     drflac\_uint32 zeroCountParts[4];}
\DoxyCodeLine{4353     drflac\_uint32 riceParamParts[4];}
\DoxyCodeLine{4354     int32x4\_t coefficients128\_0;}
\DoxyCodeLine{4355     int32x4\_t coefficients128\_4;}
\DoxyCodeLine{4356     int32x4\_t coefficients128\_8;}
\DoxyCodeLine{4357     int32x4\_t samples128\_0;}
\DoxyCodeLine{4358     int32x4\_t samples128\_4;}
\DoxyCodeLine{4359     int32x4\_t samples128\_8;}
\DoxyCodeLine{4360     uint32x4\_t riceParamMask128;}
\DoxyCodeLine{4361     int32x4\_t riceParam128;}
\DoxyCodeLine{4362     int32x2\_t shift64;}
\DoxyCodeLine{4363     uint32x4\_t one128;}
\DoxyCodeLine{4364 }
\DoxyCodeLine{4365     \textcolor{keyword}{const} drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{4366 }
\DoxyCodeLine{4367     riceParamMask    = \string~((\string~0UL) << riceParam);}
\DoxyCodeLine{4368     riceParamMask128 = vdupq\_n\_u32(riceParamMask);}
\DoxyCodeLine{4369 }
\DoxyCodeLine{4370     riceParam128 = vdupq\_n\_s32(riceParam);}
\DoxyCodeLine{4371     shift64 = vdup\_n\_s32(-\/shift); \textcolor{comment}{/* Negate the shift because we'll be doing a variable shift using vshlq\_s32(). */}}
\DoxyCodeLine{4372     one128 = vdupq\_n\_u32(1);}
\DoxyCodeLine{4373 }
\DoxyCodeLine{4374     \textcolor{comment}{/*}}
\DoxyCodeLine{4375 \textcolor{comment}{    Pre-\/loading the coefficients and prior samples is annoying because we need to ensure we don't try reading more than}}
\DoxyCodeLine{4376 \textcolor{comment}{    what's available in the input buffers. It would be conenient to use a fall-\/through switch to do this, but this results}}
\DoxyCodeLine{4377 \textcolor{comment}{    in strict aliasing warnings with GCC. To work around this I'm just doing something hacky. This feels a bit convoluted}}
\DoxyCodeLine{4378 \textcolor{comment}{    so I think there's opportunity for this to be simplified.}}
\DoxyCodeLine{4379 \textcolor{comment}{    */}}
\DoxyCodeLine{4380     \{}
\DoxyCodeLine{4381         \textcolor{keywordtype}{int} runningOrder = order;}
\DoxyCodeLine{4382         drflac\_int32 tempC[4] = \{0, 0, 0, 0\};}
\DoxyCodeLine{4383         drflac\_int32 tempS[4] = \{0, 0, 0, 0\};}
\DoxyCodeLine{4384 }
\DoxyCodeLine{4385         \textcolor{comment}{/* 0 -\/ 3. */}}
\DoxyCodeLine{4386         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4387             coefficients128\_0 = vld1q\_s32(coefficients + 0);}
\DoxyCodeLine{4388             samples128\_0      = vld1q\_s32(pSamplesOut  -\/ 4);}
\DoxyCodeLine{4389             runningOrder -\/= 4;}
\DoxyCodeLine{4390         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4391             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4392                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[2]; tempS[1] = pSamplesOut[-\/3]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4393                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[1]; tempS[2] = pSamplesOut[-\/2]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4394                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[0]; tempS[3] = pSamplesOut[-\/1]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4395             \}}
\DoxyCodeLine{4396 }
\DoxyCodeLine{4397             coefficients128\_0 = vld1q\_s32(tempC);}
\DoxyCodeLine{4398             samples128\_0      = vld1q\_s32(tempS);}
\DoxyCodeLine{4399             runningOrder = 0;}
\DoxyCodeLine{4400         \}}
\DoxyCodeLine{4401 }
\DoxyCodeLine{4402         \textcolor{comment}{/* 4 -\/ 7 */}}
\DoxyCodeLine{4403         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4404             coefficients128\_4 = vld1q\_s32(coefficients + 4);}
\DoxyCodeLine{4405             samples128\_4      = vld1q\_s32(pSamplesOut  -\/ 8);}
\DoxyCodeLine{4406             runningOrder -\/= 4;}
\DoxyCodeLine{4407         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4408             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4409                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[6]; tempS[1] = pSamplesOut[-\/7]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4410                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[5]; tempS[2] = pSamplesOut[-\/6]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4411                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[4]; tempS[3] = pSamplesOut[-\/5]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4412             \}}
\DoxyCodeLine{4413 }
\DoxyCodeLine{4414             coefficients128\_4 = vld1q\_s32(tempC);}
\DoxyCodeLine{4415             samples128\_4      = vld1q\_s32(tempS);}
\DoxyCodeLine{4416             runningOrder = 0;}
\DoxyCodeLine{4417         \}}
\DoxyCodeLine{4418 }
\DoxyCodeLine{4419         \textcolor{comment}{/* 8 -\/ 11 */}}
\DoxyCodeLine{4420         \textcolor{keywordflow}{if} (runningOrder == 4) \{}
\DoxyCodeLine{4421             coefficients128\_8 = vld1q\_s32(coefficients + 8);}
\DoxyCodeLine{4422             samples128\_8      = vld1q\_s32(pSamplesOut  -\/ 12);}
\DoxyCodeLine{4423             runningOrder -\/= 4;}
\DoxyCodeLine{4424         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4425             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4426                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[10]; tempS[1] = pSamplesOut[-\/11]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4427                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[ 9]; tempS[2] = pSamplesOut[-\/10]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4428                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[ 8]; tempS[3] = pSamplesOut[-\/ 9]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4429             \}}
\DoxyCodeLine{4430 }
\DoxyCodeLine{4431             coefficients128\_8 = vld1q\_s32(tempC);}
\DoxyCodeLine{4432             samples128\_8      = vld1q\_s32(tempS);}
\DoxyCodeLine{4433             runningOrder = 0;}
\DoxyCodeLine{4434         \}}
\DoxyCodeLine{4435 }
\DoxyCodeLine{4436         \textcolor{comment}{/* Coefficients need to be shuffled for our streaming algorithm below to work. Samples are already in the correct order from the loading routine above. */}}
\DoxyCodeLine{4437         coefficients128\_0 = drflac\_\_vrevq\_s32(coefficients128\_0);}
\DoxyCodeLine{4438         coefficients128\_4 = drflac\_\_vrevq\_s32(coefficients128\_4);}
\DoxyCodeLine{4439         coefficients128\_8 = drflac\_\_vrevq\_s32(coefficients128\_8);}
\DoxyCodeLine{4440     \}}
\DoxyCodeLine{4441 }
\DoxyCodeLine{4442     \textcolor{comment}{/* For this version we are doing one sample at a time. */}}
\DoxyCodeLine{4443     \textcolor{keywordflow}{while} (pDecodedSamples < pDecodedSamplesEnd) \{}
\DoxyCodeLine{4444         int32x4\_t prediction128;}
\DoxyCodeLine{4445         int32x2\_t prediction64;}
\DoxyCodeLine{4446         uint32x4\_t zeroCountPart128;}
\DoxyCodeLine{4447         uint32x4\_t riceParamPart128;}
\DoxyCodeLine{4448 }
\DoxyCodeLine{4449         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[0], \&riceParamParts[0]) ||}
\DoxyCodeLine{4450             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[1], \&riceParamParts[1]) ||}
\DoxyCodeLine{4451             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[2], \&riceParamParts[2]) ||}
\DoxyCodeLine{4452             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[3], \&riceParamParts[3])) \{}
\DoxyCodeLine{4453             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4454         \}}
\DoxyCodeLine{4455 }
\DoxyCodeLine{4456         zeroCountPart128 = vld1q\_u32(zeroCountParts);}
\DoxyCodeLine{4457         riceParamPart128 = vld1q\_u32(riceParamParts);}
\DoxyCodeLine{4458 }
\DoxyCodeLine{4459         riceParamPart128 = vandq\_u32(riceParamPart128, riceParamMask128);}
\DoxyCodeLine{4460         riceParamPart128 = vorrq\_u32(riceParamPart128, vshlq\_u32(zeroCountPart128, riceParam128));}
\DoxyCodeLine{4461         riceParamPart128 = veorq\_u32(vshrq\_n\_u32(riceParamPart128, 1), vaddq\_u32(drflac\_\_vnotq\_u32(vandq\_u32(riceParamPart128, one128)), one128));}
\DoxyCodeLine{4462 }
\DoxyCodeLine{4463         \textcolor{keywordflow}{if} (order <= 4) \{}
\DoxyCodeLine{4464             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{4465                 prediction128 = vmulq\_s32(coefficients128\_0, samples128\_0);}
\DoxyCodeLine{4466 }
\DoxyCodeLine{4467                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{4468                 prediction64 = drflac\_\_vhaddq\_s32(prediction128);}
\DoxyCodeLine{4469                 prediction64 = vshl\_s32(prediction64, shift64);}
\DoxyCodeLine{4470                 prediction64 = vadd\_s32(prediction64, vget\_low\_s32(vreinterpretq\_s32\_u32(riceParamPart128)));}
\DoxyCodeLine{4471 }
\DoxyCodeLine{4472                 samples128\_0 = drflac\_\_valignrq\_s32\_1(vcombine\_s32(prediction64, vdup\_n\_s32(0)), samples128\_0);}
\DoxyCodeLine{4473                 riceParamPart128 = drflac\_\_valignrq\_u32\_1(vdupq\_n\_u32(0), riceParamPart128);}
\DoxyCodeLine{4474             \}}
\DoxyCodeLine{4475         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (order <= 8) \{}
\DoxyCodeLine{4476             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{4477                 prediction128 =                vmulq\_s32(coefficients128\_4, samples128\_4);}
\DoxyCodeLine{4478                 prediction128 = vmlaq\_s32(prediction128, coefficients128\_0, samples128\_0);}
\DoxyCodeLine{4479 }
\DoxyCodeLine{4480                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{4481                 prediction64 = drflac\_\_vhaddq\_s32(prediction128);}
\DoxyCodeLine{4482                 prediction64 = vshl\_s32(prediction64, shift64);}
\DoxyCodeLine{4483                 prediction64 = vadd\_s32(prediction64, vget\_low\_s32(vreinterpretq\_s32\_u32(riceParamPart128)));}
\DoxyCodeLine{4484 }
\DoxyCodeLine{4485                 samples128\_4 = drflac\_\_valignrq\_s32\_1(samples128\_0, samples128\_4);}
\DoxyCodeLine{4486                 samples128\_0 = drflac\_\_valignrq\_s32\_1(vcombine\_s32(prediction64, vdup\_n\_s32(0)), samples128\_0);}
\DoxyCodeLine{4487                 riceParamPart128 = drflac\_\_valignrq\_u32\_1(vdupq\_n\_u32(0), riceParamPart128);}
\DoxyCodeLine{4488             \}}
\DoxyCodeLine{4489         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4490             \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{4491                 prediction128 =                vmulq\_s32(coefficients128\_8, samples128\_8);}
\DoxyCodeLine{4492                 prediction128 = vmlaq\_s32(prediction128, coefficients128\_4, samples128\_4);}
\DoxyCodeLine{4493                 prediction128 = vmlaq\_s32(prediction128, coefficients128\_0, samples128\_0);}
\DoxyCodeLine{4494 }
\DoxyCodeLine{4495                 \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{4496                 prediction64 = drflac\_\_vhaddq\_s32(prediction128);}
\DoxyCodeLine{4497                 prediction64 = vshl\_s32(prediction64, shift64);}
\DoxyCodeLine{4498                 prediction64 = vadd\_s32(prediction64, vget\_low\_s32(vreinterpretq\_s32\_u32(riceParamPart128)));}
\DoxyCodeLine{4499 }
\DoxyCodeLine{4500                 samples128\_8 = drflac\_\_valignrq\_s32\_1(samples128\_4, samples128\_8);}
\DoxyCodeLine{4501                 samples128\_4 = drflac\_\_valignrq\_s32\_1(samples128\_0, samples128\_4);}
\DoxyCodeLine{4502                 samples128\_0 = drflac\_\_valignrq\_s32\_1(vcombine\_s32(prediction64, vdup\_n\_s32(0)), samples128\_0);}
\DoxyCodeLine{4503                 riceParamPart128 = drflac\_\_valignrq\_u32\_1(vdupq\_n\_u32(0), riceParamPart128);}
\DoxyCodeLine{4504             \}}
\DoxyCodeLine{4505         \}}
\DoxyCodeLine{4506 }
\DoxyCodeLine{4507         \textcolor{comment}{/* We store samples in groups of 4. */}}
\DoxyCodeLine{4508         vst1q\_s32(pDecodedSamples, samples128\_0);}
\DoxyCodeLine{4509         pDecodedSamples += 4;}
\DoxyCodeLine{4510     \}}
\DoxyCodeLine{4511 }
\DoxyCodeLine{4512     \textcolor{comment}{/* Make sure we process the last few samples. */}}
\DoxyCodeLine{4513     i = (count \& \string~3);}
\DoxyCodeLine{4514     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})count) \{}
\DoxyCodeLine{4515         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{4516         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[0], \&riceParamParts[0])) \{}
\DoxyCodeLine{4517             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4518         \}}
\DoxyCodeLine{4519 }
\DoxyCodeLine{4520         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{4521         riceParamParts[0] \&= riceParamMask;}
\DoxyCodeLine{4522         riceParamParts[0] |= (zeroCountParts[0] << riceParam);}
\DoxyCodeLine{4523         riceParamParts[0]  = (riceParamParts[0] >> 1) \string^ t[riceParamParts[0] \& 0x01];}
\DoxyCodeLine{4524 }
\DoxyCodeLine{4525         \textcolor{comment}{/* Sample reconstruction. */}}
\DoxyCodeLine{4526         pDecodedSamples[0] = riceParamParts[0] + drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pDecodedSamples);}
\DoxyCodeLine{4527 }
\DoxyCodeLine{4528         i += 1;}
\DoxyCodeLine{4529         pDecodedSamples += 1;}
\DoxyCodeLine{4530     \}}
\DoxyCodeLine{4531 }
\DoxyCodeLine{4532     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4533 \}}
\DoxyCodeLine{4534 }
\DoxyCodeLine{4535 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon\_64(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4536 \{}
\DoxyCodeLine{4537     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{4538     drflac\_uint32 riceParamMask;}
\DoxyCodeLine{4539     drflac\_int32* pDecodedSamples    = pSamplesOut;}
\DoxyCodeLine{4540     drflac\_int32* pDecodedSamplesEnd = pSamplesOut + (count \& \string~3);}
\DoxyCodeLine{4541     drflac\_uint32 zeroCountParts[4];}
\DoxyCodeLine{4542     drflac\_uint32 riceParamParts[4];}
\DoxyCodeLine{4543     int32x4\_t coefficients128\_0;}
\DoxyCodeLine{4544     int32x4\_t coefficients128\_4;}
\DoxyCodeLine{4545     int32x4\_t coefficients128\_8;}
\DoxyCodeLine{4546     int32x4\_t samples128\_0;}
\DoxyCodeLine{4547     int32x4\_t samples128\_4;}
\DoxyCodeLine{4548     int32x4\_t samples128\_8;}
\DoxyCodeLine{4549     uint32x4\_t riceParamMask128;}
\DoxyCodeLine{4550     int32x4\_t riceParam128;}
\DoxyCodeLine{4551     int64x1\_t shift64;}
\DoxyCodeLine{4552     uint32x4\_t one128;}
\DoxyCodeLine{4553 }
\DoxyCodeLine{4554     \textcolor{keyword}{const} drflac\_uint32 t[2] = \{0x00000000, 0xFFFFFFFF\};}
\DoxyCodeLine{4555 }
\DoxyCodeLine{4556     riceParamMask    = \string~((\string~0UL) << riceParam);}
\DoxyCodeLine{4557     riceParamMask128 = vdupq\_n\_u32(riceParamMask);}
\DoxyCodeLine{4558 }
\DoxyCodeLine{4559     riceParam128 = vdupq\_n\_s32(riceParam);}
\DoxyCodeLine{4560     shift64 = vdup\_n\_s64(-\/shift); \textcolor{comment}{/* Negate the shift because we'll be doing a variable shift using vshlq\_s32(). */}}
\DoxyCodeLine{4561     one128 = vdupq\_n\_u32(1);}
\DoxyCodeLine{4562 }
\DoxyCodeLine{4563     \textcolor{comment}{/*}}
\DoxyCodeLine{4564 \textcolor{comment}{    Pre-\/loading the coefficients and prior samples is annoying because we need to ensure we don't try reading more than}}
\DoxyCodeLine{4565 \textcolor{comment}{    what's available in the input buffers. It would be conenient to use a fall-\/through switch to do this, but this results}}
\DoxyCodeLine{4566 \textcolor{comment}{    in strict aliasing warnings with GCC. To work around this I'm just doing something hacky. This feels a bit convoluted}}
\DoxyCodeLine{4567 \textcolor{comment}{    so I think there's opportunity for this to be simplified.}}
\DoxyCodeLine{4568 \textcolor{comment}{    */}}
\DoxyCodeLine{4569     \{}
\DoxyCodeLine{4570         \textcolor{keywordtype}{int} runningOrder = order;}
\DoxyCodeLine{4571         drflac\_int32 tempC[4] = \{0, 0, 0, 0\};}
\DoxyCodeLine{4572         drflac\_int32 tempS[4] = \{0, 0, 0, 0\};}
\DoxyCodeLine{4573 }
\DoxyCodeLine{4574         \textcolor{comment}{/* 0 -\/ 3. */}}
\DoxyCodeLine{4575         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4576             coefficients128\_0 = vld1q\_s32(coefficients + 0);}
\DoxyCodeLine{4577             samples128\_0      = vld1q\_s32(pSamplesOut  -\/ 4);}
\DoxyCodeLine{4578             runningOrder -\/= 4;}
\DoxyCodeLine{4579         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4580             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4581                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[2]; tempS[1] = pSamplesOut[-\/3]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4582                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[1]; tempS[2] = pSamplesOut[-\/2]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4583                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[0]; tempS[3] = pSamplesOut[-\/1]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4584             \}}
\DoxyCodeLine{4585 }
\DoxyCodeLine{4586             coefficients128\_0 = vld1q\_s32(tempC);}
\DoxyCodeLine{4587             samples128\_0      = vld1q\_s32(tempS);}
\DoxyCodeLine{4588             runningOrder = 0;}
\DoxyCodeLine{4589         \}}
\DoxyCodeLine{4590 }
\DoxyCodeLine{4591         \textcolor{comment}{/* 4 -\/ 7 */}}
\DoxyCodeLine{4592         \textcolor{keywordflow}{if} (runningOrder >= 4) \{}
\DoxyCodeLine{4593             coefficients128\_4 = vld1q\_s32(coefficients + 4);}
\DoxyCodeLine{4594             samples128\_4      = vld1q\_s32(pSamplesOut  -\/ 8);}
\DoxyCodeLine{4595             runningOrder -\/= 4;}
\DoxyCodeLine{4596         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4597             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4598                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[6]; tempS[1] = pSamplesOut[-\/7]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4599                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[5]; tempS[2] = pSamplesOut[-\/6]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4600                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[4]; tempS[3] = pSamplesOut[-\/5]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4601             \}}
\DoxyCodeLine{4602 }
\DoxyCodeLine{4603             coefficients128\_4 = vld1q\_s32(tempC);}
\DoxyCodeLine{4604             samples128\_4      = vld1q\_s32(tempS);}
\DoxyCodeLine{4605             runningOrder = 0;}
\DoxyCodeLine{4606         \}}
\DoxyCodeLine{4607 }
\DoxyCodeLine{4608         \textcolor{comment}{/* 8 -\/ 11 */}}
\DoxyCodeLine{4609         \textcolor{keywordflow}{if} (runningOrder == 4) \{}
\DoxyCodeLine{4610             coefficients128\_8 = vld1q\_s32(coefficients + 8);}
\DoxyCodeLine{4611             samples128\_8      = vld1q\_s32(pSamplesOut  -\/ 12);}
\DoxyCodeLine{4612             runningOrder -\/= 4;}
\DoxyCodeLine{4613         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4614             \textcolor{keywordflow}{switch} (runningOrder) \{}
\DoxyCodeLine{4615                 \textcolor{keywordflow}{case} 3: tempC[2] = coefficients[10]; tempS[1] = pSamplesOut[-\/11]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4616                 \textcolor{keywordflow}{case} 2: tempC[1] = coefficients[ 9]; tempS[2] = pSamplesOut[-\/10]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4617                 \textcolor{keywordflow}{case} 1: tempC[0] = coefficients[ 8]; tempS[3] = pSamplesOut[-\/ 9]; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{4618             \}}
\DoxyCodeLine{4619 }
\DoxyCodeLine{4620             coefficients128\_8 = vld1q\_s32(tempC);}
\DoxyCodeLine{4621             samples128\_8      = vld1q\_s32(tempS);}
\DoxyCodeLine{4622             runningOrder = 0;}
\DoxyCodeLine{4623         \}}
\DoxyCodeLine{4624 }
\DoxyCodeLine{4625         \textcolor{comment}{/* Coefficients need to be shuffled for our streaming algorithm below to work. Samples are already in the correct order from the loading routine above. */}}
\DoxyCodeLine{4626         coefficients128\_0 = drflac\_\_vrevq\_s32(coefficients128\_0);}
\DoxyCodeLine{4627         coefficients128\_4 = drflac\_\_vrevq\_s32(coefficients128\_4);}
\DoxyCodeLine{4628         coefficients128\_8 = drflac\_\_vrevq\_s32(coefficients128\_8);}
\DoxyCodeLine{4629     \}}
\DoxyCodeLine{4630 }
\DoxyCodeLine{4631     \textcolor{comment}{/* For this version we are doing one sample at a time. */}}
\DoxyCodeLine{4632     \textcolor{keywordflow}{while} (pDecodedSamples < pDecodedSamplesEnd) \{}
\DoxyCodeLine{4633         int64x2\_t prediction128;}
\DoxyCodeLine{4634         uint32x4\_t zeroCountPart128;}
\DoxyCodeLine{4635         uint32x4\_t riceParamPart128;}
\DoxyCodeLine{4636 }
\DoxyCodeLine{4637         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[0], \&riceParamParts[0]) ||}
\DoxyCodeLine{4638             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[1], \&riceParamParts[1]) ||}
\DoxyCodeLine{4639             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[2], \&riceParamParts[2]) ||}
\DoxyCodeLine{4640             !drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[3], \&riceParamParts[3])) \{}
\DoxyCodeLine{4641             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4642         \}}
\DoxyCodeLine{4643 }
\DoxyCodeLine{4644         zeroCountPart128 = vld1q\_u32(zeroCountParts);}
\DoxyCodeLine{4645         riceParamPart128 = vld1q\_u32(riceParamParts);}
\DoxyCodeLine{4646 }
\DoxyCodeLine{4647         riceParamPart128 = vandq\_u32(riceParamPart128, riceParamMask128);}
\DoxyCodeLine{4648         riceParamPart128 = vorrq\_u32(riceParamPart128, vshlq\_u32(zeroCountPart128, riceParam128));}
\DoxyCodeLine{4649         riceParamPart128 = veorq\_u32(vshrq\_n\_u32(riceParamPart128, 1), vaddq\_u32(drflac\_\_vnotq\_u32(vandq\_u32(riceParamPart128, one128)), one128));}
\DoxyCodeLine{4650 }
\DoxyCodeLine{4651         \textcolor{keywordflow}{for} (i = 0; i < 4; i += 1) \{}
\DoxyCodeLine{4652             int64x1\_t prediction64;}
\DoxyCodeLine{4653 }
\DoxyCodeLine{4654             prediction128 = veorq\_s64(prediction128, prediction128);    \textcolor{comment}{/* Reset to 0. */}}
\DoxyCodeLine{4655             \textcolor{keywordflow}{switch} (order)}
\DoxyCodeLine{4656             \{}
\DoxyCodeLine{4657             \textcolor{keywordflow}{case} 12:}
\DoxyCodeLine{4658             \textcolor{keywordflow}{case} 11: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_low\_s32(coefficients128\_8), vget\_low\_s32(samples128\_8)));}
\DoxyCodeLine{4659             \textcolor{keywordflow}{case} 10:}
\DoxyCodeLine{4660             \textcolor{keywordflow}{case}  9: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_high\_s32(coefficients128\_8), vget\_high\_s32(samples128\_8)));}
\DoxyCodeLine{4661             \textcolor{keywordflow}{case}  8:}
\DoxyCodeLine{4662             \textcolor{keywordflow}{case}  7: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_low\_s32(coefficients128\_4), vget\_low\_s32(samples128\_4)));}
\DoxyCodeLine{4663             \textcolor{keywordflow}{case}  6:}
\DoxyCodeLine{4664             \textcolor{keywordflow}{case}  5: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_high\_s32(coefficients128\_4), vget\_high\_s32(samples128\_4)));}
\DoxyCodeLine{4665             \textcolor{keywordflow}{case}  4:}
\DoxyCodeLine{4666             \textcolor{keywordflow}{case}  3: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_low\_s32(coefficients128\_0), vget\_low\_s32(samples128\_0)));}
\DoxyCodeLine{4667             \textcolor{keywordflow}{case}  2:}
\DoxyCodeLine{4668             \textcolor{keywordflow}{case}  1: prediction128 = vaddq\_s64(prediction128, vmull\_s32(vget\_high\_s32(coefficients128\_0), vget\_high\_s32(samples128\_0)));}
\DoxyCodeLine{4669             \}}
\DoxyCodeLine{4670 }
\DoxyCodeLine{4671             \textcolor{comment}{/* Horizontal add and shift. */}}
\DoxyCodeLine{4672             prediction64 = drflac\_\_vhaddq\_s64(prediction128);}
\DoxyCodeLine{4673             prediction64 = vshl\_s64(prediction64, shift64);}
\DoxyCodeLine{4674             prediction64 = vadd\_s64(prediction64, vdup\_n\_s64(vgetq\_lane\_u32(riceParamPart128, 0)));}
\DoxyCodeLine{4675 }
\DoxyCodeLine{4676             \textcolor{comment}{/* Our value should be sitting in prediction64[0]. We need to combine this with our SSE samples. */}}
\DoxyCodeLine{4677             samples128\_8 = drflac\_\_valignrq\_s32\_1(samples128\_4, samples128\_8);}
\DoxyCodeLine{4678             samples128\_4 = drflac\_\_valignrq\_s32\_1(samples128\_0, samples128\_4);}
\DoxyCodeLine{4679             samples128\_0 = drflac\_\_valignrq\_s32\_1(vcombine\_s32(vreinterpret\_s32\_s64(prediction64), vdup\_n\_s32(0)), samples128\_0);}
\DoxyCodeLine{4680 }
\DoxyCodeLine{4681             \textcolor{comment}{/* Slide our rice parameter down so that the value in position 0 contains the next one to process. */}}
\DoxyCodeLine{4682             riceParamPart128 = drflac\_\_valignrq\_u32\_1(vdupq\_n\_u32(0), riceParamPart128);}
\DoxyCodeLine{4683         \}}
\DoxyCodeLine{4684 }
\DoxyCodeLine{4685         \textcolor{comment}{/* We store samples in groups of 4. */}}
\DoxyCodeLine{4686         vst1q\_s32(pDecodedSamples, samples128\_0);}
\DoxyCodeLine{4687         pDecodedSamples += 4;}
\DoxyCodeLine{4688     \}}
\DoxyCodeLine{4689 }
\DoxyCodeLine{4690     \textcolor{comment}{/* Make sure we process the last few samples. */}}
\DoxyCodeLine{4691     i = (count \& \string~3);}
\DoxyCodeLine{4692     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{int})count) \{}
\DoxyCodeLine{4693         \textcolor{comment}{/* Rice extraction. */}}
\DoxyCodeLine{4694         \textcolor{keywordflow}{if} (!drflac\_\_read\_rice\_parts\_x1(bs, riceParam, \&zeroCountParts[0], \&riceParamParts[0])) \{}
\DoxyCodeLine{4695             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4696         \}}
\DoxyCodeLine{4697 }
\DoxyCodeLine{4698         \textcolor{comment}{/* Rice reconstruction. */}}
\DoxyCodeLine{4699         riceParamParts[0] \&= riceParamMask;}
\DoxyCodeLine{4700         riceParamParts[0] |= (zeroCountParts[0] << riceParam);}
\DoxyCodeLine{4701         riceParamParts[0]  = (riceParamParts[0] >> 1) \string^ t[riceParamParts[0] \& 0x01];}
\DoxyCodeLine{4702 }
\DoxyCodeLine{4703         \textcolor{comment}{/* Sample reconstruction. */}}
\DoxyCodeLine{4704         pDecodedSamples[0] = riceParamParts[0] + drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pDecodedSamples);}
\DoxyCodeLine{4705 }
\DoxyCodeLine{4706         i += 1;}
\DoxyCodeLine{4707         pDecodedSamples += 1;}
\DoxyCodeLine{4708     \}}
\DoxyCodeLine{4709 }
\DoxyCodeLine{4710     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4711 \}}
\DoxyCodeLine{4712 }
\DoxyCodeLine{4713 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4714 \{}
\DoxyCodeLine{4715     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4716     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{4717 }
\DoxyCodeLine{4718     \textcolor{comment}{/* In my testing the order is rarely > 12, so in this case I'm going to simplify the NEON implementation by only handling order <= 12. */}}
\DoxyCodeLine{4719     \textcolor{keywordflow}{if} (order > 0 \&\& order <= 12) \{}
\DoxyCodeLine{4720         \textcolor{keywordflow}{if} (bitsPerSample+shift > 32) \{}
\DoxyCodeLine{4721             \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon\_64(bs, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4722         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4723             \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon\_32(bs, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4724         \}}
\DoxyCodeLine{4725     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4726         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4727     \}}
\DoxyCodeLine{4728 \}}
\DoxyCodeLine{4729 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4730 }
\DoxyCodeLine{4731 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_rice(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 riceParam, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4732 \{}
\DoxyCodeLine{4733 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE41)}}
\DoxyCodeLine{4734     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE41Supported) \{}
\DoxyCodeLine{4735         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_sse41(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4736     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{4737 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{4738     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported) \{}
\DoxyCodeLine{4739         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_neon(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4740     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{4741 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4742     \{}
\DoxyCodeLine{4743         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{4744 \textcolor{preprocessor}{    \#if 0}}
\DoxyCodeLine{4745         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_reference(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4746 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{4747         \textcolor{keywordflow}{return} drflac\_\_decode\_samples\_with\_residual\_\_rice\_\_scalar(bs, bitsPerSample, count, riceParam, order, shift, coefficients, pSamplesOut);}
\DoxyCodeLine{4748 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{4749     \}}
\DoxyCodeLine{4750 \}}
\DoxyCodeLine{4751 }
\DoxyCodeLine{4752 \textcolor{comment}{/* Reads and seeks past a string of residual values as Rice codes. The decoder should be sitting on the first bit of the Rice codes. */}}
\DoxyCodeLine{4753 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_and\_seek\_residual\_\_rice(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 count, drflac\_uint8 riceParam)}
\DoxyCodeLine{4754 \{}
\DoxyCodeLine{4755     drflac\_uint32 i;}
\DoxyCodeLine{4756 }
\DoxyCodeLine{4757     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4758 }
\DoxyCodeLine{4759     \textcolor{keywordflow}{for} (i = 0; i < count; ++i) \{}
\DoxyCodeLine{4760         \textcolor{keywordflow}{if} (!drflac\_\_seek\_rice\_parts(bs, riceParam)) \{}
\DoxyCodeLine{4761             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4762         \}}
\DoxyCodeLine{4763     \}}
\DoxyCodeLine{4764 }
\DoxyCodeLine{4765     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4766 \}}
\DoxyCodeLine{4767 }
\DoxyCodeLine{4768 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual\_\_unencoded(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 count, drflac\_uint8 unencodedBitsPerSample, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pSamplesOut)}
\DoxyCodeLine{4769 \{}
\DoxyCodeLine{4770     drflac\_uint32 i;}
\DoxyCodeLine{4771 }
\DoxyCodeLine{4772     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4773     DRFLAC\_ASSERT(unencodedBitsPerSample <= 31);    \textcolor{comment}{/* <-\/-\/ unencodedBitsPerSample is a 5 bit number, so cannot exceed 31. */}}
\DoxyCodeLine{4774     DRFLAC\_ASSERT(pSamplesOut != NULL);}
\DoxyCodeLine{4775 }
\DoxyCodeLine{4776     \textcolor{keywordflow}{for} (i = 0; i < count; ++i) \{}
\DoxyCodeLine{4777         \textcolor{keywordflow}{if} (unencodedBitsPerSample > 0) \{}
\DoxyCodeLine{4778             \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, unencodedBitsPerSample, pSamplesOut + i)) \{}
\DoxyCodeLine{4779                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4780             \}}
\DoxyCodeLine{4781         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4782             pSamplesOut[i] = 0;}
\DoxyCodeLine{4783         \}}
\DoxyCodeLine{4784 }
\DoxyCodeLine{4785         \textcolor{keywordflow}{if} (bitsPerSample >= 24) \{}
\DoxyCodeLine{4786             pSamplesOut[i] += drflac\_\_calculate\_prediction\_64(order, shift, coefficients, pSamplesOut + i);}
\DoxyCodeLine{4787         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4788             pSamplesOut[i] += drflac\_\_calculate\_prediction\_32(order, shift, coefficients, pSamplesOut + i);}
\DoxyCodeLine{4789         \}}
\DoxyCodeLine{4790     \}}
\DoxyCodeLine{4791 }
\DoxyCodeLine{4792     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4793 \}}
\DoxyCodeLine{4794 }
\DoxyCodeLine{4795 }
\DoxyCodeLine{4796 \textcolor{comment}{/*}}
\DoxyCodeLine{4797 \textcolor{comment}{Reads and decodes the residual for the sub-\/frame the decoder is currently sitting on. This function should be called}}
\DoxyCodeLine{4798 \textcolor{comment}{when the decoder is sitting at the very start of the RESIDUAL block. The first <order> residuals will be ignored. The}}
\DoxyCodeLine{4799 \textcolor{comment}{<blockSize> and <order> parameters are used to determine how many residual values need to be decoded.}}
\DoxyCodeLine{4800 \textcolor{comment}{*/}}
\DoxyCodeLine{4801 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_with\_residual(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 bitsPerSample, drflac\_uint32 blockSize, drflac\_uint32 order, drflac\_int32 shift, \textcolor{keyword}{const} drflac\_int32* coefficients, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{4802 \{}
\DoxyCodeLine{4803     drflac\_uint8 residualMethod;}
\DoxyCodeLine{4804     drflac\_uint8 partitionOrder;}
\DoxyCodeLine{4805     drflac\_uint32 samplesInPartition;}
\DoxyCodeLine{4806     drflac\_uint32 partitionsRemaining;}
\DoxyCodeLine{4807 }
\DoxyCodeLine{4808     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4809     DRFLAC\_ASSERT(blockSize != 0);}
\DoxyCodeLine{4810     DRFLAC\_ASSERT(pDecodedSamples != NULL);       \textcolor{comment}{/* <-\/-\/ Should we allow NULL, in which case we just seek past the residual rather than do a full decode? */}}
\DoxyCodeLine{4811 }
\DoxyCodeLine{4812     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 2, \&residualMethod)) \{}
\DoxyCodeLine{4813         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4814     \}}
\DoxyCodeLine{4815 }
\DoxyCodeLine{4816     \textcolor{keywordflow}{if} (residualMethod != DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE \&\& residualMethod != DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE2) \{}
\DoxyCodeLine{4817         \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Unknown or unsupported residual coding method. */}}
\DoxyCodeLine{4818     \}}
\DoxyCodeLine{4819 }
\DoxyCodeLine{4820     \textcolor{comment}{/* Ignore the first <order> values. */}}
\DoxyCodeLine{4821     pDecodedSamples += order;}
\DoxyCodeLine{4822 }
\DoxyCodeLine{4823     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&partitionOrder)) \{}
\DoxyCodeLine{4824         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4825     \}}
\DoxyCodeLine{4826 }
\DoxyCodeLine{4827     \textcolor{comment}{/*}}
\DoxyCodeLine{4828 \textcolor{comment}{    From the FLAC spec:}}
\DoxyCodeLine{4829 \textcolor{comment}{      The Rice partition order in a Rice-\/coded residual section must be less than or equal to 8.}}
\DoxyCodeLine{4830 \textcolor{comment}{    */}}
\DoxyCodeLine{4831     \textcolor{keywordflow}{if} (partitionOrder > 8) \{}
\DoxyCodeLine{4832         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4833     \}}
\DoxyCodeLine{4834 }
\DoxyCodeLine{4835     \textcolor{comment}{/* Validation check. */}}
\DoxyCodeLine{4836     \textcolor{keywordflow}{if} ((blockSize / (1 << partitionOrder)) < order) \{}
\DoxyCodeLine{4837         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4838     \}}
\DoxyCodeLine{4839 }
\DoxyCodeLine{4840     samplesInPartition = (blockSize / (1 << partitionOrder)) -\/ order;}
\DoxyCodeLine{4841     partitionsRemaining = (1 << partitionOrder);}
\DoxyCodeLine{4842     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{4843         drflac\_uint8 riceParam = 0;}
\DoxyCodeLine{4844         \textcolor{keywordflow}{if} (residualMethod == DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE) \{}
\DoxyCodeLine{4845             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&riceParam)) \{}
\DoxyCodeLine{4846                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4847             \}}
\DoxyCodeLine{4848             \textcolor{keywordflow}{if} (riceParam == 15) \{}
\DoxyCodeLine{4849                 riceParam = 0xFF;}
\DoxyCodeLine{4850             \}}
\DoxyCodeLine{4851         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (residualMethod == DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE2) \{}
\DoxyCodeLine{4852             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 5, \&riceParam)) \{}
\DoxyCodeLine{4853                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4854             \}}
\DoxyCodeLine{4855             \textcolor{keywordflow}{if} (riceParam == 31) \{}
\DoxyCodeLine{4856                 riceParam = 0xFF;}
\DoxyCodeLine{4857             \}}
\DoxyCodeLine{4858         \}}
\DoxyCodeLine{4859 }
\DoxyCodeLine{4860         \textcolor{keywordflow}{if} (riceParam != 0xFF) \{}
\DoxyCodeLine{4861             \textcolor{keywordflow}{if} (!drflac\_\_decode\_samples\_with\_residual\_\_rice(bs, bitsPerSample, samplesInPartition, riceParam, order, shift, coefficients, pDecodedSamples)) \{}
\DoxyCodeLine{4862                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4863             \}}
\DoxyCodeLine{4864         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4865             drflac\_uint8 unencodedBitsPerSample = 0;}
\DoxyCodeLine{4866             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 5, \&unencodedBitsPerSample)) \{}
\DoxyCodeLine{4867                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4868             \}}
\DoxyCodeLine{4869 }
\DoxyCodeLine{4870             \textcolor{keywordflow}{if} (!drflac\_\_decode\_samples\_with\_residual\_\_unencoded(bs, bitsPerSample, samplesInPartition, unencodedBitsPerSample, order, shift, coefficients, pDecodedSamples)) \{}
\DoxyCodeLine{4871                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4872             \}}
\DoxyCodeLine{4873         \}}
\DoxyCodeLine{4874 }
\DoxyCodeLine{4875         pDecodedSamples += samplesInPartition;}
\DoxyCodeLine{4876 }
\DoxyCodeLine{4877         \textcolor{keywordflow}{if} (partitionsRemaining == 1) \{}
\DoxyCodeLine{4878             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4879         \}}
\DoxyCodeLine{4880 }
\DoxyCodeLine{4881         partitionsRemaining -\/= 1;}
\DoxyCodeLine{4882 }
\DoxyCodeLine{4883         \textcolor{keywordflow}{if} (partitionOrder != 0) \{}
\DoxyCodeLine{4884             samplesInPartition = blockSize / (1 << partitionOrder);}
\DoxyCodeLine{4885         \}}
\DoxyCodeLine{4886     \}}
\DoxyCodeLine{4887 }
\DoxyCodeLine{4888     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4889 \}}
\DoxyCodeLine{4890 }
\DoxyCodeLine{4891 \textcolor{comment}{/*}}
\DoxyCodeLine{4892 \textcolor{comment}{Reads and seeks past the residual for the sub-\/frame the decoder is currently sitting on. This function should be called}}
\DoxyCodeLine{4893 \textcolor{comment}{when the decoder is sitting at the very start of the RESIDUAL block. The first <order> residuals will be set to 0. The}}
\DoxyCodeLine{4894 \textcolor{comment}{<blockSize> and <order> parameters are used to determine how many residual values need to be decoded.}}
\DoxyCodeLine{4895 \textcolor{comment}{*/}}
\DoxyCodeLine{4896 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_and\_seek\_residual(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 blockSize, drflac\_uint32 order)}
\DoxyCodeLine{4897 \{}
\DoxyCodeLine{4898     drflac\_uint8 residualMethod;}
\DoxyCodeLine{4899     drflac\_uint8 partitionOrder;}
\DoxyCodeLine{4900     drflac\_uint32 samplesInPartition;}
\DoxyCodeLine{4901     drflac\_uint32 partitionsRemaining;}
\DoxyCodeLine{4902 }
\DoxyCodeLine{4903     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{4904     DRFLAC\_ASSERT(blockSize != 0);}
\DoxyCodeLine{4905 }
\DoxyCodeLine{4906     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 2, \&residualMethod)) \{}
\DoxyCodeLine{4907         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4908     \}}
\DoxyCodeLine{4909 }
\DoxyCodeLine{4910     \textcolor{keywordflow}{if} (residualMethod != DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE \&\& residualMethod != DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE2) \{}
\DoxyCodeLine{4911         \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Unknown or unsupported residual coding method. */}}
\DoxyCodeLine{4912     \}}
\DoxyCodeLine{4913 }
\DoxyCodeLine{4914     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&partitionOrder)) \{}
\DoxyCodeLine{4915         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4916     \}}
\DoxyCodeLine{4917 }
\DoxyCodeLine{4918     \textcolor{comment}{/*}}
\DoxyCodeLine{4919 \textcolor{comment}{    From the FLAC spec:}}
\DoxyCodeLine{4920 \textcolor{comment}{      The Rice partition order in a Rice-\/coded residual section must be less than or equal to 8.}}
\DoxyCodeLine{4921 \textcolor{comment}{    */}}
\DoxyCodeLine{4922     \textcolor{keywordflow}{if} (partitionOrder > 8) \{}
\DoxyCodeLine{4923         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4924     \}}
\DoxyCodeLine{4925 }
\DoxyCodeLine{4926     \textcolor{comment}{/* Validation check. */}}
\DoxyCodeLine{4927     \textcolor{keywordflow}{if} ((blockSize / (1 << partitionOrder)) <= order) \{}
\DoxyCodeLine{4928         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4929     \}}
\DoxyCodeLine{4930 }
\DoxyCodeLine{4931     samplesInPartition = (blockSize / (1 << partitionOrder)) -\/ order;}
\DoxyCodeLine{4932     partitionsRemaining = (1 << partitionOrder);}
\DoxyCodeLine{4933     \textcolor{keywordflow}{for} (;;)}
\DoxyCodeLine{4934     \{}
\DoxyCodeLine{4935         drflac\_uint8 riceParam = 0;}
\DoxyCodeLine{4936         \textcolor{keywordflow}{if} (residualMethod == DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE) \{}
\DoxyCodeLine{4937             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&riceParam)) \{}
\DoxyCodeLine{4938                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4939             \}}
\DoxyCodeLine{4940             \textcolor{keywordflow}{if} (riceParam == 15) \{}
\DoxyCodeLine{4941                 riceParam = 0xFF;}
\DoxyCodeLine{4942             \}}
\DoxyCodeLine{4943         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (residualMethod == DRFLAC\_RESIDUAL\_CODING\_METHOD\_PARTITIONED\_RICE2) \{}
\DoxyCodeLine{4944             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 5, \&riceParam)) \{}
\DoxyCodeLine{4945                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4946             \}}
\DoxyCodeLine{4947             \textcolor{keywordflow}{if} (riceParam == 31) \{}
\DoxyCodeLine{4948                 riceParam = 0xFF;}
\DoxyCodeLine{4949             \}}
\DoxyCodeLine{4950         \}}
\DoxyCodeLine{4951 }
\DoxyCodeLine{4952         \textcolor{keywordflow}{if} (riceParam != 0xFF) \{}
\DoxyCodeLine{4953             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_seek\_residual\_\_rice(bs, samplesInPartition, riceParam)) \{}
\DoxyCodeLine{4954                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4955             \}}
\DoxyCodeLine{4956         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4957             drflac\_uint8 unencodedBitsPerSample = 0;}
\DoxyCodeLine{4958             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 5, \&unencodedBitsPerSample)) \{}
\DoxyCodeLine{4959                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4960             \}}
\DoxyCodeLine{4961 }
\DoxyCodeLine{4962             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, unencodedBitsPerSample * samplesInPartition)) \{}
\DoxyCodeLine{4963                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4964             \}}
\DoxyCodeLine{4965         \}}
\DoxyCodeLine{4966 }
\DoxyCodeLine{4967 }
\DoxyCodeLine{4968         \textcolor{keywordflow}{if} (partitionsRemaining == 1) \{}
\DoxyCodeLine{4969             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4970         \}}
\DoxyCodeLine{4971 }
\DoxyCodeLine{4972         partitionsRemaining -\/= 1;}
\DoxyCodeLine{4973         samplesInPartition = blockSize / (1 << partitionOrder);}
\DoxyCodeLine{4974     \}}
\DoxyCodeLine{4975 }
\DoxyCodeLine{4976     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4977 \}}
\DoxyCodeLine{4978 }
\DoxyCodeLine{4979 }
\DoxyCodeLine{4980 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_\_constant(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 blockSize, drflac\_uint32 subframeBitsPerSample, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{4981 \{}
\DoxyCodeLine{4982     drflac\_uint32 i;}
\DoxyCodeLine{4983 }
\DoxyCodeLine{4984     \textcolor{comment}{/* Only a single sample needs to be decoded here. */}}
\DoxyCodeLine{4985     drflac\_int32 \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{4986     \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, subframeBitsPerSample, \&\mbox{\hyperlink{structsample}{sample}})) \{}
\DoxyCodeLine{4987         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{4988     \}}
\DoxyCodeLine{4989 }
\DoxyCodeLine{4990     \textcolor{comment}{/*}}
\DoxyCodeLine{4991 \textcolor{comment}{    We don't really need to expand this, but it does simplify the process of reading samples. If this becomes a performance issue (unlikely)}}
\DoxyCodeLine{4992 \textcolor{comment}{    we'll want to look at a more efficient way.}}
\DoxyCodeLine{4993 \textcolor{comment}{    */}}
\DoxyCodeLine{4994     \textcolor{keywordflow}{for} (i = 0; i < blockSize; ++i) \{}
\DoxyCodeLine{4995         pDecodedSamples[i] = \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{4996     \}}
\DoxyCodeLine{4997 }
\DoxyCodeLine{4998     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{4999 \}}
\DoxyCodeLine{5000 }
\DoxyCodeLine{5001 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_\_verbatim(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 blockSize, drflac\_uint32 subframeBitsPerSample, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{5002 \{}
\DoxyCodeLine{5003     drflac\_uint32 i;}
\DoxyCodeLine{5004 }
\DoxyCodeLine{5005     \textcolor{keywordflow}{for} (i = 0; i < blockSize; ++i) \{}
\DoxyCodeLine{5006         drflac\_int32 \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5007         \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, subframeBitsPerSample, \&\mbox{\hyperlink{structsample}{sample}})) \{}
\DoxyCodeLine{5008             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5009         \}}
\DoxyCodeLine{5010 }
\DoxyCodeLine{5011         pDecodedSamples[i] = \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5012     \}}
\DoxyCodeLine{5013 }
\DoxyCodeLine{5014     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5015 \}}
\DoxyCodeLine{5016 }
\DoxyCodeLine{5017 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_\_fixed(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 blockSize, drflac\_uint32 subframeBitsPerSample, drflac\_uint8 lpcOrder, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{5018 \{}
\DoxyCodeLine{5019     drflac\_uint32 i;}
\DoxyCodeLine{5020 }
\DoxyCodeLine{5021     \textcolor{keyword}{static} drflac\_int32 lpcCoefficientsTable[5][4] = \{}
\DoxyCodeLine{5022         \{0,  0, 0,  0\},}
\DoxyCodeLine{5023         \{1,  0, 0,  0\},}
\DoxyCodeLine{5024         \{2, -\/1, 0,  0\},}
\DoxyCodeLine{5025         \{3, -\/3, 1,  0\},}
\DoxyCodeLine{5026         \{4, -\/6, 4, -\/1\}}
\DoxyCodeLine{5027     \};}
\DoxyCodeLine{5028 }
\DoxyCodeLine{5029     \textcolor{comment}{/* Warm up samples and coefficients. */}}
\DoxyCodeLine{5030     \textcolor{keywordflow}{for} (i = 0; i < lpcOrder; ++i) \{}
\DoxyCodeLine{5031         drflac\_int32 \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5032         \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, subframeBitsPerSample, \&\mbox{\hyperlink{structsample}{sample}})) \{}
\DoxyCodeLine{5033             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5034         \}}
\DoxyCodeLine{5035 }
\DoxyCodeLine{5036         pDecodedSamples[i] = \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5037     \}}
\DoxyCodeLine{5038 }
\DoxyCodeLine{5039     \textcolor{keywordflow}{if} (!drflac\_\_decode\_samples\_with\_residual(bs, subframeBitsPerSample, blockSize, lpcOrder, 0, lpcCoefficientsTable[lpcOrder], pDecodedSamples)) \{}
\DoxyCodeLine{5040         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5041     \}}
\DoxyCodeLine{5042 }
\DoxyCodeLine{5043     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5044 \}}
\DoxyCodeLine{5045 }
\DoxyCodeLine{5046 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_samples\_\_lpc(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint32 blockSize, drflac\_uint32 bitsPerSample, drflac\_uint8 lpcOrder, drflac\_int32* pDecodedSamples)}
\DoxyCodeLine{5047 \{}
\DoxyCodeLine{5048     drflac\_uint8 i;}
\DoxyCodeLine{5049     drflac\_uint8 lpcPrecision;}
\DoxyCodeLine{5050     drflac\_int8 lpcShift;}
\DoxyCodeLine{5051     drflac\_int32 coefficients[32];}
\DoxyCodeLine{5052 }
\DoxyCodeLine{5053     \textcolor{comment}{/* Warm up samples. */}}
\DoxyCodeLine{5054     \textcolor{keywordflow}{for} (i = 0; i < lpcOrder; ++i) \{}
\DoxyCodeLine{5055         drflac\_int32 \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5056         \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, bitsPerSample, \&\mbox{\hyperlink{structsample}{sample}})) \{}
\DoxyCodeLine{5057             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5058         \}}
\DoxyCodeLine{5059 }
\DoxyCodeLine{5060         pDecodedSamples[i] = \mbox{\hyperlink{structsample}{sample}};}
\DoxyCodeLine{5061     \}}
\DoxyCodeLine{5062 }
\DoxyCodeLine{5063     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&lpcPrecision)) \{}
\DoxyCodeLine{5064         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5065     \}}
\DoxyCodeLine{5066     \textcolor{keywordflow}{if} (lpcPrecision == 15) \{}
\DoxyCodeLine{5067         \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Invalid. */}}
\DoxyCodeLine{5068     \}}
\DoxyCodeLine{5069     lpcPrecision += 1;}
\DoxyCodeLine{5070 }
\DoxyCodeLine{5071     \textcolor{keywordflow}{if} (!drflac\_\_read\_int8(bs, 5, \&lpcShift)) \{}
\DoxyCodeLine{5072         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5073     \}}
\DoxyCodeLine{5074 }
\DoxyCodeLine{5075     \textcolor{comment}{/*}}
\DoxyCodeLine{5076 \textcolor{comment}{    From the FLAC specification:}}
\DoxyCodeLine{5077 \textcolor{comment}{}}
\DoxyCodeLine{5078 \textcolor{comment}{        Quantized linear predictor coefficient shift needed in bits (NOTE: this number is signed two's-\/complement)}}
\DoxyCodeLine{5079 \textcolor{comment}{}}
\DoxyCodeLine{5080 \textcolor{comment}{    Emphasis on the "{}signed two's-\/complement"{}. In practice there does not seem to be any encoders nor decoders supporting negative shifts. For now dr\_flac is}}
\DoxyCodeLine{5081 \textcolor{comment}{    not going to support negative shifts as I don't have any reference files. However, when a reference file comes through I will consider adding support.}}
\DoxyCodeLine{5082 \textcolor{comment}{    */}}
\DoxyCodeLine{5083     \textcolor{keywordflow}{if} (lpcShift < 0) \{}
\DoxyCodeLine{5084         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5085     \}}
\DoxyCodeLine{5086 }
\DoxyCodeLine{5087     DRFLAC\_ZERO\_MEMORY(coefficients, \textcolor{keyword}{sizeof}(coefficients));}
\DoxyCodeLine{5088     \textcolor{keywordflow}{for} (i = 0; i < lpcOrder; ++i) \{}
\DoxyCodeLine{5089         \textcolor{keywordflow}{if} (!drflac\_\_read\_int32(bs, lpcPrecision, coefficients + i)) \{}
\DoxyCodeLine{5090             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5091         \}}
\DoxyCodeLine{5092     \}}
\DoxyCodeLine{5093 }
\DoxyCodeLine{5094     \textcolor{keywordflow}{if} (!drflac\_\_decode\_samples\_with\_residual(bs, bitsPerSample, blockSize, lpcOrder, lpcShift, coefficients, pDecodedSamples)) \{}
\DoxyCodeLine{5095         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5096     \}}
\DoxyCodeLine{5097 }
\DoxyCodeLine{5098     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5099 \}}
\DoxyCodeLine{5100 }
\DoxyCodeLine{5101 }
\DoxyCodeLine{5102 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_next\_flac\_frame\_header(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, drflac\_uint8 streaminfoBitsPerSample, \mbox{\hyperlink{structdrflac__frame__header}{drflac\_frame\_header}}* header)}
\DoxyCodeLine{5103 \{}
\DoxyCodeLine{5104     \textcolor{keyword}{const} drflac\_uint32 sampleRateTable[12]  = \{0, 88200, 176400, 192000, 8000, 16000, 22050, 24000, 32000, 44100, 48000, 96000\};}
\DoxyCodeLine{5105     \textcolor{keyword}{const} drflac\_uint8 bitsPerSampleTable[8] = \{0, 8, 12, (drflac\_uint8)-\/1, 16, 20, 24, (drflac\_uint8)-\/1\};   \textcolor{comment}{/* -\/1 = reserved. */}}
\DoxyCodeLine{5106 }
\DoxyCodeLine{5107     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{5108     DRFLAC\_ASSERT(header != NULL);}
\DoxyCodeLine{5109 }
\DoxyCodeLine{5110     \textcolor{comment}{/* Keep looping until we find a valid sync code. */}}
\DoxyCodeLine{5111     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5112         drflac\_uint8 crc8 = 0xCE; \textcolor{comment}{/* 0xCE = drflac\_crc8(0, 0x3FFE, 14); */}}
\DoxyCodeLine{5113         drflac\_uint8 reserved = 0;}
\DoxyCodeLine{5114         drflac\_uint8 blockingStrategy = 0;}
\DoxyCodeLine{5115         drflac\_uint8 blockSize = 0;}
\DoxyCodeLine{5116         drflac\_uint8 sampleRate = 0;}
\DoxyCodeLine{5117         drflac\_uint8 channelAssignment = 0;}
\DoxyCodeLine{5118         drflac\_uint8 bitsPerSample = 0;}
\DoxyCodeLine{5119         drflac\_bool32 isVariableBlockSize;}
\DoxyCodeLine{5120 }
\DoxyCodeLine{5121         \textcolor{keywordflow}{if} (!drflac\_\_find\_and\_seek\_to\_next\_sync\_code(bs)) \{}
\DoxyCodeLine{5122             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5123         \}}
\DoxyCodeLine{5124 }
\DoxyCodeLine{5125         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 1, \&reserved)) \{}
\DoxyCodeLine{5126             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5127         \}}
\DoxyCodeLine{5128         \textcolor{keywordflow}{if} (reserved == 1) \{}
\DoxyCodeLine{5129             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5130         \}}
\DoxyCodeLine{5131         crc8 = drflac\_crc8(crc8, reserved, 1);}
\DoxyCodeLine{5132 }
\DoxyCodeLine{5133         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 1, \&blockingStrategy)) \{}
\DoxyCodeLine{5134             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5135         \}}
\DoxyCodeLine{5136         crc8 = drflac\_crc8(crc8, blockingStrategy, 1);}
\DoxyCodeLine{5137 }
\DoxyCodeLine{5138         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&blockSize)) \{}
\DoxyCodeLine{5139             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5140         \}}
\DoxyCodeLine{5141         \textcolor{keywordflow}{if} (blockSize == 0) \{}
\DoxyCodeLine{5142             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5143         \}}
\DoxyCodeLine{5144         crc8 = drflac\_crc8(crc8, blockSize, 4);}
\DoxyCodeLine{5145 }
\DoxyCodeLine{5146         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&sampleRate)) \{}
\DoxyCodeLine{5147             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5148         \}}
\DoxyCodeLine{5149         crc8 = drflac\_crc8(crc8, sampleRate, 4);}
\DoxyCodeLine{5150 }
\DoxyCodeLine{5151         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&channelAssignment)) \{}
\DoxyCodeLine{5152             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5153         \}}
\DoxyCodeLine{5154         \textcolor{keywordflow}{if} (channelAssignment > 10) \{}
\DoxyCodeLine{5155             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5156         \}}
\DoxyCodeLine{5157         crc8 = drflac\_crc8(crc8, channelAssignment, 4);}
\DoxyCodeLine{5158 }
\DoxyCodeLine{5159         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 3, \&bitsPerSample)) \{}
\DoxyCodeLine{5160             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5161         \}}
\DoxyCodeLine{5162         \textcolor{keywordflow}{if} (bitsPerSample == 3 || bitsPerSample == 7) \{}
\DoxyCodeLine{5163             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5164         \}}
\DoxyCodeLine{5165         crc8 = drflac\_crc8(crc8, bitsPerSample, 3);}
\DoxyCodeLine{5166 }
\DoxyCodeLine{5167 }
\DoxyCodeLine{5168         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 1, \&reserved)) \{}
\DoxyCodeLine{5169             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5170         \}}
\DoxyCodeLine{5171         \textcolor{keywordflow}{if} (reserved == 1) \{}
\DoxyCodeLine{5172             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5173         \}}
\DoxyCodeLine{5174         crc8 = drflac\_crc8(crc8, reserved, 1);}
\DoxyCodeLine{5175 }
\DoxyCodeLine{5176 }
\DoxyCodeLine{5177         isVariableBlockSize = blockingStrategy == 1;}
\DoxyCodeLine{5178         \textcolor{keywordflow}{if} (isVariableBlockSize) \{}
\DoxyCodeLine{5179             drflac\_uint64 pcmFrameNumber;}
\DoxyCodeLine{5180             drflac\_result result = drflac\_\_read\_utf8\_coded\_number(bs, \&pcmFrameNumber, \&crc8);}
\DoxyCodeLine{5181             \textcolor{keywordflow}{if} (result != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5182                 \textcolor{keywordflow}{if} (result == DRFLAC\_AT\_END) \{}
\DoxyCodeLine{5183                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5184                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5185                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5186                 \}}
\DoxyCodeLine{5187             \}}
\DoxyCodeLine{5188             header-\/>flacFrameNumber  = 0;}
\DoxyCodeLine{5189             header-\/>pcmFrameNumber = pcmFrameNumber;}
\DoxyCodeLine{5190         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5191             drflac\_uint64 flacFrameNumber = 0;}
\DoxyCodeLine{5192             drflac\_result result = drflac\_\_read\_utf8\_coded\_number(bs, \&flacFrameNumber, \&crc8);}
\DoxyCodeLine{5193             \textcolor{keywordflow}{if} (result != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5194                 \textcolor{keywordflow}{if} (result == DRFLAC\_AT\_END) \{}
\DoxyCodeLine{5195                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5196                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5197                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5198                 \}}
\DoxyCodeLine{5199             \}}
\DoxyCodeLine{5200             header-\/>flacFrameNumber  = (drflac\_uint32)flacFrameNumber;   \textcolor{comment}{/* <-\/-\/ Safe cast. */}}
\DoxyCodeLine{5201             header-\/>pcmFrameNumber = 0;}
\DoxyCodeLine{5202         \}}
\DoxyCodeLine{5203 }
\DoxyCodeLine{5204 }
\DoxyCodeLine{5205         DRFLAC\_ASSERT(blockSize > 0);}
\DoxyCodeLine{5206         \textcolor{keywordflow}{if} (blockSize == 1) \{}
\DoxyCodeLine{5207             header-\/>blockSizeInPCMFrames = 192;}
\DoxyCodeLine{5208         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blockSize <= 5) \{}
\DoxyCodeLine{5209             DRFLAC\_ASSERT(blockSize >= 2);}
\DoxyCodeLine{5210             header-\/>blockSizeInPCMFrames = 576 * (1 << (blockSize -\/ 2));}
\DoxyCodeLine{5211         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blockSize == 6) \{}
\DoxyCodeLine{5212             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint16(bs, 8, \&header-\/>blockSizeInPCMFrames)) \{}
\DoxyCodeLine{5213                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5214             \}}
\DoxyCodeLine{5215             crc8 = drflac\_crc8(crc8, header-\/>blockSizeInPCMFrames, 8);}
\DoxyCodeLine{5216             header-\/>blockSizeInPCMFrames += 1;}
\DoxyCodeLine{5217         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (blockSize == 7) \{}
\DoxyCodeLine{5218             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint16(bs, 16, \&header-\/>blockSizeInPCMFrames)) \{}
\DoxyCodeLine{5219                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5220             \}}
\DoxyCodeLine{5221             crc8 = drflac\_crc8(crc8, header-\/>blockSizeInPCMFrames, 16);}
\DoxyCodeLine{5222             header-\/>blockSizeInPCMFrames += 1;}
\DoxyCodeLine{5223         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5224             DRFLAC\_ASSERT(blockSize >= 8);}
\DoxyCodeLine{5225             header-\/>blockSizeInPCMFrames = 256 * (1 << (blockSize -\/ 8));}
\DoxyCodeLine{5226         \}}
\DoxyCodeLine{5227 }
\DoxyCodeLine{5228 }
\DoxyCodeLine{5229         \textcolor{keywordflow}{if} (sampleRate <= 11) \{}
\DoxyCodeLine{5230             header-\/>sampleRate = sampleRateTable[sampleRate];}
\DoxyCodeLine{5231         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sampleRate == 12) \{}
\DoxyCodeLine{5232             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, 8, \&header-\/>sampleRate)) \{}
\DoxyCodeLine{5233                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5234             \}}
\DoxyCodeLine{5235             crc8 = drflac\_crc8(crc8, header-\/>sampleRate, 8);}
\DoxyCodeLine{5236             header-\/>sampleRate *= 1000;}
\DoxyCodeLine{5237         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sampleRate == 13) \{}
\DoxyCodeLine{5238             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, 16, \&header-\/>sampleRate)) \{}
\DoxyCodeLine{5239                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5240             \}}
\DoxyCodeLine{5241             crc8 = drflac\_crc8(crc8, header-\/>sampleRate, 16);}
\DoxyCodeLine{5242         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sampleRate == 14) \{}
\DoxyCodeLine{5243             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint32(bs, 16, \&header-\/>sampleRate)) \{}
\DoxyCodeLine{5244                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5245             \}}
\DoxyCodeLine{5246             crc8 = drflac\_crc8(crc8, header-\/>sampleRate, 16);}
\DoxyCodeLine{5247             header-\/>sampleRate *= 10;}
\DoxyCodeLine{5248         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5249             \textcolor{keywordflow}{continue};  \textcolor{comment}{/* Invalid. Assume an invalid block. */}}
\DoxyCodeLine{5250         \}}
\DoxyCodeLine{5251 }
\DoxyCodeLine{5252 }
\DoxyCodeLine{5253         header-\/>channelAssignment = channelAssignment;}
\DoxyCodeLine{5254 }
\DoxyCodeLine{5255         header-\/>bitsPerSample = bitsPerSampleTable[bitsPerSample];}
\DoxyCodeLine{5256         \textcolor{keywordflow}{if} (header-\/>bitsPerSample == 0) \{}
\DoxyCodeLine{5257             header-\/>bitsPerSample = streaminfoBitsPerSample;}
\DoxyCodeLine{5258         \}}
\DoxyCodeLine{5259 }
\DoxyCodeLine{5260         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, \&header-\/>crc8)) \{}
\DoxyCodeLine{5261             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5262         \}}
\DoxyCodeLine{5263 }
\DoxyCodeLine{5264 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5265         \textcolor{keywordflow}{if} (header-\/>crc8 != crc8) \{}
\DoxyCodeLine{5266             \textcolor{keywordflow}{continue};    \textcolor{comment}{/* CRC mismatch. Loop back to the top and find the next sync code. */}}
\DoxyCodeLine{5267         \}}
\DoxyCodeLine{5268 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5269         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5270     \}}
\DoxyCodeLine{5271 \}}
\DoxyCodeLine{5272 }
\DoxyCodeLine{5273 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_subframe\_header(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \mbox{\hyperlink{structdrflac__subframe}{drflac\_subframe}}* pSubframe)}
\DoxyCodeLine{5274 \{}
\DoxyCodeLine{5275     drflac\_uint8 header;}
\DoxyCodeLine{5276     \textcolor{keywordtype}{int} type;}
\DoxyCodeLine{5277 }
\DoxyCodeLine{5278     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 8, \&header)) \{}
\DoxyCodeLine{5279         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5280     \}}
\DoxyCodeLine{5281 }
\DoxyCodeLine{5282     \textcolor{comment}{/* First bit should always be 0. */}}
\DoxyCodeLine{5283     \textcolor{keywordflow}{if} ((header \& 0x80) != 0) \{}
\DoxyCodeLine{5284         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5285     \}}
\DoxyCodeLine{5286 }
\DoxyCodeLine{5287     type = (header \& 0x7E) >> 1;}
\DoxyCodeLine{5288     \textcolor{keywordflow}{if} (type == 0) \{}
\DoxyCodeLine{5289         pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_CONSTANT;}
\DoxyCodeLine{5290     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == 1) \{}
\DoxyCodeLine{5291         pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_VERBATIM;}
\DoxyCodeLine{5292     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5293         \textcolor{keywordflow}{if} ((type \& 0x20) != 0) \{}
\DoxyCodeLine{5294             pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_LPC;}
\DoxyCodeLine{5295             pSubframe-\/>lpcOrder = (drflac\_uint8)(type \& 0x1F) + 1;}
\DoxyCodeLine{5296         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((type \& 0x08) != 0) \{}
\DoxyCodeLine{5297             pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_FIXED;}
\DoxyCodeLine{5298             pSubframe-\/>lpcOrder = (drflac\_uint8)(type \& 0x07);}
\DoxyCodeLine{5299             \textcolor{keywordflow}{if} (pSubframe-\/>lpcOrder > 4) \{}
\DoxyCodeLine{5300                 pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_RESERVED;}
\DoxyCodeLine{5301                 pSubframe-\/>lpcOrder = 0;}
\DoxyCodeLine{5302             \}}
\DoxyCodeLine{5303         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5304             pSubframe-\/>subframeType = DRFLAC\_SUBFRAME\_RESERVED;}
\DoxyCodeLine{5305         \}}
\DoxyCodeLine{5306     \}}
\DoxyCodeLine{5307 }
\DoxyCodeLine{5308     \textcolor{keywordflow}{if} (pSubframe-\/>subframeType == DRFLAC\_SUBFRAME\_RESERVED) \{}
\DoxyCodeLine{5309         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5310     \}}
\DoxyCodeLine{5311 }
\DoxyCodeLine{5312     \textcolor{comment}{/* Wasted bits per sample. */}}
\DoxyCodeLine{5313     pSubframe-\/>wastedBitsPerSample = 0;}
\DoxyCodeLine{5314     \textcolor{keywordflow}{if} ((header \& 0x01) == 1) \{}
\DoxyCodeLine{5315         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} wastedBitsPerSample;}
\DoxyCodeLine{5316         \textcolor{keywordflow}{if} (!drflac\_\_seek\_past\_next\_set\_bit(bs, \&wastedBitsPerSample)) \{}
\DoxyCodeLine{5317             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5318         \}}
\DoxyCodeLine{5319         pSubframe-\/>wastedBitsPerSample = (drflac\_uint8)wastedBitsPerSample + 1;}
\DoxyCodeLine{5320     \}}
\DoxyCodeLine{5321 }
\DoxyCodeLine{5322     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5323 \}}
\DoxyCodeLine{5324 }
\DoxyCodeLine{5325 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_subframe(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \mbox{\hyperlink{structdrflac__frame}{drflac\_frame}}* frame, \textcolor{keywordtype}{int} subframeIndex, drflac\_int32* pDecodedSamplesOut)}
\DoxyCodeLine{5326 \{}
\DoxyCodeLine{5327     \mbox{\hyperlink{structdrflac__subframe}{drflac\_subframe}}* pSubframe;}
\DoxyCodeLine{5328     drflac\_uint32 subframeBitsPerSample;}
\DoxyCodeLine{5329 }
\DoxyCodeLine{5330     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{5331     DRFLAC\_ASSERT(frame != NULL);}
\DoxyCodeLine{5332 }
\DoxyCodeLine{5333     pSubframe = frame-\/>subframes + subframeIndex;}
\DoxyCodeLine{5334     \textcolor{keywordflow}{if} (!drflac\_\_read\_subframe\_header(bs, pSubframe)) \{}
\DoxyCodeLine{5335         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5336     \}}
\DoxyCodeLine{5337 }
\DoxyCodeLine{5338     \textcolor{comment}{/* Side channels require an extra bit per sample. Took a while to figure that one out... */}}
\DoxyCodeLine{5339     subframeBitsPerSample = frame-\/>header.bitsPerSample;}
\DoxyCodeLine{5340     \textcolor{keywordflow}{if} ((frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE || frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE) \&\& subframeIndex == 1) \{}
\DoxyCodeLine{5341         subframeBitsPerSample += 1;}
\DoxyCodeLine{5342     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE \&\& subframeIndex == 0) \{}
\DoxyCodeLine{5343         subframeBitsPerSample += 1;}
\DoxyCodeLine{5344     \}}
\DoxyCodeLine{5345 }
\DoxyCodeLine{5346     \textcolor{comment}{/* Need to handle wasted bits per sample. */}}
\DoxyCodeLine{5347     \textcolor{keywordflow}{if} (pSubframe-\/>wastedBitsPerSample >= subframeBitsPerSample) \{}
\DoxyCodeLine{5348         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5349     \}}
\DoxyCodeLine{5350     subframeBitsPerSample -\/= pSubframe-\/>wastedBitsPerSample;}
\DoxyCodeLine{5351 }
\DoxyCodeLine{5352     pSubframe-\/>pSamplesS32 = pDecodedSamplesOut;}
\DoxyCodeLine{5353 }
\DoxyCodeLine{5354     \textcolor{keywordflow}{switch} (pSubframe-\/>subframeType)}
\DoxyCodeLine{5355     \{}
\DoxyCodeLine{5356         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_CONSTANT:}
\DoxyCodeLine{5357         \{}
\DoxyCodeLine{5358             drflac\_\_decode\_samples\_\_constant(bs, frame-\/>header.blockSizeInPCMFrames, subframeBitsPerSample, pSubframe-\/>pSamplesS32);}
\DoxyCodeLine{5359         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5360 }
\DoxyCodeLine{5361         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_VERBATIM:}
\DoxyCodeLine{5362         \{}
\DoxyCodeLine{5363             drflac\_\_decode\_samples\_\_verbatim(bs, frame-\/>header.blockSizeInPCMFrames, subframeBitsPerSample, pSubframe-\/>pSamplesS32);}
\DoxyCodeLine{5364         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5365 }
\DoxyCodeLine{5366         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_FIXED:}
\DoxyCodeLine{5367         \{}
\DoxyCodeLine{5368             drflac\_\_decode\_samples\_\_fixed(bs, frame-\/>header.blockSizeInPCMFrames, subframeBitsPerSample, pSubframe-\/>lpcOrder, pSubframe-\/>pSamplesS32);}
\DoxyCodeLine{5369         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5370 }
\DoxyCodeLine{5371         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_LPC:}
\DoxyCodeLine{5372         \{}
\DoxyCodeLine{5373             drflac\_\_decode\_samples\_\_lpc(bs, frame-\/>header.blockSizeInPCMFrames, subframeBitsPerSample, pSubframe-\/>lpcOrder, pSubframe-\/>pSamplesS32);}
\DoxyCodeLine{5374         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5375 }
\DoxyCodeLine{5376         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5377     \}}
\DoxyCodeLine{5378 }
\DoxyCodeLine{5379     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5380 \}}
\DoxyCodeLine{5381 }
\DoxyCodeLine{5382 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_subframe(\mbox{\hyperlink{structdrflac__bs}{drflac\_bs}}* bs, \mbox{\hyperlink{structdrflac__frame}{drflac\_frame}}* frame, \textcolor{keywordtype}{int} subframeIndex)}
\DoxyCodeLine{5383 \{}
\DoxyCodeLine{5384     \mbox{\hyperlink{structdrflac__subframe}{drflac\_subframe}}* pSubframe;}
\DoxyCodeLine{5385     drflac\_uint32 subframeBitsPerSample;}
\DoxyCodeLine{5386 }
\DoxyCodeLine{5387     DRFLAC\_ASSERT(bs != NULL);}
\DoxyCodeLine{5388     DRFLAC\_ASSERT(frame != NULL);}
\DoxyCodeLine{5389 }
\DoxyCodeLine{5390     pSubframe = frame-\/>subframes + subframeIndex;}
\DoxyCodeLine{5391     \textcolor{keywordflow}{if} (!drflac\_\_read\_subframe\_header(bs, pSubframe)) \{}
\DoxyCodeLine{5392         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5393     \}}
\DoxyCodeLine{5394 }
\DoxyCodeLine{5395     \textcolor{comment}{/* Side channels require an extra bit per sample. Took a while to figure that one out... */}}
\DoxyCodeLine{5396     subframeBitsPerSample = frame-\/>header.bitsPerSample;}
\DoxyCodeLine{5397     \textcolor{keywordflow}{if} ((frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE || frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE) \&\& subframeIndex == 1) \{}
\DoxyCodeLine{5398         subframeBitsPerSample += 1;}
\DoxyCodeLine{5399     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (frame-\/>header.channelAssignment == DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE \&\& subframeIndex == 0) \{}
\DoxyCodeLine{5400         subframeBitsPerSample += 1;}
\DoxyCodeLine{5401     \}}
\DoxyCodeLine{5402 }
\DoxyCodeLine{5403     \textcolor{comment}{/* Need to handle wasted bits per sample. */}}
\DoxyCodeLine{5404     \textcolor{keywordflow}{if} (pSubframe-\/>wastedBitsPerSample >= subframeBitsPerSample) \{}
\DoxyCodeLine{5405         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5406     \}}
\DoxyCodeLine{5407     subframeBitsPerSample -\/= pSubframe-\/>wastedBitsPerSample;}
\DoxyCodeLine{5408 }
\DoxyCodeLine{5409     pSubframe-\/>pSamplesS32 = NULL;}
\DoxyCodeLine{5410 }
\DoxyCodeLine{5411     \textcolor{keywordflow}{switch} (pSubframe-\/>subframeType)}
\DoxyCodeLine{5412     \{}
\DoxyCodeLine{5413         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_CONSTANT:}
\DoxyCodeLine{5414         \{}
\DoxyCodeLine{5415             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, subframeBitsPerSample)) \{}
\DoxyCodeLine{5416                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5417             \}}
\DoxyCodeLine{5418         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5419 }
\DoxyCodeLine{5420         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_VERBATIM:}
\DoxyCodeLine{5421         \{}
\DoxyCodeLine{5422             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitsToSeek = frame-\/>header.blockSizeInPCMFrames * subframeBitsPerSample;}
\DoxyCodeLine{5423             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, bitsToSeek)) \{}
\DoxyCodeLine{5424                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5425             \}}
\DoxyCodeLine{5426         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5427 }
\DoxyCodeLine{5428         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_FIXED:}
\DoxyCodeLine{5429         \{}
\DoxyCodeLine{5430             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitsToSeek = pSubframe-\/>lpcOrder * subframeBitsPerSample;}
\DoxyCodeLine{5431             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, bitsToSeek)) \{}
\DoxyCodeLine{5432                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5433             \}}
\DoxyCodeLine{5434 }
\DoxyCodeLine{5435             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_seek\_residual(bs, frame-\/>header.blockSizeInPCMFrames, pSubframe-\/>lpcOrder)) \{}
\DoxyCodeLine{5436                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5437             \}}
\DoxyCodeLine{5438         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5439 }
\DoxyCodeLine{5440         \textcolor{keywordflow}{case} DRFLAC\_SUBFRAME\_LPC:}
\DoxyCodeLine{5441         \{}
\DoxyCodeLine{5442             drflac\_uint8 lpcPrecision;}
\DoxyCodeLine{5443 }
\DoxyCodeLine{5444             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitsToSeek = pSubframe-\/>lpcOrder * subframeBitsPerSample;}
\DoxyCodeLine{5445             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, bitsToSeek)) \{}
\DoxyCodeLine{5446                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5447             \}}
\DoxyCodeLine{5448 }
\DoxyCodeLine{5449             \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(bs, 4, \&lpcPrecision)) \{}
\DoxyCodeLine{5450                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5451             \}}
\DoxyCodeLine{5452             \textcolor{keywordflow}{if} (lpcPrecision == 15) \{}
\DoxyCodeLine{5453                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Invalid. */}}
\DoxyCodeLine{5454             \}}
\DoxyCodeLine{5455             lpcPrecision += 1;}
\DoxyCodeLine{5456 }
\DoxyCodeLine{5457 }
\DoxyCodeLine{5458             bitsToSeek = (pSubframe-\/>lpcOrder * lpcPrecision) + 5;    \textcolor{comment}{/* +5 for shift. */}}
\DoxyCodeLine{5459             \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(bs, bitsToSeek)) \{}
\DoxyCodeLine{5460                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5461             \}}
\DoxyCodeLine{5462 }
\DoxyCodeLine{5463             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_seek\_residual(bs, frame-\/>header.blockSizeInPCMFrames, pSubframe-\/>lpcOrder)) \{}
\DoxyCodeLine{5464                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5465             \}}
\DoxyCodeLine{5466         \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{5467 }
\DoxyCodeLine{5468         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5469     \}}
\DoxyCodeLine{5470 }
\DoxyCodeLine{5471     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5472 \}}
\DoxyCodeLine{5473 }
\DoxyCodeLine{5474 }
\DoxyCodeLine{5475 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint8 drflac\_\_get\_channel\_count\_from\_channel\_assignment(drflac\_int8 channelAssignment)}
\DoxyCodeLine{5476 \{}
\DoxyCodeLine{5477     drflac\_uint8 lookup[] = \{1, 2, 3, 4, 5, 6, 7, 8, 2, 2, 2\};}
\DoxyCodeLine{5478 }
\DoxyCodeLine{5479     DRFLAC\_ASSERT(channelAssignment <= 10);}
\DoxyCodeLine{5480     \textcolor{keywordflow}{return} lookup[channelAssignment];}
\DoxyCodeLine{5481 \}}
\DoxyCodeLine{5482 }
\DoxyCodeLine{5483 \textcolor{keyword}{static} drflac\_result drflac\_\_decode\_flac\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{5484 \{}
\DoxyCodeLine{5485     \textcolor{keywordtype}{int} channelCount;}
\DoxyCodeLine{5486     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{5487     drflac\_uint8 paddingSizeInBits;}
\DoxyCodeLine{5488     drflac\_uint16 desiredCRC16;}
\DoxyCodeLine{5489 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5490     drflac\_uint16 actualCRC16;}
\DoxyCodeLine{5491 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5492 }
\DoxyCodeLine{5493     \textcolor{comment}{/* This function should be called while the stream is sitting on the first byte after the frame header. */}}
\DoxyCodeLine{5494     DRFLAC\_ZERO\_MEMORY(pFlac-\/>currentFLACFrame.subframes, \textcolor{keyword}{sizeof}(pFlac-\/>currentFLACFrame.subframes));}
\DoxyCodeLine{5495 }
\DoxyCodeLine{5496     \textcolor{comment}{/* The frame block size must never be larger than the maximum block size defined by the FLAC stream. */}}
\DoxyCodeLine{5497     \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames > pFlac-\/>maxBlockSizeInPCMFrames) \{}
\DoxyCodeLine{5498         \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{5499     \}}
\DoxyCodeLine{5500 }
\DoxyCodeLine{5501     \textcolor{comment}{/* The number of channels in the frame must match the channel count from the STREAMINFO block. */}}
\DoxyCodeLine{5502     channelCount = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pFlac-\/>currentFLACFrame.header.channelAssignment);}
\DoxyCodeLine{5503     \textcolor{keywordflow}{if} (channelCount != (\textcolor{keywordtype}{int})pFlac-\/>channels) \{}
\DoxyCodeLine{5504         \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{5505     \}}
\DoxyCodeLine{5506 }
\DoxyCodeLine{5507     \textcolor{keywordflow}{for} (i = 0; i < channelCount; ++i) \{}
\DoxyCodeLine{5508         \textcolor{keywordflow}{if} (!drflac\_\_decode\_subframe(\&pFlac-\/>bs, \&pFlac-\/>currentFLACFrame, i, pFlac-\/>pDecodedSamples + (pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames * i))) \{}
\DoxyCodeLine{5509             \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{5510         \}}
\DoxyCodeLine{5511     \}}
\DoxyCodeLine{5512 }
\DoxyCodeLine{5513     paddingSizeInBits = (drflac\_uint8)(DRFLAC\_CACHE\_L1\_BITS\_REMAINING(\&pFlac-\/>bs) \& 7);}
\DoxyCodeLine{5514     \textcolor{keywordflow}{if} (paddingSizeInBits > 0) \{}
\DoxyCodeLine{5515         drflac\_uint8 padding = 0;}
\DoxyCodeLine{5516         \textcolor{keywordflow}{if} (!drflac\_\_read\_uint8(\&pFlac-\/>bs, paddingSizeInBits, \&padding)) \{}
\DoxyCodeLine{5517             \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{5518         \}}
\DoxyCodeLine{5519     \}}
\DoxyCodeLine{5520 }
\DoxyCodeLine{5521 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5522     actualCRC16 = drflac\_\_flush\_crc16(\&pFlac-\/>bs);}
\DoxyCodeLine{5523 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5524     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint16(\&pFlac-\/>bs, 16, \&desiredCRC16)) \{}
\DoxyCodeLine{5525         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{5526     \}}
\DoxyCodeLine{5527 }
\DoxyCodeLine{5528 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5529     \textcolor{keywordflow}{if} (actualCRC16 != desiredCRC16) \{}
\DoxyCodeLine{5530         \textcolor{keywordflow}{return} DRFLAC\_CRC\_MISMATCH;    \textcolor{comment}{/* CRC mismatch. */}}
\DoxyCodeLine{5531     \}}
\DoxyCodeLine{5532 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5533 }
\DoxyCodeLine{5534     pFlac-\/>currentFLACFrame.pcmFramesRemaining = pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames;}
\DoxyCodeLine{5535 }
\DoxyCodeLine{5536     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{5537 \}}
\DoxyCodeLine{5538 }
\DoxyCodeLine{5539 \textcolor{keyword}{static} drflac\_result drflac\_\_seek\_flac\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{5540 \{}
\DoxyCodeLine{5541     \textcolor{keywordtype}{int} channelCount;}
\DoxyCodeLine{5542     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{5543     drflac\_uint16 desiredCRC16;}
\DoxyCodeLine{5544 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5545     drflac\_uint16 actualCRC16;}
\DoxyCodeLine{5546 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5547 }
\DoxyCodeLine{5548     channelCount = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pFlac-\/>currentFLACFrame.header.channelAssignment);}
\DoxyCodeLine{5549     \textcolor{keywordflow}{for} (i = 0; i < channelCount; ++i) \{}
\DoxyCodeLine{5550         \textcolor{keywordflow}{if} (!drflac\_\_seek\_subframe(\&pFlac-\/>bs, \&pFlac-\/>currentFLACFrame, i)) \{}
\DoxyCodeLine{5551             \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{5552         \}}
\DoxyCodeLine{5553     \}}
\DoxyCodeLine{5554 }
\DoxyCodeLine{5555     \textcolor{comment}{/* Padding. */}}
\DoxyCodeLine{5556     \textcolor{keywordflow}{if} (!drflac\_\_seek\_bits(\&pFlac-\/>bs, DRFLAC\_CACHE\_L1\_BITS\_REMAINING(\&pFlac-\/>bs) \& 7)) \{}
\DoxyCodeLine{5557         \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{5558     \}}
\DoxyCodeLine{5559 }
\DoxyCodeLine{5560     \textcolor{comment}{/* CRC. */}}
\DoxyCodeLine{5561 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5562     actualCRC16 = drflac\_\_flush\_crc16(\&pFlac-\/>bs);}
\DoxyCodeLine{5563 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5564     \textcolor{keywordflow}{if} (!drflac\_\_read\_uint16(\&pFlac-\/>bs, 16, \&desiredCRC16)) \{}
\DoxyCodeLine{5565         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{5566     \}}
\DoxyCodeLine{5567 }
\DoxyCodeLine{5568 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{5569     \textcolor{keywordflow}{if} (actualCRC16 != desiredCRC16) \{}
\DoxyCodeLine{5570         \textcolor{keywordflow}{return} DRFLAC\_CRC\_MISMATCH;    \textcolor{comment}{/* CRC mismatch. */}}
\DoxyCodeLine{5571     \}}
\DoxyCodeLine{5572 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5573 }
\DoxyCodeLine{5574     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{5575 \}}
\DoxyCodeLine{5576 }
\DoxyCodeLine{5577 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_and\_decode\_next\_flac\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{5578 \{}
\DoxyCodeLine{5579     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5580 }
\DoxyCodeLine{5581     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5582         drflac\_result result;}
\DoxyCodeLine{5583 }
\DoxyCodeLine{5584         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{5585             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5586         \}}
\DoxyCodeLine{5587 }
\DoxyCodeLine{5588         result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{5589         \textcolor{keywordflow}{if} (result != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5590             \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{5591                 \textcolor{keywordflow}{continue};   \textcolor{comment}{/* CRC mismatch. Skip to the next frame. */}}
\DoxyCodeLine{5592             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5593                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5594             \}}
\DoxyCodeLine{5595         \}}
\DoxyCodeLine{5596 }
\DoxyCodeLine{5597         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5598     \}}
\DoxyCodeLine{5599 \}}
\DoxyCodeLine{5600 }
\DoxyCodeLine{5601 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64* pFirstPCMFrame, drflac\_uint64* pLastPCMFrame)}
\DoxyCodeLine{5602 \{}
\DoxyCodeLine{5603     drflac\_uint64 firstPCMFrame;}
\DoxyCodeLine{5604     drflac\_uint64 lastPCMFrame;}
\DoxyCodeLine{5605 }
\DoxyCodeLine{5606     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5607 }
\DoxyCodeLine{5608     firstPCMFrame = pFlac-\/>currentFLACFrame.header.pcmFrameNumber;}
\DoxyCodeLine{5609     \textcolor{keywordflow}{if} (firstPCMFrame == 0) \{}
\DoxyCodeLine{5610         firstPCMFrame = ((drflac\_uint64)pFlac-\/>currentFLACFrame.header.flacFrameNumber) * pFlac-\/>maxBlockSizeInPCMFrames;}
\DoxyCodeLine{5611     \}}
\DoxyCodeLine{5612 }
\DoxyCodeLine{5613     lastPCMFrame = firstPCMFrame + pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames;}
\DoxyCodeLine{5614     \textcolor{keywordflow}{if} (lastPCMFrame > 0) \{}
\DoxyCodeLine{5615         lastPCMFrame -\/= 1; \textcolor{comment}{/* Needs to be zero based. */}}
\DoxyCodeLine{5616     \}}
\DoxyCodeLine{5617 }
\DoxyCodeLine{5618     \textcolor{keywordflow}{if} (pFirstPCMFrame) \{}
\DoxyCodeLine{5619         *pFirstPCMFrame = firstPCMFrame;}
\DoxyCodeLine{5620     \}}
\DoxyCodeLine{5621     \textcolor{keywordflow}{if} (pLastPCMFrame) \{}
\DoxyCodeLine{5622         *pLastPCMFrame = lastPCMFrame;}
\DoxyCodeLine{5623     \}}
\DoxyCodeLine{5624 \}}
\DoxyCodeLine{5625 }
\DoxyCodeLine{5626 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_first\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{5627 \{}
\DoxyCodeLine{5628     drflac\_bool32 result;}
\DoxyCodeLine{5629 }
\DoxyCodeLine{5630     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5631 }
\DoxyCodeLine{5632     result = drflac\_\_seek\_to\_byte(\&pFlac-\/>bs, pFlac-\/>firstFLACFramePosInBytes);}
\DoxyCodeLine{5633 }
\DoxyCodeLine{5634     DRFLAC\_ZERO\_MEMORY(\&pFlac-\/>currentFLACFrame, \textcolor{keyword}{sizeof}(pFlac-\/>currentFLACFrame));}
\DoxyCodeLine{5635     pFlac-\/>currentPCMFrame = 0;}
\DoxyCodeLine{5636 }
\DoxyCodeLine{5637     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{5638 \}}
\DoxyCodeLine{5639 }
\DoxyCodeLine{5640 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_result drflac\_\_seek\_to\_next\_flac\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{5641 \{}
\DoxyCodeLine{5642     \textcolor{comment}{/* This function should only ever be called while the decoder is sitting on the first byte past the FRAME\_HEADER section. */}}
\DoxyCodeLine{5643     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5644     \textcolor{keywordflow}{return} drflac\_\_seek\_flac\_frame(pFlac);}
\DoxyCodeLine{5645 \}}
\DoxyCodeLine{5646 }
\DoxyCodeLine{5647 }
\DoxyCodeLine{5648 \textcolor{keyword}{static} drflac\_uint64 drflac\_\_seek\_forward\_by\_pcm\_frames(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFramesToSeek)}
\DoxyCodeLine{5649 \{}
\DoxyCodeLine{5650     drflac\_uint64 pcmFramesRead = 0;}
\DoxyCodeLine{5651     \textcolor{keywordflow}{while} (pcmFramesToSeek > 0) \{}
\DoxyCodeLine{5652         \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{5653             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac)) \{}
\DoxyCodeLine{5654                 \textcolor{keywordflow}{break};  \textcolor{comment}{/* Couldn't read the next frame, so just break from the loop and return. */}}
\DoxyCodeLine{5655             \}}
\DoxyCodeLine{5656         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5657             \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining > pcmFramesToSeek) \{}
\DoxyCodeLine{5658                 pcmFramesRead   += pcmFramesToSeek;}
\DoxyCodeLine{5659                 pFlac-\/>currentFLACFrame.pcmFramesRemaining -\/= (drflac\_uint32)pcmFramesToSeek;   \textcolor{comment}{/* <-\/-\/ Safe cast. Will always be < currentFrame.pcmFramesRemaining < 65536. */}}
\DoxyCodeLine{5660                 pcmFramesToSeek  = 0;}
\DoxyCodeLine{5661             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5662                 pcmFramesRead   += pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{5663                 pcmFramesToSeek -\/= pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{5664                 pFlac-\/>currentFLACFrame.pcmFramesRemaining = 0;}
\DoxyCodeLine{5665             \}}
\DoxyCodeLine{5666         \}}
\DoxyCodeLine{5667     \}}
\DoxyCodeLine{5668 }
\DoxyCodeLine{5669     pFlac-\/>currentPCMFrame += pcmFramesRead;}
\DoxyCodeLine{5670     \textcolor{keywordflow}{return} pcmFramesRead;}
\DoxyCodeLine{5671 \}}
\DoxyCodeLine{5672 }
\DoxyCodeLine{5673 }
\DoxyCodeLine{5674 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_pcm\_frame\_\_brute\_force(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex)}
\DoxyCodeLine{5675 \{}
\DoxyCodeLine{5676     drflac\_bool32 isMidFrame = DRFLAC\_FALSE;}
\DoxyCodeLine{5677     drflac\_uint64 runningPCMFrameCount;}
\DoxyCodeLine{5678 }
\DoxyCodeLine{5679     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5680 }
\DoxyCodeLine{5681     \textcolor{comment}{/* If we are seeking forward we start from the current position. Otherwise we need to start all the way from the start of the file. */}}
\DoxyCodeLine{5682     \textcolor{keywordflow}{if} (pcmFrameIndex >= pFlac-\/>currentPCMFrame) \{}
\DoxyCodeLine{5683         \textcolor{comment}{/* Seeking forward. Need to seek from the current position. */}}
\DoxyCodeLine{5684         runningPCMFrameCount = pFlac-\/>currentPCMFrame;}
\DoxyCodeLine{5685 }
\DoxyCodeLine{5686         \textcolor{comment}{/* The frame header for the first frame may not yet have been read. We need to do that if necessary. */}}
\DoxyCodeLine{5687         \textcolor{keywordflow}{if} (pFlac-\/>currentPCMFrame == 0 \&\& pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{5688             \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{5689                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5690             \}}
\DoxyCodeLine{5691         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5692             isMidFrame = DRFLAC\_TRUE;}
\DoxyCodeLine{5693         \}}
\DoxyCodeLine{5694     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5695         \textcolor{comment}{/* Seeking backwards. Need to seek from the start of the file. */}}
\DoxyCodeLine{5696         runningPCMFrameCount = 0;}
\DoxyCodeLine{5697 }
\DoxyCodeLine{5698         \textcolor{comment}{/* Move back to the start. */}}
\DoxyCodeLine{5699         \textcolor{keywordflow}{if} (!drflac\_\_seek\_to\_first\_frame(pFlac)) \{}
\DoxyCodeLine{5700             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5701         \}}
\DoxyCodeLine{5702 }
\DoxyCodeLine{5703         \textcolor{comment}{/* Decode the first frame in preparation for sample-\/exact seeking below. */}}
\DoxyCodeLine{5704         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{5705             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5706         \}}
\DoxyCodeLine{5707     \}}
\DoxyCodeLine{5708 }
\DoxyCodeLine{5709     \textcolor{comment}{/*}}
\DoxyCodeLine{5710 \textcolor{comment}{    We need to as quickly as possible find the frame that contains the target sample. To do this, we iterate over each frame and inspect its}}
\DoxyCodeLine{5711 \textcolor{comment}{    header. If based on the header we can determine that the frame contains the sample, we do a full decode of that frame.}}
\DoxyCodeLine{5712 \textcolor{comment}{    */}}
\DoxyCodeLine{5713     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5714         drflac\_uint64 pcmFrameCountInThisFLACFrame;}
\DoxyCodeLine{5715         drflac\_uint64 firstPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{5716         drflac\_uint64 lastPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{5717 }
\DoxyCodeLine{5718         drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&firstPCMFrameInFLACFrame, \&lastPCMFrameInFLACFrame);}
\DoxyCodeLine{5719 }
\DoxyCodeLine{5720         pcmFrameCountInThisFLACFrame = (lastPCMFrameInFLACFrame -\/ firstPCMFrameInFLACFrame) + 1;}
\DoxyCodeLine{5721         \textcolor{keywordflow}{if} (pcmFrameIndex < (runningPCMFrameCount + pcmFrameCountInThisFLACFrame)) \{}
\DoxyCodeLine{5722             \textcolor{comment}{/*}}
\DoxyCodeLine{5723 \textcolor{comment}{            The sample should be in this frame. We need to fully decode it, however if it's an invalid frame (a CRC mismatch), we need to pretend}}
\DoxyCodeLine{5724 \textcolor{comment}{            it never existed and keep iterating.}}
\DoxyCodeLine{5725 \textcolor{comment}{            */}}
\DoxyCodeLine{5726             drflac\_uint64 pcmFramesToDecode = pcmFrameIndex -\/ runningPCMFrameCount;}
\DoxyCodeLine{5727 }
\DoxyCodeLine{5728             \textcolor{keywordflow}{if} (!isMidFrame) \{}
\DoxyCodeLine{5729                 drflac\_result result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{5730                 \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5731                     \textcolor{comment}{/* The frame is valid. We just need to skip over some samples to ensure it's sample-\/exact. */}}
\DoxyCodeLine{5732                     \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFramesToDecode) == pcmFramesToDecode;  \textcolor{comment}{/* <-\/-\/ If this fails, something bad has happened (it should never fail). */}}
\DoxyCodeLine{5733                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5734                     \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{5735                         \textcolor{keywordflow}{goto} next\_iteration;   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{5736                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5737                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5738                     \}}
\DoxyCodeLine{5739                 \}}
\DoxyCodeLine{5740             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5741                 \textcolor{comment}{/* We started seeking mid-\/frame which means we need to skip the frame decoding part. */}}
\DoxyCodeLine{5742                 \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFramesToDecode) == pcmFramesToDecode;}
\DoxyCodeLine{5743             \}}
\DoxyCodeLine{5744         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5745             \textcolor{comment}{/*}}
\DoxyCodeLine{5746 \textcolor{comment}{            It's not in this frame. We need to seek past the frame, but check if there was a CRC mismatch. If so, we pretend this}}
\DoxyCodeLine{5747 \textcolor{comment}{            frame never existed and leave the running sample count untouched.}}
\DoxyCodeLine{5748 \textcolor{comment}{            */}}
\DoxyCodeLine{5749             \textcolor{keywordflow}{if} (!isMidFrame) \{}
\DoxyCodeLine{5750                 drflac\_result result = drflac\_\_seek\_to\_next\_flac\_frame(pFlac);}
\DoxyCodeLine{5751                 \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5752                     runningPCMFrameCount += pcmFrameCountInThisFLACFrame;}
\DoxyCodeLine{5753                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5754                     \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{5755                         \textcolor{keywordflow}{goto} next\_iteration;   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{5756                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5757                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5758                     \}}
\DoxyCodeLine{5759                 \}}
\DoxyCodeLine{5760             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5761                 \textcolor{comment}{/*}}
\DoxyCodeLine{5762 \textcolor{comment}{                We started seeking mid-\/frame which means we need to seek by reading to the end of the frame instead of with}}
\DoxyCodeLine{5763 \textcolor{comment}{                drflac\_\_seek\_to\_next\_flac\_frame() which only works if the decoder is sitting on the byte just after the frame header.}}
\DoxyCodeLine{5764 \textcolor{comment}{                */}}
\DoxyCodeLine{5765                 runningPCMFrameCount += pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{5766                 pFlac-\/>currentFLACFrame.pcmFramesRemaining = 0;}
\DoxyCodeLine{5767                 isMidFrame = DRFLAC\_FALSE;}
\DoxyCodeLine{5768             \}}
\DoxyCodeLine{5769 }
\DoxyCodeLine{5770             \textcolor{comment}{/* If we are seeking to the end of the file and we've just hit it, we're done. */}}
\DoxyCodeLine{5771             \textcolor{keywordflow}{if} (pcmFrameIndex == pFlac-\/>totalPCMFrameCount \&\& runningPCMFrameCount == pFlac-\/>totalPCMFrameCount) \{}
\DoxyCodeLine{5772                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5773             \}}
\DoxyCodeLine{5774         \}}
\DoxyCodeLine{5775 }
\DoxyCodeLine{5776     next\_iteration:}
\DoxyCodeLine{5777         \textcolor{comment}{/* Grab the next frame in preparation for the next iteration. */}}
\DoxyCodeLine{5778         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{5779             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5780         \}}
\DoxyCodeLine{5781     \}}
\DoxyCodeLine{5782 \}}
\DoxyCodeLine{5783 }
\DoxyCodeLine{5784 }
\DoxyCodeLine{5785 \textcolor{preprocessor}{\#if !defined(DR\_FLAC\_NO\_CRC)}}
\DoxyCodeLine{5786 \textcolor{comment}{/*}}
\DoxyCodeLine{5787 \textcolor{comment}{We use an average compression ratio to determine our approximate start location. FLAC files are generally about 50\%-\/70\% the size of their}}
\DoxyCodeLine{5788 \textcolor{comment}{uncompressed counterparts so we'll use this as a basis. I'm going to split the middle and use a factor of 0.6 to determine the starting}}
\DoxyCodeLine{5789 \textcolor{comment}{location.}}
\DoxyCodeLine{5790 \textcolor{comment}{*/}}
\DoxyCodeLine{5791 \textcolor{preprocessor}{\#define DRFLAC\_BINARY\_SEARCH\_APPROX\_COMPRESSION\_RATIO 0.6f}}
\DoxyCodeLine{5792 }
\DoxyCodeLine{5793 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_approximate\_flac\_frame\_to\_byte(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 targetByte, drflac\_uint64 rangeLo, drflac\_uint64 rangeHi, drflac\_uint64* pLastSuccessfulSeekOffset)}
\DoxyCodeLine{5794 \{}
\DoxyCodeLine{5795     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{5796     DRFLAC\_ASSERT(pLastSuccessfulSeekOffset != NULL);}
\DoxyCodeLine{5797     DRFLAC\_ASSERT(targetByte >= rangeLo);}
\DoxyCodeLine{5798     DRFLAC\_ASSERT(targetByte <= rangeHi);}
\DoxyCodeLine{5799 }
\DoxyCodeLine{5800     *pLastSuccessfulSeekOffset = pFlac-\/>firstFLACFramePosInBytes;}
\DoxyCodeLine{5801 }
\DoxyCodeLine{5802     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5803         \textcolor{comment}{/* After rangeLo == rangeHi == targetByte fails, we need to break out. */}}
\DoxyCodeLine{5804         drflac\_uint64 lastTargetByte = targetByte;}
\DoxyCodeLine{5805 }
\DoxyCodeLine{5806         \textcolor{comment}{/* When seeking to a byte, failure probably means we've attempted to seek beyond the end of the stream. To counter this we just halve it each attempt. */}}
\DoxyCodeLine{5807         \textcolor{keywordflow}{if} (!drflac\_\_seek\_to\_byte(\&pFlac-\/>bs, targetByte)) \{}
\DoxyCodeLine{5808             \textcolor{comment}{/* If we couldn't even seek to the first byte in the stream we have a problem. Just abandon the whole thing. */}}
\DoxyCodeLine{5809             \textcolor{keywordflow}{if} (targetByte == 0) \{}
\DoxyCodeLine{5810                 drflac\_\_seek\_to\_first\_frame(pFlac); \textcolor{comment}{/* Try to recover. */}}
\DoxyCodeLine{5811                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5812             \}}
\DoxyCodeLine{5813 }
\DoxyCodeLine{5814             \textcolor{comment}{/* Halve the byte location and continue. */}}
\DoxyCodeLine{5815             targetByte = rangeLo + ((rangeHi -\/ rangeLo)/2);}
\DoxyCodeLine{5816             rangeHi = targetByte;}
\DoxyCodeLine{5817         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5818             \textcolor{comment}{/* Getting here should mean that we have seeked to an appropriate byte. */}}
\DoxyCodeLine{5819 }
\DoxyCodeLine{5820             \textcolor{comment}{/* Clear the details of the FLAC frame so we don't misreport data. */}}
\DoxyCodeLine{5821             DRFLAC\_ZERO\_MEMORY(\&pFlac-\/>currentFLACFrame, \textcolor{keyword}{sizeof}(pFlac-\/>currentFLACFrame));}
\DoxyCodeLine{5822 }
\DoxyCodeLine{5823             \textcolor{comment}{/*}}
\DoxyCodeLine{5824 \textcolor{comment}{            Now seek to the next FLAC frame. We need to decode the entire frame (not just the header) because it's possible for the header to incorrectly pass the}}
\DoxyCodeLine{5825 \textcolor{comment}{            CRC check and return bad data. We need to decode the entire frame to be more certain. Although this seems unlikely, this has happened to me in testing}}
\DoxyCodeLine{5826 \textcolor{comment}{            so it needs to stay this way for now.}}
\DoxyCodeLine{5827 \textcolor{comment}{            */}}
\DoxyCodeLine{5828 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{5829             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac)) \{}
\DoxyCodeLine{5830                 \textcolor{comment}{/* Halve the byte location and continue. */}}
\DoxyCodeLine{5831                 targetByte = rangeLo + ((rangeHi -\/ rangeLo)/2);}
\DoxyCodeLine{5832                 rangeHi = targetByte;}
\DoxyCodeLine{5833             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5834                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{5835             \}}
\DoxyCodeLine{5836 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{5837             \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{5838                 \textcolor{comment}{/* Halve the byte location and continue. */}}
\DoxyCodeLine{5839                 targetByte = rangeLo + ((rangeHi -\/ rangeLo)/2);}
\DoxyCodeLine{5840                 rangeHi = targetByte;}
\DoxyCodeLine{5841             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5842                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{5843             \}}
\DoxyCodeLine{5844 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5845         \}}
\DoxyCodeLine{5846 }
\DoxyCodeLine{5847         \textcolor{comment}{/* We already tried this byte and there are no more to try, break out. */}}
\DoxyCodeLine{5848         \textcolor{keywordflow}{if}(targetByte == lastTargetByte) \{}
\DoxyCodeLine{5849             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5850         \}}
\DoxyCodeLine{5851     \}}
\DoxyCodeLine{5852 }
\DoxyCodeLine{5853     \textcolor{comment}{/* The current PCM frame needs to be updated based on the frame we just seeked to. */}}
\DoxyCodeLine{5854     drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&pFlac-\/>currentPCMFrame, NULL);}
\DoxyCodeLine{5855 }
\DoxyCodeLine{5856     DRFLAC\_ASSERT(targetByte <= rangeHi);}
\DoxyCodeLine{5857 }
\DoxyCodeLine{5858     *pLastSuccessfulSeekOffset = targetByte;}
\DoxyCodeLine{5859     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5860 \}}
\DoxyCodeLine{5861 }
\DoxyCodeLine{5862 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_decode\_flac\_frame\_and\_seek\_forward\_by\_pcm\_frames(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 offset)}
\DoxyCodeLine{5863 \{}
\DoxyCodeLine{5864     \textcolor{comment}{/* This section of code would be used if we were only decoding the FLAC frame header when calling drflac\_\_seek\_to\_approximate\_flac\_frame\_to\_byte(). */}}
\DoxyCodeLine{5865 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{5866     \textcolor{keywordflow}{if} (drflac\_\_decode\_flac\_frame(pFlac) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{5867         \textcolor{comment}{/* We failed to decode this frame which may be due to it being corrupt. We'll just use the next valid FLAC frame. */}}
\DoxyCodeLine{5868         \textcolor{keywordflow}{if} (drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac) == DRFLAC\_FALSE) \{}
\DoxyCodeLine{5869             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5870         \}}
\DoxyCodeLine{5871     \}}
\DoxyCodeLine{5872 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5873 }
\DoxyCodeLine{5874     \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, offset) == offset;}
\DoxyCodeLine{5875 \}}
\DoxyCodeLine{5876 }
\DoxyCodeLine{5877 }
\DoxyCodeLine{5878 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_pcm\_frame\_\_binary\_search\_internal(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex, drflac\_uint64 byteRangeLo, drflac\_uint64 byteRangeHi)}
\DoxyCodeLine{5879 \{}
\DoxyCodeLine{5880     \textcolor{comment}{/* This assumes pFlac-\/>currentPCMFrame is sitting on byteRangeLo upon entry. */}}
\DoxyCodeLine{5881 }
\DoxyCodeLine{5882     drflac\_uint64 targetByte;}
\DoxyCodeLine{5883     drflac\_uint64 pcmRangeLo = pFlac-\/>totalPCMFrameCount;}
\DoxyCodeLine{5884     drflac\_uint64 pcmRangeHi = 0;}
\DoxyCodeLine{5885     drflac\_uint64 lastSuccessfulSeekOffset = (drflac\_uint64)-\/1;}
\DoxyCodeLine{5886     drflac\_uint64 closestSeekOffsetBeforeTargetPCMFrame = byteRangeLo;}
\DoxyCodeLine{5887     drflac\_uint32 seekForwardThreshold = (pFlac-\/>maxBlockSizeInPCMFrames != 0) ? pFlac-\/>maxBlockSizeInPCMFrames*2 : 4096;}
\DoxyCodeLine{5888 }
\DoxyCodeLine{5889     targetByte = byteRangeLo + (drflac\_uint64)(((drflac\_int64)((pcmFrameIndex -\/ pFlac-\/>currentPCMFrame) * pFlac-\/>channels * pFlac-\/>bitsPerSample)/8.0f) * DRFLAC\_BINARY\_SEARCH\_APPROX\_COMPRESSION\_RATIO);}
\DoxyCodeLine{5890     \textcolor{keywordflow}{if} (targetByte > byteRangeHi) \{}
\DoxyCodeLine{5891         targetByte = byteRangeHi;}
\DoxyCodeLine{5892     \}}
\DoxyCodeLine{5893 }
\DoxyCodeLine{5894     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5895         \textcolor{keywordflow}{if} (drflac\_\_seek\_to\_approximate\_flac\_frame\_to\_byte(pFlac, targetByte, byteRangeLo, byteRangeHi, \&lastSuccessfulSeekOffset)) \{}
\DoxyCodeLine{5896             \textcolor{comment}{/* We found a FLAC frame. We need to check if it contains the sample we're looking for. */}}
\DoxyCodeLine{5897             drflac\_uint64 newPCMRangeLo;}
\DoxyCodeLine{5898             drflac\_uint64 newPCMRangeHi;}
\DoxyCodeLine{5899             drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&newPCMRangeLo, \&newPCMRangeHi);}
\DoxyCodeLine{5900 }
\DoxyCodeLine{5901             \textcolor{comment}{/* If we selected the same frame, it means we should be pretty close. Just decode the rest. */}}
\DoxyCodeLine{5902             \textcolor{keywordflow}{if} (pcmRangeLo == newPCMRangeLo) \{}
\DoxyCodeLine{5903                 \textcolor{keywordflow}{if} (!drflac\_\_seek\_to\_approximate\_flac\_frame\_to\_byte(pFlac, closestSeekOffsetBeforeTargetPCMFrame, closestSeekOffsetBeforeTargetPCMFrame, byteRangeHi, \&lastSuccessfulSeekOffset)) \{}
\DoxyCodeLine{5904                     \textcolor{keywordflow}{break};  \textcolor{comment}{/* Failed to seek to closest frame. */}}
\DoxyCodeLine{5905                 \}}
\DoxyCodeLine{5906 }
\DoxyCodeLine{5907                 \textcolor{keywordflow}{if} (drflac\_\_decode\_flac\_frame\_and\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFrameIndex -\/ pFlac-\/>currentPCMFrame)) \{}
\DoxyCodeLine{5908                     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5909                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5910                     \textcolor{keywordflow}{break};  \textcolor{comment}{/* Failed to seek forward. */}}
\DoxyCodeLine{5911                 \}}
\DoxyCodeLine{5912             \}}
\DoxyCodeLine{5913 }
\DoxyCodeLine{5914             pcmRangeLo = newPCMRangeLo;}
\DoxyCodeLine{5915             pcmRangeHi = newPCMRangeHi;}
\DoxyCodeLine{5916 }
\DoxyCodeLine{5917             \textcolor{keywordflow}{if} (pcmRangeLo <= pcmFrameIndex \&\& pcmRangeHi >= pcmFrameIndex) \{}
\DoxyCodeLine{5918                 \textcolor{comment}{/* The target PCM frame is in this FLAC frame. */}}
\DoxyCodeLine{5919                 \textcolor{keywordflow}{if} (drflac\_\_decode\_flac\_frame\_and\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFrameIndex -\/ pFlac-\/>currentPCMFrame) ) \{}
\DoxyCodeLine{5920                     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5921                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5922                     \textcolor{keywordflow}{break};  \textcolor{comment}{/* Failed to seek to FLAC frame. */}}
\DoxyCodeLine{5923                 \}}
\DoxyCodeLine{5924             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5925                 \textcolor{keyword}{const} \textcolor{keywordtype}{float} approxCompressionRatio = (drflac\_int64)(lastSuccessfulSeekOffset -\/ pFlac-\/>firstFLACFramePosInBytes) / ((drflac\_int64)(pcmRangeLo * pFlac-\/>channels * pFlac-\/>bitsPerSample)/8.0f);}
\DoxyCodeLine{5926 }
\DoxyCodeLine{5927                 \textcolor{keywordflow}{if} (pcmRangeLo > pcmFrameIndex) \{}
\DoxyCodeLine{5928                     \textcolor{comment}{/* We seeked too far forward. We need to move our target byte backward and try again. */}}
\DoxyCodeLine{5929                     byteRangeHi = lastSuccessfulSeekOffset;}
\DoxyCodeLine{5930                     \textcolor{keywordflow}{if} (byteRangeLo > byteRangeHi) \{}
\DoxyCodeLine{5931                         byteRangeLo = byteRangeHi;}
\DoxyCodeLine{5932                     \}}
\DoxyCodeLine{5933 }
\DoxyCodeLine{5934                     targetByte = byteRangeLo + ((byteRangeHi -\/ byteRangeLo) / 2);}
\DoxyCodeLine{5935                     \textcolor{keywordflow}{if} (targetByte < byteRangeLo) \{}
\DoxyCodeLine{5936                         targetByte = byteRangeLo;}
\DoxyCodeLine{5937                     \}}
\DoxyCodeLine{5938                 \} \textcolor{keywordflow}{else} \textcolor{comment}{/*if (pcmRangeHi < pcmFrameIndex)*/} \{}
\DoxyCodeLine{5939                     \textcolor{comment}{/* We didn't seek far enough. We need to move our target byte forward and try again. */}}
\DoxyCodeLine{5940 }
\DoxyCodeLine{5941                     \textcolor{comment}{/* If we're close enough we can just seek forward. */}}
\DoxyCodeLine{5942                     \textcolor{keywordflow}{if} ((pcmFrameIndex -\/ pcmRangeLo) < seekForwardThreshold) \{}
\DoxyCodeLine{5943                         \textcolor{keywordflow}{if} (drflac\_\_decode\_flac\_frame\_and\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFrameIndex -\/ pFlac-\/>currentPCMFrame)) \{}
\DoxyCodeLine{5944                             \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{5945                         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5946                             \textcolor{keywordflow}{break};  \textcolor{comment}{/* Failed to seek to FLAC frame. */}}
\DoxyCodeLine{5947                         \}}
\DoxyCodeLine{5948                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5949                         byteRangeLo = lastSuccessfulSeekOffset;}
\DoxyCodeLine{5950                         \textcolor{keywordflow}{if} (byteRangeHi < byteRangeLo) \{}
\DoxyCodeLine{5951                             byteRangeHi = byteRangeLo;}
\DoxyCodeLine{5952                         \}}
\DoxyCodeLine{5953 }
\DoxyCodeLine{5954                         targetByte = lastSuccessfulSeekOffset + (drflac\_uint64)(((drflac\_int64)((pcmFrameIndex-\/pcmRangeLo) * pFlac-\/>channels * pFlac-\/>bitsPerSample)/8.0f) * approxCompressionRatio);}
\DoxyCodeLine{5955                         \textcolor{keywordflow}{if} (targetByte > byteRangeHi) \{}
\DoxyCodeLine{5956                             targetByte = byteRangeHi;}
\DoxyCodeLine{5957                         \}}
\DoxyCodeLine{5958 }
\DoxyCodeLine{5959                         \textcolor{keywordflow}{if} (closestSeekOffsetBeforeTargetPCMFrame < lastSuccessfulSeekOffset) \{}
\DoxyCodeLine{5960                             closestSeekOffsetBeforeTargetPCMFrame = lastSuccessfulSeekOffset;}
\DoxyCodeLine{5961                         \}}
\DoxyCodeLine{5962                     \}}
\DoxyCodeLine{5963                 \}}
\DoxyCodeLine{5964             \}}
\DoxyCodeLine{5965         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5966             \textcolor{comment}{/* Getting here is really bad. We just recover as best we can, but moving to the first frame in the stream, and then abort. */}}
\DoxyCodeLine{5967             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5968         \}}
\DoxyCodeLine{5969     \}}
\DoxyCodeLine{5970 }
\DoxyCodeLine{5971     drflac\_\_seek\_to\_first\_frame(pFlac); \textcolor{comment}{/* <-\/-\/ Try to recover. */}}
\DoxyCodeLine{5972     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5973 \}}
\DoxyCodeLine{5974 }
\DoxyCodeLine{5975 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_pcm\_frame\_\_binary\_search(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex)}
\DoxyCodeLine{5976 \{}
\DoxyCodeLine{5977     drflac\_uint64 byteRangeLo;}
\DoxyCodeLine{5978     drflac\_uint64 byteRangeHi;}
\DoxyCodeLine{5979     drflac\_uint32 seekForwardThreshold = (pFlac-\/>maxBlockSizeInPCMFrames != 0) ? pFlac-\/>maxBlockSizeInPCMFrames*2 : 4096;}
\DoxyCodeLine{5980 }
\DoxyCodeLine{5981     \textcolor{comment}{/* Our algorithm currently assumes the FLAC stream is currently sitting at the start. */}}
\DoxyCodeLine{5982     if (drflac\_\_seek\_to\_first\_frame(pFlac) == DRFLAC\_FALSE) \{}
\DoxyCodeLine{5983         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{5984     \}}
\DoxyCodeLine{5985 }
\DoxyCodeLine{5986     \textcolor{comment}{/* If we're close enough to the start, just move to the start and seek forward. */}}
\DoxyCodeLine{5987     \textcolor{keywordflow}{if} (pcmFrameIndex < seekForwardThreshold) \{}
\DoxyCodeLine{5988         \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFrameIndex) == pcmFrameIndex;}
\DoxyCodeLine{5989     \}}
\DoxyCodeLine{5990 }
\DoxyCodeLine{5991     \textcolor{comment}{/*}}
\DoxyCodeLine{5992 \textcolor{comment}{    Our starting byte range is the byte position of the first FLAC frame and the approximate end of the file as if it were completely uncompressed. This ensures}}
\DoxyCodeLine{5993 \textcolor{comment}{    the entire file is included, even though most of the time it'll exceed the end of the actual stream. This is OK as the frame searching logic will handle it.}}
\DoxyCodeLine{5994 \textcolor{comment}{    */}}
\DoxyCodeLine{5995     byteRangeLo = pFlac-\/>firstFLACFramePosInBytes;}
\DoxyCodeLine{5996     byteRangeHi = pFlac-\/>firstFLACFramePosInBytes + (drflac\_uint64)((drflac\_int64)(pFlac-\/>totalPCMFrameCount * pFlac-\/>channels * pFlac-\/>bitsPerSample)/8.0f);}
\DoxyCodeLine{5997 }
\DoxyCodeLine{5998     \textcolor{keywordflow}{return} drflac\_\_seek\_to\_pcm\_frame\_\_binary\_search\_internal(pFlac, pcmFrameIndex, byteRangeLo, byteRangeHi);}
\DoxyCodeLine{5999 \}}
\DoxyCodeLine{6000 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* !DR\_FLAC\_NO\_CRC */}\textcolor{preprocessor}{}}
\DoxyCodeLine{6001 }
\DoxyCodeLine{6002 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_seek\_to\_pcm\_frame\_\_seek\_table(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex)}
\DoxyCodeLine{6003 \{}
\DoxyCodeLine{6004     drflac\_uint32 iClosestSeekpoint = 0;}
\DoxyCodeLine{6005     drflac\_bool32 isMidFrame = DRFLAC\_FALSE;}
\DoxyCodeLine{6006     drflac\_uint64 runningPCMFrameCount;}
\DoxyCodeLine{6007     drflac\_uint32 iSeekpoint;}
\DoxyCodeLine{6008 }
\DoxyCodeLine{6009 }
\DoxyCodeLine{6010     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{6011 }
\DoxyCodeLine{6012     \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints == NULL || pFlac-\/>seekpointCount == 0) \{}
\DoxyCodeLine{6013         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6014     \}}
\DoxyCodeLine{6015 }
\DoxyCodeLine{6016     \textcolor{keywordflow}{for} (iSeekpoint = 0; iSeekpoint < pFlac-\/>seekpointCount; ++iSeekpoint) \{}
\DoxyCodeLine{6017         \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints[iSeekpoint].firstPCMFrame >= pcmFrameIndex) \{}
\DoxyCodeLine{6018             \textcolor{keywordflow}{break};}
\DoxyCodeLine{6019         \}}
\DoxyCodeLine{6020 }
\DoxyCodeLine{6021         iClosestSeekpoint = iSeekpoint;}
\DoxyCodeLine{6022     \}}
\DoxyCodeLine{6023 }
\DoxyCodeLine{6024     \textcolor{comment}{/* There's been cases where the seek table contains only zeros. We need to do some basic validation on the closest seekpoint. */}}
\DoxyCodeLine{6025     \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints[iClosestSeekpoint].pcmFrameCount == 0 || pFlac-\/>pSeekpoints[iClosestSeekpoint].pcmFrameCount > pFlac-\/>maxBlockSizeInPCMFrames) \{}
\DoxyCodeLine{6026         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6027     \}}
\DoxyCodeLine{6028     \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints[iClosestSeekpoint].firstPCMFrame > pFlac-\/>totalPCMFrameCount \&\& pFlac-\/>totalPCMFrameCount > 0) \{}
\DoxyCodeLine{6029         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6030     \}}
\DoxyCodeLine{6031 }
\DoxyCodeLine{6032 \textcolor{preprocessor}{\#if !defined(DR\_FLAC\_NO\_CRC)}}
\DoxyCodeLine{6033     \textcolor{comment}{/* At this point we should know the closest seek point. We can use a binary search for this. We need to know the total sample count for this. */}}
\DoxyCodeLine{6034     \textcolor{keywordflow}{if} (pFlac-\/>totalPCMFrameCount > 0) \{}
\DoxyCodeLine{6035         drflac\_uint64 byteRangeLo;}
\DoxyCodeLine{6036         drflac\_uint64 byteRangeHi;}
\DoxyCodeLine{6037 }
\DoxyCodeLine{6038         byteRangeHi = pFlac-\/>firstFLACFramePosInBytes + (drflac\_uint64)((drflac\_int64)(pFlac-\/>totalPCMFrameCount * pFlac-\/>channels * pFlac-\/>bitsPerSample)/8.0f);}
\DoxyCodeLine{6039         byteRangeLo = pFlac-\/>firstFLACFramePosInBytes + pFlac-\/>pSeekpoints[iClosestSeekpoint].flacFrameOffset;}
\DoxyCodeLine{6040 }
\DoxyCodeLine{6041         \textcolor{comment}{/*}}
\DoxyCodeLine{6042 \textcolor{comment}{        If our closest seek point is not the last one, we only need to search between it and the next one. The section below calculates an appropriate starting}}
\DoxyCodeLine{6043 \textcolor{comment}{        value for byteRangeHi which will clamp it appropriately.}}
\DoxyCodeLine{6044 \textcolor{comment}{}}
\DoxyCodeLine{6045 \textcolor{comment}{        Note that the next seekpoint must have an offset greater than the closest seekpoint because otherwise our binary search algorithm will break down. There}}
\DoxyCodeLine{6046 \textcolor{comment}{        have been cases where a seektable consists of seek points where every byte offset is set to 0 which causes problems. If this happens we need to abort.}}
\DoxyCodeLine{6047 \textcolor{comment}{        */}}
\DoxyCodeLine{6048         \textcolor{keywordflow}{if} (iClosestSeekpoint < pFlac-\/>seekpointCount-\/1) \{}
\DoxyCodeLine{6049             drflac\_uint32 iNextSeekpoint = iClosestSeekpoint + 1;}
\DoxyCodeLine{6050 }
\DoxyCodeLine{6051             \textcolor{comment}{/* Basic validation on the seekpoints to ensure they're usable. */}}
\DoxyCodeLine{6052             \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints[iClosestSeekpoint].flacFrameOffset >= pFlac-\/>pSeekpoints[iNextSeekpoint].flacFrameOffset || pFlac-\/>pSeekpoints[iNextSeekpoint].pcmFrameCount == 0) \{}
\DoxyCodeLine{6053                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* The next seekpoint doesn't look right. The seek table cannot be trusted from here. Abort. */}}
\DoxyCodeLine{6054             \}}
\DoxyCodeLine{6055 }
\DoxyCodeLine{6056             \textcolor{keywordflow}{if} (pFlac-\/>pSeekpoints[iNextSeekpoint].firstPCMFrame != (((drflac\_uint64)0xFFFFFFFF << 32) | 0xFFFFFFFF)) \{ \textcolor{comment}{/* Make sure it's not a placeholder seekpoint. */}}
\DoxyCodeLine{6057                 byteRangeHi = pFlac-\/>firstFLACFramePosInBytes + pFlac-\/>pSeekpoints[iNextSeekpoint].flacFrameOffset -\/ 1; \textcolor{comment}{/* byteRangeHi must be zero based. */}}
\DoxyCodeLine{6058             \}}
\DoxyCodeLine{6059         \}}
\DoxyCodeLine{6060 }
\DoxyCodeLine{6061         \textcolor{keywordflow}{if} (drflac\_\_seek\_to\_byte(\&pFlac-\/>bs, pFlac-\/>firstFLACFramePosInBytes + pFlac-\/>pSeekpoints[iClosestSeekpoint].flacFrameOffset)) \{}
\DoxyCodeLine{6062             \textcolor{keywordflow}{if} (drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{6063                 drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&pFlac-\/>currentPCMFrame, NULL);}
\DoxyCodeLine{6064 }
\DoxyCodeLine{6065                 \textcolor{keywordflow}{if} (drflac\_\_seek\_to\_pcm\_frame\_\_binary\_search\_internal(pFlac, pcmFrameIndex, byteRangeLo, byteRangeHi)) \{}
\DoxyCodeLine{6066                     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6067                 \}}
\DoxyCodeLine{6068             \}}
\DoxyCodeLine{6069         \}}
\DoxyCodeLine{6070     \}}
\DoxyCodeLine{6071 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* !DR\_FLAC\_NO\_CRC */}\textcolor{preprocessor}{}}
\DoxyCodeLine{6072 }
\DoxyCodeLine{6073     \textcolor{comment}{/* Getting here means we need to use a slower algorithm because the binary search method failed or cannot be used. */}}
\DoxyCodeLine{6074 }
\DoxyCodeLine{6075     \textcolor{comment}{/*}}
\DoxyCodeLine{6076 \textcolor{comment}{    If we are seeking forward and the closest seekpoint is \_before\_ the current sample, we just seek forward from where we are. Otherwise we start seeking}}
\DoxyCodeLine{6077 \textcolor{comment}{    from the seekpoint's first sample.}}
\DoxyCodeLine{6078 \textcolor{comment}{    */}}
\DoxyCodeLine{6079     \textcolor{keywordflow}{if} (pcmFrameIndex >= pFlac-\/>currentPCMFrame \&\& pFlac-\/>pSeekpoints[iClosestSeekpoint].firstPCMFrame <= pFlac-\/>currentPCMFrame) \{}
\DoxyCodeLine{6080         \textcolor{comment}{/* Optimized case. Just seek forward from where we are. */}}
\DoxyCodeLine{6081         runningPCMFrameCount = pFlac-\/>currentPCMFrame;}
\DoxyCodeLine{6082 }
\DoxyCodeLine{6083         \textcolor{comment}{/* The frame header for the first frame may not yet have been read. We need to do that if necessary. */}}
\DoxyCodeLine{6084         \textcolor{keywordflow}{if} (pFlac-\/>currentPCMFrame == 0 \&\& pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{6085             \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{6086                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6087             \}}
\DoxyCodeLine{6088         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6089             isMidFrame = DRFLAC\_TRUE;}
\DoxyCodeLine{6090         \}}
\DoxyCodeLine{6091     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6092         \textcolor{comment}{/* Slower case. Seek to the start of the seekpoint and then seek forward from there. */}}
\DoxyCodeLine{6093         runningPCMFrameCount = pFlac-\/>pSeekpoints[iClosestSeekpoint].firstPCMFrame;}
\DoxyCodeLine{6094 }
\DoxyCodeLine{6095         \textcolor{keywordflow}{if} (!drflac\_\_seek\_to\_byte(\&pFlac-\/>bs, pFlac-\/>firstFLACFramePosInBytes + pFlac-\/>pSeekpoints[iClosestSeekpoint].flacFrameOffset)) \{}
\DoxyCodeLine{6096             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6097         \}}
\DoxyCodeLine{6098 }
\DoxyCodeLine{6099         \textcolor{comment}{/* Grab the frame the seekpoint is sitting on in preparation for the sample-\/exact seeking below. */}}
\DoxyCodeLine{6100         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{6101             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6102         \}}
\DoxyCodeLine{6103     \}}
\DoxyCodeLine{6104 }
\DoxyCodeLine{6105     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{6106         drflac\_uint64 pcmFrameCountInThisFLACFrame;}
\DoxyCodeLine{6107         drflac\_uint64 firstPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{6108         drflac\_uint64 lastPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{6109 }
\DoxyCodeLine{6110         drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&firstPCMFrameInFLACFrame, \&lastPCMFrameInFLACFrame);}
\DoxyCodeLine{6111 }
\DoxyCodeLine{6112         pcmFrameCountInThisFLACFrame = (lastPCMFrameInFLACFrame -\/ firstPCMFrameInFLACFrame) + 1;}
\DoxyCodeLine{6113         \textcolor{keywordflow}{if} (pcmFrameIndex < (runningPCMFrameCount + pcmFrameCountInThisFLACFrame)) \{}
\DoxyCodeLine{6114             \textcolor{comment}{/*}}
\DoxyCodeLine{6115 \textcolor{comment}{            The sample should be in this frame. We need to fully decode it, but if it's an invalid frame (a CRC mismatch) we need to pretend}}
\DoxyCodeLine{6116 \textcolor{comment}{            it never existed and keep iterating.}}
\DoxyCodeLine{6117 \textcolor{comment}{            */}}
\DoxyCodeLine{6118             drflac\_uint64 pcmFramesToDecode = pcmFrameIndex -\/ runningPCMFrameCount;}
\DoxyCodeLine{6119 }
\DoxyCodeLine{6120             \textcolor{keywordflow}{if} (!isMidFrame) \{}
\DoxyCodeLine{6121                 drflac\_result result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{6122                 \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{6123                     \textcolor{comment}{/* The frame is valid. We just need to skip over some samples to ensure it's sample-\/exact. */}}
\DoxyCodeLine{6124                     \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFramesToDecode) == pcmFramesToDecode;  \textcolor{comment}{/* <-\/-\/ If this fails, something bad has happened (it should never fail). */}}
\DoxyCodeLine{6125                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6126                     \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{6127                         \textcolor{keywordflow}{goto} next\_iteration;   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{6128                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6129                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6130                     \}}
\DoxyCodeLine{6131                 \}}
\DoxyCodeLine{6132             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6133                 \textcolor{comment}{/* We started seeking mid-\/frame which means we need to skip the frame decoding part. */}}
\DoxyCodeLine{6134                 \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFramesToDecode) == pcmFramesToDecode;}
\DoxyCodeLine{6135             \}}
\DoxyCodeLine{6136         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6137             \textcolor{comment}{/*}}
\DoxyCodeLine{6138 \textcolor{comment}{            It's not in this frame. We need to seek past the frame, but check if there was a CRC mismatch. If so, we pretend this}}
\DoxyCodeLine{6139 \textcolor{comment}{            frame never existed and leave the running sample count untouched.}}
\DoxyCodeLine{6140 \textcolor{comment}{            */}}
\DoxyCodeLine{6141             \textcolor{keywordflow}{if} (!isMidFrame) \{}
\DoxyCodeLine{6142                 drflac\_result result = drflac\_\_seek\_to\_next\_flac\_frame(pFlac);}
\DoxyCodeLine{6143                 \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{6144                     runningPCMFrameCount += pcmFrameCountInThisFLACFrame;}
\DoxyCodeLine{6145                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6146                     \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{6147                         \textcolor{keywordflow}{goto} next\_iteration;   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{6148                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6149                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6150                     \}}
\DoxyCodeLine{6151                 \}}
\DoxyCodeLine{6152             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6153                 \textcolor{comment}{/*}}
\DoxyCodeLine{6154 \textcolor{comment}{                We started seeking mid-\/frame which means we need to seek by reading to the end of the frame instead of with}}
\DoxyCodeLine{6155 \textcolor{comment}{                drflac\_\_seek\_to\_next\_flac\_frame() which only works if the decoder is sitting on the byte just after the frame header.}}
\DoxyCodeLine{6156 \textcolor{comment}{                */}}
\DoxyCodeLine{6157                 runningPCMFrameCount += pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{6158                 pFlac-\/>currentFLACFrame.pcmFramesRemaining = 0;}
\DoxyCodeLine{6159                 isMidFrame = DRFLAC\_FALSE;}
\DoxyCodeLine{6160             \}}
\DoxyCodeLine{6161 }
\DoxyCodeLine{6162             \textcolor{comment}{/* If we are seeking to the end of the file and we've just hit it, we're done. */}}
\DoxyCodeLine{6163             \textcolor{keywordflow}{if} (pcmFrameIndex == pFlac-\/>totalPCMFrameCount \&\& runningPCMFrameCount == pFlac-\/>totalPCMFrameCount) \{}
\DoxyCodeLine{6164                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6165             \}}
\DoxyCodeLine{6166         \}}
\DoxyCodeLine{6167 }
\DoxyCodeLine{6168     next\_iteration:}
\DoxyCodeLine{6169         \textcolor{comment}{/* Grab the next frame in preparation for the next iteration. */}}
\DoxyCodeLine{6170         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{6171             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6172         \}}
\DoxyCodeLine{6173     \}}
\DoxyCodeLine{6174 \}}
\DoxyCodeLine{6175 }
\DoxyCodeLine{6176 }
\DoxyCodeLine{6177 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{6178 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{6179 \{}
\DoxyCodeLine{6180     drflac\_uint8 capturePattern[4];  \textcolor{comment}{/* Should be "{}OggS"{} */}}
\DoxyCodeLine{6181     drflac\_uint8 structureVersion;   \textcolor{comment}{/* Always 0. */}}
\DoxyCodeLine{6182     drflac\_uint8 headerType;}
\DoxyCodeLine{6183     drflac\_uint64 granulePosition;}
\DoxyCodeLine{6184     drflac\_uint32 serialNumber;}
\DoxyCodeLine{6185     drflac\_uint32 sequenceNumber;}
\DoxyCodeLine{6186     drflac\_uint32 checksum;}
\DoxyCodeLine{6187     drflac\_uint8 segmentCount;}
\DoxyCodeLine{6188     drflac\_uint8 segmentTable[255];}
\DoxyCodeLine{6189 \} drflac\_ogg\_page\_header;}
\DoxyCodeLine{6190 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6191 }
\DoxyCodeLine{6192 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{6193 \{}
\DoxyCodeLine{6194     drflac\_read\_proc onRead;}
\DoxyCodeLine{6195     drflac\_seek\_proc onSeek;}
\DoxyCodeLine{6196     drflac\_meta\_proc onMeta;}
\DoxyCodeLine{6197     drflac\_container container;}
\DoxyCodeLine{6198     \textcolor{keywordtype}{void}* pUserData;}
\DoxyCodeLine{6199     \textcolor{keywordtype}{void}* pUserDataMD;}
\DoxyCodeLine{6200     drflac\_uint32 sampleRate;}
\DoxyCodeLine{6201     drflac\_uint8  channels;}
\DoxyCodeLine{6202     drflac\_uint8  bitsPerSample;}
\DoxyCodeLine{6203     drflac\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{6204     drflac\_uint16 maxBlockSizeInPCMFrames;}
\DoxyCodeLine{6205     drflac\_uint64 runningFilePos;}
\DoxyCodeLine{6206     drflac\_bool32 hasStreamInfoBlock;}
\DoxyCodeLine{6207     drflac\_bool32 hasMetadataBlocks;}
\DoxyCodeLine{6208     \mbox{\hyperlink{structdrflac__bs}{drflac\_bs}} bs;                           \textcolor{comment}{/* <-\/-\/ A bit streamer is required for loading data during initialization. */}}
\DoxyCodeLine{6209     \mbox{\hyperlink{structdrflac__frame__header}{drflac\_frame\_header}} firstFrameHeader;   \textcolor{comment}{/* <-\/-\/ The header of the first frame that was read during relaxed initalization. Only set if there is no STREAMINFO block. */}}
\DoxyCodeLine{6210 }
\DoxyCodeLine{6211 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{6212     drflac\_uint32 oggSerial;}
\DoxyCodeLine{6213     drflac\_uint64 oggFirstBytePos;}
\DoxyCodeLine{6214     drflac\_ogg\_page\_header oggBosHeader;}
\DoxyCodeLine{6215 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6216 \} drflac\_init\_info;}
\DoxyCodeLine{6217 }
\DoxyCodeLine{6218 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_\_decode\_block\_header(drflac\_uint32 blockHeader, drflac\_uint8* isLastBlock, drflac\_uint8* blockType, drflac\_uint32* blockSize)}
\DoxyCodeLine{6219 \{}
\DoxyCodeLine{6220     blockHeader = drflac\_\_be2host\_32(blockHeader);}
\DoxyCodeLine{6221     *isLastBlock = (drflac\_uint8)((blockHeader \& 0x80000000UL) >> 31);}
\DoxyCodeLine{6222     *blockType   = (drflac\_uint8)((blockHeader \& 0x7F000000UL) >> 24);}
\DoxyCodeLine{6223     *blockSize   =                (blockHeader \& 0x00FFFFFFUL);}
\DoxyCodeLine{6224 \}}
\DoxyCodeLine{6225 }
\DoxyCodeLine{6226 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_\_read\_and\_decode\_block\_header(drflac\_read\_proc onRead, \textcolor{keywordtype}{void}* pUserData, drflac\_uint8* isLastBlock, drflac\_uint8* blockType, drflac\_uint32* blockSize)}
\DoxyCodeLine{6227 \{}
\DoxyCodeLine{6228     drflac\_uint32 blockHeader;}
\DoxyCodeLine{6229 }
\DoxyCodeLine{6230     *blockSize = 0;}
\DoxyCodeLine{6231     \textcolor{keywordflow}{if} (onRead(pUserData, \&blockHeader, 4) != 4) \{}
\DoxyCodeLine{6232         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6233     \}}
\DoxyCodeLine{6234 }
\DoxyCodeLine{6235     drflac\_\_decode\_block\_header(blockHeader, isLastBlock, blockType, blockSize);}
\DoxyCodeLine{6236     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6237 \}}
\DoxyCodeLine{6238 }
\DoxyCodeLine{6239 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_streaminfo(drflac\_read\_proc onRead, \textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrflac__streaminfo}{drflac\_streaminfo}}* pStreamInfo)}
\DoxyCodeLine{6240 \{}
\DoxyCodeLine{6241     drflac\_uint32 blockSizes;}
\DoxyCodeLine{6242     drflac\_uint64 frameSizes = 0;}
\DoxyCodeLine{6243     drflac\_uint64 importantProps;}
\DoxyCodeLine{6244     drflac\_uint8 md5[16];}
\DoxyCodeLine{6245 }
\DoxyCodeLine{6246     \textcolor{comment}{/* min/max block size. */}}
\DoxyCodeLine{6247     \textcolor{keywordflow}{if} (onRead(pUserData, \&blockSizes, 4) != 4) \{}
\DoxyCodeLine{6248         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6249     \}}
\DoxyCodeLine{6250 }
\DoxyCodeLine{6251     \textcolor{comment}{/* min/max frame size. */}}
\DoxyCodeLine{6252     \textcolor{keywordflow}{if} (onRead(pUserData, \&frameSizes, 6) != 6) \{}
\DoxyCodeLine{6253         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6254     \}}
\DoxyCodeLine{6255 }
\DoxyCodeLine{6256     \textcolor{comment}{/* Sample rate, channels, bits per sample and total sample count. */}}
\DoxyCodeLine{6257     \textcolor{keywordflow}{if} (onRead(pUserData, \&importantProps, 8) != 8) \{}
\DoxyCodeLine{6258         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6259     \}}
\DoxyCodeLine{6260 }
\DoxyCodeLine{6261     \textcolor{comment}{/* MD5 */}}
\DoxyCodeLine{6262     \textcolor{keywordflow}{if} (onRead(pUserData, md5, \textcolor{keyword}{sizeof}(md5)) != \textcolor{keyword}{sizeof}(md5)) \{}
\DoxyCodeLine{6263         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6264     \}}
\DoxyCodeLine{6265 }
\DoxyCodeLine{6266     blockSizes     = drflac\_\_be2host\_32(blockSizes);}
\DoxyCodeLine{6267     frameSizes     = drflac\_\_be2host\_64(frameSizes);}
\DoxyCodeLine{6268     importantProps = drflac\_\_be2host\_64(importantProps);}
\DoxyCodeLine{6269 }
\DoxyCodeLine{6270     pStreamInfo-\/>minBlockSizeInPCMFrames = (drflac\_uint16)((blockSizes \& 0xFFFF0000) >> 16);}
\DoxyCodeLine{6271     pStreamInfo-\/>maxBlockSizeInPCMFrames = (drflac\_uint16) (blockSizes \& 0x0000FFFF);}
\DoxyCodeLine{6272     pStreamInfo-\/>minFrameSizeInPCMFrames = (drflac\_uint32)((frameSizes     \&  (((drflac\_uint64)0x00FFFFFF << 16) << 24)) >> 40);}
\DoxyCodeLine{6273     pStreamInfo-\/>maxFrameSizeInPCMFrames = (drflac\_uint32)((frameSizes     \&  (((drflac\_uint64)0x00FFFFFF << 16) <<  0)) >> 16);}
\DoxyCodeLine{6274     pStreamInfo-\/>sampleRate              = (drflac\_uint32)((importantProps \&  (((drflac\_uint64)0x000FFFFF << 16) << 28)) >> 44);}
\DoxyCodeLine{6275     pStreamInfo-\/>channels                = (drflac\_uint8 )((importantProps \&  (((drflac\_uint64)0x0000000E << 16) << 24)) >> 41) + 1;}
\DoxyCodeLine{6276     pStreamInfo-\/>bitsPerSample           = (drflac\_uint8 )((importantProps \&  (((drflac\_uint64)0x0000001F << 16) << 20)) >> 36) + 1;}
\DoxyCodeLine{6277     pStreamInfo-\/>totalPCMFrameCount      =                ((importantProps \& ((((drflac\_uint64)0x0000000F << 16) << 16) | 0xFFFFFFFF)));}
\DoxyCodeLine{6278     DRFLAC\_COPY\_MEMORY(pStreamInfo-\/>md5, md5, \textcolor{keyword}{sizeof}(md5));}
\DoxyCodeLine{6279 }
\DoxyCodeLine{6280     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6281 \}}
\DoxyCodeLine{6282 }
\DoxyCodeLine{6283 }
\DoxyCodeLine{6284 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drflac\_\_malloc\_default(\textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{6285 \{}
\DoxyCodeLine{6286     (void)pUserData;}
\DoxyCodeLine{6287     \textcolor{keywordflow}{return} DRFLAC\_MALLOC(sz);}
\DoxyCodeLine{6288 \}}
\DoxyCodeLine{6289 }
\DoxyCodeLine{6290 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drflac\_\_realloc\_default(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{6291 \{}
\DoxyCodeLine{6292     (void)pUserData;}
\DoxyCodeLine{6293     \textcolor{keywordflow}{return} DRFLAC\_REALLOC(p, sz);}
\DoxyCodeLine{6294 \}}
\DoxyCodeLine{6295 }
\DoxyCodeLine{6296 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_free\_default(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{6297 \{}
\DoxyCodeLine{6298     (void)pUserData;}
\DoxyCodeLine{6299     DRFLAC\_FREE(p);}
\DoxyCodeLine{6300 \}}
\DoxyCodeLine{6301 }
\DoxyCodeLine{6302 }
\DoxyCodeLine{6303 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drflac\_\_malloc\_from\_callbacks(\textcolor{keywordtype}{size\_t} sz, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{6304 \{}
\DoxyCodeLine{6305     \textcolor{keywordflow}{if} (pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{6306         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6307     \}}
\DoxyCodeLine{6308 }
\DoxyCodeLine{6309     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onMalloc != NULL) \{}
\DoxyCodeLine{6310         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onMalloc(sz, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6311     \}}
\DoxyCodeLine{6312 }
\DoxyCodeLine{6313     \textcolor{comment}{/* Try using realloc(). */}}
\DoxyCodeLine{6314     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onRealloc != NULL) \{}
\DoxyCodeLine{6315         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onRealloc(NULL, sz, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6316     \}}
\DoxyCodeLine{6317 }
\DoxyCodeLine{6318     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6319 \}}
\DoxyCodeLine{6320 }
\DoxyCodeLine{6321 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drflac\_\_realloc\_from\_callbacks(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} szNew, \textcolor{keywordtype}{size\_t} szOld, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{6322 \{}
\DoxyCodeLine{6323     \textcolor{keywordflow}{if} (pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{6324         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6325     \}}
\DoxyCodeLine{6326 }
\DoxyCodeLine{6327     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onRealloc != NULL) \{}
\DoxyCodeLine{6328         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onRealloc(p, szNew, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6329     \}}
\DoxyCodeLine{6330 }
\DoxyCodeLine{6331     \textcolor{comment}{/* Try emulating realloc() in terms of malloc()/free(). */}}
\DoxyCodeLine{6332     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onMalloc != NULL \&\& pAllocationCallbacks-\/>onFree != NULL) \{}
\DoxyCodeLine{6333         \textcolor{keywordtype}{void}* p2;}
\DoxyCodeLine{6334 }
\DoxyCodeLine{6335         p2 = pAllocationCallbacks-\/>onMalloc(szNew, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6336         \textcolor{keywordflow}{if} (p2 == NULL) \{}
\DoxyCodeLine{6337             \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6338         \}}
\DoxyCodeLine{6339 }
\DoxyCodeLine{6340         \textcolor{keywordflow}{if} (p != NULL) \{}
\DoxyCodeLine{6341             DRFLAC\_COPY\_MEMORY(p2, p, szOld);}
\DoxyCodeLine{6342             pAllocationCallbacks-\/>onFree(p, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6343         \}}
\DoxyCodeLine{6344 }
\DoxyCodeLine{6345         \textcolor{keywordflow}{return} p2;}
\DoxyCodeLine{6346     \}}
\DoxyCodeLine{6347 }
\DoxyCodeLine{6348     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6349 \}}
\DoxyCodeLine{6350 }
\DoxyCodeLine{6351 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_free\_from\_callbacks(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{6352 \{}
\DoxyCodeLine{6353     \textcolor{keywordflow}{if} (p == NULL || pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{6354         \textcolor{keywordflow}{return};}
\DoxyCodeLine{6355     \}}
\DoxyCodeLine{6356 }
\DoxyCodeLine{6357     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onFree != NULL) \{}
\DoxyCodeLine{6358         pAllocationCallbacks-\/>onFree(p, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{6359     \}}
\DoxyCodeLine{6360 \}}
\DoxyCodeLine{6361 }
\DoxyCodeLine{6362 }
\DoxyCodeLine{6363 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_read\_and\_decode\_metadata(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pUserDataMD, drflac\_uint64* pFirstFramePos, drflac\_uint64* pSeektablePos, drflac\_uint32* pSeektableSize, \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{6364 \{}
\DoxyCodeLine{6365     \textcolor{comment}{/*}}
\DoxyCodeLine{6366 \textcolor{comment}{    We want to keep track of the byte position in the stream of the seektable. At the time of calling this function we know that}}
\DoxyCodeLine{6367 \textcolor{comment}{    we'll be sitting on byte 42.}}
\DoxyCodeLine{6368 \textcolor{comment}{    */}}
\DoxyCodeLine{6369     drflac\_uint64 runningFilePos = 42;}
\DoxyCodeLine{6370     drflac\_uint64 seektablePos   = 0;}
\DoxyCodeLine{6371     drflac\_uint32 seektableSize  = 0;}
\DoxyCodeLine{6372 }
\DoxyCodeLine{6373     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{6374         \mbox{\hyperlink{structdrflac__metadata}{drflac\_metadata}} metadata;}
\DoxyCodeLine{6375         drflac\_uint8 isLastBlock = 0;}
\DoxyCodeLine{6376         drflac\_uint8 blockType;}
\DoxyCodeLine{6377         drflac\_uint32 blockSize;}
\DoxyCodeLine{6378         \textcolor{keywordflow}{if} (drflac\_\_read\_and\_decode\_block\_header(onRead, pUserData, \&isLastBlock, \&blockType, \&blockSize) == DRFLAC\_FALSE) \{}
\DoxyCodeLine{6379             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6380         \}}
\DoxyCodeLine{6381         runningFilePos += 4;}
\DoxyCodeLine{6382 }
\DoxyCodeLine{6383         metadata.type = blockType;}
\DoxyCodeLine{6384         metadata.pRawData = NULL;}
\DoxyCodeLine{6385         metadata.rawDataSize = 0;}
\DoxyCodeLine{6386 }
\DoxyCodeLine{6387         \textcolor{keywordflow}{switch} (blockType)}
\DoxyCodeLine{6388         \{}
\DoxyCodeLine{6389             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_APPLICATION:}
\DoxyCodeLine{6390             \{}
\DoxyCodeLine{6391                 \textcolor{keywordflow}{if} (blockSize < 4) \{}
\DoxyCodeLine{6392                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6393                 \}}
\DoxyCodeLine{6394 }
\DoxyCodeLine{6395                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6396                     \textcolor{keywordtype}{void}* pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6397                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6398                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6399                     \}}
\DoxyCodeLine{6400 }
\DoxyCodeLine{6401                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6402                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6403                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6404                     \}}
\DoxyCodeLine{6405 }
\DoxyCodeLine{6406                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6407                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6408                     metadata.data.application.id       = drflac\_\_be2host\_32(*(drflac\_uint32*)pRawData);}
\DoxyCodeLine{6409                     metadata.data.application.pData    = (\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)((drflac\_uint8*)pRawData + \textcolor{keyword}{sizeof}(drflac\_uint32));}
\DoxyCodeLine{6410                     metadata.data.application.dataSize = blockSize -\/ \textcolor{keyword}{sizeof}(drflac\_uint32);}
\DoxyCodeLine{6411                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6412 }
\DoxyCodeLine{6413                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6414                 \}}
\DoxyCodeLine{6415             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6416 }
\DoxyCodeLine{6417             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_SEEKTABLE:}
\DoxyCodeLine{6418             \{}
\DoxyCodeLine{6419                 seektablePos  = runningFilePos;}
\DoxyCodeLine{6420                 seektableSize = blockSize;}
\DoxyCodeLine{6421 }
\DoxyCodeLine{6422                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6423                     drflac\_uint32 iSeekpoint;}
\DoxyCodeLine{6424                     \textcolor{keywordtype}{void}* pRawData;}
\DoxyCodeLine{6425 }
\DoxyCodeLine{6426                     pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6427                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6428                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6429                     \}}
\DoxyCodeLine{6430 }
\DoxyCodeLine{6431                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6432                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6433                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6434                     \}}
\DoxyCodeLine{6435 }
\DoxyCodeLine{6436                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6437                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6438                     metadata.data.seektable.seekpointCount = blockSize/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}});}
\DoxyCodeLine{6439                     metadata.data.seektable.pSeekpoints = (\textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}*)pRawData;}
\DoxyCodeLine{6440 }
\DoxyCodeLine{6441                     \textcolor{comment}{/* Endian swap. */}}
\DoxyCodeLine{6442                     \textcolor{keywordflow}{for} (iSeekpoint = 0; iSeekpoint < metadata.data.seektable.seekpointCount; ++iSeekpoint) \{}
\DoxyCodeLine{6443                         \mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}* pSeekpoint = (\mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}*)pRawData + iSeekpoint;}
\DoxyCodeLine{6444                         pSeekpoint-\/>firstPCMFrame   = drflac\_\_be2host\_64(pSeekpoint-\/>firstPCMFrame);}
\DoxyCodeLine{6445                         pSeekpoint-\/>flacFrameOffset = drflac\_\_be2host\_64(pSeekpoint-\/>flacFrameOffset);}
\DoxyCodeLine{6446                         pSeekpoint-\/>pcmFrameCount   = drflac\_\_be2host\_16(pSeekpoint-\/>pcmFrameCount);}
\DoxyCodeLine{6447                     \}}
\DoxyCodeLine{6448 }
\DoxyCodeLine{6449                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6450 }
\DoxyCodeLine{6451                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6452                 \}}
\DoxyCodeLine{6453             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6454 }
\DoxyCodeLine{6455             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_VORBIS\_COMMENT:}
\DoxyCodeLine{6456             \{}
\DoxyCodeLine{6457                 \textcolor{keywordflow}{if} (blockSize < 8) \{}
\DoxyCodeLine{6458                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6459                 \}}
\DoxyCodeLine{6460 }
\DoxyCodeLine{6461                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6462                     \textcolor{keywordtype}{void}* pRawData;}
\DoxyCodeLine{6463                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{6464                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningDataEnd;}
\DoxyCodeLine{6465                     drflac\_uint32 i;}
\DoxyCodeLine{6466 }
\DoxyCodeLine{6467                     pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6468                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6469                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6470                     \}}
\DoxyCodeLine{6471 }
\DoxyCodeLine{6472                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6473                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6474                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6475                     \}}
\DoxyCodeLine{6476 }
\DoxyCodeLine{6477                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6478                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6479 }
\DoxyCodeLine{6480                     pRunningData    = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData;}
\DoxyCodeLine{6481                     pRunningDataEnd = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData + blockSize;}
\DoxyCodeLine{6482 }
\DoxyCodeLine{6483                     metadata.data.vorbis\_comment.vendorLength = drflac\_\_le2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6484 }
\DoxyCodeLine{6485                     \textcolor{comment}{/* Need space for the rest of the block */}}
\DoxyCodeLine{6486                     \textcolor{keywordflow}{if} ((pRunningDataEnd -\/ pRunningData) -\/ 4 < (drflac\_int64)metadata.data.vorbis\_comment.vendorLength) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6487                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6488                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6489                     \}}
\DoxyCodeLine{6490                     metadata.data.vorbis\_comment.vendor       = pRunningData;                                            pRunningData += metadata.data.vorbis\_comment.vendorLength;}
\DoxyCodeLine{6491                     metadata.data.vorbis\_comment.commentCount = drflac\_\_le2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6492 }
\DoxyCodeLine{6493                     \textcolor{comment}{/* Need space for 'commentCount' comments after the block, which at minimum is a drflac\_uint32 per comment */}}
\DoxyCodeLine{6494                     \textcolor{keywordflow}{if} ((pRunningDataEnd -\/ pRunningData) / \textcolor{keyword}{sizeof}(drflac\_uint32) < metadata.data.vorbis\_comment.commentCount) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6495                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6496                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6497                     \}}
\DoxyCodeLine{6498                     metadata.data.vorbis\_comment.pComments    = pRunningData;}
\DoxyCodeLine{6499 }
\DoxyCodeLine{6500                     \textcolor{comment}{/* Check that the comments section is valid before passing it to the callback */}}
\DoxyCodeLine{6501                     \textcolor{keywordflow}{for} (i = 0; i < metadata.data.vorbis\_comment.commentCount; ++i) \{}
\DoxyCodeLine{6502                         drflac\_uint32 commentLength;}
\DoxyCodeLine{6503 }
\DoxyCodeLine{6504                         \textcolor{keywordflow}{if} (pRunningDataEnd -\/ pRunningData < 4) \{}
\DoxyCodeLine{6505                             drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6506                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6507                         \}}
\DoxyCodeLine{6508 }
\DoxyCodeLine{6509                         commentLength = drflac\_\_le2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6510                         \textcolor{keywordflow}{if} (pRunningDataEnd -\/ pRunningData < (drflac\_int64)commentLength) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6511                             drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6512                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6513                         \}}
\DoxyCodeLine{6514                         pRunningData += commentLength;}
\DoxyCodeLine{6515                     \}}
\DoxyCodeLine{6516 }
\DoxyCodeLine{6517                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6518 }
\DoxyCodeLine{6519                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6520                 \}}
\DoxyCodeLine{6521             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6522 }
\DoxyCodeLine{6523             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_CUESHEET:}
\DoxyCodeLine{6524             \{}
\DoxyCodeLine{6525                 \textcolor{keywordflow}{if} (blockSize < 396) \{}
\DoxyCodeLine{6526                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6527                 \}}
\DoxyCodeLine{6528 }
\DoxyCodeLine{6529                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6530                     \textcolor{keywordtype}{void}* pRawData;}
\DoxyCodeLine{6531                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{6532                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningDataEnd;}
\DoxyCodeLine{6533                     drflac\_uint8 iTrack;}
\DoxyCodeLine{6534                     drflac\_uint8 iIndex;}
\DoxyCodeLine{6535 }
\DoxyCodeLine{6536                     pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6537                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6538                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6539                     \}}
\DoxyCodeLine{6540 }
\DoxyCodeLine{6541                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6542                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6543                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6544                     \}}
\DoxyCodeLine{6545 }
\DoxyCodeLine{6546                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6547                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6548 }
\DoxyCodeLine{6549                     pRunningData    = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData;}
\DoxyCodeLine{6550                     pRunningDataEnd = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData + blockSize;}
\DoxyCodeLine{6551 }
\DoxyCodeLine{6552                     DRFLAC\_COPY\_MEMORY(metadata.data.cuesheet.catalog, pRunningData, 128);                              pRunningData += 128;}
\DoxyCodeLine{6553                     metadata.data.cuesheet.leadInSampleCount = drflac\_\_be2host\_64(*(\textcolor{keyword}{const} drflac\_uint64*)pRunningData); pRunningData += 8;}
\DoxyCodeLine{6554                     metadata.data.cuesheet.isCD              = (pRunningData[0] \& 0x80) != 0;                           pRunningData += 259;}
\DoxyCodeLine{6555                     metadata.data.cuesheet.trackCount        = pRunningData[0];                                         pRunningData += 1;}
\DoxyCodeLine{6556                     metadata.data.cuesheet.pTrackData        = pRunningData;}
\DoxyCodeLine{6557 }
\DoxyCodeLine{6558                     \textcolor{comment}{/* Check that the cuesheet tracks are valid before passing it to the callback */}}
\DoxyCodeLine{6559                     \textcolor{keywordflow}{for} (iTrack = 0; iTrack < metadata.data.cuesheet.trackCount; ++iTrack) \{}
\DoxyCodeLine{6560                         drflac\_uint8 indexCount;}
\DoxyCodeLine{6561                         drflac\_uint32 indexPointSize;}
\DoxyCodeLine{6562 }
\DoxyCodeLine{6563                         \textcolor{keywordflow}{if} (pRunningDataEnd -\/ pRunningData < 36) \{}
\DoxyCodeLine{6564                             drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6565                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6566                         \}}
\DoxyCodeLine{6567 }
\DoxyCodeLine{6568                         \textcolor{comment}{/* Skip to the index point count */}}
\DoxyCodeLine{6569                         pRunningData += 35;}
\DoxyCodeLine{6570                         indexCount = pRunningData[0]; pRunningData += 1;}
\DoxyCodeLine{6571                         indexPointSize = indexCount * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}});}
\DoxyCodeLine{6572                         \textcolor{keywordflow}{if} (pRunningDataEnd -\/ pRunningData < (drflac\_int64)indexPointSize) \{}
\DoxyCodeLine{6573                             drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6574                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6575                         \}}
\DoxyCodeLine{6576 }
\DoxyCodeLine{6577                         \textcolor{comment}{/* Endian swap. */}}
\DoxyCodeLine{6578                         \textcolor{keywordflow}{for} (iIndex = 0; iIndex < indexCount; ++iIndex) \{}
\DoxyCodeLine{6579                             \mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}}* pTrack = (\mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}}*)pRunningData;}
\DoxyCodeLine{6580                             pRunningData += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}});}
\DoxyCodeLine{6581                             pTrack-\/>offset = drflac\_\_be2host\_64(pTrack-\/>offset);}
\DoxyCodeLine{6582                         \}}
\DoxyCodeLine{6583                     \}}
\DoxyCodeLine{6584 }
\DoxyCodeLine{6585                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6586 }
\DoxyCodeLine{6587                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6588                 \}}
\DoxyCodeLine{6589             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6590 }
\DoxyCodeLine{6591             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_PICTURE:}
\DoxyCodeLine{6592             \{}
\DoxyCodeLine{6593                 \textcolor{keywordflow}{if} (blockSize < 32) \{}
\DoxyCodeLine{6594                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6595                 \}}
\DoxyCodeLine{6596 }
\DoxyCodeLine{6597                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6598                     \textcolor{keywordtype}{void}* pRawData;}
\DoxyCodeLine{6599                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{6600                     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningDataEnd;}
\DoxyCodeLine{6601 }
\DoxyCodeLine{6602                     pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6603                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6604                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6605                     \}}
\DoxyCodeLine{6606 }
\DoxyCodeLine{6607                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6608                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6609                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6610                     \}}
\DoxyCodeLine{6611 }
\DoxyCodeLine{6612                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6613                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6614 }
\DoxyCodeLine{6615                     pRunningData    = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData;}
\DoxyCodeLine{6616                     pRunningDataEnd = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pRawData + blockSize;}
\DoxyCodeLine{6617 }
\DoxyCodeLine{6618                     metadata.data.picture.type       = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6619                     metadata.data.picture.mimeLength = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6620 }
\DoxyCodeLine{6621                     \textcolor{comment}{/* Need space for the rest of the block */}}
\DoxyCodeLine{6622                     \textcolor{keywordflow}{if} ((pRunningDataEnd -\/ pRunningData) -\/ 24 < (drflac\_int64)metadata.data.picture.mimeLength) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6623                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6624                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6625                     \}}
\DoxyCodeLine{6626                     metadata.data.picture.mime              = pRunningData;                                            pRunningData += metadata.data.picture.mimeLength;}
\DoxyCodeLine{6627                     metadata.data.picture.descriptionLength = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6628 }
\DoxyCodeLine{6629                     \textcolor{comment}{/* Need space for the rest of the block */}}
\DoxyCodeLine{6630                     \textcolor{keywordflow}{if} ((pRunningDataEnd -\/ pRunningData) -\/ 20 < (drflac\_int64)metadata.data.picture.descriptionLength) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6631                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6632                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6633                     \}}
\DoxyCodeLine{6634                     metadata.data.picture.description     = pRunningData;                                            pRunningData += metadata.data.picture.descriptionLength;}
\DoxyCodeLine{6635                     metadata.data.picture.width           = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6636                     metadata.data.picture.height          = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6637                     metadata.data.picture.colorDepth      = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6638                     metadata.data.picture.indexColorCount = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6639                     metadata.data.picture.pictureDataSize = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{6640                     metadata.data.picture.pPictureData    = (\textcolor{keyword}{const} drflac\_uint8*)pRunningData;}
\DoxyCodeLine{6641 }
\DoxyCodeLine{6642                     \textcolor{comment}{/* Need space for the picture after the block */}}
\DoxyCodeLine{6643                     \textcolor{keywordflow}{if} (pRunningDataEnd -\/ pRunningData < (drflac\_int64)metadata.data.picture.pictureDataSize) \{ \textcolor{comment}{/* <-\/-\/ Note the order of operations to avoid overflow to a valid value */}}
\DoxyCodeLine{6644                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6645                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6646                     \}}
\DoxyCodeLine{6647 }
\DoxyCodeLine{6648                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6649 }
\DoxyCodeLine{6650                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6651                 \}}
\DoxyCodeLine{6652             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6653 }
\DoxyCodeLine{6654             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_PADDING:}
\DoxyCodeLine{6655             \{}
\DoxyCodeLine{6656                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6657                     metadata.data.padding.unused = 0;}
\DoxyCodeLine{6658 }
\DoxyCodeLine{6659                     \textcolor{comment}{/* Padding doesn't have anything meaningful in it, so just skip over it, but make sure the caller is aware of it by firing the callback. */}}
\DoxyCodeLine{6660                     \textcolor{keywordflow}{if} (!onSeek(pUserData, blockSize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{6661                         isLastBlock = DRFLAC\_TRUE;  \textcolor{comment}{/* An error occurred while seeking. Attempt to recover by treating this as the last block which will in turn terminate the loop. */}}
\DoxyCodeLine{6662                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6663                         onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6664                     \}}
\DoxyCodeLine{6665                 \}}
\DoxyCodeLine{6666             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6667 }
\DoxyCodeLine{6668             \textcolor{keywordflow}{case} DRFLAC\_METADATA\_BLOCK\_TYPE\_INVALID:}
\DoxyCodeLine{6669             \{}
\DoxyCodeLine{6670                 \textcolor{comment}{/* Invalid chunk. Just skip over this one. */}}
\DoxyCodeLine{6671                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6672                     \textcolor{keywordflow}{if} (!onSeek(pUserData, blockSize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{6673                         isLastBlock = DRFLAC\_TRUE;  \textcolor{comment}{/* An error occurred while seeking. Attempt to recover by treating this as the last block which will in turn terminate the loop. */}}
\DoxyCodeLine{6674                     \}}
\DoxyCodeLine{6675                 \}}
\DoxyCodeLine{6676             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6677 }
\DoxyCodeLine{6678             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{6679             \{}
\DoxyCodeLine{6680                 \textcolor{comment}{/*}}
\DoxyCodeLine{6681 \textcolor{comment}{                It's an unknown chunk, but not necessarily invalid. There's a chance more metadata blocks might be defined later on, so we}}
\DoxyCodeLine{6682 \textcolor{comment}{                can at the very least report the chunk to the application and let it look at the raw data.}}
\DoxyCodeLine{6683 \textcolor{comment}{                */}}
\DoxyCodeLine{6684                 \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6685                     \textcolor{keywordtype}{void}* pRawData = drflac\_\_malloc\_from\_callbacks(blockSize, pAllocationCallbacks);}
\DoxyCodeLine{6686                     \textcolor{keywordflow}{if} (pRawData == NULL) \{}
\DoxyCodeLine{6687                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6688                     \}}
\DoxyCodeLine{6689 }
\DoxyCodeLine{6690                     \textcolor{keywordflow}{if} (onRead(pUserData, pRawData, blockSize) != blockSize) \{}
\DoxyCodeLine{6691                         drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6692                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6693                     \}}
\DoxyCodeLine{6694 }
\DoxyCodeLine{6695                     metadata.pRawData = pRawData;}
\DoxyCodeLine{6696                     metadata.rawDataSize = blockSize;}
\DoxyCodeLine{6697                     onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6698 }
\DoxyCodeLine{6699                     drflac\_\_free\_from\_callbacks(pRawData, pAllocationCallbacks);}
\DoxyCodeLine{6700                 \}}
\DoxyCodeLine{6701             \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{6702         \}}
\DoxyCodeLine{6703 }
\DoxyCodeLine{6704         \textcolor{comment}{/* If we're not handling metadata, just skip over the block. If we are, it will have been handled earlier in the switch statement above. */}}
\DoxyCodeLine{6705         \textcolor{keywordflow}{if} (onMeta == NULL \&\& blockSize > 0) \{}
\DoxyCodeLine{6706             \textcolor{keywordflow}{if} (!onSeek(pUserData, blockSize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{6707                 isLastBlock = DRFLAC\_TRUE;}
\DoxyCodeLine{6708             \}}
\DoxyCodeLine{6709         \}}
\DoxyCodeLine{6710 }
\DoxyCodeLine{6711         runningFilePos += blockSize;}
\DoxyCodeLine{6712         \textcolor{keywordflow}{if} (isLastBlock) \{}
\DoxyCodeLine{6713             \textcolor{keywordflow}{break};}
\DoxyCodeLine{6714         \}}
\DoxyCodeLine{6715     \}}
\DoxyCodeLine{6716 }
\DoxyCodeLine{6717     *pSeektablePos = seektablePos;}
\DoxyCodeLine{6718     *pSeektableSize = seektableSize;}
\DoxyCodeLine{6719     *pFirstFramePos = runningFilePos;}
\DoxyCodeLine{6720 }
\DoxyCodeLine{6721     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6722 \}}
\DoxyCodeLine{6723 }
\DoxyCodeLine{6724 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_init\_private\_\_native(drflac\_init\_info* pInit, drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pUserDataMD, drflac\_bool32 relaxed)}
\DoxyCodeLine{6725 \{}
\DoxyCodeLine{6726     \textcolor{comment}{/* Pre Condition: The bit stream should be sitting just past the 4-\/byte id header. */}}
\DoxyCodeLine{6727 }
\DoxyCodeLine{6728     drflac\_uint8 isLastBlock;}
\DoxyCodeLine{6729     drflac\_uint8 blockType;}
\DoxyCodeLine{6730     drflac\_uint32 blockSize;}
\DoxyCodeLine{6731 }
\DoxyCodeLine{6732     (void)onSeek;}
\DoxyCodeLine{6733 }
\DoxyCodeLine{6734     pInit-\/>container = drflac\_container\_native;}
\DoxyCodeLine{6735 }
\DoxyCodeLine{6736     \textcolor{comment}{/* The first metadata block should be the STREAMINFO block. */}}
\DoxyCodeLine{6737     \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_block\_header(onRead, pUserData, \&isLastBlock, \&blockType, \&blockSize)) \{}
\DoxyCodeLine{6738         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6739     \}}
\DoxyCodeLine{6740 }
\DoxyCodeLine{6741     \textcolor{keywordflow}{if} (blockType != DRFLAC\_METADATA\_BLOCK\_TYPE\_STREAMINFO || blockSize != 34) \{}
\DoxyCodeLine{6742         \textcolor{keywordflow}{if} (!relaxed) \{}
\DoxyCodeLine{6743             \textcolor{comment}{/* We're opening in strict mode and the first block is not the STREAMINFO block. Error. */}}
\DoxyCodeLine{6744             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6745         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6746             \textcolor{comment}{/*}}
\DoxyCodeLine{6747 \textcolor{comment}{            Relaxed mode. To open from here we need to just find the first frame and set the sample rate, etc. to whatever is defined}}
\DoxyCodeLine{6748 \textcolor{comment}{            for that frame.}}
\DoxyCodeLine{6749 \textcolor{comment}{            */}}
\DoxyCodeLine{6750             pInit-\/>hasStreamInfoBlock = DRFLAC\_FALSE;}
\DoxyCodeLine{6751             pInit-\/>hasMetadataBlocks  = DRFLAC\_FALSE;}
\DoxyCodeLine{6752 }
\DoxyCodeLine{6753             \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pInit-\/>bs, 0, \&pInit-\/>firstFrameHeader)) \{}
\DoxyCodeLine{6754                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Couldn't find a frame. */}}
\DoxyCodeLine{6755             \}}
\DoxyCodeLine{6756 }
\DoxyCodeLine{6757             \textcolor{keywordflow}{if} (pInit-\/>firstFrameHeader.bitsPerSample == 0) \{}
\DoxyCodeLine{6758                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Failed to initialize because the first frame depends on the STREAMINFO block, which does not exist. */}}
\DoxyCodeLine{6759             \}}
\DoxyCodeLine{6760 }
\DoxyCodeLine{6761             pInit-\/>sampleRate              = pInit-\/>firstFrameHeader.sampleRate;}
\DoxyCodeLine{6762             pInit-\/>channels                = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pInit-\/>firstFrameHeader.channelAssignment);}
\DoxyCodeLine{6763             pInit-\/>bitsPerSample           = pInit-\/>firstFrameHeader.bitsPerSample;}
\DoxyCodeLine{6764             pInit-\/>maxBlockSizeInPCMFrames = 65535;   \textcolor{comment}{/* <-\/-\/ See notes here: https://xiph.org/flac/format.html\#metadata\_block\_streaminfo */}}
\DoxyCodeLine{6765             \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6766         \}}
\DoxyCodeLine{6767     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6768         \mbox{\hyperlink{structdrflac__streaminfo}{drflac\_streaminfo}} streaminfo;}
\DoxyCodeLine{6769         \textcolor{keywordflow}{if} (!drflac\_\_read\_streaminfo(onRead, pUserData, \&streaminfo)) \{}
\DoxyCodeLine{6770             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{6771         \}}
\DoxyCodeLine{6772 }
\DoxyCodeLine{6773         pInit-\/>hasStreamInfoBlock      = DRFLAC\_TRUE;}
\DoxyCodeLine{6774         pInit-\/>sampleRate              = streaminfo.sampleRate;}
\DoxyCodeLine{6775         pInit-\/>channels                = streaminfo.channels;}
\DoxyCodeLine{6776         pInit-\/>bitsPerSample           = streaminfo.bitsPerSample;}
\DoxyCodeLine{6777         pInit-\/>totalPCMFrameCount      = streaminfo.totalPCMFrameCount;}
\DoxyCodeLine{6778         pInit-\/>maxBlockSizeInPCMFrames = streaminfo.maxBlockSizeInPCMFrames;    \textcolor{comment}{/* Don't care about the min block size -\/ only the max (used for determining the size of the memory allocation). */}}
\DoxyCodeLine{6779         pInit-\/>hasMetadataBlocks       = !isLastBlock;}
\DoxyCodeLine{6780 }
\DoxyCodeLine{6781         \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{6782             \mbox{\hyperlink{structdrflac__metadata}{drflac\_metadata}} metadata;}
\DoxyCodeLine{6783             metadata.type = DRFLAC\_METADATA\_BLOCK\_TYPE\_STREAMINFO;}
\DoxyCodeLine{6784             metadata.pRawData = NULL;}
\DoxyCodeLine{6785             metadata.rawDataSize = 0;}
\DoxyCodeLine{6786             metadata.data.streaminfo = streaminfo;}
\DoxyCodeLine{6787             onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{6788         \}}
\DoxyCodeLine{6789 }
\DoxyCodeLine{6790         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{6791     \}}
\DoxyCodeLine{6792 \}}
\DoxyCodeLine{6793 }
\DoxyCodeLine{6794 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{6795 \textcolor{preprocessor}{\#define DRFLAC\_OGG\_MAX\_PAGE\_SIZE            65307}}
\DoxyCodeLine{6796 \textcolor{preprocessor}{\#define DRFLAC\_OGG\_CAPTURE\_PATTERN\_CRC32    1605413199  }\textcolor{comment}{/* CRC-\/32 of "{}OggS"{}. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{6797 }
\DoxyCodeLine{6798 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{6799 \{}
\DoxyCodeLine{6800     drflac\_ogg\_recover\_on\_crc\_mismatch,}
\DoxyCodeLine{6801     drflac\_ogg\_fail\_on\_crc\_mismatch}
\DoxyCodeLine{6802 \} drflac\_ogg\_crc\_mismatch\_recovery;}
\DoxyCodeLine{6803 }
\DoxyCodeLine{6804 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{6805 \textcolor{keyword}{static} drflac\_uint32 drflac\_\_crc32\_table[] = \{}
\DoxyCodeLine{6806     0x00000000L, 0x04C11DB7L, 0x09823B6EL, 0x0D4326D9L,}
\DoxyCodeLine{6807     0x130476DCL, 0x17C56B6BL, 0x1A864DB2L, 0x1E475005L,}
\DoxyCodeLine{6808     0x2608EDB8L, 0x22C9F00FL, 0x2F8AD6D6L, 0x2B4BCB61L,}
\DoxyCodeLine{6809     0x350C9B64L, 0x31CD86D3L, 0x3C8EA00AL, 0x384FBDBDL,}
\DoxyCodeLine{6810     0x4C11DB70L, 0x48D0C6C7L, 0x4593E01EL, 0x4152FDA9L,}
\DoxyCodeLine{6811     0x5F15ADACL, 0x5BD4B01BL, 0x569796C2L, 0x52568B75L,}
\DoxyCodeLine{6812     0x6A1936C8L, 0x6ED82B7FL, 0x639B0DA6L, 0x675A1011L,}
\DoxyCodeLine{6813     0x791D4014L, 0x7DDC5DA3L, 0x709F7B7AL, 0x745E66CDL,}
\DoxyCodeLine{6814     0x9823B6E0L, 0x9CE2AB57L, 0x91A18D8EL, 0x95609039L,}
\DoxyCodeLine{6815     0x8B27C03CL, 0x8FE6DD8BL, 0x82A5FB52L, 0x8664E6E5L,}
\DoxyCodeLine{6816     0xBE2B5B58L, 0xBAEA46EFL, 0xB7A96036L, 0xB3687D81L,}
\DoxyCodeLine{6817     0xAD2F2D84L, 0xA9EE3033L, 0xA4AD16EAL, 0xA06C0B5DL,}
\DoxyCodeLine{6818     0xD4326D90L, 0xD0F37027L, 0xDDB056FEL, 0xD9714B49L,}
\DoxyCodeLine{6819     0xC7361B4CL, 0xC3F706FBL, 0xCEB42022L, 0xCA753D95L,}
\DoxyCodeLine{6820     0xF23A8028L, 0xF6FB9D9FL, 0xFBB8BB46L, 0xFF79A6F1L,}
\DoxyCodeLine{6821     0xE13EF6F4L, 0xE5FFEB43L, 0xE8BCCD9AL, 0xEC7DD02DL,}
\DoxyCodeLine{6822     0x34867077L, 0x30476DC0L, 0x3D044B19L, 0x39C556AEL,}
\DoxyCodeLine{6823     0x278206ABL, 0x23431B1CL, 0x2E003DC5L, 0x2AC12072L,}
\DoxyCodeLine{6824     0x128E9DCFL, 0x164F8078L, 0x1B0CA6A1L, 0x1FCDBB16L,}
\DoxyCodeLine{6825     0x018AEB13L, 0x054BF6A4L, 0x0808D07DL, 0x0CC9CDCAL,}
\DoxyCodeLine{6826     0x7897AB07L, 0x7C56B6B0L, 0x71159069L, 0x75D48DDEL,}
\DoxyCodeLine{6827     0x6B93DDDBL, 0x6F52C06CL, 0x6211E6B5L, 0x66D0FB02L,}
\DoxyCodeLine{6828     0x5E9F46BFL, 0x5A5E5B08L, 0x571D7DD1L, 0x53DC6066L,}
\DoxyCodeLine{6829     0x4D9B3063L, 0x495A2DD4L, 0x44190B0DL, 0x40D816BAL,}
\DoxyCodeLine{6830     0xACA5C697L, 0xA864DB20L, 0xA527FDF9L, 0xA1E6E04EL,}
\DoxyCodeLine{6831     0xBFA1B04BL, 0xBB60ADFCL, 0xB6238B25L, 0xB2E29692L,}
\DoxyCodeLine{6832     0x8AAD2B2FL, 0x8E6C3698L, 0x832F1041L, 0x87EE0DF6L,}
\DoxyCodeLine{6833     0x99A95DF3L, 0x9D684044L, 0x902B669DL, 0x94EA7B2AL,}
\DoxyCodeLine{6834     0xE0B41DE7L, 0xE4750050L, 0xE9362689L, 0xEDF73B3EL,}
\DoxyCodeLine{6835     0xF3B06B3BL, 0xF771768CL, 0xFA325055L, 0xFEF34DE2L,}
\DoxyCodeLine{6836     0xC6BCF05FL, 0xC27DEDE8L, 0xCF3ECB31L, 0xCBFFD686L,}
\DoxyCodeLine{6837     0xD5B88683L, 0xD1799B34L, 0xDC3ABDEDL, 0xD8FBA05AL,}
\DoxyCodeLine{6838     0x690CE0EEL, 0x6DCDFD59L, 0x608EDB80L, 0x644FC637L,}
\DoxyCodeLine{6839     0x7A089632L, 0x7EC98B85L, 0x738AAD5CL, 0x774BB0EBL,}
\DoxyCodeLine{6840     0x4F040D56L, 0x4BC510E1L, 0x46863638L, 0x42472B8FL,}
\DoxyCodeLine{6841     0x5C007B8AL, 0x58C1663DL, 0x558240E4L, 0x51435D53L,}
\DoxyCodeLine{6842     0x251D3B9EL, 0x21DC2629L, 0x2C9F00F0L, 0x285E1D47L,}
\DoxyCodeLine{6843     0x36194D42L, 0x32D850F5L, 0x3F9B762CL, 0x3B5A6B9BL,}
\DoxyCodeLine{6844     0x0315D626L, 0x07D4CB91L, 0x0A97ED48L, 0x0E56F0FFL,}
\DoxyCodeLine{6845     0x1011A0FAL, 0x14D0BD4DL, 0x19939B94L, 0x1D528623L,}
\DoxyCodeLine{6846     0xF12F560EL, 0xF5EE4BB9L, 0xF8AD6D60L, 0xFC6C70D7L,}
\DoxyCodeLine{6847     0xE22B20D2L, 0xE6EA3D65L, 0xEBA91BBCL, 0xEF68060BL,}
\DoxyCodeLine{6848     0xD727BBB6L, 0xD3E6A601L, 0xDEA580D8L, 0xDA649D6FL,}
\DoxyCodeLine{6849     0xC423CD6AL, 0xC0E2D0DDL, 0xCDA1F604L, 0xC960EBB3L,}
\DoxyCodeLine{6850     0xBD3E8D7EL, 0xB9FF90C9L, 0xB4BCB610L, 0xB07DABA7L,}
\DoxyCodeLine{6851     0xAE3AFBA2L, 0xAAFBE615L, 0xA7B8C0CCL, 0xA379DD7BL,}
\DoxyCodeLine{6852     0x9B3660C6L, 0x9FF77D71L, 0x92B45BA8L, 0x9675461FL,}
\DoxyCodeLine{6853     0x8832161AL, 0x8CF30BADL, 0x81B02D74L, 0x857130C3L,}
\DoxyCodeLine{6854     0x5D8A9099L, 0x594B8D2EL, 0x5408ABF7L, 0x50C9B640L,}
\DoxyCodeLine{6855     0x4E8EE645L, 0x4A4FFBF2L, 0x470CDD2BL, 0x43CDC09CL,}
\DoxyCodeLine{6856     0x7B827D21L, 0x7F436096L, 0x7200464FL, 0x76C15BF8L,}
\DoxyCodeLine{6857     0x68860BFDL, 0x6C47164AL, 0x61043093L, 0x65C52D24L,}
\DoxyCodeLine{6858     0x119B4BE9L, 0x155A565EL, 0x18197087L, 0x1CD86D30L,}
\DoxyCodeLine{6859     0x029F3D35L, 0x065E2082L, 0x0B1D065BL, 0x0FDC1BECL,}
\DoxyCodeLine{6860     0x3793A651L, 0x3352BBE6L, 0x3E119D3FL, 0x3AD08088L,}
\DoxyCodeLine{6861     0x2497D08DL, 0x2056CD3AL, 0x2D15EBE3L, 0x29D4F654L,}
\DoxyCodeLine{6862     0xC5A92679L, 0xC1683BCEL, 0xCC2B1D17L, 0xC8EA00A0L,}
\DoxyCodeLine{6863     0xD6AD50A5L, 0xD26C4D12L, 0xDF2F6BCBL, 0xDBEE767CL,}
\DoxyCodeLine{6864     0xE3A1CBC1L, 0xE760D676L, 0xEA23F0AFL, 0xEEE2ED18L,}
\DoxyCodeLine{6865     0xF0A5BD1DL, 0xF464A0AAL, 0xF9278673L, 0xFDE69BC4L,}
\DoxyCodeLine{6866     0x89B8FD09L, 0x8D79E0BEL, 0x803AC667L, 0x84FBDBD0L,}
\DoxyCodeLine{6867     0x9ABC8BD5L, 0x9E7D9662L, 0x933EB0BBL, 0x97FFAD0CL,}
\DoxyCodeLine{6868     0xAFB010B1L, 0xAB710D06L, 0xA6322BDFL, 0xA2F33668L,}
\DoxyCodeLine{6869     0xBCB4666DL, 0xB8757BDAL, 0xB5365D03L, 0xB1F740B4L}
\DoxyCodeLine{6870 \};}
\DoxyCodeLine{6871 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6872 }
\DoxyCodeLine{6873 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_crc32\_byte(drflac\_uint32 crc32, drflac\_uint8 data)}
\DoxyCodeLine{6874 \{}
\DoxyCodeLine{6875 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{6876     \textcolor{keywordflow}{return} (crc32 << 8) \string^ drflac\_\_crc32\_table[(drflac\_uint8)((crc32 >> 24) \& 0xFF) \string^ data];}
\DoxyCodeLine{6877 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{6878     (void)data;}
\DoxyCodeLine{6879     \textcolor{keywordflow}{return} crc32;}
\DoxyCodeLine{6880 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6881 \}}
\DoxyCodeLine{6882 }
\DoxyCodeLine{6883 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{6884 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_crc32\_uint32(drflac\_uint32 crc32, drflac\_uint32 data)}
\DoxyCodeLine{6885 \{}
\DoxyCodeLine{6886     crc32 = drflac\_crc32\_byte(crc32, (drflac\_uint8)((data >> 24) \& 0xFF));}
\DoxyCodeLine{6887     crc32 = drflac\_crc32\_byte(crc32, (drflac\_uint8)((data >> 16) \& 0xFF));}
\DoxyCodeLine{6888     crc32 = drflac\_crc32\_byte(crc32, (drflac\_uint8)((data >>  8) \& 0xFF));}
\DoxyCodeLine{6889     crc32 = drflac\_crc32\_byte(crc32, (drflac\_uint8)((data >>  0) \& 0xFF));}
\DoxyCodeLine{6890     \textcolor{keywordflow}{return} crc32;}
\DoxyCodeLine{6891 \}}
\DoxyCodeLine{6892 }
\DoxyCodeLine{6893 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_crc32\_uint64(drflac\_uint32 crc32, drflac\_uint64 data)}
\DoxyCodeLine{6894 \{}
\DoxyCodeLine{6895     crc32 = drflac\_crc32\_uint32(crc32, (drflac\_uint32)((data >> 32) \& 0xFFFFFFFF));}
\DoxyCodeLine{6896     crc32 = drflac\_crc32\_uint32(crc32, (drflac\_uint32)((data >>  0) \& 0xFFFFFFFF));}
\DoxyCodeLine{6897     \textcolor{keywordflow}{return} crc32;}
\DoxyCodeLine{6898 \}}
\DoxyCodeLine{6899 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6900 }
\DoxyCodeLine{6901 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_crc32\_buffer(drflac\_uint32 crc32, drflac\_uint8* pData, drflac\_uint32 dataSize)}
\DoxyCodeLine{6902 \{}
\DoxyCodeLine{6903     \textcolor{comment}{/* This can be optimized. */}}
\DoxyCodeLine{6904     drflac\_uint32 i;}
\DoxyCodeLine{6905     \textcolor{keywordflow}{for} (i = 0; i < dataSize; ++i) \{}
\DoxyCodeLine{6906         crc32 = drflac\_crc32\_byte(crc32, pData[i]);}
\DoxyCodeLine{6907     \}}
\DoxyCodeLine{6908     \textcolor{keywordflow}{return} crc32;}
\DoxyCodeLine{6909 \}}
\DoxyCodeLine{6910 }
\DoxyCodeLine{6911 }
\DoxyCodeLine{6912 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_bool32 drflac\_ogg\_\_is\_capture\_pattern(drflac\_uint8 pattern[4])}
\DoxyCodeLine{6913 \{}
\DoxyCodeLine{6914     \textcolor{keywordflow}{return} pattern[0] == \textcolor{charliteral}{'O'} \&\& pattern[1] == \textcolor{charliteral}{'g'} \&\& pattern[2] == \textcolor{charliteral}{'g'} \&\& pattern[3] == \textcolor{charliteral}{'S'};}
\DoxyCodeLine{6915 \}}
\DoxyCodeLine{6916 }
\DoxyCodeLine{6917 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_ogg\_\_get\_page\_header\_size(drflac\_ogg\_page\_header* pHeader)}
\DoxyCodeLine{6918 \{}
\DoxyCodeLine{6919     \textcolor{keywordflow}{return} 27 + pHeader-\/>segmentCount;}
\DoxyCodeLine{6920 \}}
\DoxyCodeLine{6921 }
\DoxyCodeLine{6922 \textcolor{keyword}{static} DRFLAC\_INLINE drflac\_uint32 drflac\_ogg\_\_get\_page\_body\_size(drflac\_ogg\_page\_header* pHeader)}
\DoxyCodeLine{6923 \{}
\DoxyCodeLine{6924     drflac\_uint32 pageBodySize = 0;}
\DoxyCodeLine{6925     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{6926 }
\DoxyCodeLine{6927     \textcolor{keywordflow}{for} (i = 0; i < pHeader-\/>segmentCount; ++i) \{}
\DoxyCodeLine{6928         pageBodySize += pHeader-\/>segmentTable[i];}
\DoxyCodeLine{6929     \}}
\DoxyCodeLine{6930 }
\DoxyCodeLine{6931     \textcolor{keywordflow}{return} pageBodySize;}
\DoxyCodeLine{6932 \}}
\DoxyCodeLine{6933 }
\DoxyCodeLine{6934 \textcolor{keyword}{static} drflac\_result drflac\_ogg\_\_read\_page\_header\_after\_capture\_pattern(drflac\_read\_proc onRead, \textcolor{keywordtype}{void}* pUserData, drflac\_ogg\_page\_header* pHeader, drflac\_uint32* pBytesRead, drflac\_uint32* pCRC32)}
\DoxyCodeLine{6935 \{}
\DoxyCodeLine{6936     drflac\_uint8 data[23];}
\DoxyCodeLine{6937     drflac\_uint32 i;}
\DoxyCodeLine{6938 }
\DoxyCodeLine{6939     DRFLAC\_ASSERT(*pCRC32 == DRFLAC\_OGG\_CAPTURE\_PATTERN\_CRC32);}
\DoxyCodeLine{6940 }
\DoxyCodeLine{6941     \textcolor{keywordflow}{if} (onRead(pUserData, data, 23) != 23) \{}
\DoxyCodeLine{6942         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{6943     \}}
\DoxyCodeLine{6944     *pBytesRead += 23;}
\DoxyCodeLine{6945 }
\DoxyCodeLine{6946     \textcolor{comment}{/*}}
\DoxyCodeLine{6947 \textcolor{comment}{    It's not actually used, but set the capture pattern to 'OggS' for completeness. Not doing this will cause static analysers to complain about}}
\DoxyCodeLine{6948 \textcolor{comment}{    us trying to access uninitialized data. We could alternatively just comment out this member of the drflac\_ogg\_page\_header structure, but I}}
\DoxyCodeLine{6949 \textcolor{comment}{    like to have it map to the structure of the underlying data.}}
\DoxyCodeLine{6950 \textcolor{comment}{    */}}
\DoxyCodeLine{6951     pHeader-\/>capturePattern[0] = \textcolor{charliteral}{'O'};}
\DoxyCodeLine{6952     pHeader-\/>capturePattern[1] = \textcolor{charliteral}{'g'};}
\DoxyCodeLine{6953     pHeader-\/>capturePattern[2] = \textcolor{charliteral}{'g'};}
\DoxyCodeLine{6954     pHeader-\/>capturePattern[3] = \textcolor{charliteral}{'S'};}
\DoxyCodeLine{6955 }
\DoxyCodeLine{6956     pHeader-\/>structureVersion = data[0];}
\DoxyCodeLine{6957     pHeader-\/>headerType       = data[1];}
\DoxyCodeLine{6958     DRFLAC\_COPY\_MEMORY(\&pHeader-\/>granulePosition, \&data[ 2], 8);}
\DoxyCodeLine{6959     DRFLAC\_COPY\_MEMORY(\&pHeader-\/>serialNumber,    \&data[10], 4);}
\DoxyCodeLine{6960     DRFLAC\_COPY\_MEMORY(\&pHeader-\/>sequenceNumber,  \&data[14], 4);}
\DoxyCodeLine{6961     DRFLAC\_COPY\_MEMORY(\&pHeader-\/>checksum,        \&data[18], 4);}
\DoxyCodeLine{6962     pHeader-\/>segmentCount     = data[22];}
\DoxyCodeLine{6963 }
\DoxyCodeLine{6964     \textcolor{comment}{/* Calculate the CRC. Note that for the calculation the checksum part of the page needs to be set to 0. */}}
\DoxyCodeLine{6965     data[18] = 0;}
\DoxyCodeLine{6966     data[19] = 0;}
\DoxyCodeLine{6967     data[20] = 0;}
\DoxyCodeLine{6968     data[21] = 0;}
\DoxyCodeLine{6969 }
\DoxyCodeLine{6970     \textcolor{keywordflow}{for} (i = 0; i < 23; ++i) \{}
\DoxyCodeLine{6971         *pCRC32 = drflac\_crc32\_byte(*pCRC32, data[i]);}
\DoxyCodeLine{6972     \}}
\DoxyCodeLine{6973 }
\DoxyCodeLine{6974 }
\DoxyCodeLine{6975     \textcolor{keywordflow}{if} (onRead(pUserData, pHeader-\/>segmentTable, pHeader-\/>segmentCount) != pHeader-\/>segmentCount) \{}
\DoxyCodeLine{6976         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{6977     \}}
\DoxyCodeLine{6978     *pBytesRead += pHeader-\/>segmentCount;}
\DoxyCodeLine{6979 }
\DoxyCodeLine{6980     \textcolor{keywordflow}{for} (i = 0; i < pHeader-\/>segmentCount; ++i) \{}
\DoxyCodeLine{6981         *pCRC32 = drflac\_crc32\_byte(*pCRC32, pHeader-\/>segmentTable[i]);}
\DoxyCodeLine{6982     \}}
\DoxyCodeLine{6983 }
\DoxyCodeLine{6984     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{6985 \}}
\DoxyCodeLine{6986 }
\DoxyCodeLine{6987 \textcolor{keyword}{static} drflac\_result drflac\_ogg\_\_read\_page\_header(drflac\_read\_proc onRead, \textcolor{keywordtype}{void}* pUserData, drflac\_ogg\_page\_header* pHeader, drflac\_uint32* pBytesRead, drflac\_uint32* pCRC32)}
\DoxyCodeLine{6988 \{}
\DoxyCodeLine{6989     drflac\_uint8 \textcolor{keywordtype}{id}[4];}
\DoxyCodeLine{6990 }
\DoxyCodeLine{6991     *pBytesRead = 0;}
\DoxyCodeLine{6992 }
\DoxyCodeLine{6993     \textcolor{keywordflow}{if} (onRead(pUserData, \textcolor{keywordtype}{id}, 4) != 4) \{}
\DoxyCodeLine{6994         \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{6995     \}}
\DoxyCodeLine{6996     *pBytesRead += 4;}
\DoxyCodeLine{6997 }
\DoxyCodeLine{6998     \textcolor{comment}{/* We need to read byte-\/by-\/byte until we find the OggS capture pattern. */}}
\DoxyCodeLine{6999     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7000         \textcolor{keywordflow}{if} (drflac\_ogg\_\_is\_capture\_pattern(\textcolor{keywordtype}{id})) \{}
\DoxyCodeLine{7001             drflac\_result result;}
\DoxyCodeLine{7002 }
\DoxyCodeLine{7003             *pCRC32 = DRFLAC\_OGG\_CAPTURE\_PATTERN\_CRC32;}
\DoxyCodeLine{7004 }
\DoxyCodeLine{7005             result = drflac\_ogg\_\_read\_page\_header\_after\_capture\_pattern(onRead, pUserData, pHeader, pBytesRead, pCRC32);}
\DoxyCodeLine{7006             \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7007                 \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{7008             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7009                 \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{7010                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{7011                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7012                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{7013                 \}}
\DoxyCodeLine{7014             \}}
\DoxyCodeLine{7015         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7016             \textcolor{comment}{/* The first 4 bytes did not equal the capture pattern. Read the next byte and try again. */}}
\DoxyCodeLine{7017             \textcolor{keywordtype}{id}[0] = \textcolor{keywordtype}{id}[1];}
\DoxyCodeLine{7018             \textcolor{keywordtype}{id}[1] = \textcolor{keywordtype}{id}[2];}
\DoxyCodeLine{7019             \textcolor{keywordtype}{id}[2] = \textcolor{keywordtype}{id}[3];}
\DoxyCodeLine{7020             \textcolor{keywordflow}{if} (onRead(pUserData, \&\textcolor{keywordtype}{id}[3], 1) != 1) \{}
\DoxyCodeLine{7021                 \textcolor{keywordflow}{return} DRFLAC\_AT\_END;}
\DoxyCodeLine{7022             \}}
\DoxyCodeLine{7023             *pBytesRead += 1;}
\DoxyCodeLine{7024         \}}
\DoxyCodeLine{7025     \}}
\DoxyCodeLine{7026 \}}
\DoxyCodeLine{7027 }
\DoxyCodeLine{7028 }
\DoxyCodeLine{7029 \textcolor{comment}{/*}}
\DoxyCodeLine{7030 \textcolor{comment}{The main part of the Ogg encapsulation is the conversion from the physical Ogg bitstream to the native FLAC bitstream. It works}}
\DoxyCodeLine{7031 \textcolor{comment}{in three general stages: Ogg Physical Bitstream -\/> Ogg/FLAC Logical Bitstream -\/> FLAC Native Bitstream. dr\_flac is designed}}
\DoxyCodeLine{7032 \textcolor{comment}{in such a way that the core sections assume everything is delivered in native format. Therefore, for each encapsulation type}}
\DoxyCodeLine{7033 \textcolor{comment}{dr\_flac is supporting there needs to be a layer sitting on top of the onRead and onSeek callbacks that ensures the bits read from}}
\DoxyCodeLine{7034 \textcolor{comment}{the physical Ogg bitstream are converted and delivered in native FLAC format.}}
\DoxyCodeLine{7035 \textcolor{comment}{*/}}
\DoxyCodeLine{7036 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{7037 \{}
\DoxyCodeLine{7038     drflac\_read\_proc onRead;                \textcolor{comment}{/* The original onRead callback from drflac\_open() and family. */}}
\DoxyCodeLine{7039     drflac\_seek\_proc onSeek;                \textcolor{comment}{/* The original onSeek callback from drflac\_open() and family. */}}
\DoxyCodeLine{7040     \textcolor{keywordtype}{void}* pUserData;                        \textcolor{comment}{/* The user data passed on onRead and onSeek. This is the user data that was passed on drflac\_open() and family. */}}
\DoxyCodeLine{7041     drflac\_uint64 currentBytePos;           \textcolor{comment}{/* The position of the byte we are sitting on in the physical byte stream. Used for efficient seeking. */}}
\DoxyCodeLine{7042     drflac\_uint64 firstBytePos;             \textcolor{comment}{/* The position of the first byte in the physical bitstream. Points to the start of the "{}OggS"{} identifier of the FLAC bos page. */}}
\DoxyCodeLine{7043     drflac\_uint32 serialNumber;             \textcolor{comment}{/* The serial number of the FLAC audio pages. This is determined by the initial header page that was read during initialization. */}}
\DoxyCodeLine{7044     drflac\_ogg\_page\_header bosPageHeader;   \textcolor{comment}{/* Used for seeking. */}}
\DoxyCodeLine{7045     drflac\_ogg\_page\_header currentPageHeader;}
\DoxyCodeLine{7046     drflac\_uint32 bytesRemainingInPage;}
\DoxyCodeLine{7047     drflac\_uint32 pageDataSize;}
\DoxyCodeLine{7048     drflac\_uint8 pageData[DRFLAC\_OGG\_MAX\_PAGE\_SIZE];}
\DoxyCodeLine{7049 \} drflac\_oggbs; \textcolor{comment}{/* oggbs = Ogg Bitstream */}}
\DoxyCodeLine{7050 }
\DoxyCodeLine{7051 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drflac\_oggbs\_\_read\_physical(drflac\_oggbs* oggbs, \textcolor{keywordtype}{void}* bufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{7052 \{}
\DoxyCodeLine{7053     \textcolor{keywordtype}{size\_t} bytesActuallyRead = oggbs-\/>onRead(oggbs-\/>pUserData, bufferOut, bytesToRead);}
\DoxyCodeLine{7054     oggbs-\/>currentBytePos += bytesActuallyRead;}
\DoxyCodeLine{7055 }
\DoxyCodeLine{7056     \textcolor{keywordflow}{return} bytesActuallyRead;}
\DoxyCodeLine{7057 \}}
\DoxyCodeLine{7058 }
\DoxyCodeLine{7059 \textcolor{keyword}{static} drflac\_bool32 drflac\_oggbs\_\_seek\_physical(drflac\_oggbs* oggbs, drflac\_uint64 offset, drflac\_seek\_origin origin)}
\DoxyCodeLine{7060 \{}
\DoxyCodeLine{7061     \textcolor{keywordflow}{if} (origin == drflac\_seek\_origin\_start) \{}
\DoxyCodeLine{7062         \textcolor{keywordflow}{if} (offset <= 0x7FFFFFFF) \{}
\DoxyCodeLine{7063             \textcolor{keywordflow}{if} (!oggbs-\/>onSeek(oggbs-\/>pUserData, (\textcolor{keywordtype}{int})offset, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7064                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7065             \}}
\DoxyCodeLine{7066             oggbs-\/>currentBytePos = offset;}
\DoxyCodeLine{7067 }
\DoxyCodeLine{7068             \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7069         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7070             \textcolor{keywordflow}{if} (!oggbs-\/>onSeek(oggbs-\/>pUserData, 0x7FFFFFFF, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7071                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7072             \}}
\DoxyCodeLine{7073             oggbs-\/>currentBytePos = offset;}
\DoxyCodeLine{7074 }
\DoxyCodeLine{7075             \textcolor{keywordflow}{return} drflac\_oggbs\_\_seek\_physical(oggbs, offset -\/ 0x7FFFFFFF, drflac\_seek\_origin\_current);}
\DoxyCodeLine{7076         \}}
\DoxyCodeLine{7077     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7078         \textcolor{keywordflow}{while} (offset > 0x7FFFFFFF) \{}
\DoxyCodeLine{7079             \textcolor{keywordflow}{if} (!oggbs-\/>onSeek(oggbs-\/>pUserData, 0x7FFFFFFF, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7080                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7081             \}}
\DoxyCodeLine{7082             oggbs-\/>currentBytePos += 0x7FFFFFFF;}
\DoxyCodeLine{7083             offset -\/= 0x7FFFFFFF;}
\DoxyCodeLine{7084         \}}
\DoxyCodeLine{7085 }
\DoxyCodeLine{7086         \textcolor{keywordflow}{if} (!oggbs-\/>onSeek(oggbs-\/>pUserData, (\textcolor{keywordtype}{int})offset, drflac\_seek\_origin\_current)) \{    \textcolor{comment}{/* <-\/-\/ Safe cast thanks to the loop above. */}}
\DoxyCodeLine{7087             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7088         \}}
\DoxyCodeLine{7089         oggbs-\/>currentBytePos += offset;}
\DoxyCodeLine{7090 }
\DoxyCodeLine{7091         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7092     \}}
\DoxyCodeLine{7093 \}}
\DoxyCodeLine{7094 }
\DoxyCodeLine{7095 \textcolor{keyword}{static} drflac\_bool32 drflac\_oggbs\_\_goto\_next\_page(drflac\_oggbs* oggbs, drflac\_ogg\_crc\_mismatch\_recovery recoveryMethod)}
\DoxyCodeLine{7096 \{}
\DoxyCodeLine{7097     drflac\_ogg\_page\_header header;}
\DoxyCodeLine{7098     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7099         drflac\_uint32 crc32 = 0;}
\DoxyCodeLine{7100         drflac\_uint32 bytesRead;}
\DoxyCodeLine{7101         drflac\_uint32 pageBodySize;}
\DoxyCodeLine{7102 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{7103         drflac\_uint32 actualCRC32;}
\DoxyCodeLine{7104 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7105 }
\DoxyCodeLine{7106         \textcolor{keywordflow}{if} (drflac\_ogg\_\_read\_page\_header(oggbs-\/>onRead, oggbs-\/>pUserData, \&header, \&bytesRead, \&crc32) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7107             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7108         \}}
\DoxyCodeLine{7109         oggbs-\/>currentBytePos += bytesRead;}
\DoxyCodeLine{7110 }
\DoxyCodeLine{7111         pageBodySize = drflac\_ogg\_\_get\_page\_body\_size(\&header);}
\DoxyCodeLine{7112         \textcolor{keywordflow}{if} (pageBodySize > DRFLAC\_OGG\_MAX\_PAGE\_SIZE) \{}
\DoxyCodeLine{7113             \textcolor{keywordflow}{continue};   \textcolor{comment}{/* Invalid page size. Assume it's corrupted and just move to the next page. */}}
\DoxyCodeLine{7114         \}}
\DoxyCodeLine{7115 }
\DoxyCodeLine{7116         \textcolor{keywordflow}{if} (header.serialNumber != oggbs-\/>serialNumber) \{}
\DoxyCodeLine{7117             \textcolor{comment}{/* It's not a FLAC page. Skip it. */}}
\DoxyCodeLine{7118             \textcolor{keywordflow}{if} (pageBodySize > 0 \&\& !drflac\_oggbs\_\_seek\_physical(oggbs, pageBodySize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7119                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7120             \}}
\DoxyCodeLine{7121             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{7122         \}}
\DoxyCodeLine{7123 }
\DoxyCodeLine{7124 }
\DoxyCodeLine{7125         \textcolor{comment}{/* We need to read the entire page and then do a CRC check on it. If there's a CRC mismatch we need to skip this page. */}}
\DoxyCodeLine{7126         \textcolor{keywordflow}{if} (drflac\_oggbs\_\_read\_physical(oggbs, oggbs-\/>pageData, pageBodySize) != pageBodySize) \{}
\DoxyCodeLine{7127             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7128         \}}
\DoxyCodeLine{7129         oggbs-\/>pageDataSize = pageBodySize;}
\DoxyCodeLine{7130 }
\DoxyCodeLine{7131 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_CRC}}
\DoxyCodeLine{7132         actualCRC32 = drflac\_crc32\_buffer(crc32, oggbs-\/>pageData, oggbs-\/>pageDataSize);}
\DoxyCodeLine{7133         \textcolor{keywordflow}{if} (actualCRC32 != header.checksum) \{}
\DoxyCodeLine{7134             \textcolor{keywordflow}{if} (recoveryMethod == drflac\_ogg\_recover\_on\_crc\_mismatch) \{}
\DoxyCodeLine{7135                 \textcolor{keywordflow}{continue};   \textcolor{comment}{/* CRC mismatch. Skip this page. */}}
\DoxyCodeLine{7136             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7137                 \textcolor{comment}{/*}}
\DoxyCodeLine{7138 \textcolor{comment}{                Even though we are failing on a CRC mismatch, we still want our stream to be in a good state. Therefore we}}
\DoxyCodeLine{7139 \textcolor{comment}{                go to the next valid page to ensure we're in a good state, but return false to let the caller know that the}}
\DoxyCodeLine{7140 \textcolor{comment}{                seek did not fully complete.}}
\DoxyCodeLine{7141 \textcolor{comment}{                */}}
\DoxyCodeLine{7142                 drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_recover\_on\_crc\_mismatch);}
\DoxyCodeLine{7143                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7144             \}}
\DoxyCodeLine{7145         \}}
\DoxyCodeLine{7146 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7147         (void)recoveryMethod;   \textcolor{comment}{/* <-\/-\/ Silence a warning. */}}
\DoxyCodeLine{7148 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7149 }
\DoxyCodeLine{7150         oggbs-\/>currentPageHeader = header;}
\DoxyCodeLine{7151         oggbs-\/>bytesRemainingInPage = pageBodySize;}
\DoxyCodeLine{7152         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7153     \}}
\DoxyCodeLine{7154 \}}
\DoxyCodeLine{7155 }
\DoxyCodeLine{7156 \textcolor{comment}{/* Function below is unused at the moment, but I might be re-\/adding it later. */}}
\DoxyCodeLine{7157 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{7158 \textcolor{keyword}{static} drflac\_uint8 drflac\_oggbs\_\_get\_current\_segment\_index(drflac\_oggbs* oggbs, drflac\_uint8* pBytesRemainingInSeg)}
\DoxyCodeLine{7159 \{}
\DoxyCodeLine{7160     drflac\_uint32 bytesConsumedInPage = drflac\_ogg\_\_get\_page\_body\_size(\&oggbs-\/>currentPageHeader) -\/ oggbs-\/>bytesRemainingInPage;}
\DoxyCodeLine{7161     drflac\_uint8 iSeg = 0;}
\DoxyCodeLine{7162     drflac\_uint32 iByte = 0;}
\DoxyCodeLine{7163     \textcolor{keywordflow}{while} (iByte < bytesConsumedInPage) \{}
\DoxyCodeLine{7164         drflac\_uint8 segmentSize = oggbs-\/>currentPageHeader.segmentTable[iSeg];}
\DoxyCodeLine{7165         \textcolor{keywordflow}{if} (iByte + segmentSize > bytesConsumedInPage) \{}
\DoxyCodeLine{7166             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7167         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7168             iSeg += 1;}
\DoxyCodeLine{7169             iByte += segmentSize;}
\DoxyCodeLine{7170         \}}
\DoxyCodeLine{7171     \}}
\DoxyCodeLine{7172 }
\DoxyCodeLine{7173     *pBytesRemainingInSeg = oggbs-\/>currentPageHeader.segmentTable[iSeg] -\/ (drflac\_uint8)(bytesConsumedInPage -\/ iByte);}
\DoxyCodeLine{7174     \textcolor{keywordflow}{return} iSeg;}
\DoxyCodeLine{7175 \}}
\DoxyCodeLine{7176 }
\DoxyCodeLine{7177 \textcolor{keyword}{static} drflac\_bool32 drflac\_oggbs\_\_seek\_to\_next\_packet(drflac\_oggbs* oggbs)}
\DoxyCodeLine{7178 \{}
\DoxyCodeLine{7179     \textcolor{comment}{/* The current packet ends when we get to the segment with a lacing value of < 255 which is not at the end of a page. */}}
\DoxyCodeLine{7180     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7181         drflac\_bool32 atEndOfPage = DRFLAC\_FALSE;}
\DoxyCodeLine{7182 }
\DoxyCodeLine{7183         drflac\_uint8 bytesRemainingInSeg;}
\DoxyCodeLine{7184         drflac\_uint8 iFirstSeg = drflac\_oggbs\_\_get\_current\_segment\_index(oggbs, \&bytesRemainingInSeg);}
\DoxyCodeLine{7185 }
\DoxyCodeLine{7186         drflac\_uint32 bytesToEndOfPacketOrPage = bytesRemainingInSeg;}
\DoxyCodeLine{7187         \textcolor{keywordflow}{for} (drflac\_uint8 iSeg = iFirstSeg; iSeg < oggbs-\/>currentPageHeader.segmentCount; ++iSeg) \{}
\DoxyCodeLine{7188             drflac\_uint8 segmentSize = oggbs-\/>currentPageHeader.segmentTable[iSeg];}
\DoxyCodeLine{7189             \textcolor{keywordflow}{if} (segmentSize < 255) \{}
\DoxyCodeLine{7190                 \textcolor{keywordflow}{if} (iSeg == oggbs-\/>currentPageHeader.segmentCount-\/1) \{}
\DoxyCodeLine{7191                     atEndOfPage = DRFLAC\_TRUE;}
\DoxyCodeLine{7192                 \}}
\DoxyCodeLine{7193 }
\DoxyCodeLine{7194                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{7195             \}}
\DoxyCodeLine{7196 }
\DoxyCodeLine{7197             bytesToEndOfPacketOrPage += segmentSize;}
\DoxyCodeLine{7198         \}}
\DoxyCodeLine{7199 }
\DoxyCodeLine{7200         \textcolor{comment}{/*}}
\DoxyCodeLine{7201 \textcolor{comment}{        At this point we will have found either the packet or the end of the page. If were at the end of the page we'll}}
\DoxyCodeLine{7202 \textcolor{comment}{        want to load the next page and keep searching for the end of the packet.}}
\DoxyCodeLine{7203 \textcolor{comment}{        */}}
\DoxyCodeLine{7204         drflac\_oggbs\_\_seek\_physical(oggbs, bytesToEndOfPacketOrPage, drflac\_seek\_origin\_current);}
\DoxyCodeLine{7205         oggbs-\/>bytesRemainingInPage -\/= bytesToEndOfPacketOrPage;}
\DoxyCodeLine{7206 }
\DoxyCodeLine{7207         \textcolor{keywordflow}{if} (atEndOfPage) \{}
\DoxyCodeLine{7208             \textcolor{comment}{/*}}
\DoxyCodeLine{7209 \textcolor{comment}{            We're potentially at the next packet, but we need to check the next page first to be sure because the packet may}}
\DoxyCodeLine{7210 \textcolor{comment}{            straddle pages.}}
\DoxyCodeLine{7211 \textcolor{comment}{            */}}
\DoxyCodeLine{7212             \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs)) \{}
\DoxyCodeLine{7213                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7214             \}}
\DoxyCodeLine{7215 }
\DoxyCodeLine{7216             \textcolor{comment}{/* If it's a fresh packet it most likely means we're at the next packet. */}}
\DoxyCodeLine{7217             \textcolor{keywordflow}{if} ((oggbs-\/>currentPageHeader.headerType \& 0x01) == 0) \{}
\DoxyCodeLine{7218                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7219             \}}
\DoxyCodeLine{7220         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7221             \textcolor{comment}{/* We're at the next packet. */}}
\DoxyCodeLine{7222             \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7223         \}}
\DoxyCodeLine{7224     \}}
\DoxyCodeLine{7225 \}}
\DoxyCodeLine{7226 }
\DoxyCodeLine{7227 \textcolor{keyword}{static} drflac\_bool32 drflac\_oggbs\_\_seek\_to\_next\_frame(drflac\_oggbs* oggbs)}
\DoxyCodeLine{7228 \{}
\DoxyCodeLine{7229     \textcolor{comment}{/* The bitstream should be sitting on the first byte just after the header of the frame. */}}
\DoxyCodeLine{7230 }
\DoxyCodeLine{7231     \textcolor{comment}{/* What we're actually doing here is seeking to the start of the next packet. */}}
\DoxyCodeLine{7232     \textcolor{keywordflow}{return} drflac\_oggbs\_\_seek\_to\_next\_packet(oggbs);}
\DoxyCodeLine{7233 \}}
\DoxyCodeLine{7234 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7235 }
\DoxyCodeLine{7236 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drflac\_\_on\_read\_ogg(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* bufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{7237 \{}
\DoxyCodeLine{7238     drflac\_oggbs* oggbs = (drflac\_oggbs*)pUserData;}
\DoxyCodeLine{7239     drflac\_uint8* pRunningBufferOut = (drflac\_uint8*)bufferOut;}
\DoxyCodeLine{7240     \textcolor{keywordtype}{size\_t} bytesRead = 0;}
\DoxyCodeLine{7241 }
\DoxyCodeLine{7242     DRFLAC\_ASSERT(oggbs != NULL);}
\DoxyCodeLine{7243     DRFLAC\_ASSERT(pRunningBufferOut != NULL);}
\DoxyCodeLine{7244 }
\DoxyCodeLine{7245     \textcolor{comment}{/* Reading is done page-\/by-\/page. If we've run out of bytes in the page we need to move to the next one. */}}
\DoxyCodeLine{7246     \textcolor{keywordflow}{while} (bytesRead < bytesToRead) \{}
\DoxyCodeLine{7247         \textcolor{keywordtype}{size\_t} bytesRemainingToRead = bytesToRead -\/ bytesRead;}
\DoxyCodeLine{7248 }
\DoxyCodeLine{7249         \textcolor{keywordflow}{if} (oggbs-\/>bytesRemainingInPage >= bytesRemainingToRead) \{}
\DoxyCodeLine{7250             DRFLAC\_COPY\_MEMORY(pRunningBufferOut, oggbs-\/>pageData + (oggbs-\/>pageDataSize -\/ oggbs-\/>bytesRemainingInPage), bytesRemainingToRead);}
\DoxyCodeLine{7251             bytesRead += bytesRemainingToRead;}
\DoxyCodeLine{7252             oggbs-\/>bytesRemainingInPage -\/= (drflac\_uint32)bytesRemainingToRead;}
\DoxyCodeLine{7253             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7254         \}}
\DoxyCodeLine{7255 }
\DoxyCodeLine{7256         \textcolor{comment}{/* If we get here it means some of the requested data is contained in the next pages. */}}
\DoxyCodeLine{7257         \textcolor{keywordflow}{if} (oggbs-\/>bytesRemainingInPage > 0) \{}
\DoxyCodeLine{7258             DRFLAC\_COPY\_MEMORY(pRunningBufferOut, oggbs-\/>pageData + (oggbs-\/>pageDataSize -\/ oggbs-\/>bytesRemainingInPage), oggbs-\/>bytesRemainingInPage);}
\DoxyCodeLine{7259             bytesRead += oggbs-\/>bytesRemainingInPage;}
\DoxyCodeLine{7260             pRunningBufferOut += oggbs-\/>bytesRemainingInPage;}
\DoxyCodeLine{7261             oggbs-\/>bytesRemainingInPage = 0;}
\DoxyCodeLine{7262         \}}
\DoxyCodeLine{7263 }
\DoxyCodeLine{7264         DRFLAC\_ASSERT(bytesRemainingToRead > 0);}
\DoxyCodeLine{7265         \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_recover\_on\_crc\_mismatch)) \{}
\DoxyCodeLine{7266             \textcolor{keywordflow}{break};  \textcolor{comment}{/* Failed to go to the next page. Might have simply hit the end of the stream. */}}
\DoxyCodeLine{7267         \}}
\DoxyCodeLine{7268     \}}
\DoxyCodeLine{7269 }
\DoxyCodeLine{7270     \textcolor{keywordflow}{return} bytesRead;}
\DoxyCodeLine{7271 \}}
\DoxyCodeLine{7272 }
\DoxyCodeLine{7273 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_on\_seek\_ogg(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drflac\_seek\_origin origin)}
\DoxyCodeLine{7274 \{}
\DoxyCodeLine{7275     drflac\_oggbs* oggbs = (drflac\_oggbs*)pUserData;}
\DoxyCodeLine{7276     \textcolor{keywordtype}{int} bytesSeeked = 0;}
\DoxyCodeLine{7277 }
\DoxyCodeLine{7278     DRFLAC\_ASSERT(oggbs != NULL);}
\DoxyCodeLine{7279     DRFLAC\_ASSERT(offset >= 0);  \textcolor{comment}{/* <-\/-\/ Never seek backwards. */}}
\DoxyCodeLine{7280 }
\DoxyCodeLine{7281     \textcolor{comment}{/* Seeking is always forward which makes things a lot simpler. */}}
\DoxyCodeLine{7282     \textcolor{keywordflow}{if} (origin == drflac\_seek\_origin\_start) \{}
\DoxyCodeLine{7283         \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_seek\_physical(oggbs, (\textcolor{keywordtype}{int})oggbs-\/>firstBytePos, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7284             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7285         \}}
\DoxyCodeLine{7286 }
\DoxyCodeLine{7287         \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_fail\_on\_crc\_mismatch)) \{}
\DoxyCodeLine{7288             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7289         \}}
\DoxyCodeLine{7290 }
\DoxyCodeLine{7291         \textcolor{keywordflow}{return} drflac\_\_on\_seek\_ogg(pUserData, offset, drflac\_seek\_origin\_current);}
\DoxyCodeLine{7292     \}}
\DoxyCodeLine{7293 }
\DoxyCodeLine{7294     DRFLAC\_ASSERT(origin == drflac\_seek\_origin\_current);}
\DoxyCodeLine{7295 }
\DoxyCodeLine{7296     \textcolor{keywordflow}{while} (bytesSeeked < offset) \{}
\DoxyCodeLine{7297         \textcolor{keywordtype}{int} bytesRemainingToSeek = offset -\/ bytesSeeked;}
\DoxyCodeLine{7298         DRFLAC\_ASSERT(bytesRemainingToSeek >= 0);}
\DoxyCodeLine{7299 }
\DoxyCodeLine{7300         \textcolor{keywordflow}{if} (oggbs-\/>bytesRemainingInPage >= (\textcolor{keywordtype}{size\_t})bytesRemainingToSeek) \{}
\DoxyCodeLine{7301             bytesSeeked += bytesRemainingToSeek;}
\DoxyCodeLine{7302             (void)bytesSeeked;  \textcolor{comment}{/* <-\/-\/ Silence a dead store warning emitted by Clang Static Analyzer. */}}
\DoxyCodeLine{7303             oggbs-\/>bytesRemainingInPage -\/= bytesRemainingToSeek;}
\DoxyCodeLine{7304             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7305         \}}
\DoxyCodeLine{7306 }
\DoxyCodeLine{7307         \textcolor{comment}{/* If we get here it means some of the requested data is contained in the next pages. */}}
\DoxyCodeLine{7308         \textcolor{keywordflow}{if} (oggbs-\/>bytesRemainingInPage > 0) \{}
\DoxyCodeLine{7309             bytesSeeked += (int)oggbs-\/>bytesRemainingInPage;}
\DoxyCodeLine{7310             oggbs-\/>bytesRemainingInPage = 0;}
\DoxyCodeLine{7311         \}}
\DoxyCodeLine{7312 }
\DoxyCodeLine{7313         DRFLAC\_ASSERT(bytesRemainingToSeek > 0);}
\DoxyCodeLine{7314         \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_fail\_on\_crc\_mismatch)) \{}
\DoxyCodeLine{7315             \textcolor{comment}{/* Failed to go to the next page. We either hit the end of the stream or had a CRC mismatch. */}}
\DoxyCodeLine{7316             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7317         \}}
\DoxyCodeLine{7318     \}}
\DoxyCodeLine{7319 }
\DoxyCodeLine{7320     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7321 \}}
\DoxyCodeLine{7322 }
\DoxyCodeLine{7323 }
\DoxyCodeLine{7324 \textcolor{keyword}{static} drflac\_bool32 drflac\_ogg\_\_seek\_to\_pcm\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex)}
\DoxyCodeLine{7325 \{}
\DoxyCodeLine{7326     drflac\_oggbs* oggbs = (drflac\_oggbs*)pFlac-\/>\_oggbs;}
\DoxyCodeLine{7327     drflac\_uint64 originalBytePos;}
\DoxyCodeLine{7328     drflac\_uint64 runningGranulePosition;}
\DoxyCodeLine{7329     drflac\_uint64 runningFrameBytePos;}
\DoxyCodeLine{7330     drflac\_uint64 runningPCMFrameCount;}
\DoxyCodeLine{7331 }
\DoxyCodeLine{7332     DRFLAC\_ASSERT(oggbs != NULL);}
\DoxyCodeLine{7333 }
\DoxyCodeLine{7334     originalBytePos = oggbs-\/>currentBytePos;   \textcolor{comment}{/* For recovery. Points to the OggS identifier. */}}
\DoxyCodeLine{7335 }
\DoxyCodeLine{7336     \textcolor{comment}{/* First seek to the first frame. */}}
\DoxyCodeLine{7337     \textcolor{keywordflow}{if} (!drflac\_\_seek\_to\_byte(\&pFlac-\/>bs, pFlac-\/>firstFLACFramePosInBytes)) \{}
\DoxyCodeLine{7338         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7339     \}}
\DoxyCodeLine{7340     oggbs-\/>bytesRemainingInPage = 0;}
\DoxyCodeLine{7341 }
\DoxyCodeLine{7342     runningGranulePosition = 0;}
\DoxyCodeLine{7343     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7344         \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_recover\_on\_crc\_mismatch)) \{}
\DoxyCodeLine{7345             drflac\_oggbs\_\_seek\_physical(oggbs, originalBytePos, drflac\_seek\_origin\_start);}
\DoxyCodeLine{7346             \textcolor{keywordflow}{return} DRFLAC\_FALSE;   \textcolor{comment}{/* Never did find that sample... */}}
\DoxyCodeLine{7347         \}}
\DoxyCodeLine{7348 }
\DoxyCodeLine{7349         runningFrameBytePos = oggbs-\/>currentBytePos -\/ drflac\_ogg\_\_get\_page\_header\_size(\&oggbs-\/>currentPageHeader) -\/ oggbs-\/>pageDataSize;}
\DoxyCodeLine{7350         \textcolor{keywordflow}{if} (oggbs-\/>currentPageHeader.granulePosition >= pcmFrameIndex) \{}
\DoxyCodeLine{7351             \textcolor{keywordflow}{break}; \textcolor{comment}{/* The sample is somewhere in the previous page. */}}
\DoxyCodeLine{7352         \}}
\DoxyCodeLine{7353 }
\DoxyCodeLine{7354         \textcolor{comment}{/*}}
\DoxyCodeLine{7355 \textcolor{comment}{        At this point we know the sample is not in the previous page. It could possibly be in this page. For simplicity we}}
\DoxyCodeLine{7356 \textcolor{comment}{        disregard any pages that do not begin a fresh packet.}}
\DoxyCodeLine{7357 \textcolor{comment}{        */}}
\DoxyCodeLine{7358         \textcolor{keywordflow}{if} ((oggbs-\/>currentPageHeader.headerType \& 0x01) == 0) \{    \textcolor{comment}{/* <-\/-\/ Is it a fresh page? */}}
\DoxyCodeLine{7359             \textcolor{keywordflow}{if} (oggbs-\/>currentPageHeader.segmentTable[0] >= 2) \{}
\DoxyCodeLine{7360                 drflac\_uint8 firstBytesInPage[2];}
\DoxyCodeLine{7361                 firstBytesInPage[0] = oggbs-\/>pageData[0];}
\DoxyCodeLine{7362                 firstBytesInPage[1] = oggbs-\/>pageData[1];}
\DoxyCodeLine{7363 }
\DoxyCodeLine{7364                 \textcolor{keywordflow}{if} ((firstBytesInPage[0] == 0xFF) \&\& (firstBytesInPage[1] \& 0xFC) == 0xF8) \{    \textcolor{comment}{/* <-\/-\/ Does the page begin with a frame's sync code? */}}
\DoxyCodeLine{7365                     runningGranulePosition = oggbs-\/>currentPageHeader.granulePosition;}
\DoxyCodeLine{7366                 \}}
\DoxyCodeLine{7367 }
\DoxyCodeLine{7368                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{7369             \}}
\DoxyCodeLine{7370         \}}
\DoxyCodeLine{7371     \}}
\DoxyCodeLine{7372 }
\DoxyCodeLine{7373     \textcolor{comment}{/*}}
\DoxyCodeLine{7374 \textcolor{comment}{    We found the page that that is closest to the sample, so now we need to find it. The first thing to do is seek to the}}
\DoxyCodeLine{7375 \textcolor{comment}{    start of that page. In the loop above we checked that it was a fresh page which means this page is also the start of}}
\DoxyCodeLine{7376 \textcolor{comment}{    a new frame. This property means that after we've seeked to the page we can immediately start looping over frames until}}
\DoxyCodeLine{7377 \textcolor{comment}{    we find the one containing the target sample.}}
\DoxyCodeLine{7378 \textcolor{comment}{    */}}
\DoxyCodeLine{7379     \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_seek\_physical(oggbs, runningFrameBytePos, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7380         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7381     \}}
\DoxyCodeLine{7382     \textcolor{keywordflow}{if} (!drflac\_oggbs\_\_goto\_next\_page(oggbs, drflac\_ogg\_recover\_on\_crc\_mismatch)) \{}
\DoxyCodeLine{7383         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7384     \}}
\DoxyCodeLine{7385 }
\DoxyCodeLine{7386     \textcolor{comment}{/*}}
\DoxyCodeLine{7387 \textcolor{comment}{    At this point we'll be sitting on the first byte of the frame header of the first frame in the page. We just keep}}
\DoxyCodeLine{7388 \textcolor{comment}{    looping over these frames until we find the one containing the sample we're after.}}
\DoxyCodeLine{7389 \textcolor{comment}{    */}}
\DoxyCodeLine{7390     runningPCMFrameCount = runningGranulePosition;}
\DoxyCodeLine{7391     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7392         \textcolor{comment}{/*}}
\DoxyCodeLine{7393 \textcolor{comment}{        There are two ways to find the sample and seek past irrelevant frames:}}
\DoxyCodeLine{7394 \textcolor{comment}{          1) Use the native FLAC decoder.}}
\DoxyCodeLine{7395 \textcolor{comment}{          2) Use Ogg's framing system.}}
\DoxyCodeLine{7396 \textcolor{comment}{}}
\DoxyCodeLine{7397 \textcolor{comment}{        Both of these options have their own pros and cons. Using the native FLAC decoder is slower because it needs to}}
\DoxyCodeLine{7398 \textcolor{comment}{        do a full decode of the frame. Using Ogg's framing system is faster, but more complicated and involves some code}}
\DoxyCodeLine{7399 \textcolor{comment}{        duplication for the decoding of frame headers.}}
\DoxyCodeLine{7400 \textcolor{comment}{}}
\DoxyCodeLine{7401 \textcolor{comment}{        Another thing to consider is that using the Ogg framing system will perform direct seeking of the physical Ogg}}
\DoxyCodeLine{7402 \textcolor{comment}{        bitstream. This is important to consider because it means we cannot read data from the drflac\_bs object using the}}
\DoxyCodeLine{7403 \textcolor{comment}{        standard drflac\_\_*() APIs because that will read in extra data for its own internal caching which in turn breaks}}
\DoxyCodeLine{7404 \textcolor{comment}{        the positioning of the read pointer of the physical Ogg bitstream. Therefore, anything that would normally be read}}
\DoxyCodeLine{7405 \textcolor{comment}{        using the native FLAC decoding APIs, such as drflac\_\_read\_next\_flac\_frame\_header(), need to be re-\/implemented so as to}}
\DoxyCodeLine{7406 \textcolor{comment}{        avoid the use of the drflac\_bs object.}}
\DoxyCodeLine{7407 \textcolor{comment}{}}
\DoxyCodeLine{7408 \textcolor{comment}{        Considering these issues, I have decided to use the slower native FLAC decoding method for the following reasons:}}
\DoxyCodeLine{7409 \textcolor{comment}{          1) Seeking is already partially accelerated using Ogg's paging system in the code block above.}}
\DoxyCodeLine{7410 \textcolor{comment}{          2) Seeking in an Ogg encapsulated FLAC stream is probably quite uncommon.}}
\DoxyCodeLine{7411 \textcolor{comment}{          3) Simplicity.}}
\DoxyCodeLine{7412 \textcolor{comment}{        */}}
\DoxyCodeLine{7413         drflac\_uint64 firstPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{7414         drflac\_uint64 lastPCMFrameInFLACFrame = 0;}
\DoxyCodeLine{7415         drflac\_uint64 pcmFrameCountInThisFrame;}
\DoxyCodeLine{7416 }
\DoxyCodeLine{7417         \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{7418             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7419         \}}
\DoxyCodeLine{7420 }
\DoxyCodeLine{7421         drflac\_\_get\_pcm\_frame\_range\_of\_current\_flac\_frame(pFlac, \&firstPCMFrameInFLACFrame, \&lastPCMFrameInFLACFrame);}
\DoxyCodeLine{7422 }
\DoxyCodeLine{7423         pcmFrameCountInThisFrame = (lastPCMFrameInFLACFrame -\/ firstPCMFrameInFLACFrame) + 1;}
\DoxyCodeLine{7424 }
\DoxyCodeLine{7425         \textcolor{comment}{/* If we are seeking to the end of the file and we've just hit it, we're done. */}}
\DoxyCodeLine{7426         \textcolor{keywordflow}{if} (pcmFrameIndex == pFlac-\/>totalPCMFrameCount \&\& (runningPCMFrameCount + pcmFrameCountInThisFrame) == pFlac-\/>totalPCMFrameCount) \{}
\DoxyCodeLine{7427             drflac\_result result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{7428             \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7429                 pFlac-\/>currentPCMFrame = pcmFrameIndex;}
\DoxyCodeLine{7430                 pFlac-\/>currentFLACFrame.pcmFramesRemaining = 0;}
\DoxyCodeLine{7431                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7432             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7433                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7434             \}}
\DoxyCodeLine{7435         \}}
\DoxyCodeLine{7436 }
\DoxyCodeLine{7437         \textcolor{keywordflow}{if} (pcmFrameIndex < (runningPCMFrameCount + pcmFrameCountInThisFrame)) \{}
\DoxyCodeLine{7438             \textcolor{comment}{/*}}
\DoxyCodeLine{7439 \textcolor{comment}{            The sample should be in this FLAC frame. We need to fully decode it, however if it's an invalid frame (a CRC mismatch), we need to pretend}}
\DoxyCodeLine{7440 \textcolor{comment}{            it never existed and keep iterating.}}
\DoxyCodeLine{7441 \textcolor{comment}{            */}}
\DoxyCodeLine{7442             drflac\_result result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{7443             \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7444                 \textcolor{comment}{/* The frame is valid. We just need to skip over some samples to ensure it's sample-\/exact. */}}
\DoxyCodeLine{7445                 drflac\_uint64 pcmFramesToDecode = (size\_t)(pcmFrameIndex -\/ runningPCMFrameCount);    \textcolor{comment}{/* <-\/-\/ Safe cast because the maximum number of samples in a frame is 65535. */}}
\DoxyCodeLine{7446                 \textcolor{keywordflow}{if} (pcmFramesToDecode == 0) \{}
\DoxyCodeLine{7447                     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7448                 \}}
\DoxyCodeLine{7449 }
\DoxyCodeLine{7450                 pFlac-\/>currentPCMFrame = runningPCMFrameCount;}
\DoxyCodeLine{7451 }
\DoxyCodeLine{7452                 \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, pcmFramesToDecode) == pcmFramesToDecode;  \textcolor{comment}{/* <-\/-\/ If this fails, something bad has happened (it should never fail). */}}
\DoxyCodeLine{7453             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7454                 \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{7455                     \textcolor{keywordflow}{continue};   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{7456                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7457                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7458                 \}}
\DoxyCodeLine{7459             \}}
\DoxyCodeLine{7460         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7461             \textcolor{comment}{/*}}
\DoxyCodeLine{7462 \textcolor{comment}{            It's not in this frame. We need to seek past the frame, but check if there was a CRC mismatch. If so, we pretend this}}
\DoxyCodeLine{7463 \textcolor{comment}{            frame never existed and leave the running sample count untouched.}}
\DoxyCodeLine{7464 \textcolor{comment}{            */}}
\DoxyCodeLine{7465             drflac\_result result = drflac\_\_seek\_to\_next\_flac\_frame(pFlac);}
\DoxyCodeLine{7466             \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7467                 runningPCMFrameCount += pcmFrameCountInThisFrame;}
\DoxyCodeLine{7468             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7469                 \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{7470                     \textcolor{keywordflow}{continue};   \textcolor{comment}{/* CRC mismatch. Pretend this frame never existed. */}}
\DoxyCodeLine{7471                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7472                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7473                 \}}
\DoxyCodeLine{7474             \}}
\DoxyCodeLine{7475         \}}
\DoxyCodeLine{7476     \}}
\DoxyCodeLine{7477 \}}
\DoxyCodeLine{7478 }
\DoxyCodeLine{7479 }
\DoxyCodeLine{7480 }
\DoxyCodeLine{7481 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_init\_private\_\_ogg(drflac\_init\_info* pInit, drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pUserDataMD, drflac\_bool32 relaxed)}
\DoxyCodeLine{7482 \{}
\DoxyCodeLine{7483     drflac\_ogg\_page\_header header;}
\DoxyCodeLine{7484     drflac\_uint32 crc32 = DRFLAC\_OGG\_CAPTURE\_PATTERN\_CRC32;}
\DoxyCodeLine{7485     drflac\_uint32 bytesRead = 0;}
\DoxyCodeLine{7486 }
\DoxyCodeLine{7487     \textcolor{comment}{/* Pre Condition: The bit stream should be sitting just past the 4-\/byte OggS capture pattern. */}}
\DoxyCodeLine{7488     (void)relaxed;}
\DoxyCodeLine{7489 }
\DoxyCodeLine{7490     pInit-\/>container = drflac\_container\_ogg;}
\DoxyCodeLine{7491     pInit-\/>oggFirstBytePos = 0;}
\DoxyCodeLine{7492 }
\DoxyCodeLine{7493     \textcolor{comment}{/*}}
\DoxyCodeLine{7494 \textcolor{comment}{    We'll get here if the first 4 bytes of the stream were the OggS capture pattern, however it doesn't necessarily mean the}}
\DoxyCodeLine{7495 \textcolor{comment}{    stream includes FLAC encoded audio. To check for this we need to scan the beginning-\/of-\/stream page markers and check if}}
\DoxyCodeLine{7496 \textcolor{comment}{    any match the FLAC specification. Important to keep in mind that the stream may be multiplexed.}}
\DoxyCodeLine{7497 \textcolor{comment}{    */}}
\DoxyCodeLine{7498     \textcolor{keywordflow}{if} (drflac\_ogg\_\_read\_page\_header\_after\_capture\_pattern(onRead, pUserData, \&header, \&bytesRead, \&crc32) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7499         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7500     \}}
\DoxyCodeLine{7501     pInit-\/>runningFilePos += bytesRead;}
\DoxyCodeLine{7502 }
\DoxyCodeLine{7503     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7504         \textcolor{keywordtype}{int} pageBodySize;}
\DoxyCodeLine{7505 }
\DoxyCodeLine{7506         \textcolor{comment}{/* Break if we're past the beginning of stream page. */}}
\DoxyCodeLine{7507         \textcolor{keywordflow}{if} ((header.headerType \& 0x02) == 0) \{}
\DoxyCodeLine{7508             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7509         \}}
\DoxyCodeLine{7510 }
\DoxyCodeLine{7511         \textcolor{comment}{/* Check if it's a FLAC header. */}}
\DoxyCodeLine{7512         pageBodySize = drflac\_ogg\_\_get\_page\_body\_size(\&header);}
\DoxyCodeLine{7513         \textcolor{keywordflow}{if} (pageBodySize == 51) \{   \textcolor{comment}{/* 51 = the lacing value of the FLAC header packet. */}}
\DoxyCodeLine{7514             \textcolor{comment}{/* It could be a FLAC page... */}}
\DoxyCodeLine{7515             drflac\_uint32 bytesRemainingInPage = pageBodySize;}
\DoxyCodeLine{7516             drflac\_uint8 packetType;}
\DoxyCodeLine{7517 }
\DoxyCodeLine{7518             \textcolor{keywordflow}{if} (onRead(pUserData, \&packetType, 1) != 1) \{}
\DoxyCodeLine{7519                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7520             \}}
\DoxyCodeLine{7521 }
\DoxyCodeLine{7522             bytesRemainingInPage -\/= 1;}
\DoxyCodeLine{7523             \textcolor{keywordflow}{if} (packetType == 0x7F) \{}
\DoxyCodeLine{7524                 \textcolor{comment}{/* Increasingly more likely to be a FLAC page... */}}
\DoxyCodeLine{7525                 drflac\_uint8 sig[4];}
\DoxyCodeLine{7526                 \textcolor{keywordflow}{if} (onRead(pUserData, sig, 4) != 4) \{}
\DoxyCodeLine{7527                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7528                 \}}
\DoxyCodeLine{7529 }
\DoxyCodeLine{7530                 bytesRemainingInPage -\/= 4;}
\DoxyCodeLine{7531                 \textcolor{keywordflow}{if} (sig[0] == \textcolor{charliteral}{'F'} \&\& sig[1] == \textcolor{charliteral}{'L'} \&\& sig[2] == \textcolor{charliteral}{'A'} \&\& sig[3] == \textcolor{charliteral}{'C'}) \{}
\DoxyCodeLine{7532                     \textcolor{comment}{/* Almost certainly a FLAC page... */}}
\DoxyCodeLine{7533                     drflac\_uint8 mappingVersion[2];}
\DoxyCodeLine{7534                     \textcolor{keywordflow}{if} (onRead(pUserData, mappingVersion, 2) != 2) \{}
\DoxyCodeLine{7535                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7536                     \}}
\DoxyCodeLine{7537 }
\DoxyCodeLine{7538                     \textcolor{keywordflow}{if} (mappingVersion[0] != 1) \{}
\DoxyCodeLine{7539                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;   \textcolor{comment}{/* Only supporting version 1.x of the Ogg mapping. */}}
\DoxyCodeLine{7540                     \}}
\DoxyCodeLine{7541 }
\DoxyCodeLine{7542                     \textcolor{comment}{/*}}
\DoxyCodeLine{7543 \textcolor{comment}{                    The next 2 bytes are the non-\/audio packets, not including this one. We don't care about this because we're going to}}
\DoxyCodeLine{7544 \textcolor{comment}{                    be handling it in a generic way based on the serial number and packet types.}}
\DoxyCodeLine{7545 \textcolor{comment}{                    */}}
\DoxyCodeLine{7546                     \textcolor{keywordflow}{if} (!onSeek(pUserData, 2, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7547                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7548                     \}}
\DoxyCodeLine{7549 }
\DoxyCodeLine{7550                     \textcolor{comment}{/* Expecting the native FLAC signature "{}fLaC"{}. */}}
\DoxyCodeLine{7551                     \textcolor{keywordflow}{if} (onRead(pUserData, sig, 4) != 4) \{}
\DoxyCodeLine{7552                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7553                     \}}
\DoxyCodeLine{7554 }
\DoxyCodeLine{7555                     \textcolor{keywordflow}{if} (sig[0] == \textcolor{charliteral}{'f'} \&\& sig[1] == \textcolor{charliteral}{'L'} \&\& sig[2] == \textcolor{charliteral}{'a'} \&\& sig[3] == \textcolor{charliteral}{'C'}) \{}
\DoxyCodeLine{7556                         \textcolor{comment}{/* The remaining data in the page should be the STREAMINFO block. */}}
\DoxyCodeLine{7557                         \mbox{\hyperlink{structdrflac__streaminfo}{drflac\_streaminfo}} streaminfo;}
\DoxyCodeLine{7558                         drflac\_uint8 isLastBlock;}
\DoxyCodeLine{7559                         drflac\_uint8 blockType;}
\DoxyCodeLine{7560                         drflac\_uint32 blockSize;}
\DoxyCodeLine{7561                         \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_block\_header(onRead, pUserData, \&isLastBlock, \&blockType, \&blockSize)) \{}
\DoxyCodeLine{7562                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7563                         \}}
\DoxyCodeLine{7564 }
\DoxyCodeLine{7565                         \textcolor{keywordflow}{if} (blockType != DRFLAC\_METADATA\_BLOCK\_TYPE\_STREAMINFO || blockSize != 34) \{}
\DoxyCodeLine{7566                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Invalid block type. First block must be the STREAMINFO block. */}}
\DoxyCodeLine{7567                         \}}
\DoxyCodeLine{7568 }
\DoxyCodeLine{7569                         \textcolor{keywordflow}{if} (drflac\_\_read\_streaminfo(onRead, pUserData, \&streaminfo)) \{}
\DoxyCodeLine{7570                             \textcolor{comment}{/* Success! */}}
\DoxyCodeLine{7571                             pInit-\/>hasStreamInfoBlock      = DRFLAC\_TRUE;}
\DoxyCodeLine{7572                             pInit-\/>sampleRate              = streaminfo.sampleRate;}
\DoxyCodeLine{7573                             pInit-\/>channels                = streaminfo.channels;}
\DoxyCodeLine{7574                             pInit-\/>bitsPerSample           = streaminfo.bitsPerSample;}
\DoxyCodeLine{7575                             pInit-\/>totalPCMFrameCount      = streaminfo.totalPCMFrameCount;}
\DoxyCodeLine{7576                             pInit-\/>maxBlockSizeInPCMFrames = streaminfo.maxBlockSizeInPCMFrames;}
\DoxyCodeLine{7577                             pInit-\/>hasMetadataBlocks       = !isLastBlock;}
\DoxyCodeLine{7578 }
\DoxyCodeLine{7579                             \textcolor{keywordflow}{if} (onMeta) \{}
\DoxyCodeLine{7580                                 \mbox{\hyperlink{structdrflac__metadata}{drflac\_metadata}} metadata;}
\DoxyCodeLine{7581                                 metadata.type = DRFLAC\_METADATA\_BLOCK\_TYPE\_STREAMINFO;}
\DoxyCodeLine{7582                                 metadata.pRawData = NULL;}
\DoxyCodeLine{7583                                 metadata.rawDataSize = 0;}
\DoxyCodeLine{7584                                 metadata.data.streaminfo = streaminfo;}
\DoxyCodeLine{7585                                 onMeta(pUserDataMD, \&metadata);}
\DoxyCodeLine{7586                             \}}
\DoxyCodeLine{7587 }
\DoxyCodeLine{7588                             pInit-\/>runningFilePos  += pageBodySize;}
\DoxyCodeLine{7589                             pInit-\/>oggFirstBytePos  = pInit-\/>runningFilePos -\/ 79;   \textcolor{comment}{/* Subtracting 79 will place us right on top of the "{}OggS"{} identifier of the FLAC bos page. */}}
\DoxyCodeLine{7590                             pInit-\/>oggSerial        = header.serialNumber;}
\DoxyCodeLine{7591                             pInit-\/>oggBosHeader     = header;}
\DoxyCodeLine{7592                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7593                         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7594                             \textcolor{comment}{/* Failed to read STREAMINFO block. Aww, so close... */}}
\DoxyCodeLine{7595                             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7596                         \}}
\DoxyCodeLine{7597                     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7598                         \textcolor{comment}{/* Invalid file. */}}
\DoxyCodeLine{7599                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7600                     \}}
\DoxyCodeLine{7601                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7602                     \textcolor{comment}{/* Not a FLAC header. Skip it. */}}
\DoxyCodeLine{7603                     \textcolor{keywordflow}{if} (!onSeek(pUserData, bytesRemainingInPage, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7604                         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7605                     \}}
\DoxyCodeLine{7606                 \}}
\DoxyCodeLine{7607             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7608                 \textcolor{comment}{/* Not a FLAC header. Seek past the entire page and move on to the next. */}}
\DoxyCodeLine{7609                 \textcolor{keywordflow}{if} (!onSeek(pUserData, bytesRemainingInPage, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7610                     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7611                 \}}
\DoxyCodeLine{7612             \}}
\DoxyCodeLine{7613         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7614             \textcolor{keywordflow}{if} (!onSeek(pUserData, pageBodySize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7615                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7616             \}}
\DoxyCodeLine{7617         \}}
\DoxyCodeLine{7618 }
\DoxyCodeLine{7619         pInit-\/>runningFilePos += pageBodySize;}
\DoxyCodeLine{7620 }
\DoxyCodeLine{7621 }
\DoxyCodeLine{7622         \textcolor{comment}{/* Read the header of the next page. */}}
\DoxyCodeLine{7623         \textcolor{keywordflow}{if} (drflac\_ogg\_\_read\_page\_header(onRead, pUserData, \&header, \&bytesRead, \&crc32) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7624             \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7625         \}}
\DoxyCodeLine{7626         pInit-\/>runningFilePos += bytesRead;}
\DoxyCodeLine{7627     \}}
\DoxyCodeLine{7628 }
\DoxyCodeLine{7629     \textcolor{comment}{/*}}
\DoxyCodeLine{7630 \textcolor{comment}{    If we get here it means we found a FLAC audio stream. We should be sitting on the first byte of the header of the next page. The next}}
\DoxyCodeLine{7631 \textcolor{comment}{    packets in the FLAC logical stream contain the metadata. The only thing left to do in the initialization phase for Ogg is to create the}}
\DoxyCodeLine{7632 \textcolor{comment}{    Ogg bistream object.}}
\DoxyCodeLine{7633 \textcolor{comment}{    */}}
\DoxyCodeLine{7634     pInit-\/>hasMetadataBlocks = DRFLAC\_TRUE;    \textcolor{comment}{/* <-\/-\/ Always have at least VORBIS\_COMMENT metadata block. */}}
\DoxyCodeLine{7635     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{7636 \}}
\DoxyCodeLine{7637 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7638 }
\DoxyCodeLine{7639 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_init\_private(drflac\_init\_info* pInit, drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pUserDataMD)}
\DoxyCodeLine{7640 \{}
\DoxyCodeLine{7641     drflac\_bool32 relaxed;}
\DoxyCodeLine{7642     drflac\_uint8 \textcolor{keywordtype}{id}[4];}
\DoxyCodeLine{7643 }
\DoxyCodeLine{7644     \textcolor{keywordflow}{if} (pInit == NULL || onRead == NULL || onSeek == NULL) \{}
\DoxyCodeLine{7645         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7646     \}}
\DoxyCodeLine{7647 }
\DoxyCodeLine{7648     DRFLAC\_ZERO\_MEMORY(pInit, \textcolor{keyword}{sizeof}(*pInit));}
\DoxyCodeLine{7649     pInit-\/>onRead       = onRead;}
\DoxyCodeLine{7650     pInit-\/>onSeek       = onSeek;}
\DoxyCodeLine{7651     pInit-\/>onMeta       = onMeta;}
\DoxyCodeLine{7652     pInit-\/>container    = container;}
\DoxyCodeLine{7653     pInit-\/>pUserData    = pUserData;}
\DoxyCodeLine{7654     pInit-\/>pUserDataMD  = pUserDataMD;}
\DoxyCodeLine{7655 }
\DoxyCodeLine{7656     pInit-\/>bs.onRead    = onRead;}
\DoxyCodeLine{7657     pInit-\/>bs.onSeek    = onSeek;}
\DoxyCodeLine{7658     pInit-\/>bs.pUserData = pUserData;}
\DoxyCodeLine{7659     drflac\_\_reset\_cache(\&pInit-\/>bs);}
\DoxyCodeLine{7660 }
\DoxyCodeLine{7661 }
\DoxyCodeLine{7662     \textcolor{comment}{/* If the container is explicitly defined then we can try opening in relaxed mode. */}}
\DoxyCodeLine{7663     relaxed = container != drflac\_container\_unknown;}
\DoxyCodeLine{7664 }
\DoxyCodeLine{7665     \textcolor{comment}{/* Skip over any ID3 tags. */}}
\DoxyCodeLine{7666     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7667         \textcolor{keywordflow}{if} (onRead(pUserData, \textcolor{keywordtype}{id}, 4) != 4) \{}
\DoxyCodeLine{7668             \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Ran out of data. */}}
\DoxyCodeLine{7669         \}}
\DoxyCodeLine{7670         pInit-\/>runningFilePos += 4;}
\DoxyCodeLine{7671 }
\DoxyCodeLine{7672         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{id}[0] == \textcolor{charliteral}{'I'} \&\& \textcolor{keywordtype}{id}[1] == \textcolor{charliteral}{'D'} \&\& \textcolor{keywordtype}{id}[2] == \textcolor{charliteral}{'3'}) \{}
\DoxyCodeLine{7673             drflac\_uint8 header[6];}
\DoxyCodeLine{7674             drflac\_uint8 flags;}
\DoxyCodeLine{7675             drflac\_uint32 headerSize;}
\DoxyCodeLine{7676 }
\DoxyCodeLine{7677             \textcolor{keywordflow}{if} (onRead(pUserData, header, 6) != 6) \{}
\DoxyCodeLine{7678                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Ran out of data. */}}
\DoxyCodeLine{7679             \}}
\DoxyCodeLine{7680             pInit-\/>runningFilePos += 6;}
\DoxyCodeLine{7681 }
\DoxyCodeLine{7682             flags = header[1];}
\DoxyCodeLine{7683 }
\DoxyCodeLine{7684             DRFLAC\_COPY\_MEMORY(\&headerSize, header+2, 4);}
\DoxyCodeLine{7685             headerSize = drflac\_\_unsynchsafe\_32(drflac\_\_be2host\_32(headerSize));}
\DoxyCodeLine{7686             \textcolor{keywordflow}{if} (flags \& 0x10) \{}
\DoxyCodeLine{7687                 headerSize += 10;}
\DoxyCodeLine{7688             \}}
\DoxyCodeLine{7689 }
\DoxyCodeLine{7690             \textcolor{keywordflow}{if} (!onSeek(pUserData, headerSize, drflac\_seek\_origin\_current)) \{}
\DoxyCodeLine{7691                 \textcolor{keywordflow}{return} DRFLAC\_FALSE;    \textcolor{comment}{/* Failed to seek past the tag. */}}
\DoxyCodeLine{7692             \}}
\DoxyCodeLine{7693             pInit-\/>runningFilePos += headerSize;}
\DoxyCodeLine{7694         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7695             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7696         \}}
\DoxyCodeLine{7697     \}}
\DoxyCodeLine{7698 }
\DoxyCodeLine{7699     \textcolor{keywordflow}{if} (\textcolor{keywordtype}{id}[0] == \textcolor{charliteral}{'f'} \&\& \textcolor{keywordtype}{id}[1] == \textcolor{charliteral}{'L'} \&\& \textcolor{keywordtype}{id}[2] == \textcolor{charliteral}{'a'} \&\& \textcolor{keywordtype}{id}[3] == \textcolor{charliteral}{'C'}) \{}
\DoxyCodeLine{7700         \textcolor{keywordflow}{return} drflac\_\_init\_private\_\_native(pInit, onRead, onSeek, onMeta, pUserData, pUserDataMD, relaxed);}
\DoxyCodeLine{7701     \}}
\DoxyCodeLine{7702 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7703     \textcolor{keywordflow}{if} (\textcolor{keywordtype}{id}[0] == \textcolor{charliteral}{'O'} \&\& \textcolor{keywordtype}{id}[1] == \textcolor{charliteral}{'g'} \&\& \textcolor{keywordtype}{id}[2] == \textcolor{charliteral}{'g'} \&\& \textcolor{keywordtype}{id}[3] == \textcolor{charliteral}{'S'}) \{}
\DoxyCodeLine{7704         \textcolor{keywordflow}{return} drflac\_\_init\_private\_\_ogg(pInit, onRead, onSeek, onMeta, pUserData, pUserDataMD, relaxed);}
\DoxyCodeLine{7705     \}}
\DoxyCodeLine{7706 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7707 }
\DoxyCodeLine{7708     \textcolor{comment}{/* If we get here it means we likely don't have a header. Try opening in relaxed mode, if applicable. */}}
\DoxyCodeLine{7709     \textcolor{keywordflow}{if} (relaxed) \{}
\DoxyCodeLine{7710         \textcolor{keywordflow}{if} (container == drflac\_container\_native) \{}
\DoxyCodeLine{7711             \textcolor{keywordflow}{return} drflac\_\_init\_private\_\_native(pInit, onRead, onSeek, onMeta, pUserData, pUserDataMD, relaxed);}
\DoxyCodeLine{7712         \}}
\DoxyCodeLine{7713 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7714         \textcolor{keywordflow}{if} (container == drflac\_container\_ogg) \{}
\DoxyCodeLine{7715             \textcolor{keywordflow}{return} drflac\_\_init\_private\_\_ogg(pInit, onRead, onSeek, onMeta, pUserData, pUserDataMD, relaxed);}
\DoxyCodeLine{7716         \}}
\DoxyCodeLine{7717 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7718     \}}
\DoxyCodeLine{7719 }
\DoxyCodeLine{7720     \textcolor{comment}{/* Unsupported container. */}}
\DoxyCodeLine{7721     \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{7722 \}}
\DoxyCodeLine{7723 }
\DoxyCodeLine{7724 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drflac\_\_init\_from\_info(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, \textcolor{keyword}{const} drflac\_init\_info* pInit)}
\DoxyCodeLine{7725 \{}
\DoxyCodeLine{7726     DRFLAC\_ASSERT(pFlac != NULL);}
\DoxyCodeLine{7727     DRFLAC\_ASSERT(pInit != NULL);}
\DoxyCodeLine{7728 }
\DoxyCodeLine{7729     DRFLAC\_ZERO\_MEMORY(pFlac, \textcolor{keyword}{sizeof}(*pFlac));}
\DoxyCodeLine{7730     pFlac-\/>bs                      = pInit-\/>bs;}
\DoxyCodeLine{7731     pFlac-\/>onMeta                  = pInit-\/>onMeta;}
\DoxyCodeLine{7732     pFlac-\/>pUserDataMD             = pInit-\/>pUserDataMD;}
\DoxyCodeLine{7733     pFlac-\/>maxBlockSizeInPCMFrames = pInit-\/>maxBlockSizeInPCMFrames;}
\DoxyCodeLine{7734     pFlac-\/>sampleRate              = pInit-\/>sampleRate;}
\DoxyCodeLine{7735     pFlac-\/>channels                = (drflac\_uint8)pInit-\/>channels;}
\DoxyCodeLine{7736     pFlac-\/>bitsPerSample           = (drflac\_uint8)pInit-\/>bitsPerSample;}
\DoxyCodeLine{7737     pFlac-\/>totalPCMFrameCount      = pInit-\/>totalPCMFrameCount;}
\DoxyCodeLine{7738     pFlac-\/>container               = pInit-\/>container;}
\DoxyCodeLine{7739 \}}
\DoxyCodeLine{7740 }
\DoxyCodeLine{7741 }
\DoxyCodeLine{7742 \textcolor{keyword}{static} \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_with\_metadata\_private(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pUserDataMD, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{7743 \{}
\DoxyCodeLine{7744     drflac\_init\_info init;}
\DoxyCodeLine{7745     drflac\_uint32 allocationSize;}
\DoxyCodeLine{7746     drflac\_uint32 wholeSIMDVectorCountPerChannel;}
\DoxyCodeLine{7747     drflac\_uint32 decodedSamplesAllocationSize;}
\DoxyCodeLine{7748 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7749     drflac\_oggbs oggbs;}
\DoxyCodeLine{7750 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7751     drflac\_uint64 firstFramePos;}
\DoxyCodeLine{7752     drflac\_uint64 seektablePos;}
\DoxyCodeLine{7753     drflac\_uint32 seektableSize;}
\DoxyCodeLine{7754     \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}} allocationCallbacks;}
\DoxyCodeLine{7755     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{7756 }
\DoxyCodeLine{7757     \textcolor{comment}{/* CPU support first. */}}
\DoxyCodeLine{7758     drflac\_\_init\_cpu\_caps();}
\DoxyCodeLine{7759 }
\DoxyCodeLine{7760     \textcolor{keywordflow}{if} (!drflac\_\_init\_private(\&init, onRead, onSeek, onMeta, container, pUserData, pUserDataMD)) \{}
\DoxyCodeLine{7761         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7762     \}}
\DoxyCodeLine{7763 }
\DoxyCodeLine{7764     \textcolor{keywordflow}{if} (pAllocationCallbacks != NULL) \{}
\DoxyCodeLine{7765         allocationCallbacks = *pAllocationCallbacks;}
\DoxyCodeLine{7766         \textcolor{keywordflow}{if} (allocationCallbacks.onFree == NULL || (allocationCallbacks.onMalloc == NULL \&\& allocationCallbacks.onRealloc == NULL)) \{}
\DoxyCodeLine{7767             \textcolor{keywordflow}{return} NULL;    \textcolor{comment}{/* Invalid allocation callbacks. */}}
\DoxyCodeLine{7768         \}}
\DoxyCodeLine{7769     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7770         allocationCallbacks.pUserData = NULL;}
\DoxyCodeLine{7771         allocationCallbacks.onMalloc  = drflac\_\_malloc\_default;}
\DoxyCodeLine{7772         allocationCallbacks.onRealloc = drflac\_\_realloc\_default;}
\DoxyCodeLine{7773         allocationCallbacks.onFree    = drflac\_\_free\_default;}
\DoxyCodeLine{7774     \}}
\DoxyCodeLine{7775 }
\DoxyCodeLine{7776 }
\DoxyCodeLine{7777     \textcolor{comment}{/*}}
\DoxyCodeLine{7778 \textcolor{comment}{    The size of the allocation for the drflac object needs to be large enough to fit the following:}}
\DoxyCodeLine{7779 \textcolor{comment}{      1) The main members of the drflac structure}}
\DoxyCodeLine{7780 \textcolor{comment}{      2) A block of memory large enough to store the decoded samples of the largest frame in the stream}}
\DoxyCodeLine{7781 \textcolor{comment}{      3) If the container is Ogg, a drflac\_oggbs object}}
\DoxyCodeLine{7782 \textcolor{comment}{}}
\DoxyCodeLine{7783 \textcolor{comment}{    The complicated part of the allocation is making sure there's enough room the decoded samples, taking into consideration}}
\DoxyCodeLine{7784 \textcolor{comment}{    the different SIMD instruction sets.}}
\DoxyCodeLine{7785 \textcolor{comment}{    */}}
\DoxyCodeLine{7786     allocationSize = \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrflac}{drflac}});}
\DoxyCodeLine{7787 }
\DoxyCodeLine{7788     \textcolor{comment}{/*}}
\DoxyCodeLine{7789 \textcolor{comment}{    The allocation size for decoded frames depends on the number of 32-\/bit integers that fit inside the largest SIMD vector}}
\DoxyCodeLine{7790 \textcolor{comment}{    we are supporting.}}
\DoxyCodeLine{7791 \textcolor{comment}{    */}}
\DoxyCodeLine{7792     \textcolor{keywordflow}{if} ((init.maxBlockSizeInPCMFrames \% (DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE / \textcolor{keyword}{sizeof}(drflac\_int32))) == 0) \{}
\DoxyCodeLine{7793         wholeSIMDVectorCountPerChannel = (init.maxBlockSizeInPCMFrames / (DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE / \textcolor{keyword}{sizeof}(drflac\_int32)));}
\DoxyCodeLine{7794     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7795         wholeSIMDVectorCountPerChannel = (init.maxBlockSizeInPCMFrames / (DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE / \textcolor{keyword}{sizeof}(drflac\_int32))) + 1;}
\DoxyCodeLine{7796     \}}
\DoxyCodeLine{7797 }
\DoxyCodeLine{7798     decodedSamplesAllocationSize = wholeSIMDVectorCountPerChannel * DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE * init.channels;}
\DoxyCodeLine{7799 }
\DoxyCodeLine{7800     allocationSize += decodedSamplesAllocationSize;}
\DoxyCodeLine{7801     allocationSize += DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE;  \textcolor{comment}{/* Allocate extra bytes to ensure we have enough for alignment. */}}
\DoxyCodeLine{7802 }
\DoxyCodeLine{7803 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7804     \textcolor{comment}{/* There's additional data required for Ogg streams. */}}
\DoxyCodeLine{7805     \textcolor{keywordflow}{if} (init.container == drflac\_container\_ogg) \{}
\DoxyCodeLine{7806         allocationSize += \textcolor{keyword}{sizeof}(drflac\_oggbs);}
\DoxyCodeLine{7807     \}}
\DoxyCodeLine{7808 }
\DoxyCodeLine{7809     DRFLAC\_ZERO\_MEMORY(\&oggbs, \textcolor{keyword}{sizeof}(oggbs));}
\DoxyCodeLine{7810     \textcolor{keywordflow}{if} (init.container == drflac\_container\_ogg) \{}
\DoxyCodeLine{7811         oggbs.onRead = onRead;}
\DoxyCodeLine{7812         oggbs.onSeek = onSeek;}
\DoxyCodeLine{7813         oggbs.pUserData = pUserData;}
\DoxyCodeLine{7814         oggbs.currentBytePos = init.oggFirstBytePos;}
\DoxyCodeLine{7815         oggbs.firstBytePos = init.oggFirstBytePos;}
\DoxyCodeLine{7816         oggbs.serialNumber = init.oggSerial;}
\DoxyCodeLine{7817         oggbs.bosPageHeader = init.oggBosHeader;}
\DoxyCodeLine{7818         oggbs.bytesRemainingInPage = 0;}
\DoxyCodeLine{7819     \}}
\DoxyCodeLine{7820 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7821 }
\DoxyCodeLine{7822     \textcolor{comment}{/*}}
\DoxyCodeLine{7823 \textcolor{comment}{    This part is a bit awkward. We need to load the seektable so that it can be referenced in-\/memory, but I want the drflac object to}}
\DoxyCodeLine{7824 \textcolor{comment}{    consist of only a single heap allocation. To this, the size of the seek table needs to be known, which we determine when reading}}
\DoxyCodeLine{7825 \textcolor{comment}{    and decoding the metadata.}}
\DoxyCodeLine{7826 \textcolor{comment}{    */}}
\DoxyCodeLine{7827     firstFramePos = 42;   \textcolor{comment}{/* <-\/-\/ We know we are at byte 42 at this point. */}}
\DoxyCodeLine{7828     seektablePos  = 0;}
\DoxyCodeLine{7829     seektableSize = 0;}
\DoxyCodeLine{7830     \textcolor{keywordflow}{if} (init.hasMetadataBlocks) \{}
\DoxyCodeLine{7831         drflac\_read\_proc onReadOverride = onRead;}
\DoxyCodeLine{7832         drflac\_seek\_proc onSeekOverride = onSeek;}
\DoxyCodeLine{7833         \textcolor{keywordtype}{void}* pUserDataOverride = pUserData;}
\DoxyCodeLine{7834 }
\DoxyCodeLine{7835 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7836         \textcolor{keywordflow}{if} (init.container == drflac\_container\_ogg) \{}
\DoxyCodeLine{7837             onReadOverride = drflac\_\_on\_read\_ogg;}
\DoxyCodeLine{7838             onSeekOverride = drflac\_\_on\_seek\_ogg;}
\DoxyCodeLine{7839             pUserDataOverride = (\textcolor{keywordtype}{void}*)\&oggbs;}
\DoxyCodeLine{7840         \}}
\DoxyCodeLine{7841 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7842 }
\DoxyCodeLine{7843         \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_metadata(onReadOverride, onSeekOverride, onMeta, pUserDataOverride, pUserDataMD, \&firstFramePos, \&seektablePos, \&seektableSize, \&allocationCallbacks)) \{}
\DoxyCodeLine{7844             \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7845         \}}
\DoxyCodeLine{7846 }
\DoxyCodeLine{7847         allocationSize += seektableSize;}
\DoxyCodeLine{7848     \}}
\DoxyCodeLine{7849 }
\DoxyCodeLine{7850 }
\DoxyCodeLine{7851     pFlac = (\mbox{\hyperlink{structdrflac}{drflac}}*)drflac\_\_malloc\_from\_callbacks(allocationSize, \&allocationCallbacks);}
\DoxyCodeLine{7852     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{7853         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7854     \}}
\DoxyCodeLine{7855 }
\DoxyCodeLine{7856     drflac\_\_init\_from\_info(pFlac, \&init);}
\DoxyCodeLine{7857     pFlac-\/>allocationCallbacks = allocationCallbacks;}
\DoxyCodeLine{7858     pFlac-\/>pDecodedSamples = (drflac\_int32*)drflac\_align((\textcolor{keywordtype}{size\_t})pFlac-\/>pExtraData, DRFLAC\_MAX\_SIMD\_VECTOR\_SIZE);}
\DoxyCodeLine{7859 }
\DoxyCodeLine{7860 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7861     \textcolor{keywordflow}{if} (init.container == drflac\_container\_ogg) \{}
\DoxyCodeLine{7862         drflac\_oggbs* pInternalOggbs = (drflac\_oggbs*)((drflac\_uint8*)pFlac-\/>pDecodedSamples + decodedSamplesAllocationSize + seektableSize);}
\DoxyCodeLine{7863         *pInternalOggbs = oggbs;}
\DoxyCodeLine{7864 }
\DoxyCodeLine{7865         \textcolor{comment}{/* The Ogg bistream needs to be layered on top of the original bitstream. */}}
\DoxyCodeLine{7866         pFlac-\/>bs.onRead = drflac\_\_on\_read\_ogg;}
\DoxyCodeLine{7867         pFlac-\/>bs.onSeek = drflac\_\_on\_seek\_ogg;}
\DoxyCodeLine{7868         pFlac-\/>bs.pUserData = (\textcolor{keywordtype}{void}*)pInternalOggbs;}
\DoxyCodeLine{7869         pFlac-\/>\_oggbs = (\textcolor{keywordtype}{void}*)pInternalOggbs;}
\DoxyCodeLine{7870     \}}
\DoxyCodeLine{7871 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7872 }
\DoxyCodeLine{7873     pFlac-\/>firstFLACFramePosInBytes = firstFramePos;}
\DoxyCodeLine{7874 }
\DoxyCodeLine{7875     \textcolor{comment}{/* NOTE: Seektables are not currently compatible with Ogg encapsulation (Ogg has its own accelerated seeking system). I may change this later, so I'm leaving this here for now. */}}
\DoxyCodeLine{7876 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{7877     \textcolor{keywordflow}{if} (init.container == drflac\_container\_ogg)}
\DoxyCodeLine{7878     \{}
\DoxyCodeLine{7879         pFlac-\/>pSeekpoints = NULL;}
\DoxyCodeLine{7880         pFlac-\/>seekpointCount = 0;}
\DoxyCodeLine{7881     \}}
\DoxyCodeLine{7882     \textcolor{keywordflow}{else}}
\DoxyCodeLine{7883 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7884     \{}
\DoxyCodeLine{7885         \textcolor{comment}{/* If we have a seektable we need to load it now, making sure we move back to where we were previously. */}}
\DoxyCodeLine{7886         \textcolor{keywordflow}{if} (seektablePos != 0) \{}
\DoxyCodeLine{7887             pFlac-\/>seekpointCount = seektableSize / \textcolor{keyword}{sizeof}(*pFlac-\/>pSeekpoints);}
\DoxyCodeLine{7888             pFlac-\/>pSeekpoints = (\mbox{\hyperlink{structdrflac__seekpoint}{drflac\_seekpoint}}*)((drflac\_uint8*)pFlac-\/>pDecodedSamples + decodedSamplesAllocationSize);}
\DoxyCodeLine{7889 }
\DoxyCodeLine{7890             DRFLAC\_ASSERT(pFlac-\/>bs.onSeek != NULL);}
\DoxyCodeLine{7891             DRFLAC\_ASSERT(pFlac-\/>bs.onRead != NULL);}
\DoxyCodeLine{7892 }
\DoxyCodeLine{7893             \textcolor{comment}{/* Seek to the seektable, then just read directly into our seektable buffer. */}}
\DoxyCodeLine{7894             \textcolor{keywordflow}{if} (pFlac-\/>bs.onSeek(pFlac-\/>bs.pUserData, (\textcolor{keywordtype}{int})seektablePos, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7895                 \textcolor{keywordflow}{if} (pFlac-\/>bs.onRead(pFlac-\/>bs.pUserData, pFlac-\/>pSeekpoints, seektableSize) == seektableSize) \{}
\DoxyCodeLine{7896                     \textcolor{comment}{/* Endian swap. */}}
\DoxyCodeLine{7897                     drflac\_uint32 iSeekpoint;}
\DoxyCodeLine{7898                     \textcolor{keywordflow}{for} (iSeekpoint = 0; iSeekpoint < pFlac-\/>seekpointCount; ++iSeekpoint) \{}
\DoxyCodeLine{7899                         pFlac-\/>pSeekpoints[iSeekpoint].firstPCMFrame   = drflac\_\_be2host\_64(pFlac-\/>pSeekpoints[iSeekpoint].firstPCMFrame);}
\DoxyCodeLine{7900                         pFlac-\/>pSeekpoints[iSeekpoint].flacFrameOffset = drflac\_\_be2host\_64(pFlac-\/>pSeekpoints[iSeekpoint].flacFrameOffset);}
\DoxyCodeLine{7901                         pFlac-\/>pSeekpoints[iSeekpoint].pcmFrameCount   = drflac\_\_be2host\_16(pFlac-\/>pSeekpoints[iSeekpoint].pcmFrameCount);}
\DoxyCodeLine{7902                     \}}
\DoxyCodeLine{7903                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7904                     \textcolor{comment}{/* Failed to read the seektable. Pretend we don't have one. */}}
\DoxyCodeLine{7905                     pFlac-\/>pSeekpoints = NULL;}
\DoxyCodeLine{7906                     pFlac-\/>seekpointCount = 0;}
\DoxyCodeLine{7907                 \}}
\DoxyCodeLine{7908 }
\DoxyCodeLine{7909                 \textcolor{comment}{/* We need to seek back to where we were. If this fails it's a critical error. */}}
\DoxyCodeLine{7910                 \textcolor{keywordflow}{if} (!pFlac-\/>bs.onSeek(pFlac-\/>bs.pUserData, (\textcolor{keywordtype}{int})pFlac-\/>firstFLACFramePosInBytes, drflac\_seek\_origin\_start)) \{}
\DoxyCodeLine{7911                     drflac\_\_free\_from\_callbacks(pFlac, \&allocationCallbacks);}
\DoxyCodeLine{7912                     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7913                 \}}
\DoxyCodeLine{7914             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7915                 \textcolor{comment}{/* Failed to seek to the seektable. Ominous sign, but for now we can just pretend we don't have one. */}}
\DoxyCodeLine{7916                 pFlac-\/>pSeekpoints = NULL;}
\DoxyCodeLine{7917                 pFlac-\/>seekpointCount = 0;}
\DoxyCodeLine{7918             \}}
\DoxyCodeLine{7919         \}}
\DoxyCodeLine{7920     \}}
\DoxyCodeLine{7921 }
\DoxyCodeLine{7922 }
\DoxyCodeLine{7923     \textcolor{comment}{/*}}
\DoxyCodeLine{7924 \textcolor{comment}{    If we get here, but don't have a STREAMINFO block, it means we've opened the stream in relaxed mode and need to decode}}
\DoxyCodeLine{7925 \textcolor{comment}{    the first frame.}}
\DoxyCodeLine{7926 \textcolor{comment}{    */}}
\DoxyCodeLine{7927     \textcolor{keywordflow}{if} (!init.hasStreamInfoBlock) \{}
\DoxyCodeLine{7928         pFlac-\/>currentFLACFrame.header = init.firstFrameHeader;}
\DoxyCodeLine{7929         \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7930             drflac\_result result = drflac\_\_decode\_flac\_frame(pFlac);}
\DoxyCodeLine{7931             \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{7932                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{7933             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7934                 \textcolor{keywordflow}{if} (result == DRFLAC\_CRC\_MISMATCH) \{}
\DoxyCodeLine{7935                     \textcolor{keywordflow}{if} (!drflac\_\_read\_next\_flac\_frame\_header(\&pFlac-\/>bs, pFlac-\/>bitsPerSample, \&pFlac-\/>currentFLACFrame.header)) \{}
\DoxyCodeLine{7936                         drflac\_\_free\_from\_callbacks(pFlac, \&allocationCallbacks);}
\DoxyCodeLine{7937                         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7938                     \}}
\DoxyCodeLine{7939                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{7940                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7941                     drflac\_\_free\_from\_callbacks(pFlac, \&allocationCallbacks);}
\DoxyCodeLine{7942                     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{7943                 \}}
\DoxyCodeLine{7944             \}}
\DoxyCodeLine{7945         \}}
\DoxyCodeLine{7946     \}}
\DoxyCodeLine{7947 }
\DoxyCodeLine{7948     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{7949 \}}
\DoxyCodeLine{7950 }
\DoxyCodeLine{7951 }
\DoxyCodeLine{7952 }
\DoxyCodeLine{7953 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{7954 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{7955 \textcolor{preprocessor}{\#include <wchar.h>}      \textcolor{comment}{/* For wcslen(), wcsrtombs() */}}
\DoxyCodeLine{7956 }
\DoxyCodeLine{7957 \textcolor{comment}{/* drflac\_result\_from\_errno() is only used for fopen() and wfopen() so putting it inside DR\_WAV\_NO\_STDIO for now. If something else needs this later we can move it out. */}}
\DoxyCodeLine{7958 \textcolor{preprocessor}{\#include <errno.h>}}
\DoxyCodeLine{7959 \textcolor{keyword}{static} drflac\_result drflac\_result\_from\_errno(\textcolor{keywordtype}{int} e)}
\DoxyCodeLine{7960 \{}
\DoxyCodeLine{7961     \textcolor{keywordflow}{switch} (e)}
\DoxyCodeLine{7962     \{}
\DoxyCodeLine{7963         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{7964 \textcolor{preprocessor}{    \#ifdef EPERM}}
\DoxyCodeLine{7965         \textcolor{keywordflow}{case} EPERM: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_OPERATION;}
\DoxyCodeLine{7966 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7967 \textcolor{preprocessor}{    \#ifdef ENOENT}}
\DoxyCodeLine{7968         \textcolor{keywordflow}{case} ENOENT: \textcolor{keywordflow}{return} DRFLAC\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{7969 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7970 \textcolor{preprocessor}{    \#ifdef ESRCH}}
\DoxyCodeLine{7971         \textcolor{keywordflow}{case} ESRCH: \textcolor{keywordflow}{return} DRFLAC\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{7972 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7973 \textcolor{preprocessor}{    \#ifdef EINTR}}
\DoxyCodeLine{7974         \textcolor{keywordflow}{case} EINTR: \textcolor{keywordflow}{return} DRFLAC\_INTERRUPT;}
\DoxyCodeLine{7975 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7976 \textcolor{preprocessor}{    \#ifdef EIO}}
\DoxyCodeLine{7977         \textcolor{keywordflow}{case} EIO: \textcolor{keywordflow}{return} DRFLAC\_IO\_ERROR;}
\DoxyCodeLine{7978 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7979 \textcolor{preprocessor}{    \#ifdef ENXIO}}
\DoxyCodeLine{7980         \textcolor{keywordflow}{case} ENXIO: \textcolor{keywordflow}{return} DRFLAC\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{7981 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7982 \textcolor{preprocessor}{    \#ifdef E2BIG}}
\DoxyCodeLine{7983         \textcolor{keywordflow}{case} E2BIG: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_ARGS;}
\DoxyCodeLine{7984 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7985 \textcolor{preprocessor}{    \#ifdef ENOEXEC}}
\DoxyCodeLine{7986         \textcolor{keywordflow}{case} ENOEXEC: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{7987 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7988 \textcolor{preprocessor}{    \#ifdef EBADF}}
\DoxyCodeLine{7989         \textcolor{keywordflow}{case} EBADF: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{7990 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7991 \textcolor{preprocessor}{    \#ifdef ECHILD}}
\DoxyCodeLine{7992         \textcolor{keywordflow}{case} ECHILD: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{7993 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7994 \textcolor{preprocessor}{    \#ifdef EAGAIN}}
\DoxyCodeLine{7995         \textcolor{keywordflow}{case} EAGAIN: \textcolor{keywordflow}{return} DRFLAC\_UNAVAILABLE;}
\DoxyCodeLine{7996 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{7997 \textcolor{preprocessor}{    \#ifdef ENOMEM}}
\DoxyCodeLine{7998         \textcolor{keywordflow}{case} ENOMEM: \textcolor{keywordflow}{return} DRFLAC\_OUT\_OF\_MEMORY;}
\DoxyCodeLine{7999 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8000 \textcolor{preprocessor}{    \#ifdef EACCES}}
\DoxyCodeLine{8001         \textcolor{keywordflow}{case} EACCES: \textcolor{keywordflow}{return} DRFLAC\_ACCESS\_DENIED;}
\DoxyCodeLine{8002 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8003 \textcolor{preprocessor}{    \#ifdef EFAULT}}
\DoxyCodeLine{8004         \textcolor{keywordflow}{case} EFAULT: \textcolor{keywordflow}{return} DRFLAC\_BAD\_ADDRESS;}
\DoxyCodeLine{8005 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8006 \textcolor{preprocessor}{    \#ifdef ENOTBLK}}
\DoxyCodeLine{8007         \textcolor{keywordflow}{case} ENOTBLK: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8008 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8009 \textcolor{preprocessor}{    \#ifdef EBUSY}}
\DoxyCodeLine{8010         \textcolor{keywordflow}{case} EBUSY: \textcolor{keywordflow}{return} DRFLAC\_BUSY;}
\DoxyCodeLine{8011 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8012 \textcolor{preprocessor}{    \#ifdef EEXIST}}
\DoxyCodeLine{8013         \textcolor{keywordflow}{case} EEXIST: \textcolor{keywordflow}{return} DRFLAC\_ALREADY\_EXISTS;}
\DoxyCodeLine{8014 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8015 \textcolor{preprocessor}{    \#ifdef EXDEV}}
\DoxyCodeLine{8016         \textcolor{keywordflow}{case} EXDEV: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8017 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8018 \textcolor{preprocessor}{    \#ifdef ENODEV}}
\DoxyCodeLine{8019         \textcolor{keywordflow}{case} ENODEV: \textcolor{keywordflow}{return} DRFLAC\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{8020 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8021 \textcolor{preprocessor}{    \#ifdef ENOTDIR}}
\DoxyCodeLine{8022         \textcolor{keywordflow}{case} ENOTDIR: \textcolor{keywordflow}{return} DRFLAC\_NOT\_DIRECTORY;}
\DoxyCodeLine{8023 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8024 \textcolor{preprocessor}{    \#ifdef EISDIR}}
\DoxyCodeLine{8025         \textcolor{keywordflow}{case} EISDIR: \textcolor{keywordflow}{return} DRFLAC\_IS\_DIRECTORY;}
\DoxyCodeLine{8026 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8027 \textcolor{preprocessor}{    \#ifdef EINVAL}}
\DoxyCodeLine{8028         \textcolor{keywordflow}{case} EINVAL: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_ARGS;}
\DoxyCodeLine{8029 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8030 \textcolor{preprocessor}{    \#ifdef ENFILE}}
\DoxyCodeLine{8031         \textcolor{keywordflow}{case} ENFILE: \textcolor{keywordflow}{return} DRFLAC\_TOO\_MANY\_OPEN\_FILES;}
\DoxyCodeLine{8032 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8033 \textcolor{preprocessor}{    \#ifdef EMFILE}}
\DoxyCodeLine{8034         \textcolor{keywordflow}{case} EMFILE: \textcolor{keywordflow}{return} DRFLAC\_TOO\_MANY\_OPEN\_FILES;}
\DoxyCodeLine{8035 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8036 \textcolor{preprocessor}{    \#ifdef ENOTTY}}
\DoxyCodeLine{8037         \textcolor{keywordflow}{case} ENOTTY: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_OPERATION;}
\DoxyCodeLine{8038 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8039 \textcolor{preprocessor}{    \#ifdef ETXTBSY}}
\DoxyCodeLine{8040         \textcolor{keywordflow}{case} ETXTBSY: \textcolor{keywordflow}{return} DRFLAC\_BUSY;}
\DoxyCodeLine{8041 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8042 \textcolor{preprocessor}{    \#ifdef EFBIG}}
\DoxyCodeLine{8043         \textcolor{keywordflow}{case} EFBIG: \textcolor{keywordflow}{return} DRFLAC\_TOO\_BIG;}
\DoxyCodeLine{8044 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8045 \textcolor{preprocessor}{    \#ifdef ENOSPC}}
\DoxyCodeLine{8046         \textcolor{keywordflow}{case} ENOSPC: \textcolor{keywordflow}{return} DRFLAC\_NO\_SPACE;}
\DoxyCodeLine{8047 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8048 \textcolor{preprocessor}{    \#ifdef ESPIPE}}
\DoxyCodeLine{8049         \textcolor{keywordflow}{case} ESPIPE: \textcolor{keywordflow}{return} DRFLAC\_BAD\_SEEK;}
\DoxyCodeLine{8050 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8051 \textcolor{preprocessor}{    \#ifdef EROFS}}
\DoxyCodeLine{8052         \textcolor{keywordflow}{case} EROFS: \textcolor{keywordflow}{return} DRFLAC\_ACCESS\_DENIED;}
\DoxyCodeLine{8053 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8054 \textcolor{preprocessor}{    \#ifdef EMLINK}}
\DoxyCodeLine{8055         \textcolor{keywordflow}{case} EMLINK: \textcolor{keywordflow}{return} DRFLAC\_TOO\_MANY\_LINKS;}
\DoxyCodeLine{8056 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8057 \textcolor{preprocessor}{    \#ifdef EPIPE}}
\DoxyCodeLine{8058         \textcolor{keywordflow}{case} EPIPE: \textcolor{keywordflow}{return} DRFLAC\_BAD\_PIPE;}
\DoxyCodeLine{8059 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8060 \textcolor{preprocessor}{    \#ifdef EDOM}}
\DoxyCodeLine{8061         \textcolor{keywordflow}{case} EDOM: \textcolor{keywordflow}{return} DRFLAC\_OUT\_OF\_RANGE;}
\DoxyCodeLine{8062 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8063 \textcolor{preprocessor}{    \#ifdef ERANGE}}
\DoxyCodeLine{8064         \textcolor{keywordflow}{case} ERANGE: \textcolor{keywordflow}{return} DRFLAC\_OUT\_OF\_RANGE;}
\DoxyCodeLine{8065 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8066 \textcolor{preprocessor}{    \#ifdef EDEADLK}}
\DoxyCodeLine{8067         \textcolor{keywordflow}{case} EDEADLK: \textcolor{keywordflow}{return} DRFLAC\_DEADLOCK;}
\DoxyCodeLine{8068 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8069 \textcolor{preprocessor}{    \#ifdef ENAMETOOLONG}}
\DoxyCodeLine{8070         \textcolor{keywordflow}{case} ENAMETOOLONG: \textcolor{keywordflow}{return} DRFLAC\_PATH\_TOO\_LONG;}
\DoxyCodeLine{8071 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8072 \textcolor{preprocessor}{    \#ifdef ENOLCK}}
\DoxyCodeLine{8073         \textcolor{keywordflow}{case} ENOLCK: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8074 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8075 \textcolor{preprocessor}{    \#ifdef ENOSYS}}
\DoxyCodeLine{8076         \textcolor{keywordflow}{case} ENOSYS: \textcolor{keywordflow}{return} DRFLAC\_NOT\_IMPLEMENTED;}
\DoxyCodeLine{8077 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8078 \textcolor{preprocessor}{    \#ifdef ENOTEMPTY}}
\DoxyCodeLine{8079         \textcolor{keywordflow}{case} ENOTEMPTY: \textcolor{keywordflow}{return} DRFLAC\_DIRECTORY\_NOT\_EMPTY;}
\DoxyCodeLine{8080 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8081 \textcolor{preprocessor}{    \#ifdef ELOOP}}
\DoxyCodeLine{8082         \textcolor{keywordflow}{case} ELOOP: \textcolor{keywordflow}{return} DRFLAC\_TOO\_MANY\_LINKS;}
\DoxyCodeLine{8083 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8084 \textcolor{preprocessor}{    \#ifdef ENOMSG}}
\DoxyCodeLine{8085         \textcolor{keywordflow}{case} ENOMSG: \textcolor{keywordflow}{return} DRFLAC\_NO\_MESSAGE;}
\DoxyCodeLine{8086 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8087 \textcolor{preprocessor}{    \#ifdef EIDRM}}
\DoxyCodeLine{8088         \textcolor{keywordflow}{case} EIDRM: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8089 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8090 \textcolor{preprocessor}{    \#ifdef ECHRNG}}
\DoxyCodeLine{8091         \textcolor{keywordflow}{case} ECHRNG: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8092 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8093 \textcolor{preprocessor}{    \#ifdef EL2NSYNC}}
\DoxyCodeLine{8094         \textcolor{keywordflow}{case} EL2NSYNC: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8095 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8096 \textcolor{preprocessor}{    \#ifdef EL3HLT}}
\DoxyCodeLine{8097         \textcolor{keywordflow}{case} EL3HLT: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8098 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8099 \textcolor{preprocessor}{    \#ifdef EL3RST}}
\DoxyCodeLine{8100         \textcolor{keywordflow}{case} EL3RST: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8101 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8102 \textcolor{preprocessor}{    \#ifdef ELNRNG}}
\DoxyCodeLine{8103         \textcolor{keywordflow}{case} ELNRNG: \textcolor{keywordflow}{return} DRFLAC\_OUT\_OF\_RANGE;}
\DoxyCodeLine{8104 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8105 \textcolor{preprocessor}{    \#ifdef EUNATCH}}
\DoxyCodeLine{8106         \textcolor{keywordflow}{case} EUNATCH: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8107 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8108 \textcolor{preprocessor}{    \#ifdef ENOCSI}}
\DoxyCodeLine{8109         \textcolor{keywordflow}{case} ENOCSI: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8110 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8111 \textcolor{preprocessor}{    \#ifdef EL2HLT}}
\DoxyCodeLine{8112         \textcolor{keywordflow}{case} EL2HLT: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8113 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8114 \textcolor{preprocessor}{    \#ifdef EBADE}}
\DoxyCodeLine{8115         \textcolor{keywordflow}{case} EBADE: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8116 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8117 \textcolor{preprocessor}{    \#ifdef EBADR}}
\DoxyCodeLine{8118         \textcolor{keywordflow}{case} EBADR: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8119 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8120 \textcolor{preprocessor}{    \#ifdef EXFULL}}
\DoxyCodeLine{8121         \textcolor{keywordflow}{case} EXFULL: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8122 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8123 \textcolor{preprocessor}{    \#ifdef ENOANO}}
\DoxyCodeLine{8124         \textcolor{keywordflow}{case} ENOANO: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8125 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8126 \textcolor{preprocessor}{    \#ifdef EBADRQC}}
\DoxyCodeLine{8127         \textcolor{keywordflow}{case} EBADRQC: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8128 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8129 \textcolor{preprocessor}{    \#ifdef EBADSLT}}
\DoxyCodeLine{8130         \textcolor{keywordflow}{case} EBADSLT: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8131 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8132 \textcolor{preprocessor}{    \#ifdef EBFONT}}
\DoxyCodeLine{8133         \textcolor{keywordflow}{case} EBFONT: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{8134 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8135 \textcolor{preprocessor}{    \#ifdef ENOSTR}}
\DoxyCodeLine{8136         \textcolor{keywordflow}{case} ENOSTR: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8137 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8138 \textcolor{preprocessor}{    \#ifdef ENODATA}}
\DoxyCodeLine{8139         \textcolor{keywordflow}{case} ENODATA: \textcolor{keywordflow}{return} DRFLAC\_NO\_DATA\_AVAILABLE;}
\DoxyCodeLine{8140 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8141 \textcolor{preprocessor}{    \#ifdef ETIME}}
\DoxyCodeLine{8142         \textcolor{keywordflow}{case} ETIME: \textcolor{keywordflow}{return} DRFLAC\_TIMEOUT;}
\DoxyCodeLine{8143 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8144 \textcolor{preprocessor}{    \#ifdef ENOSR}}
\DoxyCodeLine{8145         \textcolor{keywordflow}{case} ENOSR: \textcolor{keywordflow}{return} DRFLAC\_NO\_DATA\_AVAILABLE;}
\DoxyCodeLine{8146 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8147 \textcolor{preprocessor}{    \#ifdef ENONET}}
\DoxyCodeLine{8148         \textcolor{keywordflow}{case} ENONET: \textcolor{keywordflow}{return} DRFLAC\_NO\_NETWORK;}
\DoxyCodeLine{8149 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8150 \textcolor{preprocessor}{    \#ifdef ENOPKG}}
\DoxyCodeLine{8151         \textcolor{keywordflow}{case} ENOPKG: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8152 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8153 \textcolor{preprocessor}{    \#ifdef EREMOTE}}
\DoxyCodeLine{8154         \textcolor{keywordflow}{case} EREMOTE: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8155 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8156 \textcolor{preprocessor}{    \#ifdef ENOLINK}}
\DoxyCodeLine{8157         \textcolor{keywordflow}{case} ENOLINK: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8158 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8159 \textcolor{preprocessor}{    \#ifdef EADV}}
\DoxyCodeLine{8160         \textcolor{keywordflow}{case} EADV: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8161 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8162 \textcolor{preprocessor}{    \#ifdef ESRMNT}}
\DoxyCodeLine{8163         \textcolor{keywordflow}{case} ESRMNT: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8164 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8165 \textcolor{preprocessor}{    \#ifdef ECOMM}}
\DoxyCodeLine{8166         \textcolor{keywordflow}{case} ECOMM: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8167 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8168 \textcolor{preprocessor}{    \#ifdef EPROTO}}
\DoxyCodeLine{8169         \textcolor{keywordflow}{case} EPROTO: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8170 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8171 \textcolor{preprocessor}{    \#ifdef EMULTIHOP}}
\DoxyCodeLine{8172         \textcolor{keywordflow}{case} EMULTIHOP: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8173 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8174 \textcolor{preprocessor}{    \#ifdef EDOTDOT}}
\DoxyCodeLine{8175         \textcolor{keywordflow}{case} EDOTDOT: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8176 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8177 \textcolor{preprocessor}{    \#ifdef EBADMSG}}
\DoxyCodeLine{8178         \textcolor{keywordflow}{case} EBADMSG: \textcolor{keywordflow}{return} DRFLAC\_BAD\_MESSAGE;}
\DoxyCodeLine{8179 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8180 \textcolor{preprocessor}{    \#ifdef EOVERFLOW}}
\DoxyCodeLine{8181         \textcolor{keywordflow}{case} EOVERFLOW: \textcolor{keywordflow}{return} DRFLAC\_TOO\_BIG;}
\DoxyCodeLine{8182 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8183 \textcolor{preprocessor}{    \#ifdef ENOTUNIQ}}
\DoxyCodeLine{8184         \textcolor{keywordflow}{case} ENOTUNIQ: \textcolor{keywordflow}{return} DRFLAC\_NOT\_UNIQUE;}
\DoxyCodeLine{8185 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8186 \textcolor{preprocessor}{    \#ifdef EBADFD}}
\DoxyCodeLine{8187         \textcolor{keywordflow}{case} EBADFD: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8188 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8189 \textcolor{preprocessor}{    \#ifdef EREMCHG}}
\DoxyCodeLine{8190         \textcolor{keywordflow}{case} EREMCHG: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8191 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8192 \textcolor{preprocessor}{    \#ifdef ELIBACC}}
\DoxyCodeLine{8193         \textcolor{keywordflow}{case} ELIBACC: \textcolor{keywordflow}{return} DRFLAC\_ACCESS\_DENIED;}
\DoxyCodeLine{8194 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8195 \textcolor{preprocessor}{    \#ifdef ELIBBAD}}
\DoxyCodeLine{8196         \textcolor{keywordflow}{case} ELIBBAD: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{8197 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8198 \textcolor{preprocessor}{    \#ifdef ELIBSCN}}
\DoxyCodeLine{8199         \textcolor{keywordflow}{case} ELIBSCN: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{8200 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8201 \textcolor{preprocessor}{    \#ifdef ELIBMAX}}
\DoxyCodeLine{8202         \textcolor{keywordflow}{case} ELIBMAX: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8203 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8204 \textcolor{preprocessor}{    \#ifdef ELIBEXEC}}
\DoxyCodeLine{8205         \textcolor{keywordflow}{case} ELIBEXEC: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8206 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8207 \textcolor{preprocessor}{    \#ifdef EILSEQ}}
\DoxyCodeLine{8208         \textcolor{keywordflow}{case} EILSEQ: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_DATA;}
\DoxyCodeLine{8209 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8210 \textcolor{preprocessor}{    \#ifdef ERESTART}}
\DoxyCodeLine{8211         \textcolor{keywordflow}{case} ERESTART: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8212 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8213 \textcolor{preprocessor}{    \#ifdef ESTRPIPE}}
\DoxyCodeLine{8214         \textcolor{keywordflow}{case} ESTRPIPE: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8215 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8216 \textcolor{preprocessor}{    \#ifdef EUSERS}}
\DoxyCodeLine{8217         \textcolor{keywordflow}{case} EUSERS: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8218 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8219 \textcolor{preprocessor}{    \#ifdef ENOTSOCK}}
\DoxyCodeLine{8220         \textcolor{keywordflow}{case} ENOTSOCK: \textcolor{keywordflow}{return} DRFLAC\_NOT\_SOCKET;}
\DoxyCodeLine{8221 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8222 \textcolor{preprocessor}{    \#ifdef EDESTADDRREQ}}
\DoxyCodeLine{8223         \textcolor{keywordflow}{case} EDESTADDRREQ: \textcolor{keywordflow}{return} DRFLAC\_NO\_ADDRESS;}
\DoxyCodeLine{8224 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8225 \textcolor{preprocessor}{    \#ifdef EMSGSIZE}}
\DoxyCodeLine{8226         \textcolor{keywordflow}{case} EMSGSIZE: \textcolor{keywordflow}{return} DRFLAC\_TOO\_BIG;}
\DoxyCodeLine{8227 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8228 \textcolor{preprocessor}{    \#ifdef EPROTOTYPE}}
\DoxyCodeLine{8229         \textcolor{keywordflow}{case} EPROTOTYPE: \textcolor{keywordflow}{return} DRFLAC\_BAD\_PROTOCOL;}
\DoxyCodeLine{8230 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8231 \textcolor{preprocessor}{    \#ifdef ENOPROTOOPT}}
\DoxyCodeLine{8232         \textcolor{keywordflow}{case} ENOPROTOOPT: \textcolor{keywordflow}{return} DRFLAC\_PROTOCOL\_UNAVAILABLE;}
\DoxyCodeLine{8233 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8234 \textcolor{preprocessor}{    \#ifdef EPROTONOSUPPORT}}
\DoxyCodeLine{8235         \textcolor{keywordflow}{case} EPROTONOSUPPORT: \textcolor{keywordflow}{return} DRFLAC\_PROTOCOL\_NOT\_SUPPORTED;}
\DoxyCodeLine{8236 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8237 \textcolor{preprocessor}{    \#ifdef ESOCKTNOSUPPORT}}
\DoxyCodeLine{8238         \textcolor{keywordflow}{case} ESOCKTNOSUPPORT: \textcolor{keywordflow}{return} DRFLAC\_SOCKET\_NOT\_SUPPORTED;}
\DoxyCodeLine{8239 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8240 \textcolor{preprocessor}{    \#ifdef EOPNOTSUPP}}
\DoxyCodeLine{8241         \textcolor{keywordflow}{case} EOPNOTSUPP: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_OPERATION;}
\DoxyCodeLine{8242 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8243 \textcolor{preprocessor}{    \#ifdef EPFNOSUPPORT}}
\DoxyCodeLine{8244         \textcolor{keywordflow}{case} EPFNOSUPPORT: \textcolor{keywordflow}{return} DRFLAC\_PROTOCOL\_FAMILY\_NOT\_SUPPORTED;}
\DoxyCodeLine{8245 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8246 \textcolor{preprocessor}{    \#ifdef EAFNOSUPPORT}}
\DoxyCodeLine{8247         \textcolor{keywordflow}{case} EAFNOSUPPORT: \textcolor{keywordflow}{return} DRFLAC\_ADDRESS\_FAMILY\_NOT\_SUPPORTED;}
\DoxyCodeLine{8248 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8249 \textcolor{preprocessor}{    \#ifdef EADDRINUSE}}
\DoxyCodeLine{8250         \textcolor{keywordflow}{case} EADDRINUSE: \textcolor{keywordflow}{return} DRFLAC\_ALREADY\_IN\_USE;}
\DoxyCodeLine{8251 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8252 \textcolor{preprocessor}{    \#ifdef EADDRNOTAVAIL}}
\DoxyCodeLine{8253         \textcolor{keywordflow}{case} EADDRNOTAVAIL: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8254 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8255 \textcolor{preprocessor}{    \#ifdef ENETDOWN}}
\DoxyCodeLine{8256         \textcolor{keywordflow}{case} ENETDOWN: \textcolor{keywordflow}{return} DRFLAC\_NO\_NETWORK;}
\DoxyCodeLine{8257 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8258 \textcolor{preprocessor}{    \#ifdef ENETUNREACH}}
\DoxyCodeLine{8259         \textcolor{keywordflow}{case} ENETUNREACH: \textcolor{keywordflow}{return} DRFLAC\_NO\_NETWORK;}
\DoxyCodeLine{8260 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8261 \textcolor{preprocessor}{    \#ifdef ENETRESET}}
\DoxyCodeLine{8262         \textcolor{keywordflow}{case} ENETRESET: \textcolor{keywordflow}{return} DRFLAC\_NO\_NETWORK;}
\DoxyCodeLine{8263 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8264 \textcolor{preprocessor}{    \#ifdef ECONNABORTED}}
\DoxyCodeLine{8265         \textcolor{keywordflow}{case} ECONNABORTED: \textcolor{keywordflow}{return} DRFLAC\_NO\_NETWORK;}
\DoxyCodeLine{8266 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8267 \textcolor{preprocessor}{    \#ifdef ECONNRESET}}
\DoxyCodeLine{8268         \textcolor{keywordflow}{case} ECONNRESET: \textcolor{keywordflow}{return} DRFLAC\_CONNECTION\_RESET;}
\DoxyCodeLine{8269 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8270 \textcolor{preprocessor}{    \#ifdef ENOBUFS}}
\DoxyCodeLine{8271         \textcolor{keywordflow}{case} ENOBUFS: \textcolor{keywordflow}{return} DRFLAC\_NO\_SPACE;}
\DoxyCodeLine{8272 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8273 \textcolor{preprocessor}{    \#ifdef EISCONN}}
\DoxyCodeLine{8274         \textcolor{keywordflow}{case} EISCONN: \textcolor{keywordflow}{return} DRFLAC\_ALREADY\_CONNECTED;}
\DoxyCodeLine{8275 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8276 \textcolor{preprocessor}{    \#ifdef ENOTCONN}}
\DoxyCodeLine{8277         \textcolor{keywordflow}{case} ENOTCONN: \textcolor{keywordflow}{return} DRFLAC\_NOT\_CONNECTED;}
\DoxyCodeLine{8278 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8279 \textcolor{preprocessor}{    \#ifdef ESHUTDOWN}}
\DoxyCodeLine{8280         \textcolor{keywordflow}{case} ESHUTDOWN: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8281 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8282 \textcolor{preprocessor}{    \#ifdef ETOOMANYREFS}}
\DoxyCodeLine{8283         \textcolor{keywordflow}{case} ETOOMANYREFS: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8284 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8285 \textcolor{preprocessor}{    \#ifdef ETIMEDOUT}}
\DoxyCodeLine{8286         \textcolor{keywordflow}{case} ETIMEDOUT: \textcolor{keywordflow}{return} DRFLAC\_TIMEOUT;}
\DoxyCodeLine{8287 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8288 \textcolor{preprocessor}{    \#ifdef ECONNREFUSED}}
\DoxyCodeLine{8289         \textcolor{keywordflow}{case} ECONNREFUSED: \textcolor{keywordflow}{return} DRFLAC\_CONNECTION\_REFUSED;}
\DoxyCodeLine{8290 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8291 \textcolor{preprocessor}{    \#ifdef EHOSTDOWN}}
\DoxyCodeLine{8292         \textcolor{keywordflow}{case} EHOSTDOWN: \textcolor{keywordflow}{return} DRFLAC\_NO\_HOST;}
\DoxyCodeLine{8293 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8294 \textcolor{preprocessor}{    \#ifdef EHOSTUNREACH}}
\DoxyCodeLine{8295         \textcolor{keywordflow}{case} EHOSTUNREACH: \textcolor{keywordflow}{return} DRFLAC\_NO\_HOST;}
\DoxyCodeLine{8296 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8297 \textcolor{preprocessor}{    \#ifdef EALREADY}}
\DoxyCodeLine{8298         \textcolor{keywordflow}{case} EALREADY: \textcolor{keywordflow}{return} DRFLAC\_IN\_PROGRESS;}
\DoxyCodeLine{8299 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8300 \textcolor{preprocessor}{    \#ifdef EINPROGRESS}}
\DoxyCodeLine{8301         \textcolor{keywordflow}{case} EINPROGRESS: \textcolor{keywordflow}{return} DRFLAC\_IN\_PROGRESS;}
\DoxyCodeLine{8302 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8303 \textcolor{preprocessor}{    \#ifdef ESTALE}}
\DoxyCodeLine{8304         \textcolor{keywordflow}{case} ESTALE: \textcolor{keywordflow}{return} DRFLAC\_INVALID\_FILE;}
\DoxyCodeLine{8305 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8306 \textcolor{preprocessor}{    \#ifdef EUCLEAN}}
\DoxyCodeLine{8307         \textcolor{keywordflow}{case} EUCLEAN: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8308 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8309 \textcolor{preprocessor}{    \#ifdef ENOTNAM}}
\DoxyCodeLine{8310         \textcolor{keywordflow}{case} ENOTNAM: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8311 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8312 \textcolor{preprocessor}{    \#ifdef ENAVAIL}}
\DoxyCodeLine{8313         \textcolor{keywordflow}{case} ENAVAIL: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8314 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8315 \textcolor{preprocessor}{    \#ifdef EISNAM}}
\DoxyCodeLine{8316         \textcolor{keywordflow}{case} EISNAM: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8317 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8318 \textcolor{preprocessor}{    \#ifdef EREMOTEIO}}
\DoxyCodeLine{8319         \textcolor{keywordflow}{case} EREMOTEIO: \textcolor{keywordflow}{return} DRFLAC\_IO\_ERROR;}
\DoxyCodeLine{8320 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8321 \textcolor{preprocessor}{    \#ifdef EDQUOT}}
\DoxyCodeLine{8322         \textcolor{keywordflow}{case} EDQUOT: \textcolor{keywordflow}{return} DRFLAC\_NO\_SPACE;}
\DoxyCodeLine{8323 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8324 \textcolor{preprocessor}{    \#ifdef ENOMEDIUM}}
\DoxyCodeLine{8325         \textcolor{keywordflow}{case} ENOMEDIUM: \textcolor{keywordflow}{return} DRFLAC\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{8326 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8327 \textcolor{preprocessor}{    \#ifdef EMEDIUMTYPE}}
\DoxyCodeLine{8328         \textcolor{keywordflow}{case} EMEDIUMTYPE: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8329 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8330 \textcolor{preprocessor}{    \#ifdef ECANCELED}}
\DoxyCodeLine{8331         \textcolor{keywordflow}{case} ECANCELED: \textcolor{keywordflow}{return} DRFLAC\_CANCELLED;}
\DoxyCodeLine{8332 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8333 \textcolor{preprocessor}{    \#ifdef ENOKEY}}
\DoxyCodeLine{8334         \textcolor{keywordflow}{case} ENOKEY: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8335 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8336 \textcolor{preprocessor}{    \#ifdef EKEYEXPIRED}}
\DoxyCodeLine{8337         \textcolor{keywordflow}{case} EKEYEXPIRED: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8338 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8339 \textcolor{preprocessor}{    \#ifdef EKEYREVOKED}}
\DoxyCodeLine{8340         \textcolor{keywordflow}{case} EKEYREVOKED: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8341 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8342 \textcolor{preprocessor}{    \#ifdef EKEYREJECTED}}
\DoxyCodeLine{8343         \textcolor{keywordflow}{case} EKEYREJECTED: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8344 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8345 \textcolor{preprocessor}{    \#ifdef EOWNERDEAD}}
\DoxyCodeLine{8346         \textcolor{keywordflow}{case} EOWNERDEAD: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8347 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8348 \textcolor{preprocessor}{    \#ifdef ENOTRECOVERABLE}}
\DoxyCodeLine{8349         \textcolor{keywordflow}{case} ENOTRECOVERABLE: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8350 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8351 \textcolor{preprocessor}{    \#ifdef ERFKILL}}
\DoxyCodeLine{8352         \textcolor{keywordflow}{case} ERFKILL: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8353 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8354 \textcolor{preprocessor}{    \#ifdef EHWPOISON}}
\DoxyCodeLine{8355         \textcolor{keywordflow}{case} EHWPOISON: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8356 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8357         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8358     \}}
\DoxyCodeLine{8359 \}}
\DoxyCodeLine{8360 }
\DoxyCodeLine{8361 \textcolor{keyword}{static} drflac\_result drflac\_fopen(FILE** ppFile, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFilePath, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pOpenMode)}
\DoxyCodeLine{8362 \{}
\DoxyCodeLine{8363 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{8364     errno\_t err;}
\DoxyCodeLine{8365 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8366 }
\DoxyCodeLine{8367     \textcolor{keywordflow}{if} (ppFile != NULL) \{}
\DoxyCodeLine{8368         *ppFile = NULL;  \textcolor{comment}{/* Safety. */}}
\DoxyCodeLine{8369     \}}
\DoxyCodeLine{8370 }
\DoxyCodeLine{8371     \textcolor{keywordflow}{if} (pFilePath == NULL || pOpenMode == NULL || ppFile == NULL) \{}
\DoxyCodeLine{8372         \textcolor{keywordflow}{return} DRFLAC\_INVALID\_ARGS;}
\DoxyCodeLine{8373     \}}
\DoxyCodeLine{8374 }
\DoxyCodeLine{8375 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{8376     err = fopen\_s(ppFile, pFilePath, pOpenMode);}
\DoxyCodeLine{8377     \textcolor{keywordflow}{if} (err != 0) \{}
\DoxyCodeLine{8378         \textcolor{keywordflow}{return} drflac\_result\_from\_errno(err);}
\DoxyCodeLine{8379     \}}
\DoxyCodeLine{8380 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8381 \textcolor{preprocessor}{\#if defined(\_WIN32) || defined(\_\_APPLE\_\_)}}
\DoxyCodeLine{8382     *ppFile = fopen(pFilePath, pOpenMode);}
\DoxyCodeLine{8383 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8384 \textcolor{preprocessor}{    \#if defined(\_FILE\_OFFSET\_BITS) \&\& \_FILE\_OFFSET\_BITS == 64 \&\& defined(\_LARGEFILE64\_SOURCE)}}
\DoxyCodeLine{8385         *ppFile = fopen64(pFilePath, pOpenMode);}
\DoxyCodeLine{8386 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{8387         *ppFile = fopen(pFilePath, pOpenMode);}
\DoxyCodeLine{8388 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8389 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8390     \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{8391         drflac\_result result = drflac\_result\_from\_errno(errno);}
\DoxyCodeLine{8392         \textcolor{keywordflow}{if} (result == DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{8393             result = DRFLAC\_ERROR;   \textcolor{comment}{/* Just a safety check to make sure we never ever return success when pFile == NULL. */}}
\DoxyCodeLine{8394         \}}
\DoxyCodeLine{8395 }
\DoxyCodeLine{8396         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{8397     \}}
\DoxyCodeLine{8398 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8399 }
\DoxyCodeLine{8400     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{8401 \}}
\DoxyCodeLine{8402 }
\DoxyCodeLine{8403 \textcolor{comment}{/*}}
\DoxyCodeLine{8404 \textcolor{comment}{\_wfopen() isn't always available in all compilation environments.}}
\DoxyCodeLine{8405 \textcolor{comment}{}}
\DoxyCodeLine{8406 \textcolor{comment}{    * Windows only.}}
\DoxyCodeLine{8407 \textcolor{comment}{    * MSVC seems to support it universally as far back as VC6 from what I can tell (haven't checked further back).}}
\DoxyCodeLine{8408 \textcolor{comment}{    * MinGW-\/64 (both 32-\/ and 64-\/bit) seems to support it.}}
\DoxyCodeLine{8409 \textcolor{comment}{    * MinGW wraps it in !defined(\_\_STRICT\_ANSI\_\_).}}
\DoxyCodeLine{8410 \textcolor{comment}{    * OpenWatcom wraps it in !defined(\_NO\_EXT\_KEYS).}}
\DoxyCodeLine{8411 \textcolor{comment}{}}
\DoxyCodeLine{8412 \textcolor{comment}{This can be reviewed as compatibility issues arise. The preference is to use \_wfopen\_s() and \_wfopen() as opposed to the wcsrtombs()}}
\DoxyCodeLine{8413 \textcolor{comment}{fallback, so if you notice your compiler not detecting this properly I'm happy to look at adding support.}}
\DoxyCodeLine{8414 \textcolor{comment}{*/}}
\DoxyCodeLine{8415 \textcolor{preprocessor}{\#if defined(\_WIN32)}}
\DoxyCodeLine{8416 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) || defined(\_\_MINGW64\_\_) || (!defined(\_\_STRICT\_ANSI\_\_) \&\& !defined(\_NO\_EXT\_KEYS))}}
\DoxyCodeLine{8417 \textcolor{preprocessor}{        \#define DRFLAC\_HAS\_WFOPEN}}
\DoxyCodeLine{8418 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8419 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8420 }
\DoxyCodeLine{8421 \textcolor{keyword}{static} drflac\_result drflac\_wfopen(FILE** ppFile, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePath, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pOpenMode, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8422 \{}
\DoxyCodeLine{8423     \textcolor{keywordflow}{if} (ppFile != NULL) \{}
\DoxyCodeLine{8424         *ppFile = NULL;  \textcolor{comment}{/* Safety. */}}
\DoxyCodeLine{8425     \}}
\DoxyCodeLine{8426 }
\DoxyCodeLine{8427     \textcolor{keywordflow}{if} (pFilePath == NULL || pOpenMode == NULL || ppFile == NULL) \{}
\DoxyCodeLine{8428         \textcolor{keywordflow}{return} DRFLAC\_INVALID\_ARGS;}
\DoxyCodeLine{8429     \}}
\DoxyCodeLine{8430 }
\DoxyCodeLine{8431 \textcolor{preprocessor}{\#if defined(DRFLAC\_HAS\_WFOPEN)}}
\DoxyCodeLine{8432     \{}
\DoxyCodeLine{8433         \textcolor{comment}{/* Use \_wfopen() on Windows. */}}
\DoxyCodeLine{8434 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{8435         errno\_t err = \_wfopen\_s(ppFile, pFilePath, pOpenMode);}
\DoxyCodeLine{8436         \textcolor{keywordflow}{if} (err != 0) \{}
\DoxyCodeLine{8437             \textcolor{keywordflow}{return} drflac\_result\_from\_errno(err);}
\DoxyCodeLine{8438         \}}
\DoxyCodeLine{8439 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{8440         *ppFile = \_wfopen(pFilePath, pOpenMode);}
\DoxyCodeLine{8441         \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{8442             \textcolor{keywordflow}{return} drflac\_result\_from\_errno(errno);}
\DoxyCodeLine{8443         \}}
\DoxyCodeLine{8444 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{8445         (void)pAllocationCallbacks;}
\DoxyCodeLine{8446     \}}
\DoxyCodeLine{8447 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8448     \textcolor{comment}{/*}}
\DoxyCodeLine{8449 \textcolor{comment}{    Use fopen() on anything other than Windows. Requires a conversion. This is annoying because fopen() is locale specific. The only real way I can}}
\DoxyCodeLine{8450 \textcolor{comment}{    think of to do this is with wcsrtombs(). Note that wcstombs() is apparently not thread-\/safe because it uses a static global mbstate\_t object for}}
\DoxyCodeLine{8451 \textcolor{comment}{    maintaining state. I've checked this with -\/std=c89 and it works, but if somebody get's a compiler error I'll look into improving compatibility.}}
\DoxyCodeLine{8452 \textcolor{comment}{    */}}
\DoxyCodeLine{8453     \{}
\DoxyCodeLine{8454         mbstate\_t mbs;}
\DoxyCodeLine{8455         \textcolor{keywordtype}{size\_t} lenMB;}
\DoxyCodeLine{8456         \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePathTemp = pFilePath;}
\DoxyCodeLine{8457         \textcolor{keywordtype}{char}* pFilePathMB = NULL;}
\DoxyCodeLine{8458         \textcolor{keywordtype}{char} pOpenModeMB[32] = \{0\};}
\DoxyCodeLine{8459 }
\DoxyCodeLine{8460         \textcolor{comment}{/* Get the length first. */}}
\DoxyCodeLine{8461         DRFLAC\_ZERO\_OBJECT(\&mbs);}
\DoxyCodeLine{8462         lenMB = wcsrtombs(NULL, \&pFilePathTemp, 0, \&mbs);}
\DoxyCodeLine{8463         \textcolor{keywordflow}{if} (lenMB == (\textcolor{keywordtype}{size\_t})-\/1) \{}
\DoxyCodeLine{8464             \textcolor{keywordflow}{return} drflac\_result\_from\_errno(errno);}
\DoxyCodeLine{8465         \}}
\DoxyCodeLine{8466 }
\DoxyCodeLine{8467         pFilePathMB = (\textcolor{keywordtype}{char}*)drflac\_\_malloc\_from\_callbacks(lenMB + 1, pAllocationCallbacks);}
\DoxyCodeLine{8468         \textcolor{keywordflow}{if} (pFilePathMB == NULL) \{}
\DoxyCodeLine{8469             \textcolor{keywordflow}{return} DRFLAC\_OUT\_OF\_MEMORY;}
\DoxyCodeLine{8470         \}}
\DoxyCodeLine{8471 }
\DoxyCodeLine{8472         pFilePathTemp = pFilePath;}
\DoxyCodeLine{8473         DRFLAC\_ZERO\_OBJECT(\&mbs);}
\DoxyCodeLine{8474         wcsrtombs(pFilePathMB, \&pFilePathTemp, lenMB + 1, \&mbs);}
\DoxyCodeLine{8475 }
\DoxyCodeLine{8476         \textcolor{comment}{/* The open mode should always consist of ASCII characters so we should be able to do a trivial conversion. */}}
\DoxyCodeLine{8477         \{}
\DoxyCodeLine{8478             \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{8479             \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{8480                 \textcolor{keywordflow}{if} (pOpenMode[i] == 0) \{}
\DoxyCodeLine{8481                     pOpenModeMB[i] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{8482                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{8483                 \}}
\DoxyCodeLine{8484 }
\DoxyCodeLine{8485                 pOpenModeMB[i] = (char)pOpenMode[i];}
\DoxyCodeLine{8486                 i += 1;}
\DoxyCodeLine{8487             \}}
\DoxyCodeLine{8488         \}}
\DoxyCodeLine{8489 }
\DoxyCodeLine{8490         *ppFile = fopen(pFilePathMB, pOpenModeMB);}
\DoxyCodeLine{8491 }
\DoxyCodeLine{8492         drflac\_\_free\_from\_callbacks(pFilePathMB, pAllocationCallbacks);}
\DoxyCodeLine{8493     \}}
\DoxyCodeLine{8494 }
\DoxyCodeLine{8495     \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{8496         \textcolor{keywordflow}{return} DRFLAC\_ERROR;}
\DoxyCodeLine{8497     \}}
\DoxyCodeLine{8498 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8499 }
\DoxyCodeLine{8500     \textcolor{keywordflow}{return} DRFLAC\_SUCCESS;}
\DoxyCodeLine{8501 \}}
\DoxyCodeLine{8502 }
\DoxyCodeLine{8503 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drflac\_\_on\_read\_stdio(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* bufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{8504 \{}
\DoxyCodeLine{8505     \textcolor{keywordflow}{return} fread(bufferOut, 1, bytesToRead, (FILE*)pUserData);}
\DoxyCodeLine{8506 \}}
\DoxyCodeLine{8507 }
\DoxyCodeLine{8508 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_on\_seek\_stdio(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drflac\_seek\_origin origin)}
\DoxyCodeLine{8509 \{}
\DoxyCodeLine{8510     DRFLAC\_ASSERT(offset >= 0);  \textcolor{comment}{/* <-\/-\/ Never seek backwards. */}}
\DoxyCodeLine{8511 }
\DoxyCodeLine{8512     \textcolor{keywordflow}{return} fseek((FILE*)pUserData, offset, (origin == drflac\_seek\_origin\_current) ? SEEK\_CUR : SEEK\_SET) == 0;}
\DoxyCodeLine{8513 \}}
\DoxyCodeLine{8514 }
\DoxyCodeLine{8515 }
\DoxyCodeLine{8516 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFileName, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8517 \{}
\DoxyCodeLine{8518     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8519     FILE* pFile;}
\DoxyCodeLine{8520 }
\DoxyCodeLine{8521     \textcolor{keywordflow}{if} (drflac\_fopen(\&pFile, pFileName, \textcolor{stringliteral}{"{}rb"{}}) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{8522         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8523     \}}
\DoxyCodeLine{8524 }
\DoxyCodeLine{8525     pFlac = drflac\_open(drflac\_\_on\_read\_stdio, drflac\_\_on\_seek\_stdio, (\textcolor{keywordtype}{void}*)pFile, pAllocationCallbacks);}
\DoxyCodeLine{8526     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8527         fclose(pFile);}
\DoxyCodeLine{8528         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8529     \}}
\DoxyCodeLine{8530 }
\DoxyCodeLine{8531     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8532 \}}
\DoxyCodeLine{8533 }
\DoxyCodeLine{8534 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_w(\textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFileName, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8535 \{}
\DoxyCodeLine{8536     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8537     FILE* pFile;}
\DoxyCodeLine{8538 }
\DoxyCodeLine{8539     \textcolor{keywordflow}{if} (drflac\_wfopen(\&pFile, pFileName, L\textcolor{stringliteral}{"{}rb"{}}, pAllocationCallbacks) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{8540         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8541     \}}
\DoxyCodeLine{8542 }
\DoxyCodeLine{8543     pFlac = drflac\_open(drflac\_\_on\_read\_stdio, drflac\_\_on\_seek\_stdio, (\textcolor{keywordtype}{void}*)pFile, pAllocationCallbacks);}
\DoxyCodeLine{8544     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8545         fclose(pFile);}
\DoxyCodeLine{8546         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8547     \}}
\DoxyCodeLine{8548 }
\DoxyCodeLine{8549     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8550 \}}
\DoxyCodeLine{8551 }
\DoxyCodeLine{8552 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_with\_metadata(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFileName, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8553 \{}
\DoxyCodeLine{8554     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8555     FILE* pFile;}
\DoxyCodeLine{8556 }
\DoxyCodeLine{8557     \textcolor{keywordflow}{if} (drflac\_fopen(\&pFile, pFileName, \textcolor{stringliteral}{"{}rb"{}}) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{8558         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8559     \}}
\DoxyCodeLine{8560 }
\DoxyCodeLine{8561     pFlac = drflac\_open\_with\_metadata\_private(drflac\_\_on\_read\_stdio, drflac\_\_on\_seek\_stdio, onMeta, drflac\_container\_unknown, (\textcolor{keywordtype}{void}*)pFile, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8562     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8563         fclose(pFile);}
\DoxyCodeLine{8564         \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8565     \}}
\DoxyCodeLine{8566 }
\DoxyCodeLine{8567     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8568 \}}
\DoxyCodeLine{8569 }
\DoxyCodeLine{8570 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_file\_with\_metadata\_w(\textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFileName, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8571 \{}
\DoxyCodeLine{8572     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8573     FILE* pFile;}
\DoxyCodeLine{8574 }
\DoxyCodeLine{8575     \textcolor{keywordflow}{if} (drflac\_wfopen(\&pFile, pFileName, L\textcolor{stringliteral}{"{}rb"{}}, pAllocationCallbacks) != DRFLAC\_SUCCESS) \{}
\DoxyCodeLine{8576         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8577     \}}
\DoxyCodeLine{8578 }
\DoxyCodeLine{8579     pFlac = drflac\_open\_with\_metadata\_private(drflac\_\_on\_read\_stdio, drflac\_\_on\_seek\_stdio, onMeta, drflac\_container\_unknown, (\textcolor{keywordtype}{void}*)pFile, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8580     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8581         fclose(pFile);}
\DoxyCodeLine{8582         \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8583     \}}
\DoxyCodeLine{8584 }
\DoxyCodeLine{8585     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8586 \}}
\DoxyCodeLine{8587 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* DR\_FLAC\_NO\_STDIO */}\textcolor{preprocessor}{}}
\DoxyCodeLine{8588 }
\DoxyCodeLine{8589 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drflac\_\_on\_read\_memory(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* bufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{8590 \{}
\DoxyCodeLine{8591     \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}}* memoryStream = (\mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}}*)pUserData;}
\DoxyCodeLine{8592     \textcolor{keywordtype}{size\_t} bytesRemaining;}
\DoxyCodeLine{8593 }
\DoxyCodeLine{8594     DRFLAC\_ASSERT(memoryStream != NULL);}
\DoxyCodeLine{8595     DRFLAC\_ASSERT(memoryStream-\/>dataSize >= memoryStream-\/>currentReadPos);}
\DoxyCodeLine{8596 }
\DoxyCodeLine{8597     bytesRemaining = memoryStream-\/>dataSize -\/ memoryStream-\/>currentReadPos;}
\DoxyCodeLine{8598     \textcolor{keywordflow}{if} (bytesToRead > bytesRemaining) \{}
\DoxyCodeLine{8599         bytesToRead = bytesRemaining;}
\DoxyCodeLine{8600     \}}
\DoxyCodeLine{8601 }
\DoxyCodeLine{8602     \textcolor{keywordflow}{if} (bytesToRead > 0) \{}
\DoxyCodeLine{8603         DRFLAC\_COPY\_MEMORY(bufferOut, memoryStream-\/>data + memoryStream-\/>currentReadPos, bytesToRead);}
\DoxyCodeLine{8604         memoryStream-\/>currentReadPos += bytesToRead;}
\DoxyCodeLine{8605     \}}
\DoxyCodeLine{8606 }
\DoxyCodeLine{8607     \textcolor{keywordflow}{return} bytesToRead;}
\DoxyCodeLine{8608 \}}
\DoxyCodeLine{8609 }
\DoxyCodeLine{8610 \textcolor{keyword}{static} drflac\_bool32 drflac\_\_on\_seek\_memory(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drflac\_seek\_origin origin)}
\DoxyCodeLine{8611 \{}
\DoxyCodeLine{8612     \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}}* memoryStream = (\mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}}*)pUserData;}
\DoxyCodeLine{8613 }
\DoxyCodeLine{8614     DRFLAC\_ASSERT(memoryStream != NULL);}
\DoxyCodeLine{8615     DRFLAC\_ASSERT(offset >= 0); \textcolor{comment}{/* <-\/-\/ Never seek backwards. */}}
\DoxyCodeLine{8616 }
\DoxyCodeLine{8617     \textcolor{keywordflow}{if} (offset > (drflac\_int64)memoryStream-\/>dataSize) \{}
\DoxyCodeLine{8618         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{8619     \}}
\DoxyCodeLine{8620 }
\DoxyCodeLine{8621     \textcolor{keywordflow}{if} (origin == drflac\_seek\_origin\_current) \{}
\DoxyCodeLine{8622         \textcolor{keywordflow}{if} (memoryStream-\/>currentReadPos + offset <= memoryStream-\/>dataSize) \{}
\DoxyCodeLine{8623             memoryStream-\/>currentReadPos += offset;}
\DoxyCodeLine{8624         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{8625             \textcolor{keywordflow}{return} DRFLAC\_FALSE;  \textcolor{comment}{/* Trying to seek too far forward. */}}
\DoxyCodeLine{8626         \}}
\DoxyCodeLine{8627     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{8628         \textcolor{keywordflow}{if} ((drflac\_uint32)offset <= memoryStream-\/>dataSize) \{}
\DoxyCodeLine{8629             memoryStream-\/>currentReadPos = offset;}
\DoxyCodeLine{8630         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{8631             \textcolor{keywordflow}{return} DRFLAC\_FALSE;  \textcolor{comment}{/* Trying to seek too far forward. */}}
\DoxyCodeLine{8632         \}}
\DoxyCodeLine{8633     \}}
\DoxyCodeLine{8634 }
\DoxyCodeLine{8635     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{8636 \}}
\DoxyCodeLine{8637 }
\DoxyCodeLine{8638 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_memory(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8639 \{}
\DoxyCodeLine{8640     \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}} memoryStream;}
\DoxyCodeLine{8641     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8642 }
\DoxyCodeLine{8643     memoryStream.data = (\textcolor{keyword}{const} drflac\_uint8*)pData;}
\DoxyCodeLine{8644     memoryStream.dataSize = dataSize;}
\DoxyCodeLine{8645     memoryStream.currentReadPos = 0;}
\DoxyCodeLine{8646     pFlac = drflac\_open(drflac\_\_on\_read\_memory, drflac\_\_on\_seek\_memory, \&memoryStream, pAllocationCallbacks);}
\DoxyCodeLine{8647     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8648         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8649     \}}
\DoxyCodeLine{8650 }
\DoxyCodeLine{8651     pFlac-\/>memoryStream = memoryStream;}
\DoxyCodeLine{8652 }
\DoxyCodeLine{8653     \textcolor{comment}{/* This is an awful hack... */}}
\DoxyCodeLine{8654 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{8655     \textcolor{keywordflow}{if} (pFlac-\/>container == drflac\_container\_ogg)}
\DoxyCodeLine{8656     \{}
\DoxyCodeLine{8657         drflac\_oggbs* oggbs = (drflac\_oggbs*)pFlac-\/>\_oggbs;}
\DoxyCodeLine{8658         oggbs-\/>pUserData = \&pFlac-\/>memoryStream;}
\DoxyCodeLine{8659     \}}
\DoxyCodeLine{8660     \textcolor{keywordflow}{else}}
\DoxyCodeLine{8661 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8662     \{}
\DoxyCodeLine{8663         pFlac-\/>bs.pUserData = \&pFlac-\/>memoryStream;}
\DoxyCodeLine{8664     \}}
\DoxyCodeLine{8665 }
\DoxyCodeLine{8666     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8667 \}}
\DoxyCodeLine{8668 }
\DoxyCodeLine{8669 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_memory\_with\_metadata(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8670 \{}
\DoxyCodeLine{8671     \mbox{\hyperlink{structdrflac____memory__stream}{drflac\_\_memory\_stream}} memoryStream;}
\DoxyCodeLine{8672     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{8673 }
\DoxyCodeLine{8674     memoryStream.data = (\textcolor{keyword}{const} drflac\_uint8*)pData;}
\DoxyCodeLine{8675     memoryStream.dataSize = dataSize;}
\DoxyCodeLine{8676     memoryStream.currentReadPos = 0;}
\DoxyCodeLine{8677     pFlac = drflac\_open\_with\_metadata\_private(drflac\_\_on\_read\_memory, drflac\_\_on\_seek\_memory, onMeta, drflac\_container\_unknown, \&memoryStream, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8678     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8679         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{8680     \}}
\DoxyCodeLine{8681 }
\DoxyCodeLine{8682     pFlac-\/>memoryStream = memoryStream;}
\DoxyCodeLine{8683 }
\DoxyCodeLine{8684     \textcolor{comment}{/* This is an awful hack... */}}
\DoxyCodeLine{8685 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{8686     \textcolor{keywordflow}{if} (pFlac-\/>container == drflac\_container\_ogg)}
\DoxyCodeLine{8687     \{}
\DoxyCodeLine{8688         drflac\_oggbs* oggbs = (drflac\_oggbs*)pFlac-\/>\_oggbs;}
\DoxyCodeLine{8689         oggbs-\/>pUserData = \&pFlac-\/>memoryStream;}
\DoxyCodeLine{8690     \}}
\DoxyCodeLine{8691     \textcolor{keywordflow}{else}}
\DoxyCodeLine{8692 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8693     \{}
\DoxyCodeLine{8694         pFlac-\/>bs.pUserData = \&pFlac-\/>memoryStream;}
\DoxyCodeLine{8695     \}}
\DoxyCodeLine{8696 }
\DoxyCodeLine{8697     \textcolor{keywordflow}{return} pFlac;}
\DoxyCodeLine{8698 \}}
\DoxyCodeLine{8699 }
\DoxyCodeLine{8700 }
\DoxyCodeLine{8701 }
\DoxyCodeLine{8702 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8703 \{}
\DoxyCodeLine{8704     \textcolor{keywordflow}{return} drflac\_open\_with\_metadata\_private(onRead, onSeek, NULL, drflac\_container\_unknown, pUserData, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8705 \}}
\DoxyCodeLine{8706 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_relaxed(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8707 \{}
\DoxyCodeLine{8708     \textcolor{keywordflow}{return} drflac\_open\_with\_metadata\_private(onRead, onSeek, NULL, container, pUserData, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8709 \}}
\DoxyCodeLine{8710 }
\DoxyCodeLine{8711 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_with\_metadata(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8712 \{}
\DoxyCodeLine{8713     \textcolor{keywordflow}{return} drflac\_open\_with\_metadata\_private(onRead, onSeek, onMeta, drflac\_container\_unknown, pUserData, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8714 \}}
\DoxyCodeLine{8715 DRFLAC\_API \mbox{\hyperlink{structdrflac}{drflac}}* drflac\_open\_with\_metadata\_relaxed(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, drflac\_meta\_proc onMeta, drflac\_container container, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{8716 \{}
\DoxyCodeLine{8717     \textcolor{keywordflow}{return} drflac\_open\_with\_metadata\_private(onRead, onSeek, onMeta, container, pUserData, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{8718 \}}
\DoxyCodeLine{8719 }
\DoxyCodeLine{8720 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_close(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac)}
\DoxyCodeLine{8721 \{}
\DoxyCodeLine{8722     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{8723         \textcolor{keywordflow}{return};}
\DoxyCodeLine{8724     \}}
\DoxyCodeLine{8725 }
\DoxyCodeLine{8726 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{8727     \textcolor{comment}{/*}}
\DoxyCodeLine{8728 \textcolor{comment}{    If we opened the file with drflac\_open\_file() we will want to close the file handle. We can know whether or not drflac\_open\_file()}}
\DoxyCodeLine{8729 \textcolor{comment}{    was used by looking at the callbacks.}}
\DoxyCodeLine{8730 \textcolor{comment}{    */}}
\DoxyCodeLine{8731     \textcolor{keywordflow}{if} (pFlac-\/>bs.onRead == drflac\_\_on\_read\_stdio) \{}
\DoxyCodeLine{8732         fclose((FILE*)pFlac-\/>bs.pUserData);}
\DoxyCodeLine{8733     \}}
\DoxyCodeLine{8734 }
\DoxyCodeLine{8735 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{8736     \textcolor{comment}{/* Need to clean up Ogg streams a bit differently due to the way the bit streaming is chained. */}}
\DoxyCodeLine{8737     \textcolor{keywordflow}{if} (pFlac-\/>container == drflac\_container\_ogg) \{}
\DoxyCodeLine{8738         drflac\_oggbs* oggbs = (drflac\_oggbs*)pFlac-\/>\_oggbs;}
\DoxyCodeLine{8739         DRFLAC\_ASSERT(pFlac-\/>bs.onRead == drflac\_\_on\_read\_ogg);}
\DoxyCodeLine{8740 }
\DoxyCodeLine{8741         \textcolor{keywordflow}{if} (oggbs-\/>onRead == drflac\_\_on\_read\_stdio) \{}
\DoxyCodeLine{8742             fclose((FILE*)oggbs-\/>pUserData);}
\DoxyCodeLine{8743         \}}
\DoxyCodeLine{8744     \}}
\DoxyCodeLine{8745 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8746 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8747 }
\DoxyCodeLine{8748     drflac\_\_free\_from\_callbacks(pFlac, \&pFlac-\/>allocationCallbacks);}
\DoxyCodeLine{8749 \}}
\DoxyCodeLine{8750 }
\DoxyCodeLine{8751 }
\DoxyCodeLine{8752 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{8753 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8754 \{}
\DoxyCodeLine{8755     drflac\_uint64 i;}
\DoxyCodeLine{8756     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{8757         drflac\_uint32 left  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{8758         drflac\_uint32 side  = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{8759         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{8760 }
\DoxyCodeLine{8761         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8762         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8763     \}}
\DoxyCodeLine{8764 \}}
\DoxyCodeLine{8765 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8766 }
\DoxyCodeLine{8767 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8768 \{}
\DoxyCodeLine{8769     drflac\_uint64 i;}
\DoxyCodeLine{8770     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{8771     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{8772     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{8773     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{8774     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{8775 }
\DoxyCodeLine{8776     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{8777         drflac\_uint32 left0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{8778         drflac\_uint32 left1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{8779         drflac\_uint32 left2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{8780         drflac\_uint32 left3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{8781 }
\DoxyCodeLine{8782         drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{8783         drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{8784         drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{8785         drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{8786 }
\DoxyCodeLine{8787         drflac\_uint32 right0 = left0 -\/ side0;}
\DoxyCodeLine{8788         drflac\_uint32 right1 = left1 -\/ side1;}
\DoxyCodeLine{8789         drflac\_uint32 right2 = left2 -\/ side2;}
\DoxyCodeLine{8790         drflac\_uint32 right3 = left3 -\/ side3;}
\DoxyCodeLine{8791 }
\DoxyCodeLine{8792         pOutputSamples[i*8+0] = (drflac\_int32)left0;}
\DoxyCodeLine{8793         pOutputSamples[i*8+1] = (drflac\_int32)right0;}
\DoxyCodeLine{8794         pOutputSamples[i*8+2] = (drflac\_int32)left1;}
\DoxyCodeLine{8795         pOutputSamples[i*8+3] = (drflac\_int32)right1;}
\DoxyCodeLine{8796         pOutputSamples[i*8+4] = (drflac\_int32)left2;}
\DoxyCodeLine{8797         pOutputSamples[i*8+5] = (drflac\_int32)right2;}
\DoxyCodeLine{8798         pOutputSamples[i*8+6] = (drflac\_int32)left3;}
\DoxyCodeLine{8799         pOutputSamples[i*8+7] = (drflac\_int32)right3;}
\DoxyCodeLine{8800     \}}
\DoxyCodeLine{8801 }
\DoxyCodeLine{8802     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{8803         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{8804         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{8805         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{8806 }
\DoxyCodeLine{8807         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8808         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8809     \}}
\DoxyCodeLine{8810 \}}
\DoxyCodeLine{8811 }
\DoxyCodeLine{8812 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{8813 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8814 \{}
\DoxyCodeLine{8815     drflac\_uint64 i;}
\DoxyCodeLine{8816     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{8817     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{8818     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{8819     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{8820     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{8821 }
\DoxyCodeLine{8822     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{8823 }
\DoxyCodeLine{8824     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{8825         \_\_m128i left  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{8826         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{8827         \_\_m128i right = \_mm\_sub\_epi32(left, side);}
\DoxyCodeLine{8828 }
\DoxyCodeLine{8829         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 0), \_mm\_unpacklo\_epi32(left, right));}
\DoxyCodeLine{8830         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 4), \_mm\_unpackhi\_epi32(left, right));}
\DoxyCodeLine{8831     \}}
\DoxyCodeLine{8832 }
\DoxyCodeLine{8833     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{8834         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{8835         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{8836         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{8837 }
\DoxyCodeLine{8838         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8839         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8840     \}}
\DoxyCodeLine{8841 \}}
\DoxyCodeLine{8842 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8843 }
\DoxyCodeLine{8844 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{8845 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8846 \{}
\DoxyCodeLine{8847     drflac\_uint64 i;}
\DoxyCodeLine{8848     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{8849     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{8850     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{8851     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{8852     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{8853     int32x4\_t shift0\_4;}
\DoxyCodeLine{8854     int32x4\_t shift1\_4;}
\DoxyCodeLine{8855 }
\DoxyCodeLine{8856     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{8857 }
\DoxyCodeLine{8858     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{8859     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{8860 }
\DoxyCodeLine{8861     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{8862         uint32x4\_t left;}
\DoxyCodeLine{8863         uint32x4\_t side;}
\DoxyCodeLine{8864         uint32x4\_t right;}
\DoxyCodeLine{8865 }
\DoxyCodeLine{8866         left  = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{8867         side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{8868         right = vsubq\_u32(left, side);}
\DoxyCodeLine{8869 }
\DoxyCodeLine{8870         drflac\_\_vst2q\_u32((drflac\_uint32*)pOutputSamples + i*8, vzipq\_u32(left, right));}
\DoxyCodeLine{8871     \}}
\DoxyCodeLine{8872 }
\DoxyCodeLine{8873     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{8874         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{8875         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{8876         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{8877 }
\DoxyCodeLine{8878         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8879         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8880     \}}
\DoxyCodeLine{8881 \}}
\DoxyCodeLine{8882 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8883 }
\DoxyCodeLine{8884 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8885 \{}
\DoxyCodeLine{8886 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{8887     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{8888         drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{8889     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{8890 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{8891     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{8892         drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{8893     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{8894 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8895     \{}
\DoxyCodeLine{8896         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{8897 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{8898         drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{8899 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8900         drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{8901 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8902     \}}
\DoxyCodeLine{8903 \}}
\DoxyCodeLine{8904 }
\DoxyCodeLine{8905 }
\DoxyCodeLine{8906 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{8907 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8908 \{}
\DoxyCodeLine{8909     drflac\_uint64 i;}
\DoxyCodeLine{8910     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{8911         drflac\_uint32 side  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{8912         drflac\_uint32 right = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{8913         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{8914 }
\DoxyCodeLine{8915         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8916         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8917     \}}
\DoxyCodeLine{8918 \}}
\DoxyCodeLine{8919 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8920 }
\DoxyCodeLine{8921 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8922 \{}
\DoxyCodeLine{8923     drflac\_uint64 i;}
\DoxyCodeLine{8924     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{8925     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{8926     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{8927     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{8928     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{8929 }
\DoxyCodeLine{8930     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{8931         drflac\_uint32 side0  = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{8932         drflac\_uint32 side1  = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{8933         drflac\_uint32 side2  = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{8934         drflac\_uint32 side3  = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{8935 }
\DoxyCodeLine{8936         drflac\_uint32 right0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{8937         drflac\_uint32 right1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{8938         drflac\_uint32 right2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{8939         drflac\_uint32 right3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{8940 }
\DoxyCodeLine{8941         drflac\_uint32 left0 = right0 + side0;}
\DoxyCodeLine{8942         drflac\_uint32 left1 = right1 + side1;}
\DoxyCodeLine{8943         drflac\_uint32 left2 = right2 + side2;}
\DoxyCodeLine{8944         drflac\_uint32 left3 = right3 + side3;}
\DoxyCodeLine{8945 }
\DoxyCodeLine{8946         pOutputSamples[i*8+0] = (drflac\_int32)left0;}
\DoxyCodeLine{8947         pOutputSamples[i*8+1] = (drflac\_int32)right0;}
\DoxyCodeLine{8948         pOutputSamples[i*8+2] = (drflac\_int32)left1;}
\DoxyCodeLine{8949         pOutputSamples[i*8+3] = (drflac\_int32)right1;}
\DoxyCodeLine{8950         pOutputSamples[i*8+4] = (drflac\_int32)left2;}
\DoxyCodeLine{8951         pOutputSamples[i*8+5] = (drflac\_int32)right2;}
\DoxyCodeLine{8952         pOutputSamples[i*8+6] = (drflac\_int32)left3;}
\DoxyCodeLine{8953         pOutputSamples[i*8+7] = (drflac\_int32)right3;}
\DoxyCodeLine{8954     \}}
\DoxyCodeLine{8955 }
\DoxyCodeLine{8956     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{8957         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{8958         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{8959         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{8960 }
\DoxyCodeLine{8961         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8962         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8963     \}}
\DoxyCodeLine{8964 \}}
\DoxyCodeLine{8965 }
\DoxyCodeLine{8966 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{8967 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{8968 \{}
\DoxyCodeLine{8969     drflac\_uint64 i;}
\DoxyCodeLine{8970     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{8971     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{8972     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{8973     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{8974     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{8975 }
\DoxyCodeLine{8976     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{8977 }
\DoxyCodeLine{8978     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{8979         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{8980         \_\_m128i right = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{8981         \_\_m128i left  = \_mm\_add\_epi32(right, side);}
\DoxyCodeLine{8982 }
\DoxyCodeLine{8983         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 0), \_mm\_unpacklo\_epi32(left, right));}
\DoxyCodeLine{8984         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 4), \_mm\_unpackhi\_epi32(left, right));}
\DoxyCodeLine{8985     \}}
\DoxyCodeLine{8986 }
\DoxyCodeLine{8987     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{8988         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{8989         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{8990         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{8991 }
\DoxyCodeLine{8992         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{8993         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{8994     \}}
\DoxyCodeLine{8995 \}}
\DoxyCodeLine{8996 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8997 }
\DoxyCodeLine{8998 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{8999 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9000 \{}
\DoxyCodeLine{9001     drflac\_uint64 i;}
\DoxyCodeLine{9002     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9003     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9004     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9005     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9006     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9007     int32x4\_t shift0\_4;}
\DoxyCodeLine{9008     int32x4\_t shift1\_4;}
\DoxyCodeLine{9009 }
\DoxyCodeLine{9010     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9011 }
\DoxyCodeLine{9012     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{9013     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{9014 }
\DoxyCodeLine{9015     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9016         uint32x4\_t side;}
\DoxyCodeLine{9017         uint32x4\_t right;}
\DoxyCodeLine{9018         uint32x4\_t left;}
\DoxyCodeLine{9019 }
\DoxyCodeLine{9020         side  = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{9021         right = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{9022         left  = vaddq\_u32(right, side);}
\DoxyCodeLine{9023 }
\DoxyCodeLine{9024         drflac\_\_vst2q\_u32((drflac\_uint32*)pOutputSamples + i*8, vzipq\_u32(left, right));}
\DoxyCodeLine{9025     \}}
\DoxyCodeLine{9026 }
\DoxyCodeLine{9027     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9028         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9029         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9030         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{9031 }
\DoxyCodeLine{9032         pOutputSamples[i*2+0] = (drflac\_int32)left;}
\DoxyCodeLine{9033         pOutputSamples[i*2+1] = (drflac\_int32)right;}
\DoxyCodeLine{9034     \}}
\DoxyCodeLine{9035 \}}
\DoxyCodeLine{9036 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9037 }
\DoxyCodeLine{9038 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9039 \{}
\DoxyCodeLine{9040 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9041     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9042         drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9043     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9044 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9045     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9046         drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9047     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9048 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9049     \{}
\DoxyCodeLine{9050         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{9051 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9052         drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9053 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9054         drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9055 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9056     \}}
\DoxyCodeLine{9057 \}}
\DoxyCodeLine{9058 }
\DoxyCodeLine{9059 }
\DoxyCodeLine{9060 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9061 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9062 \{}
\DoxyCodeLine{9063     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{9064         drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9065         drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9066 }
\DoxyCodeLine{9067         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9068 }
\DoxyCodeLine{9069         pOutputSamples[i*2+0] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid + side) >> 1) << unusedBitsPerSample);}
\DoxyCodeLine{9070         pOutputSamples[i*2+1] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid -\/ side) >> 1) << unusedBitsPerSample);}
\DoxyCodeLine{9071     \}}
\DoxyCodeLine{9072 \}}
\DoxyCodeLine{9073 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9074 }
\DoxyCodeLine{9075 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9076 \{}
\DoxyCodeLine{9077     drflac\_uint64 i;}
\DoxyCodeLine{9078     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9079     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9080     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9081     drflac\_int32 shift = unusedBitsPerSample;}
\DoxyCodeLine{9082 }
\DoxyCodeLine{9083     \textcolor{keywordflow}{if} (shift > 0) \{}
\DoxyCodeLine{9084         shift -\/= 1;}
\DoxyCodeLine{9085         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9086             drflac\_uint32 temp0L;}
\DoxyCodeLine{9087             drflac\_uint32 temp1L;}
\DoxyCodeLine{9088             drflac\_uint32 temp2L;}
\DoxyCodeLine{9089             drflac\_uint32 temp3L;}
\DoxyCodeLine{9090             drflac\_uint32 temp0R;}
\DoxyCodeLine{9091             drflac\_uint32 temp1R;}
\DoxyCodeLine{9092             drflac\_uint32 temp2R;}
\DoxyCodeLine{9093             drflac\_uint32 temp3R;}
\DoxyCodeLine{9094 }
\DoxyCodeLine{9095             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9096             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9097             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9098             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9099 }
\DoxyCodeLine{9100             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9101             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9102             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9103             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9104 }
\DoxyCodeLine{9105             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{9106             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{9107             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{9108             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{9109 }
\DoxyCodeLine{9110             temp0L = (mid0 + side0) << shift;}
\DoxyCodeLine{9111             temp1L = (mid1 + side1) << shift;}
\DoxyCodeLine{9112             temp2L = (mid2 + side2) << shift;}
\DoxyCodeLine{9113             temp3L = (mid3 + side3) << shift;}
\DoxyCodeLine{9114 }
\DoxyCodeLine{9115             temp0R = (mid0 -\/ side0) << shift;}
\DoxyCodeLine{9116             temp1R = (mid1 -\/ side1) << shift;}
\DoxyCodeLine{9117             temp2R = (mid2 -\/ side2) << shift;}
\DoxyCodeLine{9118             temp3R = (mid3 -\/ side3) << shift;}
\DoxyCodeLine{9119 }
\DoxyCodeLine{9120             pOutputSamples[i*8+0] = (drflac\_int32)temp0L;}
\DoxyCodeLine{9121             pOutputSamples[i*8+1] = (drflac\_int32)temp0R;}
\DoxyCodeLine{9122             pOutputSamples[i*8+2] = (drflac\_int32)temp1L;}
\DoxyCodeLine{9123             pOutputSamples[i*8+3] = (drflac\_int32)temp1R;}
\DoxyCodeLine{9124             pOutputSamples[i*8+4] = (drflac\_int32)temp2L;}
\DoxyCodeLine{9125             pOutputSamples[i*8+5] = (drflac\_int32)temp2R;}
\DoxyCodeLine{9126             pOutputSamples[i*8+6] = (drflac\_int32)temp3L;}
\DoxyCodeLine{9127             pOutputSamples[i*8+7] = (drflac\_int32)temp3R;}
\DoxyCodeLine{9128         \}}
\DoxyCodeLine{9129     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{9130         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9131             drflac\_uint32 temp0L;}
\DoxyCodeLine{9132             drflac\_uint32 temp1L;}
\DoxyCodeLine{9133             drflac\_uint32 temp2L;}
\DoxyCodeLine{9134             drflac\_uint32 temp3L;}
\DoxyCodeLine{9135             drflac\_uint32 temp0R;}
\DoxyCodeLine{9136             drflac\_uint32 temp1R;}
\DoxyCodeLine{9137             drflac\_uint32 temp2R;}
\DoxyCodeLine{9138             drflac\_uint32 temp3R;}
\DoxyCodeLine{9139 }
\DoxyCodeLine{9140             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9141             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9142             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9143             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9144 }
\DoxyCodeLine{9145             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9146             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9147             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9148             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9149 }
\DoxyCodeLine{9150             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{9151             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{9152             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{9153             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{9154 }
\DoxyCodeLine{9155             temp0L = (drflac\_uint32)((drflac\_int32)(mid0 + side0) >> 1);}
\DoxyCodeLine{9156             temp1L = (drflac\_uint32)((drflac\_int32)(mid1 + side1) >> 1);}
\DoxyCodeLine{9157             temp2L = (drflac\_uint32)((drflac\_int32)(mid2 + side2) >> 1);}
\DoxyCodeLine{9158             temp3L = (drflac\_uint32)((drflac\_int32)(mid3 + side3) >> 1);}
\DoxyCodeLine{9159 }
\DoxyCodeLine{9160             temp0R = (drflac\_uint32)((drflac\_int32)(mid0 -\/ side0) >> 1);}
\DoxyCodeLine{9161             temp1R = (drflac\_uint32)((drflac\_int32)(mid1 -\/ side1) >> 1);}
\DoxyCodeLine{9162             temp2R = (drflac\_uint32)((drflac\_int32)(mid2 -\/ side2) >> 1);}
\DoxyCodeLine{9163             temp3R = (drflac\_uint32)((drflac\_int32)(mid3 -\/ side3) >> 1);}
\DoxyCodeLine{9164 }
\DoxyCodeLine{9165             pOutputSamples[i*8+0] = (drflac\_int32)temp0L;}
\DoxyCodeLine{9166             pOutputSamples[i*8+1] = (drflac\_int32)temp0R;}
\DoxyCodeLine{9167             pOutputSamples[i*8+2] = (drflac\_int32)temp1L;}
\DoxyCodeLine{9168             pOutputSamples[i*8+3] = (drflac\_int32)temp1R;}
\DoxyCodeLine{9169             pOutputSamples[i*8+4] = (drflac\_int32)temp2L;}
\DoxyCodeLine{9170             pOutputSamples[i*8+5] = (drflac\_int32)temp2R;}
\DoxyCodeLine{9171             pOutputSamples[i*8+6] = (drflac\_int32)temp3L;}
\DoxyCodeLine{9172             pOutputSamples[i*8+7] = (drflac\_int32)temp3R;}
\DoxyCodeLine{9173         \}}
\DoxyCodeLine{9174     \}}
\DoxyCodeLine{9175 }
\DoxyCodeLine{9176     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9177         drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9178         drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9179 }
\DoxyCodeLine{9180         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9181 }
\DoxyCodeLine{9182         pOutputSamples[i*2+0] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid + side) >> 1) << unusedBitsPerSample);}
\DoxyCodeLine{9183         pOutputSamples[i*2+1] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid -\/ side) >> 1) << unusedBitsPerSample);}
\DoxyCodeLine{9184     \}}
\DoxyCodeLine{9185 \}}
\DoxyCodeLine{9186 }
\DoxyCodeLine{9187 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9188 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9189 \{}
\DoxyCodeLine{9190     drflac\_uint64 i;}
\DoxyCodeLine{9191     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9192     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9193     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9194     drflac\_int32 shift = unusedBitsPerSample;}
\DoxyCodeLine{9195 }
\DoxyCodeLine{9196     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9197 }
\DoxyCodeLine{9198     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{9199         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9200             \_\_m128i mid;}
\DoxyCodeLine{9201             \_\_m128i side;}
\DoxyCodeLine{9202             \_\_m128i left;}
\DoxyCodeLine{9203             \_\_m128i right;}
\DoxyCodeLine{9204 }
\DoxyCodeLine{9205             mid   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{9206             side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{9207 }
\DoxyCodeLine{9208             mid   = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{9209 }
\DoxyCodeLine{9210             left  = \_mm\_srai\_epi32(\_mm\_add\_epi32(mid, side), 1);}
\DoxyCodeLine{9211             right = \_mm\_srai\_epi32(\_mm\_sub\_epi32(mid, side), 1);}
\DoxyCodeLine{9212 }
\DoxyCodeLine{9213             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 0), \_mm\_unpacklo\_epi32(left, right));}
\DoxyCodeLine{9214             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 4), \_mm\_unpackhi\_epi32(left, right));}
\DoxyCodeLine{9215         \}}
\DoxyCodeLine{9216 }
\DoxyCodeLine{9217         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9218             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9219             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9220 }
\DoxyCodeLine{9221             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9222 }
\DoxyCodeLine{9223             pOutputSamples[i*2+0] = (drflac\_int32)(mid + side) >> 1;}
\DoxyCodeLine{9224             pOutputSamples[i*2+1] = (drflac\_int32)(mid -\/ side) >> 1;}
\DoxyCodeLine{9225         \}}
\DoxyCodeLine{9226     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{9227         shift -\/= 1;}
\DoxyCodeLine{9228         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9229             \_\_m128i mid;}
\DoxyCodeLine{9230             \_\_m128i side;}
\DoxyCodeLine{9231             \_\_m128i left;}
\DoxyCodeLine{9232             \_\_m128i right;}
\DoxyCodeLine{9233 }
\DoxyCodeLine{9234             mid   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{9235             side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{9236 }
\DoxyCodeLine{9237             mid   = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{9238 }
\DoxyCodeLine{9239             left  = \_mm\_slli\_epi32(\_mm\_add\_epi32(mid, side), shift);}
\DoxyCodeLine{9240             right = \_mm\_slli\_epi32(\_mm\_sub\_epi32(mid, side), shift);}
\DoxyCodeLine{9241 }
\DoxyCodeLine{9242             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 0), \_mm\_unpacklo\_epi32(left, right));}
\DoxyCodeLine{9243             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 4), \_mm\_unpackhi\_epi32(left, right));}
\DoxyCodeLine{9244         \}}
\DoxyCodeLine{9245 }
\DoxyCodeLine{9246         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9247             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9248             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9249 }
\DoxyCodeLine{9250             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9251 }
\DoxyCodeLine{9252             pOutputSamples[i*2+0] = (drflac\_int32)((mid + side) << shift);}
\DoxyCodeLine{9253             pOutputSamples[i*2+1] = (drflac\_int32)((mid -\/ side) << shift);}
\DoxyCodeLine{9254         \}}
\DoxyCodeLine{9255     \}}
\DoxyCodeLine{9256 \}}
\DoxyCodeLine{9257 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9258 }
\DoxyCodeLine{9259 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9260 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9261 \{}
\DoxyCodeLine{9262     drflac\_uint64 i;}
\DoxyCodeLine{9263     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9264     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9265     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9266     drflac\_int32 shift = unusedBitsPerSample;}
\DoxyCodeLine{9267     int32x4\_t  wbpsShift0\_4; \textcolor{comment}{/* wbps = Wasted Bits Per Sample */}}
\DoxyCodeLine{9268     int32x4\_t  wbpsShift1\_4; \textcolor{comment}{/* wbps = Wasted Bits Per Sample */}}
\DoxyCodeLine{9269     uint32x4\_t one4;}
\DoxyCodeLine{9270 }
\DoxyCodeLine{9271     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9272 }
\DoxyCodeLine{9273     wbpsShift0\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{9274     wbpsShift1\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{9275     one4         = vdupq\_n\_u32(1);}
\DoxyCodeLine{9276 }
\DoxyCodeLine{9277     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{9278         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9279             uint32x4\_t mid;}
\DoxyCodeLine{9280             uint32x4\_t side;}
\DoxyCodeLine{9281             int32x4\_t left;}
\DoxyCodeLine{9282             int32x4\_t right;}
\DoxyCodeLine{9283 }
\DoxyCodeLine{9284             mid   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbpsShift0\_4);}
\DoxyCodeLine{9285             side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbpsShift1\_4);}
\DoxyCodeLine{9286 }
\DoxyCodeLine{9287             mid   = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, one4));}
\DoxyCodeLine{9288 }
\DoxyCodeLine{9289             left  = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vaddq\_u32(mid, side)), 1);}
\DoxyCodeLine{9290             right = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vsubq\_u32(mid, side)), 1);}
\DoxyCodeLine{9291 }
\DoxyCodeLine{9292             drflac\_\_vst2q\_s32(pOutputSamples + i*8, vzipq\_s32(left, right));}
\DoxyCodeLine{9293         \}}
\DoxyCodeLine{9294 }
\DoxyCodeLine{9295         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9296             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9297             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9298 }
\DoxyCodeLine{9299             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9300 }
\DoxyCodeLine{9301             pOutputSamples[i*2+0] = (drflac\_int32)(mid + side) >> 1;}
\DoxyCodeLine{9302             pOutputSamples[i*2+1] = (drflac\_int32)(mid -\/ side) >> 1;}
\DoxyCodeLine{9303         \}}
\DoxyCodeLine{9304     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{9305         int32x4\_t shift4;}
\DoxyCodeLine{9306 }
\DoxyCodeLine{9307         shift -\/= 1;}
\DoxyCodeLine{9308         shift4 = vdupq\_n\_s32(shift);}
\DoxyCodeLine{9309 }
\DoxyCodeLine{9310         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9311             uint32x4\_t mid;}
\DoxyCodeLine{9312             uint32x4\_t side;}
\DoxyCodeLine{9313             int32x4\_t left;}
\DoxyCodeLine{9314             int32x4\_t right;}
\DoxyCodeLine{9315 }
\DoxyCodeLine{9316             mid   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbpsShift0\_4);}
\DoxyCodeLine{9317             side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbpsShift1\_4);}
\DoxyCodeLine{9318 }
\DoxyCodeLine{9319             mid   = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, one4));}
\DoxyCodeLine{9320 }
\DoxyCodeLine{9321             left  = vreinterpretq\_s32\_u32(vshlq\_u32(vaddq\_u32(mid, side), shift4));}
\DoxyCodeLine{9322             right = vreinterpretq\_s32\_u32(vshlq\_u32(vsubq\_u32(mid, side), shift4));}
\DoxyCodeLine{9323 }
\DoxyCodeLine{9324             drflac\_\_vst2q\_s32(pOutputSamples + i*8, vzipq\_s32(left, right));}
\DoxyCodeLine{9325         \}}
\DoxyCodeLine{9326 }
\DoxyCodeLine{9327         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9328             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9329             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9330 }
\DoxyCodeLine{9331             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9332 }
\DoxyCodeLine{9333             pOutputSamples[i*2+0] = (drflac\_int32)((mid + side) << shift);}
\DoxyCodeLine{9334             pOutputSamples[i*2+1] = (drflac\_int32)((mid -\/ side) << shift);}
\DoxyCodeLine{9335         \}}
\DoxyCodeLine{9336     \}}
\DoxyCodeLine{9337 \}}
\DoxyCodeLine{9338 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9339 }
\DoxyCodeLine{9340 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9341 \{}
\DoxyCodeLine{9342 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9343     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9344         drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9345     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9346 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9347     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9348         drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9349     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9350 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9351     \{}
\DoxyCodeLine{9352         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{9353 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9354         drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9355 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9356         drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9357 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9358     \}}
\DoxyCodeLine{9359 \}}
\DoxyCodeLine{9360 }
\DoxyCodeLine{9361 }
\DoxyCodeLine{9362 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9363 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9364 \{}
\DoxyCodeLine{9365     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{9366         pOutputSamples[i*2+0] = (drflac\_int32)((drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample));}
\DoxyCodeLine{9367         pOutputSamples[i*2+1] = (drflac\_int32)((drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample));}
\DoxyCodeLine{9368     \}}
\DoxyCodeLine{9369 \}}
\DoxyCodeLine{9370 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9371 }
\DoxyCodeLine{9372 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9373 \{}
\DoxyCodeLine{9374     drflac\_uint64 i;}
\DoxyCodeLine{9375     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9376     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9377     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9378     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9379     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9380 }
\DoxyCodeLine{9381     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9382         drflac\_uint32 tempL0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{9383         drflac\_uint32 tempL1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{9384         drflac\_uint32 tempL2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{9385         drflac\_uint32 tempL3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{9386 }
\DoxyCodeLine{9387         drflac\_uint32 tempR0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{9388         drflac\_uint32 tempR1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{9389         drflac\_uint32 tempR2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{9390         drflac\_uint32 tempR3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{9391 }
\DoxyCodeLine{9392         pOutputSamples[i*8+0] = (drflac\_int32)tempL0;}
\DoxyCodeLine{9393         pOutputSamples[i*8+1] = (drflac\_int32)tempR0;}
\DoxyCodeLine{9394         pOutputSamples[i*8+2] = (drflac\_int32)tempL1;}
\DoxyCodeLine{9395         pOutputSamples[i*8+3] = (drflac\_int32)tempR1;}
\DoxyCodeLine{9396         pOutputSamples[i*8+4] = (drflac\_int32)tempL2;}
\DoxyCodeLine{9397         pOutputSamples[i*8+5] = (drflac\_int32)tempR2;}
\DoxyCodeLine{9398         pOutputSamples[i*8+6] = (drflac\_int32)tempL3;}
\DoxyCodeLine{9399         pOutputSamples[i*8+7] = (drflac\_int32)tempR3;}
\DoxyCodeLine{9400     \}}
\DoxyCodeLine{9401 }
\DoxyCodeLine{9402     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9403         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0);}
\DoxyCodeLine{9404         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1);}
\DoxyCodeLine{9405     \}}
\DoxyCodeLine{9406 \}}
\DoxyCodeLine{9407 }
\DoxyCodeLine{9408 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9409 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9410 \{}
\DoxyCodeLine{9411     drflac\_uint64 i;}
\DoxyCodeLine{9412     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9413     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9414     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9415     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9416     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9417 }
\DoxyCodeLine{9418     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9419         \_\_m128i left  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{9420         \_\_m128i right = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{9421 }
\DoxyCodeLine{9422         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 0), \_mm\_unpacklo\_epi32(left, right));}
\DoxyCodeLine{9423         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8 + 4), \_mm\_unpackhi\_epi32(left, right));}
\DoxyCodeLine{9424     \}}
\DoxyCodeLine{9425 }
\DoxyCodeLine{9426     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9427         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0);}
\DoxyCodeLine{9428         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1);}
\DoxyCodeLine{9429     \}}
\DoxyCodeLine{9430 \}}
\DoxyCodeLine{9431 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9432 }
\DoxyCodeLine{9433 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9434 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9435 \{}
\DoxyCodeLine{9436     drflac\_uint64 i;}
\DoxyCodeLine{9437     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9438     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9439     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9440     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9441     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9442 }
\DoxyCodeLine{9443     int32x4\_t shift4\_0 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{9444     int32x4\_t shift4\_1 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{9445 }
\DoxyCodeLine{9446     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9447         int32x4\_t left;}
\DoxyCodeLine{9448         int32x4\_t right;}
\DoxyCodeLine{9449 }
\DoxyCodeLine{9450         left  = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift4\_0));}
\DoxyCodeLine{9451         right = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift4\_1));}
\DoxyCodeLine{9452 }
\DoxyCodeLine{9453         drflac\_\_vst2q\_s32(pOutputSamples + i*8, vzipq\_s32(left, right));}
\DoxyCodeLine{9454     \}}
\DoxyCodeLine{9455 }
\DoxyCodeLine{9456     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9457         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0);}
\DoxyCodeLine{9458         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1);}
\DoxyCodeLine{9459     \}}
\DoxyCodeLine{9460 \}}
\DoxyCodeLine{9461 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9462 }
\DoxyCodeLine{9463 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int32* pOutputSamples)}
\DoxyCodeLine{9464 \{}
\DoxyCodeLine{9465 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9466     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9467         drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9468     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9469 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9470     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9471         drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9472     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9473 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9474     \{}
\DoxyCodeLine{9475         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{9476 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9477         drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9478 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9479         drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9480 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9481     \}}
\DoxyCodeLine{9482 \}}
\DoxyCodeLine{9483 }
\DoxyCodeLine{9484 }
\DoxyCodeLine{9485 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_s32(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, drflac\_int32* pBufferOut)}
\DoxyCodeLine{9486 \{}
\DoxyCodeLine{9487     drflac\_uint64 framesRead;}
\DoxyCodeLine{9488     drflac\_uint32 unusedBitsPerSample;}
\DoxyCodeLine{9489 }
\DoxyCodeLine{9490     \textcolor{keywordflow}{if} (pFlac == NULL || framesToRead == 0) \{}
\DoxyCodeLine{9491         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{9492     \}}
\DoxyCodeLine{9493 }
\DoxyCodeLine{9494     \textcolor{keywordflow}{if} (pBufferOut == NULL) \{}
\DoxyCodeLine{9495         \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, framesToRead);}
\DoxyCodeLine{9496     \}}
\DoxyCodeLine{9497 }
\DoxyCodeLine{9498     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 32);}
\DoxyCodeLine{9499     unusedBitsPerSample = 32 -\/ pFlac-\/>bitsPerSample;}
\DoxyCodeLine{9500 }
\DoxyCodeLine{9501     framesRead = 0;}
\DoxyCodeLine{9502     \textcolor{keywordflow}{while} (framesToRead > 0) \{}
\DoxyCodeLine{9503         \textcolor{comment}{/* If we've run out of samples in this frame, go to the next. */}}
\DoxyCodeLine{9504         \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{9505             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac)) \{}
\DoxyCodeLine{9506                 \textcolor{keywordflow}{break};  \textcolor{comment}{/* Couldn't read the next frame, so just break from the loop and return. */}}
\DoxyCodeLine{9507             \}}
\DoxyCodeLine{9508         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{9509             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} channelCount = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pFlac-\/>currentFLACFrame.header.channelAssignment);}
\DoxyCodeLine{9510             drflac\_uint64 iFirstPCMFrame = pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames -\/ pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{9511             drflac\_uint64 frameCountThisIteration = framesToRead;}
\DoxyCodeLine{9512 }
\DoxyCodeLine{9513             \textcolor{keywordflow}{if} (frameCountThisIteration > pFlac-\/>currentFLACFrame.pcmFramesRemaining) \{}
\DoxyCodeLine{9514                 frameCountThisIteration = pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{9515             \}}
\DoxyCodeLine{9516 }
\DoxyCodeLine{9517             \textcolor{keywordflow}{if} (channelCount == 2) \{}
\DoxyCodeLine{9518                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples0 = pFlac-\/>currentFLACFrame.subframes[0].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{9519                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples1 = pFlac-\/>currentFLACFrame.subframes[1].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{9520 }
\DoxyCodeLine{9521                 \textcolor{keywordflow}{switch} (pFlac-\/>currentFLACFrame.header.channelAssignment)}
\DoxyCodeLine{9522                 \{}
\DoxyCodeLine{9523                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE:}
\DoxyCodeLine{9524                     \{}
\DoxyCodeLine{9525                         drflac\_read\_pcm\_frames\_s32\_\_decode\_left\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{9526                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{9527 }
\DoxyCodeLine{9528                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE:}
\DoxyCodeLine{9529                     \{}
\DoxyCodeLine{9530                         drflac\_read\_pcm\_frames\_s32\_\_decode\_right\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{9531                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{9532 }
\DoxyCodeLine{9533                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE:}
\DoxyCodeLine{9534                     \{}
\DoxyCodeLine{9535                         drflac\_read\_pcm\_frames\_s32\_\_decode\_mid\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{9536                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{9537 }
\DoxyCodeLine{9538                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_INDEPENDENT:}
\DoxyCodeLine{9539                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{9540                     \{}
\DoxyCodeLine{9541                         drflac\_read\_pcm\_frames\_s32\_\_decode\_independent\_stereo(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{9542                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{9543                 \}}
\DoxyCodeLine{9544             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{9545                 \textcolor{comment}{/* Generic interleaving. */}}
\DoxyCodeLine{9546                 drflac\_uint64 i;}
\DoxyCodeLine{9547                 \textcolor{keywordflow}{for} (i = 0; i < frameCountThisIteration; ++i) \{}
\DoxyCodeLine{9548                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{9549                     \textcolor{keywordflow}{for} (j = 0; j < channelCount; ++j) \{}
\DoxyCodeLine{9550                         pBufferOut[(i*channelCount)+j] = (drflac\_int32)((drflac\_uint32)(pFlac-\/>currentFLACFrame.subframes[j].pSamplesS32[iFirstPCMFrame + i]) << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[j].wastedBitsPerSample));}
\DoxyCodeLine{9551                     \}}
\DoxyCodeLine{9552                 \}}
\DoxyCodeLine{9553             \}}
\DoxyCodeLine{9554 }
\DoxyCodeLine{9555             framesRead                += frameCountThisIteration;}
\DoxyCodeLine{9556             pBufferOut                += frameCountThisIteration * channelCount;}
\DoxyCodeLine{9557             framesToRead              -\/= frameCountThisIteration;}
\DoxyCodeLine{9558             pFlac-\/>currentPCMFrame    += frameCountThisIteration;}
\DoxyCodeLine{9559             pFlac-\/>currentFLACFrame.pcmFramesRemaining -\/= (drflac\_uint32)frameCountThisIteration;}
\DoxyCodeLine{9560         \}}
\DoxyCodeLine{9561     \}}
\DoxyCodeLine{9562 }
\DoxyCodeLine{9563     \textcolor{keywordflow}{return} framesRead;}
\DoxyCodeLine{9564 \}}
\DoxyCodeLine{9565 }
\DoxyCodeLine{9566 }
\DoxyCodeLine{9567 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9568 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9569 \{}
\DoxyCodeLine{9570     drflac\_uint64 i;}
\DoxyCodeLine{9571     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{9572         drflac\_uint32 left  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{9573         drflac\_uint32 side  = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{9574         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{9575 }
\DoxyCodeLine{9576         left  >>= 16;}
\DoxyCodeLine{9577         right >>= 16;}
\DoxyCodeLine{9578 }
\DoxyCodeLine{9579         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9580         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9581     \}}
\DoxyCodeLine{9582 \}}
\DoxyCodeLine{9583 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9584 }
\DoxyCodeLine{9585 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9586 \{}
\DoxyCodeLine{9587     drflac\_uint64 i;}
\DoxyCodeLine{9588     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9589     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9590     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9591     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9592     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9593 }
\DoxyCodeLine{9594     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9595         drflac\_uint32 left0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{9596         drflac\_uint32 left1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{9597         drflac\_uint32 left2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{9598         drflac\_uint32 left3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{9599 }
\DoxyCodeLine{9600         drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{9601         drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{9602         drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{9603         drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{9604 }
\DoxyCodeLine{9605         drflac\_uint32 right0 = left0 -\/ side0;}
\DoxyCodeLine{9606         drflac\_uint32 right1 = left1 -\/ side1;}
\DoxyCodeLine{9607         drflac\_uint32 right2 = left2 -\/ side2;}
\DoxyCodeLine{9608         drflac\_uint32 right3 = left3 -\/ side3;}
\DoxyCodeLine{9609 }
\DoxyCodeLine{9610         left0  >>= 16;}
\DoxyCodeLine{9611         left1  >>= 16;}
\DoxyCodeLine{9612         left2  >>= 16;}
\DoxyCodeLine{9613         left3  >>= 16;}
\DoxyCodeLine{9614 }
\DoxyCodeLine{9615         right0 >>= 16;}
\DoxyCodeLine{9616         right1 >>= 16;}
\DoxyCodeLine{9617         right2 >>= 16;}
\DoxyCodeLine{9618         right3 >>= 16;}
\DoxyCodeLine{9619 }
\DoxyCodeLine{9620         pOutputSamples[i*8+0] = (drflac\_int16)left0;}
\DoxyCodeLine{9621         pOutputSamples[i*8+1] = (drflac\_int16)right0;}
\DoxyCodeLine{9622         pOutputSamples[i*8+2] = (drflac\_int16)left1;}
\DoxyCodeLine{9623         pOutputSamples[i*8+3] = (drflac\_int16)right1;}
\DoxyCodeLine{9624         pOutputSamples[i*8+4] = (drflac\_int16)left2;}
\DoxyCodeLine{9625         pOutputSamples[i*8+5] = (drflac\_int16)right2;}
\DoxyCodeLine{9626         pOutputSamples[i*8+6] = (drflac\_int16)left3;}
\DoxyCodeLine{9627         pOutputSamples[i*8+7] = (drflac\_int16)right3;}
\DoxyCodeLine{9628     \}}
\DoxyCodeLine{9629 }
\DoxyCodeLine{9630     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9631         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9632         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9633         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{9634 }
\DoxyCodeLine{9635         left  >>= 16;}
\DoxyCodeLine{9636         right >>= 16;}
\DoxyCodeLine{9637 }
\DoxyCodeLine{9638         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9639         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9640     \}}
\DoxyCodeLine{9641 \}}
\DoxyCodeLine{9642 }
\DoxyCodeLine{9643 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9644 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9645 \{}
\DoxyCodeLine{9646     drflac\_uint64 i;}
\DoxyCodeLine{9647     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9648     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9649     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9650     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9651     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9652 }
\DoxyCodeLine{9653     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9654 }
\DoxyCodeLine{9655     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9656         \_\_m128i left  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{9657         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{9658         \_\_m128i right = \_mm\_sub\_epi32(left, side);}
\DoxyCodeLine{9659 }
\DoxyCodeLine{9660         left  = \_mm\_srai\_epi32(left,  16);}
\DoxyCodeLine{9661         right = \_mm\_srai\_epi32(right, 16);}
\DoxyCodeLine{9662 }
\DoxyCodeLine{9663         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8), drflac\_\_mm\_packs\_interleaved\_epi32(left, right));}
\DoxyCodeLine{9664     \}}
\DoxyCodeLine{9665 }
\DoxyCodeLine{9666     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9667         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9668         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9669         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{9670 }
\DoxyCodeLine{9671         left  >>= 16;}
\DoxyCodeLine{9672         right >>= 16;}
\DoxyCodeLine{9673 }
\DoxyCodeLine{9674         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9675         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9676     \}}
\DoxyCodeLine{9677 \}}
\DoxyCodeLine{9678 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9679 }
\DoxyCodeLine{9680 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9681 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9682 \{}
\DoxyCodeLine{9683     drflac\_uint64 i;}
\DoxyCodeLine{9684     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9685     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9686     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9687     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9688     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9689     int32x4\_t shift0\_4;}
\DoxyCodeLine{9690     int32x4\_t shift1\_4;}
\DoxyCodeLine{9691 }
\DoxyCodeLine{9692     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9693 }
\DoxyCodeLine{9694     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{9695     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{9696 }
\DoxyCodeLine{9697     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9698         uint32x4\_t left;}
\DoxyCodeLine{9699         uint32x4\_t side;}
\DoxyCodeLine{9700         uint32x4\_t right;}
\DoxyCodeLine{9701 }
\DoxyCodeLine{9702         left  = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{9703         side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{9704         right = vsubq\_u32(left, side);}
\DoxyCodeLine{9705 }
\DoxyCodeLine{9706         left  = vshrq\_n\_u32(left,  16);}
\DoxyCodeLine{9707         right = vshrq\_n\_u32(right, 16);}
\DoxyCodeLine{9708 }
\DoxyCodeLine{9709         drflac\_\_vst2q\_u16((drflac\_uint16*)pOutputSamples + i*8, vzip\_u16(vmovn\_u32(left), vmovn\_u32(right)));}
\DoxyCodeLine{9710     \}}
\DoxyCodeLine{9711 }
\DoxyCodeLine{9712     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9713         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9714         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9715         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{9716 }
\DoxyCodeLine{9717         left  >>= 16;}
\DoxyCodeLine{9718         right >>= 16;}
\DoxyCodeLine{9719 }
\DoxyCodeLine{9720         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9721         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9722     \}}
\DoxyCodeLine{9723 \}}
\DoxyCodeLine{9724 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9725 }
\DoxyCodeLine{9726 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9727 \{}
\DoxyCodeLine{9728 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9729     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9730         drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9731     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9732 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9733     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9734         drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9735     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9736 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9737     \{}
\DoxyCodeLine{9738         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{9739 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9740         drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9741 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9742         drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9743 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9744     \}}
\DoxyCodeLine{9745 \}}
\DoxyCodeLine{9746 }
\DoxyCodeLine{9747 }
\DoxyCodeLine{9748 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9749 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9750 \{}
\DoxyCodeLine{9751     drflac\_uint64 i;}
\DoxyCodeLine{9752     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{9753         drflac\_uint32 side  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{9754         drflac\_uint32 right = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{9755         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{9756 }
\DoxyCodeLine{9757         left  >>= 16;}
\DoxyCodeLine{9758         right >>= 16;}
\DoxyCodeLine{9759 }
\DoxyCodeLine{9760         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9761         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9762     \}}
\DoxyCodeLine{9763 \}}
\DoxyCodeLine{9764 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9765 }
\DoxyCodeLine{9766 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9767 \{}
\DoxyCodeLine{9768     drflac\_uint64 i;}
\DoxyCodeLine{9769     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9770     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9771     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9772     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9773     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9774 }
\DoxyCodeLine{9775     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9776         drflac\_uint32 side0  = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{9777         drflac\_uint32 side1  = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{9778         drflac\_uint32 side2  = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{9779         drflac\_uint32 side3  = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{9780 }
\DoxyCodeLine{9781         drflac\_uint32 right0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{9782         drflac\_uint32 right1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{9783         drflac\_uint32 right2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{9784         drflac\_uint32 right3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{9785 }
\DoxyCodeLine{9786         drflac\_uint32 left0 = right0 + side0;}
\DoxyCodeLine{9787         drflac\_uint32 left1 = right1 + side1;}
\DoxyCodeLine{9788         drflac\_uint32 left2 = right2 + side2;}
\DoxyCodeLine{9789         drflac\_uint32 left3 = right3 + side3;}
\DoxyCodeLine{9790 }
\DoxyCodeLine{9791         left0  >>= 16;}
\DoxyCodeLine{9792         left1  >>= 16;}
\DoxyCodeLine{9793         left2  >>= 16;}
\DoxyCodeLine{9794         left3  >>= 16;}
\DoxyCodeLine{9795 }
\DoxyCodeLine{9796         right0 >>= 16;}
\DoxyCodeLine{9797         right1 >>= 16;}
\DoxyCodeLine{9798         right2 >>= 16;}
\DoxyCodeLine{9799         right3 >>= 16;}
\DoxyCodeLine{9800 }
\DoxyCodeLine{9801         pOutputSamples[i*8+0] = (drflac\_int16)left0;}
\DoxyCodeLine{9802         pOutputSamples[i*8+1] = (drflac\_int16)right0;}
\DoxyCodeLine{9803         pOutputSamples[i*8+2] = (drflac\_int16)left1;}
\DoxyCodeLine{9804         pOutputSamples[i*8+3] = (drflac\_int16)right1;}
\DoxyCodeLine{9805         pOutputSamples[i*8+4] = (drflac\_int16)left2;}
\DoxyCodeLine{9806         pOutputSamples[i*8+5] = (drflac\_int16)right2;}
\DoxyCodeLine{9807         pOutputSamples[i*8+6] = (drflac\_int16)left3;}
\DoxyCodeLine{9808         pOutputSamples[i*8+7] = (drflac\_int16)right3;}
\DoxyCodeLine{9809     \}}
\DoxyCodeLine{9810 }
\DoxyCodeLine{9811     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9812         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9813         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9814         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{9815 }
\DoxyCodeLine{9816         left  >>= 16;}
\DoxyCodeLine{9817         right >>= 16;}
\DoxyCodeLine{9818 }
\DoxyCodeLine{9819         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9820         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9821     \}}
\DoxyCodeLine{9822 \}}
\DoxyCodeLine{9823 }
\DoxyCodeLine{9824 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9825 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9826 \{}
\DoxyCodeLine{9827     drflac\_uint64 i;}
\DoxyCodeLine{9828     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9829     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9830     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9831     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9832     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9833 }
\DoxyCodeLine{9834     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9835 }
\DoxyCodeLine{9836     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9837         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{9838         \_\_m128i right = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{9839         \_\_m128i left  = \_mm\_add\_epi32(right, side);}
\DoxyCodeLine{9840 }
\DoxyCodeLine{9841         left  = \_mm\_srai\_epi32(left,  16);}
\DoxyCodeLine{9842         right = \_mm\_srai\_epi32(right, 16);}
\DoxyCodeLine{9843 }
\DoxyCodeLine{9844         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8), drflac\_\_mm\_packs\_interleaved\_epi32(left, right));}
\DoxyCodeLine{9845     \}}
\DoxyCodeLine{9846 }
\DoxyCodeLine{9847     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9848         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9849         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9850         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{9851 }
\DoxyCodeLine{9852         left  >>= 16;}
\DoxyCodeLine{9853         right >>= 16;}
\DoxyCodeLine{9854 }
\DoxyCodeLine{9855         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9856         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9857     \}}
\DoxyCodeLine{9858 \}}
\DoxyCodeLine{9859 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9860 }
\DoxyCodeLine{9861 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9862 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9863 \{}
\DoxyCodeLine{9864     drflac\_uint64 i;}
\DoxyCodeLine{9865     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9866     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9867     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9868     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9869     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9870     int32x4\_t shift0\_4;}
\DoxyCodeLine{9871     int32x4\_t shift1\_4;}
\DoxyCodeLine{9872 }
\DoxyCodeLine{9873     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{9874 }
\DoxyCodeLine{9875     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{9876     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{9877 }
\DoxyCodeLine{9878     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9879         uint32x4\_t side;}
\DoxyCodeLine{9880         uint32x4\_t right;}
\DoxyCodeLine{9881         uint32x4\_t left;}
\DoxyCodeLine{9882 }
\DoxyCodeLine{9883         side  = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{9884         right = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{9885         left  = vaddq\_u32(right, side);}
\DoxyCodeLine{9886 }
\DoxyCodeLine{9887         left  = vshrq\_n\_u32(left,  16);}
\DoxyCodeLine{9888         right = vshrq\_n\_u32(right, 16);}
\DoxyCodeLine{9889 }
\DoxyCodeLine{9890         drflac\_\_vst2q\_u16((drflac\_uint16*)pOutputSamples + i*8, vzip\_u16(vmovn\_u32(left), vmovn\_u32(right)));}
\DoxyCodeLine{9891     \}}
\DoxyCodeLine{9892 }
\DoxyCodeLine{9893     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{9894         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{9895         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{9896         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{9897 }
\DoxyCodeLine{9898         left  >>= 16;}
\DoxyCodeLine{9899         right >>= 16;}
\DoxyCodeLine{9900 }
\DoxyCodeLine{9901         pOutputSamples[i*2+0] = (drflac\_int16)left;}
\DoxyCodeLine{9902         pOutputSamples[i*2+1] = (drflac\_int16)right;}
\DoxyCodeLine{9903     \}}
\DoxyCodeLine{9904 \}}
\DoxyCodeLine{9905 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9906 }
\DoxyCodeLine{9907 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9908 \{}
\DoxyCodeLine{9909 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{9910     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9911         drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9912     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9913 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{9914     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{9915         drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9916     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{9917 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9918     \{}
\DoxyCodeLine{9919         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{9920 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9921         drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9922 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9923         drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{9924 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9925     \}}
\DoxyCodeLine{9926 \}}
\DoxyCodeLine{9927 }
\DoxyCodeLine{9928 }
\DoxyCodeLine{9929 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{9930 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9931 \{}
\DoxyCodeLine{9932     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{9933         drflac\_uint32 mid  = (drflac\_uint32)pInputSamples0[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9934         drflac\_uint32 side = (drflac\_uint32)pInputSamples1[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9935 }
\DoxyCodeLine{9936         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{9937 }
\DoxyCodeLine{9938         pOutputSamples[i*2+0] = (drflac\_int16)(((drflac\_uint32)((drflac\_int32)(mid + side) >> 1) << unusedBitsPerSample) >> 16);}
\DoxyCodeLine{9939         pOutputSamples[i*2+1] = (drflac\_int16)(((drflac\_uint32)((drflac\_int32)(mid -\/ side) >> 1) << unusedBitsPerSample) >> 16);}
\DoxyCodeLine{9940     \}}
\DoxyCodeLine{9941 \}}
\DoxyCodeLine{9942 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9943 }
\DoxyCodeLine{9944 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{9945 \{}
\DoxyCodeLine{9946     drflac\_uint64 i;}
\DoxyCodeLine{9947     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{9948     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{9949     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{9950     drflac\_uint32 shift = unusedBitsPerSample;}
\DoxyCodeLine{9951 }
\DoxyCodeLine{9952     \textcolor{keywordflow}{if} (shift > 0) \{}
\DoxyCodeLine{9953         shift -\/= 1;}
\DoxyCodeLine{9954         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{9955             drflac\_uint32 temp0L;}
\DoxyCodeLine{9956             drflac\_uint32 temp1L;}
\DoxyCodeLine{9957             drflac\_uint32 temp2L;}
\DoxyCodeLine{9958             drflac\_uint32 temp3L;}
\DoxyCodeLine{9959             drflac\_uint32 temp0R;}
\DoxyCodeLine{9960             drflac\_uint32 temp1R;}
\DoxyCodeLine{9961             drflac\_uint32 temp2R;}
\DoxyCodeLine{9962             drflac\_uint32 temp3R;}
\DoxyCodeLine{9963 }
\DoxyCodeLine{9964             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9965             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9966             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9967             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{9968 }
\DoxyCodeLine{9969             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9970             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9971             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9972             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{9973 }
\DoxyCodeLine{9974             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{9975             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{9976             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{9977             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{9978 }
\DoxyCodeLine{9979             temp0L = (mid0 + side0) << shift;}
\DoxyCodeLine{9980             temp1L = (mid1 + side1) << shift;}
\DoxyCodeLine{9981             temp2L = (mid2 + side2) << shift;}
\DoxyCodeLine{9982             temp3L = (mid3 + side3) << shift;}
\DoxyCodeLine{9983 }
\DoxyCodeLine{9984             temp0R = (mid0 -\/ side0) << shift;}
\DoxyCodeLine{9985             temp1R = (mid1 -\/ side1) << shift;}
\DoxyCodeLine{9986             temp2R = (mid2 -\/ side2) << shift;}
\DoxyCodeLine{9987             temp3R = (mid3 -\/ side3) << shift;}
\DoxyCodeLine{9988 }
\DoxyCodeLine{9989             temp0L >>= 16;}
\DoxyCodeLine{9990             temp1L >>= 16;}
\DoxyCodeLine{9991             temp2L >>= 16;}
\DoxyCodeLine{9992             temp3L >>= 16;}
\DoxyCodeLine{9993 }
\DoxyCodeLine{9994             temp0R >>= 16;}
\DoxyCodeLine{9995             temp1R >>= 16;}
\DoxyCodeLine{9996             temp2R >>= 16;}
\DoxyCodeLine{9997             temp3R >>= 16;}
\DoxyCodeLine{9998 }
\DoxyCodeLine{9999             pOutputSamples[i*8+0] = (drflac\_int16)temp0L;}
\DoxyCodeLine{10000             pOutputSamples[i*8+1] = (drflac\_int16)temp0R;}
\DoxyCodeLine{10001             pOutputSamples[i*8+2] = (drflac\_int16)temp1L;}
\DoxyCodeLine{10002             pOutputSamples[i*8+3] = (drflac\_int16)temp1R;}
\DoxyCodeLine{10003             pOutputSamples[i*8+4] = (drflac\_int16)temp2L;}
\DoxyCodeLine{10004             pOutputSamples[i*8+5] = (drflac\_int16)temp2R;}
\DoxyCodeLine{10005             pOutputSamples[i*8+6] = (drflac\_int16)temp3L;}
\DoxyCodeLine{10006             pOutputSamples[i*8+7] = (drflac\_int16)temp3R;}
\DoxyCodeLine{10007         \}}
\DoxyCodeLine{10008     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10009         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10010             drflac\_uint32 temp0L;}
\DoxyCodeLine{10011             drflac\_uint32 temp1L;}
\DoxyCodeLine{10012             drflac\_uint32 temp2L;}
\DoxyCodeLine{10013             drflac\_uint32 temp3L;}
\DoxyCodeLine{10014             drflac\_uint32 temp0R;}
\DoxyCodeLine{10015             drflac\_uint32 temp1R;}
\DoxyCodeLine{10016             drflac\_uint32 temp2R;}
\DoxyCodeLine{10017             drflac\_uint32 temp3R;}
\DoxyCodeLine{10018 }
\DoxyCodeLine{10019             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10020             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10021             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10022             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10023 }
\DoxyCodeLine{10024             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10025             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10026             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10027             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10028 }
\DoxyCodeLine{10029             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{10030             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{10031             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{10032             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{10033 }
\DoxyCodeLine{10034             temp0L = ((drflac\_int32)(mid0 + side0) >> 1);}
\DoxyCodeLine{10035             temp1L = ((drflac\_int32)(mid1 + side1) >> 1);}
\DoxyCodeLine{10036             temp2L = ((drflac\_int32)(mid2 + side2) >> 1);}
\DoxyCodeLine{10037             temp3L = ((drflac\_int32)(mid3 + side3) >> 1);}
\DoxyCodeLine{10038 }
\DoxyCodeLine{10039             temp0R = ((drflac\_int32)(mid0 -\/ side0) >> 1);}
\DoxyCodeLine{10040             temp1R = ((drflac\_int32)(mid1 -\/ side1) >> 1);}
\DoxyCodeLine{10041             temp2R = ((drflac\_int32)(mid2 -\/ side2) >> 1);}
\DoxyCodeLine{10042             temp3R = ((drflac\_int32)(mid3 -\/ side3) >> 1);}
\DoxyCodeLine{10043 }
\DoxyCodeLine{10044             temp0L >>= 16;}
\DoxyCodeLine{10045             temp1L >>= 16;}
\DoxyCodeLine{10046             temp2L >>= 16;}
\DoxyCodeLine{10047             temp3L >>= 16;}
\DoxyCodeLine{10048 }
\DoxyCodeLine{10049             temp0R >>= 16;}
\DoxyCodeLine{10050             temp1R >>= 16;}
\DoxyCodeLine{10051             temp2R >>= 16;}
\DoxyCodeLine{10052             temp3R >>= 16;}
\DoxyCodeLine{10053 }
\DoxyCodeLine{10054             pOutputSamples[i*8+0] = (drflac\_int16)temp0L;}
\DoxyCodeLine{10055             pOutputSamples[i*8+1] = (drflac\_int16)temp0R;}
\DoxyCodeLine{10056             pOutputSamples[i*8+2] = (drflac\_int16)temp1L;}
\DoxyCodeLine{10057             pOutputSamples[i*8+3] = (drflac\_int16)temp1R;}
\DoxyCodeLine{10058             pOutputSamples[i*8+4] = (drflac\_int16)temp2L;}
\DoxyCodeLine{10059             pOutputSamples[i*8+5] = (drflac\_int16)temp2R;}
\DoxyCodeLine{10060             pOutputSamples[i*8+6] = (drflac\_int16)temp3L;}
\DoxyCodeLine{10061             pOutputSamples[i*8+7] = (drflac\_int16)temp3R;}
\DoxyCodeLine{10062         \}}
\DoxyCodeLine{10063     \}}
\DoxyCodeLine{10064 }
\DoxyCodeLine{10065     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10066         drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10067         drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10068 }
\DoxyCodeLine{10069         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10070 }
\DoxyCodeLine{10071         pOutputSamples[i*2+0] = (drflac\_int16)(((drflac\_uint32)((drflac\_int32)(mid + side) >> 1) << unusedBitsPerSample) >> 16);}
\DoxyCodeLine{10072         pOutputSamples[i*2+1] = (drflac\_int16)(((drflac\_uint32)((drflac\_int32)(mid -\/ side) >> 1) << unusedBitsPerSample) >> 16);}
\DoxyCodeLine{10073     \}}
\DoxyCodeLine{10074 \}}
\DoxyCodeLine{10075 }
\DoxyCodeLine{10076 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10077 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10078 \{}
\DoxyCodeLine{10079     drflac\_uint64 i;}
\DoxyCodeLine{10080     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10081     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10082     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10083     drflac\_uint32 shift = unusedBitsPerSample;}
\DoxyCodeLine{10084 }
\DoxyCodeLine{10085     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10086 }
\DoxyCodeLine{10087     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{10088         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10089             \_\_m128i mid;}
\DoxyCodeLine{10090             \_\_m128i side;}
\DoxyCodeLine{10091             \_\_m128i left;}
\DoxyCodeLine{10092             \_\_m128i right;}
\DoxyCodeLine{10093 }
\DoxyCodeLine{10094             mid   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10095             side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10096 }
\DoxyCodeLine{10097             mid   = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{10098 }
\DoxyCodeLine{10099             left  = \_mm\_srai\_epi32(\_mm\_add\_epi32(mid, side), 1);}
\DoxyCodeLine{10100             right = \_mm\_srai\_epi32(\_mm\_sub\_epi32(mid, side), 1);}
\DoxyCodeLine{10101 }
\DoxyCodeLine{10102             left  = \_mm\_srai\_epi32(left,  16);}
\DoxyCodeLine{10103             right = \_mm\_srai\_epi32(right, 16);}
\DoxyCodeLine{10104 }
\DoxyCodeLine{10105             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8), drflac\_\_mm\_packs\_interleaved\_epi32(left, right));}
\DoxyCodeLine{10106         \}}
\DoxyCodeLine{10107 }
\DoxyCodeLine{10108         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10109             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10110             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10111 }
\DoxyCodeLine{10112             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10113 }
\DoxyCodeLine{10114             pOutputSamples[i*2+0] = (drflac\_int16)(((drflac\_int32)(mid + side) >> 1) >> 16);}
\DoxyCodeLine{10115             pOutputSamples[i*2+1] = (drflac\_int16)(((drflac\_int32)(mid -\/ side) >> 1) >> 16);}
\DoxyCodeLine{10116         \}}
\DoxyCodeLine{10117     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10118         shift -\/= 1;}
\DoxyCodeLine{10119         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10120             \_\_m128i mid;}
\DoxyCodeLine{10121             \_\_m128i side;}
\DoxyCodeLine{10122             \_\_m128i left;}
\DoxyCodeLine{10123             \_\_m128i right;}
\DoxyCodeLine{10124 }
\DoxyCodeLine{10125             mid   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10126             side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10127 }
\DoxyCodeLine{10128             mid   = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{10129 }
\DoxyCodeLine{10130             left  = \_mm\_slli\_epi32(\_mm\_add\_epi32(mid, side), shift);}
\DoxyCodeLine{10131             right = \_mm\_slli\_epi32(\_mm\_sub\_epi32(mid, side), shift);}
\DoxyCodeLine{10132 }
\DoxyCodeLine{10133             left  = \_mm\_srai\_epi32(left,  16);}
\DoxyCodeLine{10134             right = \_mm\_srai\_epi32(right, 16);}
\DoxyCodeLine{10135 }
\DoxyCodeLine{10136             \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8), drflac\_\_mm\_packs\_interleaved\_epi32(left, right));}
\DoxyCodeLine{10137         \}}
\DoxyCodeLine{10138 }
\DoxyCodeLine{10139         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10140             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10141             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10142 }
\DoxyCodeLine{10143             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10144 }
\DoxyCodeLine{10145             pOutputSamples[i*2+0] = (drflac\_int16)(((mid + side) << shift) >> 16);}
\DoxyCodeLine{10146             pOutputSamples[i*2+1] = (drflac\_int16)(((mid -\/ side) << shift) >> 16);}
\DoxyCodeLine{10147         \}}
\DoxyCodeLine{10148     \}}
\DoxyCodeLine{10149 \}}
\DoxyCodeLine{10150 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10151 }
\DoxyCodeLine{10152 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10153 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10154 \{}
\DoxyCodeLine{10155     drflac\_uint64 i;}
\DoxyCodeLine{10156     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10157     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10158     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10159     drflac\_uint32 shift = unusedBitsPerSample;}
\DoxyCodeLine{10160     int32x4\_t wbpsShift0\_4; \textcolor{comment}{/* wbps = Wasted Bits Per Sample */}}
\DoxyCodeLine{10161     int32x4\_t wbpsShift1\_4; \textcolor{comment}{/* wbps = Wasted Bits Per Sample */}}
\DoxyCodeLine{10162 }
\DoxyCodeLine{10163     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10164 }
\DoxyCodeLine{10165     wbpsShift0\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10166     wbpsShift1\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10167 }
\DoxyCodeLine{10168     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{10169         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10170             uint32x4\_t mid;}
\DoxyCodeLine{10171             uint32x4\_t side;}
\DoxyCodeLine{10172             int32x4\_t left;}
\DoxyCodeLine{10173             int32x4\_t right;}
\DoxyCodeLine{10174 }
\DoxyCodeLine{10175             mid   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbpsShift0\_4);}
\DoxyCodeLine{10176             side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbpsShift1\_4);}
\DoxyCodeLine{10177 }
\DoxyCodeLine{10178             mid   = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, vdupq\_n\_u32(1)));}
\DoxyCodeLine{10179 }
\DoxyCodeLine{10180             left  = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vaddq\_u32(mid, side)), 1);}
\DoxyCodeLine{10181             right = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vsubq\_u32(mid, side)), 1);}
\DoxyCodeLine{10182 }
\DoxyCodeLine{10183             left  = vshrq\_n\_s32(left,  16);}
\DoxyCodeLine{10184             right = vshrq\_n\_s32(right, 16);}
\DoxyCodeLine{10185 }
\DoxyCodeLine{10186             drflac\_\_vst2q\_s16(pOutputSamples + i*8, vzip\_s16(vmovn\_s32(left), vmovn\_s32(right)));}
\DoxyCodeLine{10187         \}}
\DoxyCodeLine{10188 }
\DoxyCodeLine{10189         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10190             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10191             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10192 }
\DoxyCodeLine{10193             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10194 }
\DoxyCodeLine{10195             pOutputSamples[i*2+0] = (drflac\_int16)(((drflac\_int32)(mid + side) >> 1) >> 16);}
\DoxyCodeLine{10196             pOutputSamples[i*2+1] = (drflac\_int16)(((drflac\_int32)(mid -\/ side) >> 1) >> 16);}
\DoxyCodeLine{10197         \}}
\DoxyCodeLine{10198     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10199         int32x4\_t shift4;}
\DoxyCodeLine{10200 }
\DoxyCodeLine{10201         shift -\/= 1;}
\DoxyCodeLine{10202         shift4 = vdupq\_n\_s32(shift);}
\DoxyCodeLine{10203 }
\DoxyCodeLine{10204         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10205             uint32x4\_t mid;}
\DoxyCodeLine{10206             uint32x4\_t side;}
\DoxyCodeLine{10207             int32x4\_t left;}
\DoxyCodeLine{10208             int32x4\_t right;}
\DoxyCodeLine{10209 }
\DoxyCodeLine{10210             mid   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbpsShift0\_4);}
\DoxyCodeLine{10211             side  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbpsShift1\_4);}
\DoxyCodeLine{10212 }
\DoxyCodeLine{10213             mid   = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, vdupq\_n\_u32(1)));}
\DoxyCodeLine{10214 }
\DoxyCodeLine{10215             left  = vreinterpretq\_s32\_u32(vshlq\_u32(vaddq\_u32(mid, side), shift4));}
\DoxyCodeLine{10216             right = vreinterpretq\_s32\_u32(vshlq\_u32(vsubq\_u32(mid, side), shift4));}
\DoxyCodeLine{10217 }
\DoxyCodeLine{10218             left  = vshrq\_n\_s32(left,  16);}
\DoxyCodeLine{10219             right = vshrq\_n\_s32(right, 16);}
\DoxyCodeLine{10220 }
\DoxyCodeLine{10221             drflac\_\_vst2q\_s16(pOutputSamples + i*8, vzip\_s16(vmovn\_s32(left), vmovn\_s32(right)));}
\DoxyCodeLine{10222         \}}
\DoxyCodeLine{10223 }
\DoxyCodeLine{10224         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10225             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10226             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10227 }
\DoxyCodeLine{10228             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10229 }
\DoxyCodeLine{10230             pOutputSamples[i*2+0] = (drflac\_int16)(((mid + side) << shift) >> 16);}
\DoxyCodeLine{10231             pOutputSamples[i*2+1] = (drflac\_int16)(((mid -\/ side) << shift) >> 16);}
\DoxyCodeLine{10232         \}}
\DoxyCodeLine{10233     \}}
\DoxyCodeLine{10234 \}}
\DoxyCodeLine{10235 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10236 }
\DoxyCodeLine{10237 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10238 \{}
\DoxyCodeLine{10239 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10240     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10241         drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10242     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10243 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10244     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10245         drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10246     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10248     \{}
\DoxyCodeLine{10249         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{10250 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10251         drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10252 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10253         drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10254 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10255     \}}
\DoxyCodeLine{10256 \}}
\DoxyCodeLine{10257 }
\DoxyCodeLine{10258 }
\DoxyCodeLine{10259 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10260 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10261 \{}
\DoxyCodeLine{10262     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{10263         pOutputSamples[i*2+0] = (drflac\_int16)((drflac\_int32)((drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample)) >> 16);}
\DoxyCodeLine{10264         pOutputSamples[i*2+1] = (drflac\_int16)((drflac\_int32)((drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample)) >> 16);}
\DoxyCodeLine{10265     \}}
\DoxyCodeLine{10266 \}}
\DoxyCodeLine{10267 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10268 }
\DoxyCodeLine{10269 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10270 \{}
\DoxyCodeLine{10271     drflac\_uint64 i;}
\DoxyCodeLine{10272     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10273     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10274     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10275     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10276     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10277 }
\DoxyCodeLine{10278     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10279         drflac\_uint32 tempL0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{10280         drflac\_uint32 tempL1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{10281         drflac\_uint32 tempL2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{10282         drflac\_uint32 tempL3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{10283 }
\DoxyCodeLine{10284         drflac\_uint32 tempR0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{10285         drflac\_uint32 tempR1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{10286         drflac\_uint32 tempR2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{10287         drflac\_uint32 tempR3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{10288 }
\DoxyCodeLine{10289         tempL0 >>= 16;}
\DoxyCodeLine{10290         tempL1 >>= 16;}
\DoxyCodeLine{10291         tempL2 >>= 16;}
\DoxyCodeLine{10292         tempL3 >>= 16;}
\DoxyCodeLine{10293 }
\DoxyCodeLine{10294         tempR0 >>= 16;}
\DoxyCodeLine{10295         tempR1 >>= 16;}
\DoxyCodeLine{10296         tempR2 >>= 16;}
\DoxyCodeLine{10297         tempR3 >>= 16;}
\DoxyCodeLine{10298 }
\DoxyCodeLine{10299         pOutputSamples[i*8+0] = (drflac\_int16)tempL0;}
\DoxyCodeLine{10300         pOutputSamples[i*8+1] = (drflac\_int16)tempR0;}
\DoxyCodeLine{10301         pOutputSamples[i*8+2] = (drflac\_int16)tempL1;}
\DoxyCodeLine{10302         pOutputSamples[i*8+3] = (drflac\_int16)tempR1;}
\DoxyCodeLine{10303         pOutputSamples[i*8+4] = (drflac\_int16)tempL2;}
\DoxyCodeLine{10304         pOutputSamples[i*8+5] = (drflac\_int16)tempR2;}
\DoxyCodeLine{10305         pOutputSamples[i*8+6] = (drflac\_int16)tempL3;}
\DoxyCodeLine{10306         pOutputSamples[i*8+7] = (drflac\_int16)tempR3;}
\DoxyCodeLine{10307     \}}
\DoxyCodeLine{10308 }
\DoxyCodeLine{10309     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10310         pOutputSamples[i*2+0] = (drflac\_int16)((pInputSamples0U32[i] << shift0) >> 16);}
\DoxyCodeLine{10311         pOutputSamples[i*2+1] = (drflac\_int16)((pInputSamples1U32[i] << shift1) >> 16);}
\DoxyCodeLine{10312     \}}
\DoxyCodeLine{10313 \}}
\DoxyCodeLine{10314 }
\DoxyCodeLine{10315 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10316 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10317 \{}
\DoxyCodeLine{10318     drflac\_uint64 i;}
\DoxyCodeLine{10319     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10320     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10321     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10322     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10323     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10324 }
\DoxyCodeLine{10325     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10326         \_\_m128i left  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{10327         \_\_m128i right = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{10328 }
\DoxyCodeLine{10329         left  = \_mm\_srai\_epi32(left,  16);}
\DoxyCodeLine{10330         right = \_mm\_srai\_epi32(right, 16);}
\DoxyCodeLine{10331 }
\DoxyCodeLine{10332         \textcolor{comment}{/* At this point we have results. We can now pack and interleave these into a single \_\_m128i object and then store the in the output buffer. */}}
\DoxyCodeLine{10333         \_mm\_storeu\_si128((\_\_m128i*)(pOutputSamples + i*8), drflac\_\_mm\_packs\_interleaved\_epi32(left, right));}
\DoxyCodeLine{10334     \}}
\DoxyCodeLine{10335 }
\DoxyCodeLine{10336     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10337         pOutputSamples[i*2+0] = (drflac\_int16)((pInputSamples0U32[i] << shift0) >> 16);}
\DoxyCodeLine{10338         pOutputSamples[i*2+1] = (drflac\_int16)((pInputSamples1U32[i] << shift1) >> 16);}
\DoxyCodeLine{10339     \}}
\DoxyCodeLine{10340 \}}
\DoxyCodeLine{10341 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10342 }
\DoxyCodeLine{10343 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10344 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10345 \{}
\DoxyCodeLine{10346     drflac\_uint64 i;}
\DoxyCodeLine{10347     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10348     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10349     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10350     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10351     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10352 }
\DoxyCodeLine{10353     int32x4\_t shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{10354     int32x4\_t shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{10355 }
\DoxyCodeLine{10356     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10357         int32x4\_t left;}
\DoxyCodeLine{10358         int32x4\_t right;}
\DoxyCodeLine{10359 }
\DoxyCodeLine{10360         left  = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4));}
\DoxyCodeLine{10361         right = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4));}
\DoxyCodeLine{10362 }
\DoxyCodeLine{10363         left  = vshrq\_n\_s32(left,  16);}
\DoxyCodeLine{10364         right = vshrq\_n\_s32(right, 16);}
\DoxyCodeLine{10365 }
\DoxyCodeLine{10366         drflac\_\_vst2q\_s16(pOutputSamples + i*8, vzip\_s16(vmovn\_s32(left), vmovn\_s32(right)));}
\DoxyCodeLine{10367     \}}
\DoxyCodeLine{10368 }
\DoxyCodeLine{10369     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10370         pOutputSamples[i*2+0] = (drflac\_int16)((pInputSamples0U32[i] << shift0) >> 16);}
\DoxyCodeLine{10371         pOutputSamples[i*2+1] = (drflac\_int16)((pInputSamples1U32[i] << shift1) >> 16);}
\DoxyCodeLine{10372     \}}
\DoxyCodeLine{10373 \}}
\DoxyCodeLine{10374 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10375 }
\DoxyCodeLine{10376 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, drflac\_int16* pOutputSamples)}
\DoxyCodeLine{10377 \{}
\DoxyCodeLine{10378 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10379     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10380         drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10381     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10382 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10383     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10384         drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10385     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10387     \{}
\DoxyCodeLine{10388         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{10389 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10390         drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10391 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10392         drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10393 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10394     \}}
\DoxyCodeLine{10395 \}}
\DoxyCodeLine{10396 }
\DoxyCodeLine{10397 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_s16(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, drflac\_int16* pBufferOut)}
\DoxyCodeLine{10398 \{}
\DoxyCodeLine{10399     drflac\_uint64 framesRead;}
\DoxyCodeLine{10400     drflac\_uint32 unusedBitsPerSample;}
\DoxyCodeLine{10401 }
\DoxyCodeLine{10402     \textcolor{keywordflow}{if} (pFlac == NULL || framesToRead == 0) \{}
\DoxyCodeLine{10403         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{10404     \}}
\DoxyCodeLine{10405 }
\DoxyCodeLine{10406     \textcolor{keywordflow}{if} (pBufferOut == NULL) \{}
\DoxyCodeLine{10407         \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, framesToRead);}
\DoxyCodeLine{10408     \}}
\DoxyCodeLine{10409 }
\DoxyCodeLine{10410     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 32);}
\DoxyCodeLine{10411     unusedBitsPerSample = 32 -\/ pFlac-\/>bitsPerSample;}
\DoxyCodeLine{10412 }
\DoxyCodeLine{10413     framesRead = 0;}
\DoxyCodeLine{10414     \textcolor{keywordflow}{while} (framesToRead > 0) \{}
\DoxyCodeLine{10415         \textcolor{comment}{/* If we've run out of samples in this frame, go to the next. */}}
\DoxyCodeLine{10416         \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{10417             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac)) \{}
\DoxyCodeLine{10418                 \textcolor{keywordflow}{break};  \textcolor{comment}{/* Couldn't read the next frame, so just break from the loop and return. */}}
\DoxyCodeLine{10419             \}}
\DoxyCodeLine{10420         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10421             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} channelCount = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pFlac-\/>currentFLACFrame.header.channelAssignment);}
\DoxyCodeLine{10422             drflac\_uint64 iFirstPCMFrame = pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames -\/ pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{10423             drflac\_uint64 frameCountThisIteration = framesToRead;}
\DoxyCodeLine{10424 }
\DoxyCodeLine{10425             \textcolor{keywordflow}{if} (frameCountThisIteration > pFlac-\/>currentFLACFrame.pcmFramesRemaining) \{}
\DoxyCodeLine{10426                 frameCountThisIteration = pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{10427             \}}
\DoxyCodeLine{10428 }
\DoxyCodeLine{10429             \textcolor{keywordflow}{if} (channelCount == 2) \{}
\DoxyCodeLine{10430                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples0 = pFlac-\/>currentFLACFrame.subframes[0].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{10431                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples1 = pFlac-\/>currentFLACFrame.subframes[1].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{10432 }
\DoxyCodeLine{10433                 \textcolor{keywordflow}{switch} (pFlac-\/>currentFLACFrame.header.channelAssignment)}
\DoxyCodeLine{10434                 \{}
\DoxyCodeLine{10435                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE:}
\DoxyCodeLine{10436                     \{}
\DoxyCodeLine{10437                         drflac\_read\_pcm\_frames\_s16\_\_decode\_left\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{10438                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{10439 }
\DoxyCodeLine{10440                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE:}
\DoxyCodeLine{10441                     \{}
\DoxyCodeLine{10442                         drflac\_read\_pcm\_frames\_s16\_\_decode\_right\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{10443                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{10444 }
\DoxyCodeLine{10445                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE:}
\DoxyCodeLine{10446                     \{}
\DoxyCodeLine{10447                         drflac\_read\_pcm\_frames\_s16\_\_decode\_mid\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{10448                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{10449 }
\DoxyCodeLine{10450                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_INDEPENDENT:}
\DoxyCodeLine{10451                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10452                     \{}
\DoxyCodeLine{10453                         drflac\_read\_pcm\_frames\_s16\_\_decode\_independent\_stereo(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{10454                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{10455                 \}}
\DoxyCodeLine{10456             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10457                 \textcolor{comment}{/* Generic interleaving. */}}
\DoxyCodeLine{10458                 drflac\_uint64 i;}
\DoxyCodeLine{10459                 \textcolor{keywordflow}{for} (i = 0; i < frameCountThisIteration; ++i) \{}
\DoxyCodeLine{10460                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{10461                     \textcolor{keywordflow}{for} (j = 0; j < channelCount; ++j) \{}
\DoxyCodeLine{10462                         drflac\_int32 sampleS32 = (drflac\_int32)((drflac\_uint32)(pFlac-\/>currentFLACFrame.subframes[j].pSamplesS32[iFirstPCMFrame + i]) << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[j].wastedBitsPerSample));}
\DoxyCodeLine{10463                         pBufferOut[(i*channelCount)+j] = (drflac\_int16)(sampleS32 >> 16);}
\DoxyCodeLine{10464                     \}}
\DoxyCodeLine{10465                 \}}
\DoxyCodeLine{10466             \}}
\DoxyCodeLine{10467 }
\DoxyCodeLine{10468             framesRead                += frameCountThisIteration;}
\DoxyCodeLine{10469             pBufferOut                += frameCountThisIteration * channelCount;}
\DoxyCodeLine{10470             framesToRead              -\/= frameCountThisIteration;}
\DoxyCodeLine{10471             pFlac-\/>currentPCMFrame    += frameCountThisIteration;}
\DoxyCodeLine{10472             pFlac-\/>currentFLACFrame.pcmFramesRemaining -\/= (drflac\_uint32)frameCountThisIteration;}
\DoxyCodeLine{10473         \}}
\DoxyCodeLine{10474     \}}
\DoxyCodeLine{10475 }
\DoxyCodeLine{10476     \textcolor{keywordflow}{return} framesRead;}
\DoxyCodeLine{10477 \}}
\DoxyCodeLine{10478 }
\DoxyCodeLine{10479 }
\DoxyCodeLine{10480 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10481 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10482 \{}
\DoxyCodeLine{10483     drflac\_uint64 i;}
\DoxyCodeLine{10484     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{10485         drflac\_uint32 left  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10486         drflac\_uint32 side  = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10487         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{10488 }
\DoxyCodeLine{10489         pOutputSamples[i*2+0] = (float)((drflac\_int32)left  / 2147483648.0);}
\DoxyCodeLine{10490         pOutputSamples[i*2+1] = (float)((drflac\_int32)right / 2147483648.0);}
\DoxyCodeLine{10491     \}}
\DoxyCodeLine{10492 \}}
\DoxyCodeLine{10493 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10494 }
\DoxyCodeLine{10495 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10496 \{}
\DoxyCodeLine{10497     drflac\_uint64 i;}
\DoxyCodeLine{10498     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10499     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10500     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10501     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10502     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10503 }
\DoxyCodeLine{10504     \textcolor{keywordtype}{float} factor = 1 / 2147483648.0;}
\DoxyCodeLine{10505 }
\DoxyCodeLine{10506     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10507         drflac\_uint32 left0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{10508         drflac\_uint32 left1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{10509         drflac\_uint32 left2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{10510         drflac\_uint32 left3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{10511 }
\DoxyCodeLine{10512         drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{10513         drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{10514         drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{10515         drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{10516 }
\DoxyCodeLine{10517         drflac\_uint32 right0 = left0 -\/ side0;}
\DoxyCodeLine{10518         drflac\_uint32 right1 = left1 -\/ side1;}
\DoxyCodeLine{10519         drflac\_uint32 right2 = left2 -\/ side2;}
\DoxyCodeLine{10520         drflac\_uint32 right3 = left3 -\/ side3;}
\DoxyCodeLine{10521 }
\DoxyCodeLine{10522         pOutputSamples[i*8+0] = (drflac\_int32)left0  * factor;}
\DoxyCodeLine{10523         pOutputSamples[i*8+1] = (drflac\_int32)right0 * factor;}
\DoxyCodeLine{10524         pOutputSamples[i*8+2] = (drflac\_int32)left1  * factor;}
\DoxyCodeLine{10525         pOutputSamples[i*8+3] = (drflac\_int32)right1 * factor;}
\DoxyCodeLine{10526         pOutputSamples[i*8+4] = (drflac\_int32)left2  * factor;}
\DoxyCodeLine{10527         pOutputSamples[i*8+5] = (drflac\_int32)right2 * factor;}
\DoxyCodeLine{10528         pOutputSamples[i*8+6] = (drflac\_int32)left3  * factor;}
\DoxyCodeLine{10529         pOutputSamples[i*8+7] = (drflac\_int32)right3 * factor;}
\DoxyCodeLine{10530     \}}
\DoxyCodeLine{10531 }
\DoxyCodeLine{10532     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10533         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10534         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10535         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{10536 }
\DoxyCodeLine{10537         pOutputSamples[i*2+0] = (drflac\_int32)left  * factor;}
\DoxyCodeLine{10538         pOutputSamples[i*2+1] = (drflac\_int32)right * factor;}
\DoxyCodeLine{10539     \}}
\DoxyCodeLine{10540 \}}
\DoxyCodeLine{10541 }
\DoxyCodeLine{10542 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10543 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10544 \{}
\DoxyCodeLine{10545     drflac\_uint64 i;}
\DoxyCodeLine{10546     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10547     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10548     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10549     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10550     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10551     \_\_m128 factor;}
\DoxyCodeLine{10552 }
\DoxyCodeLine{10553     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10554 }
\DoxyCodeLine{10555     factor = \_mm\_set1\_ps(1.0f / 8388608.0f);}
\DoxyCodeLine{10556 }
\DoxyCodeLine{10557     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10558         \_\_m128i left  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{10559         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{10560         \_\_m128i right = \_mm\_sub\_epi32(left, side);}
\DoxyCodeLine{10561         \_\_m128 leftf  = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(left),  factor);}
\DoxyCodeLine{10562         \_\_m128 rightf = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(right), factor);}
\DoxyCodeLine{10563 }
\DoxyCodeLine{10564         \_mm\_storeu\_ps(pOutputSamples + i*8 + 0, \_mm\_unpacklo\_ps(leftf, rightf));}
\DoxyCodeLine{10565         \_mm\_storeu\_ps(pOutputSamples + i*8 + 4, \_mm\_unpackhi\_ps(leftf, rightf));}
\DoxyCodeLine{10566     \}}
\DoxyCodeLine{10567 }
\DoxyCodeLine{10568     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10569         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10570         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10571         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{10572 }
\DoxyCodeLine{10573         pOutputSamples[i*2+0] = (drflac\_int32)left  / 8388608.0f;}
\DoxyCodeLine{10574         pOutputSamples[i*2+1] = (drflac\_int32)right / 8388608.0f;}
\DoxyCodeLine{10575     \}}
\DoxyCodeLine{10576 \}}
\DoxyCodeLine{10577 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10578 }
\DoxyCodeLine{10579 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10580 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10581 \{}
\DoxyCodeLine{10582     drflac\_uint64 i;}
\DoxyCodeLine{10583     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10584     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10585     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10586     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10587     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10588     float32x4\_t factor4;}
\DoxyCodeLine{10589     int32x4\_t shift0\_4;}
\DoxyCodeLine{10590     int32x4\_t shift1\_4;}
\DoxyCodeLine{10591 }
\DoxyCodeLine{10592     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10593 }
\DoxyCodeLine{10594     factor4  = vdupq\_n\_f32(1.0f / 8388608.0f);}
\DoxyCodeLine{10595     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{10596     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{10597 }
\DoxyCodeLine{10598     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10599         uint32x4\_t left;}
\DoxyCodeLine{10600         uint32x4\_t side;}
\DoxyCodeLine{10601         uint32x4\_t right;}
\DoxyCodeLine{10602         float32x4\_t leftf;}
\DoxyCodeLine{10603         float32x4\_t rightf;}
\DoxyCodeLine{10604 }
\DoxyCodeLine{10605         left   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{10606         side   = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{10607         right  = vsubq\_u32(left, side);}
\DoxyCodeLine{10608         leftf  = vmulq\_f32(vcvtq\_f32\_s32(vreinterpretq\_s32\_u32(left)),  factor4);}
\DoxyCodeLine{10609         rightf = vmulq\_f32(vcvtq\_f32\_s32(vreinterpretq\_s32\_u32(right)), factor4);}
\DoxyCodeLine{10610 }
\DoxyCodeLine{10611         drflac\_\_vst2q\_f32(pOutputSamples + i*8, vzipq\_f32(leftf, rightf));}
\DoxyCodeLine{10612     \}}
\DoxyCodeLine{10613 }
\DoxyCodeLine{10614     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10615         drflac\_uint32 left  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10616         drflac\_uint32 side  = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10617         drflac\_uint32 right = left -\/ side;}
\DoxyCodeLine{10618 }
\DoxyCodeLine{10619         pOutputSamples[i*2+0] = (drflac\_int32)left  / 8388608.0f;}
\DoxyCodeLine{10620         pOutputSamples[i*2+1] = (drflac\_int32)right / 8388608.0f;}
\DoxyCodeLine{10621     \}}
\DoxyCodeLine{10622 \}}
\DoxyCodeLine{10623 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10624 }
\DoxyCodeLine{10625 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10626 \{}
\DoxyCodeLine{10627 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10628     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10629         drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10630     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10631 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10632     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10633         drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10634     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10635 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10636     \{}
\DoxyCodeLine{10637         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{10638 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10639         drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10640 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10641         drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10642 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10643     \}}
\DoxyCodeLine{10644 \}}
\DoxyCodeLine{10645 }
\DoxyCodeLine{10646 }
\DoxyCodeLine{10647 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10648 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10649 \{}
\DoxyCodeLine{10650     drflac\_uint64 i;}
\DoxyCodeLine{10651     \textcolor{keywordflow}{for} (i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{10652         drflac\_uint32 side  = (drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10653         drflac\_uint32 right = (drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10654         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{10655 }
\DoxyCodeLine{10656         pOutputSamples[i*2+0] = (float)((drflac\_int32)left  / 2147483648.0);}
\DoxyCodeLine{10657         pOutputSamples[i*2+1] = (float)((drflac\_int32)right / 2147483648.0);}
\DoxyCodeLine{10658     \}}
\DoxyCodeLine{10659 \}}
\DoxyCodeLine{10660 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10661 }
\DoxyCodeLine{10662 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10663 \{}
\DoxyCodeLine{10664     drflac\_uint64 i;}
\DoxyCodeLine{10665     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10666     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10667     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10668     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10669     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10670     \textcolor{keywordtype}{float} factor = 1 / 2147483648.0;}
\DoxyCodeLine{10671 }
\DoxyCodeLine{10672     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10673         drflac\_uint32 side0  = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{10674         drflac\_uint32 side1  = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{10675         drflac\_uint32 side2  = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{10676         drflac\_uint32 side3  = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{10677 }
\DoxyCodeLine{10678         drflac\_uint32 right0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{10679         drflac\_uint32 right1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{10680         drflac\_uint32 right2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{10681         drflac\_uint32 right3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{10682 }
\DoxyCodeLine{10683         drflac\_uint32 left0 = right0 + side0;}
\DoxyCodeLine{10684         drflac\_uint32 left1 = right1 + side1;}
\DoxyCodeLine{10685         drflac\_uint32 left2 = right2 + side2;}
\DoxyCodeLine{10686         drflac\_uint32 left3 = right3 + side3;}
\DoxyCodeLine{10687 }
\DoxyCodeLine{10688         pOutputSamples[i*8+0] = (drflac\_int32)left0  * factor;}
\DoxyCodeLine{10689         pOutputSamples[i*8+1] = (drflac\_int32)right0 * factor;}
\DoxyCodeLine{10690         pOutputSamples[i*8+2] = (drflac\_int32)left1  * factor;}
\DoxyCodeLine{10691         pOutputSamples[i*8+3] = (drflac\_int32)right1 * factor;}
\DoxyCodeLine{10692         pOutputSamples[i*8+4] = (drflac\_int32)left2  * factor;}
\DoxyCodeLine{10693         pOutputSamples[i*8+5] = (drflac\_int32)right2 * factor;}
\DoxyCodeLine{10694         pOutputSamples[i*8+6] = (drflac\_int32)left3  * factor;}
\DoxyCodeLine{10695         pOutputSamples[i*8+7] = (drflac\_int32)right3 * factor;}
\DoxyCodeLine{10696     \}}
\DoxyCodeLine{10697 }
\DoxyCodeLine{10698     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10699         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10700         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10701         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{10702 }
\DoxyCodeLine{10703         pOutputSamples[i*2+0] = (drflac\_int32)left  * factor;}
\DoxyCodeLine{10704         pOutputSamples[i*2+1] = (drflac\_int32)right * factor;}
\DoxyCodeLine{10705     \}}
\DoxyCodeLine{10706 \}}
\DoxyCodeLine{10707 }
\DoxyCodeLine{10708 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10709 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10710 \{}
\DoxyCodeLine{10711     drflac\_uint64 i;}
\DoxyCodeLine{10712     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10713     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10714     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10715     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10716     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10717     \_\_m128 factor;}
\DoxyCodeLine{10718 }
\DoxyCodeLine{10719     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10720 }
\DoxyCodeLine{10721     factor = \_mm\_set1\_ps(1.0f / 8388608.0f);}
\DoxyCodeLine{10722 }
\DoxyCodeLine{10723     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10724         \_\_m128i side  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{10725         \_\_m128i right = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{10726         \_\_m128i left  = \_mm\_add\_epi32(right, side);}
\DoxyCodeLine{10727         \_\_m128 leftf  = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(left),  factor);}
\DoxyCodeLine{10728         \_\_m128 rightf = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(right), factor);}
\DoxyCodeLine{10729 }
\DoxyCodeLine{10730         \_mm\_storeu\_ps(pOutputSamples + i*8 + 0, \_mm\_unpacklo\_ps(leftf, rightf));}
\DoxyCodeLine{10731         \_mm\_storeu\_ps(pOutputSamples + i*8 + 4, \_mm\_unpackhi\_ps(leftf, rightf));}
\DoxyCodeLine{10732     \}}
\DoxyCodeLine{10733 }
\DoxyCodeLine{10734     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10735         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10736         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10737         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{10738 }
\DoxyCodeLine{10739         pOutputSamples[i*2+0] = (drflac\_int32)left  / 8388608.0f;}
\DoxyCodeLine{10740         pOutputSamples[i*2+1] = (drflac\_int32)right / 8388608.0f;}
\DoxyCodeLine{10741     \}}
\DoxyCodeLine{10742 \}}
\DoxyCodeLine{10743 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10744 }
\DoxyCodeLine{10745 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10746 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10747 \{}
\DoxyCodeLine{10748     drflac\_uint64 i;}
\DoxyCodeLine{10749     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10750     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10751     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10752     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10753     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{10754     float32x4\_t factor4;}
\DoxyCodeLine{10755     int32x4\_t shift0\_4;}
\DoxyCodeLine{10756     int32x4\_t shift1\_4;}
\DoxyCodeLine{10757 }
\DoxyCodeLine{10758     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10759 }
\DoxyCodeLine{10760     factor4  = vdupq\_n\_f32(1.0f / 8388608.0f);}
\DoxyCodeLine{10761     shift0\_4 = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{10762     shift1\_4 = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{10763 }
\DoxyCodeLine{10764     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10765         uint32x4\_t side;}
\DoxyCodeLine{10766         uint32x4\_t right;}
\DoxyCodeLine{10767         uint32x4\_t left;}
\DoxyCodeLine{10768         float32x4\_t leftf;}
\DoxyCodeLine{10769         float32x4\_t rightf;}
\DoxyCodeLine{10770 }
\DoxyCodeLine{10771         side   = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4);}
\DoxyCodeLine{10772         right  = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4);}
\DoxyCodeLine{10773         left   = vaddq\_u32(right, side);}
\DoxyCodeLine{10774         leftf  = vmulq\_f32(vcvtq\_f32\_s32(vreinterpretq\_s32\_u32(left)),  factor4);}
\DoxyCodeLine{10775         rightf = vmulq\_f32(vcvtq\_f32\_s32(vreinterpretq\_s32\_u32(right)), factor4);}
\DoxyCodeLine{10776 }
\DoxyCodeLine{10777         drflac\_\_vst2q\_f32(pOutputSamples + i*8, vzipq\_f32(leftf, rightf));}
\DoxyCodeLine{10778     \}}
\DoxyCodeLine{10779 }
\DoxyCodeLine{10780     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10781         drflac\_uint32 side  = pInputSamples0U32[i] << shift0;}
\DoxyCodeLine{10782         drflac\_uint32 right = pInputSamples1U32[i] << shift1;}
\DoxyCodeLine{10783         drflac\_uint32 left  = right + side;}
\DoxyCodeLine{10784 }
\DoxyCodeLine{10785         pOutputSamples[i*2+0] = (drflac\_int32)left  / 8388608.0f;}
\DoxyCodeLine{10786         pOutputSamples[i*2+1] = (drflac\_int32)right / 8388608.0f;}
\DoxyCodeLine{10787     \}}
\DoxyCodeLine{10788 \}}
\DoxyCodeLine{10789 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10790 }
\DoxyCodeLine{10791 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10792 \{}
\DoxyCodeLine{10793 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10794     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10795         drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10796     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10797 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{10798     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{10799         drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10800     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{10801 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10802     \{}
\DoxyCodeLine{10803         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{10804 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10805         drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10806 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10807         drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{10808 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10809     \}}
\DoxyCodeLine{10810 \}}
\DoxyCodeLine{10811 }
\DoxyCodeLine{10812 }
\DoxyCodeLine{10813 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{10814 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10815 \{}
\DoxyCodeLine{10816     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{10817         drflac\_uint32 mid  = (drflac\_uint32)pInputSamples0[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10818         drflac\_uint32 side = (drflac\_uint32)pInputSamples1[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10819 }
\DoxyCodeLine{10820         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10821 }
\DoxyCodeLine{10822         pOutputSamples[i*2+0] = (float)((((drflac\_int32)(mid + side) >> 1) << (unusedBitsPerSample)) / 2147483648.0);}
\DoxyCodeLine{10823         pOutputSamples[i*2+1] = (float)((((drflac\_int32)(mid -\/ side) >> 1) << (unusedBitsPerSample)) / 2147483648.0);}
\DoxyCodeLine{10824     \}}
\DoxyCodeLine{10825 \}}
\DoxyCodeLine{10826 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10827 }
\DoxyCodeLine{10828 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10829 \{}
\DoxyCodeLine{10830     drflac\_uint64 i;}
\DoxyCodeLine{10831     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10832     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10833     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10834     drflac\_uint32 shift = unusedBitsPerSample;}
\DoxyCodeLine{10835     \textcolor{keywordtype}{float} factor = 1 / 2147483648.0;}
\DoxyCodeLine{10836 }
\DoxyCodeLine{10837     \textcolor{keywordflow}{if} (shift > 0) \{}
\DoxyCodeLine{10838         shift -\/= 1;}
\DoxyCodeLine{10839         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10840             drflac\_uint32 temp0L;}
\DoxyCodeLine{10841             drflac\_uint32 temp1L;}
\DoxyCodeLine{10842             drflac\_uint32 temp2L;}
\DoxyCodeLine{10843             drflac\_uint32 temp3L;}
\DoxyCodeLine{10844             drflac\_uint32 temp0R;}
\DoxyCodeLine{10845             drflac\_uint32 temp1R;}
\DoxyCodeLine{10846             drflac\_uint32 temp2R;}
\DoxyCodeLine{10847             drflac\_uint32 temp3R;}
\DoxyCodeLine{10848 }
\DoxyCodeLine{10849             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10850             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10851             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10852             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10853 }
\DoxyCodeLine{10854             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10855             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10856             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10857             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10858 }
\DoxyCodeLine{10859             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{10860             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{10861             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{10862             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{10863 }
\DoxyCodeLine{10864             temp0L = (mid0 + side0) << shift;}
\DoxyCodeLine{10865             temp1L = (mid1 + side1) << shift;}
\DoxyCodeLine{10866             temp2L = (mid2 + side2) << shift;}
\DoxyCodeLine{10867             temp3L = (mid3 + side3) << shift;}
\DoxyCodeLine{10868 }
\DoxyCodeLine{10869             temp0R = (mid0 -\/ side0) << shift;}
\DoxyCodeLine{10870             temp1R = (mid1 -\/ side1) << shift;}
\DoxyCodeLine{10871             temp2R = (mid2 -\/ side2) << shift;}
\DoxyCodeLine{10872             temp3R = (mid3 -\/ side3) << shift;}
\DoxyCodeLine{10873 }
\DoxyCodeLine{10874             pOutputSamples[i*8+0] = (drflac\_int32)temp0L * factor;}
\DoxyCodeLine{10875             pOutputSamples[i*8+1] = (drflac\_int32)temp0R * factor;}
\DoxyCodeLine{10876             pOutputSamples[i*8+2] = (drflac\_int32)temp1L * factor;}
\DoxyCodeLine{10877             pOutputSamples[i*8+3] = (drflac\_int32)temp1R * factor;}
\DoxyCodeLine{10878             pOutputSamples[i*8+4] = (drflac\_int32)temp2L * factor;}
\DoxyCodeLine{10879             pOutputSamples[i*8+5] = (drflac\_int32)temp2R * factor;}
\DoxyCodeLine{10880             pOutputSamples[i*8+6] = (drflac\_int32)temp3L * factor;}
\DoxyCodeLine{10881             pOutputSamples[i*8+7] = (drflac\_int32)temp3R * factor;}
\DoxyCodeLine{10882         \}}
\DoxyCodeLine{10883     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10884         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10885             drflac\_uint32 temp0L;}
\DoxyCodeLine{10886             drflac\_uint32 temp1L;}
\DoxyCodeLine{10887             drflac\_uint32 temp2L;}
\DoxyCodeLine{10888             drflac\_uint32 temp3L;}
\DoxyCodeLine{10889             drflac\_uint32 temp0R;}
\DoxyCodeLine{10890             drflac\_uint32 temp1R;}
\DoxyCodeLine{10891             drflac\_uint32 temp2R;}
\DoxyCodeLine{10892             drflac\_uint32 temp3R;}
\DoxyCodeLine{10893 }
\DoxyCodeLine{10894             drflac\_uint32 mid0  = pInputSamples0U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10895             drflac\_uint32 mid1  = pInputSamples0U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10896             drflac\_uint32 mid2  = pInputSamples0U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10897             drflac\_uint32 mid3  = pInputSamples0U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10898 }
\DoxyCodeLine{10899             drflac\_uint32 side0 = pInputSamples1U32[i*4+0] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10900             drflac\_uint32 side1 = pInputSamples1U32[i*4+1] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10901             drflac\_uint32 side2 = pInputSamples1U32[i*4+2] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10902             drflac\_uint32 side3 = pInputSamples1U32[i*4+3] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10903 }
\DoxyCodeLine{10904             mid0 = (mid0 << 1) | (side0 \& 0x01);}
\DoxyCodeLine{10905             mid1 = (mid1 << 1) | (side1 \& 0x01);}
\DoxyCodeLine{10906             mid2 = (mid2 << 1) | (side2 \& 0x01);}
\DoxyCodeLine{10907             mid3 = (mid3 << 1) | (side3 \& 0x01);}
\DoxyCodeLine{10908 }
\DoxyCodeLine{10909             temp0L = (drflac\_uint32)((drflac\_int32)(mid0 + side0) >> 1);}
\DoxyCodeLine{10910             temp1L = (drflac\_uint32)((drflac\_int32)(mid1 + side1) >> 1);}
\DoxyCodeLine{10911             temp2L = (drflac\_uint32)((drflac\_int32)(mid2 + side2) >> 1);}
\DoxyCodeLine{10912             temp3L = (drflac\_uint32)((drflac\_int32)(mid3 + side3) >> 1);}
\DoxyCodeLine{10913 }
\DoxyCodeLine{10914             temp0R = (drflac\_uint32)((drflac\_int32)(mid0 -\/ side0) >> 1);}
\DoxyCodeLine{10915             temp1R = (drflac\_uint32)((drflac\_int32)(mid1 -\/ side1) >> 1);}
\DoxyCodeLine{10916             temp2R = (drflac\_uint32)((drflac\_int32)(mid2 -\/ side2) >> 1);}
\DoxyCodeLine{10917             temp3R = (drflac\_uint32)((drflac\_int32)(mid3 -\/ side3) >> 1);}
\DoxyCodeLine{10918 }
\DoxyCodeLine{10919             pOutputSamples[i*8+0] = (drflac\_int32)temp0L * factor;}
\DoxyCodeLine{10920             pOutputSamples[i*8+1] = (drflac\_int32)temp0R * factor;}
\DoxyCodeLine{10921             pOutputSamples[i*8+2] = (drflac\_int32)temp1L * factor;}
\DoxyCodeLine{10922             pOutputSamples[i*8+3] = (drflac\_int32)temp1R * factor;}
\DoxyCodeLine{10923             pOutputSamples[i*8+4] = (drflac\_int32)temp2L * factor;}
\DoxyCodeLine{10924             pOutputSamples[i*8+5] = (drflac\_int32)temp2R * factor;}
\DoxyCodeLine{10925             pOutputSamples[i*8+6] = (drflac\_int32)temp3L * factor;}
\DoxyCodeLine{10926             pOutputSamples[i*8+7] = (drflac\_int32)temp3R * factor;}
\DoxyCodeLine{10927         \}}
\DoxyCodeLine{10928     \}}
\DoxyCodeLine{10929 }
\DoxyCodeLine{10930     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10931         drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10932         drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10933 }
\DoxyCodeLine{10934         mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10935 }
\DoxyCodeLine{10936         pOutputSamples[i*2+0] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid + side) >> 1) << unusedBitsPerSample) * factor;}
\DoxyCodeLine{10937         pOutputSamples[i*2+1] = (drflac\_int32)((drflac\_uint32)((drflac\_int32)(mid -\/ side) >> 1) << unusedBitsPerSample) * factor;}
\DoxyCodeLine{10938     \}}
\DoxyCodeLine{10939 \}}
\DoxyCodeLine{10940 }
\DoxyCodeLine{10941 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{10942 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{10943 \{}
\DoxyCodeLine{10944     drflac\_uint64 i;}
\DoxyCodeLine{10945     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{10946     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{10947     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{10948     drflac\_uint32 shift = unusedBitsPerSample -\/ 8;}
\DoxyCodeLine{10949     \textcolor{keywordtype}{float} factor;}
\DoxyCodeLine{10950     \_\_m128 factor128;}
\DoxyCodeLine{10951 }
\DoxyCodeLine{10952     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{10953 }
\DoxyCodeLine{10954     factor = 1.0f / 8388608.0f;}
\DoxyCodeLine{10955     factor128 = \_mm\_set1\_ps(factor);}
\DoxyCodeLine{10956 }
\DoxyCodeLine{10957     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{10958         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10959             \_\_m128i mid;}
\DoxyCodeLine{10960             \_\_m128i side;}
\DoxyCodeLine{10961             \_\_m128i tempL;}
\DoxyCodeLine{10962             \_\_m128i tempR;}
\DoxyCodeLine{10963             \_\_m128  leftf;}
\DoxyCodeLine{10964             \_\_m128  rightf;}
\DoxyCodeLine{10965 }
\DoxyCodeLine{10966             mid    = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{10967             side   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{10968 }
\DoxyCodeLine{10969             mid    = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{10970 }
\DoxyCodeLine{10971             tempL  = \_mm\_srai\_epi32(\_mm\_add\_epi32(mid, side), 1);}
\DoxyCodeLine{10972             tempR  = \_mm\_srai\_epi32(\_mm\_sub\_epi32(mid, side), 1);}
\DoxyCodeLine{10973 }
\DoxyCodeLine{10974             leftf  = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(tempL), factor128);}
\DoxyCodeLine{10975             rightf = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(tempR), factor128);}
\DoxyCodeLine{10976 }
\DoxyCodeLine{10977             \_mm\_storeu\_ps(pOutputSamples + i*8 + 0, \_mm\_unpacklo\_ps(leftf, rightf));}
\DoxyCodeLine{10978             \_mm\_storeu\_ps(pOutputSamples + i*8 + 4, \_mm\_unpackhi\_ps(leftf, rightf));}
\DoxyCodeLine{10979         \}}
\DoxyCodeLine{10980 }
\DoxyCodeLine{10981         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{10982             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{10983             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{10984 }
\DoxyCodeLine{10985             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{10986 }
\DoxyCodeLine{10987             pOutputSamples[i*2+0] = ((drflac\_int32)(mid + side) >> 1) * factor;}
\DoxyCodeLine{10988             pOutputSamples[i*2+1] = ((drflac\_int32)(mid -\/ side) >> 1) * factor;}
\DoxyCodeLine{10989         \}}
\DoxyCodeLine{10990     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{10991         shift -\/= 1;}
\DoxyCodeLine{10992         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{10993             \_\_m128i mid;}
\DoxyCodeLine{10994             \_\_m128i side;}
\DoxyCodeLine{10995             \_\_m128i tempL;}
\DoxyCodeLine{10996             \_\_m128i tempR;}
\DoxyCodeLine{10997             \_\_m128 leftf;}
\DoxyCodeLine{10998             \_\_m128 rightf;}
\DoxyCodeLine{10999 }
\DoxyCodeLine{11000             mid    = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{11001             side   = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{11002 }
\DoxyCodeLine{11003             mid    = \_mm\_or\_si128(\_mm\_slli\_epi32(mid, 1), \_mm\_and\_si128(side, \_mm\_set1\_epi32(0x01)));}
\DoxyCodeLine{11004 }
\DoxyCodeLine{11005             tempL  = \_mm\_slli\_epi32(\_mm\_add\_epi32(mid, side), shift);}
\DoxyCodeLine{11006             tempR  = \_mm\_slli\_epi32(\_mm\_sub\_epi32(mid, side), shift);}
\DoxyCodeLine{11007 }
\DoxyCodeLine{11008             leftf  = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(tempL), factor128);}
\DoxyCodeLine{11009             rightf = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(tempR), factor128);}
\DoxyCodeLine{11010 }
\DoxyCodeLine{11011             \_mm\_storeu\_ps(pOutputSamples + i*8 + 0, \_mm\_unpacklo\_ps(leftf, rightf));}
\DoxyCodeLine{11012             \_mm\_storeu\_ps(pOutputSamples + i*8 + 4, \_mm\_unpackhi\_ps(leftf, rightf));}
\DoxyCodeLine{11013         \}}
\DoxyCodeLine{11014 }
\DoxyCodeLine{11015         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11016             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{11017             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{11018 }
\DoxyCodeLine{11019             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{11020 }
\DoxyCodeLine{11021             pOutputSamples[i*2+0] = (drflac\_int32)((mid + side) << shift) * factor;}
\DoxyCodeLine{11022             pOutputSamples[i*2+1] = (drflac\_int32)((mid -\/ side) << shift) * factor;}
\DoxyCodeLine{11023         \}}
\DoxyCodeLine{11024     \}}
\DoxyCodeLine{11025 \}}
\DoxyCodeLine{11026 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11027 }
\DoxyCodeLine{11028 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{11029 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11030 \{}
\DoxyCodeLine{11031     drflac\_uint64 i;}
\DoxyCodeLine{11032     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{11033     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{11034     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{11035     drflac\_uint32 shift = unusedBitsPerSample -\/ 8;}
\DoxyCodeLine{11036     \textcolor{keywordtype}{float} factor;}
\DoxyCodeLine{11037     float32x4\_t factor4;}
\DoxyCodeLine{11038     int32x4\_t shift4;}
\DoxyCodeLine{11039     int32x4\_t wbps0\_4;  \textcolor{comment}{/* Wasted Bits Per Sample */}}
\DoxyCodeLine{11040     int32x4\_t wbps1\_4;  \textcolor{comment}{/* Wasted Bits Per Sample */}}
\DoxyCodeLine{11041 }
\DoxyCodeLine{11042     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 24);}
\DoxyCodeLine{11043 }
\DoxyCodeLine{11044     factor  = 1.0f / 8388608.0f;}
\DoxyCodeLine{11045     factor4 = vdupq\_n\_f32(factor);}
\DoxyCodeLine{11046     wbps0\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample);}
\DoxyCodeLine{11047     wbps1\_4 = vdupq\_n\_s32(pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample);}
\DoxyCodeLine{11048 }
\DoxyCodeLine{11049     \textcolor{keywordflow}{if} (shift == 0) \{}
\DoxyCodeLine{11050         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{11051             int32x4\_t lefti;}
\DoxyCodeLine{11052             int32x4\_t righti;}
\DoxyCodeLine{11053             float32x4\_t leftf;}
\DoxyCodeLine{11054             float32x4\_t rightf;}
\DoxyCodeLine{11055 }
\DoxyCodeLine{11056             uint32x4\_t mid  = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbps0\_4);}
\DoxyCodeLine{11057             uint32x4\_t side = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbps1\_4);}
\DoxyCodeLine{11058 }
\DoxyCodeLine{11059             mid    = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, vdupq\_n\_u32(1)));}
\DoxyCodeLine{11060 }
\DoxyCodeLine{11061             lefti  = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vaddq\_u32(mid, side)), 1);}
\DoxyCodeLine{11062             righti = vshrq\_n\_s32(vreinterpretq\_s32\_u32(vsubq\_u32(mid, side)), 1);}
\DoxyCodeLine{11063 }
\DoxyCodeLine{11064             leftf  = vmulq\_f32(vcvtq\_f32\_s32(lefti),  factor4);}
\DoxyCodeLine{11065             rightf = vmulq\_f32(vcvtq\_f32\_s32(righti), factor4);}
\DoxyCodeLine{11066 }
\DoxyCodeLine{11067             drflac\_\_vst2q\_f32(pOutputSamples + i*8, vzipq\_f32(leftf, rightf));}
\DoxyCodeLine{11068         \}}
\DoxyCodeLine{11069 }
\DoxyCodeLine{11070         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11071             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{11072             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{11073 }
\DoxyCodeLine{11074             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{11075 }
\DoxyCodeLine{11076             pOutputSamples[i*2+0] = ((drflac\_int32)(mid + side) >> 1) * factor;}
\DoxyCodeLine{11077             pOutputSamples[i*2+1] = ((drflac\_int32)(mid -\/ side) >> 1) * factor;}
\DoxyCodeLine{11078         \}}
\DoxyCodeLine{11079     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11080         shift -\/= 1;}
\DoxyCodeLine{11081         shift4 = vdupq\_n\_s32(shift);}
\DoxyCodeLine{11082         \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{11083             uint32x4\_t mid;}
\DoxyCodeLine{11084             uint32x4\_t side;}
\DoxyCodeLine{11085             int32x4\_t lefti;}
\DoxyCodeLine{11086             int32x4\_t righti;}
\DoxyCodeLine{11087             float32x4\_t leftf;}
\DoxyCodeLine{11088             float32x4\_t rightf;}
\DoxyCodeLine{11089 }
\DoxyCodeLine{11090             mid    = vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), wbps0\_4);}
\DoxyCodeLine{11091             side   = vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), wbps1\_4);}
\DoxyCodeLine{11092 }
\DoxyCodeLine{11093             mid    = vorrq\_u32(vshlq\_n\_u32(mid, 1), vandq\_u32(side, vdupq\_n\_u32(1)));}
\DoxyCodeLine{11094 }
\DoxyCodeLine{11095             lefti  = vreinterpretq\_s32\_u32(vshlq\_u32(vaddq\_u32(mid, side), shift4));}
\DoxyCodeLine{11096             righti = vreinterpretq\_s32\_u32(vshlq\_u32(vsubq\_u32(mid, side), shift4));}
\DoxyCodeLine{11097 }
\DoxyCodeLine{11098             leftf  = vmulq\_f32(vcvtq\_f32\_s32(lefti),  factor4);}
\DoxyCodeLine{11099             rightf = vmulq\_f32(vcvtq\_f32\_s32(righti), factor4);}
\DoxyCodeLine{11100 }
\DoxyCodeLine{11101             drflac\_\_vst2q\_f32(pOutputSamples + i*8, vzipq\_f32(leftf, rightf));}
\DoxyCodeLine{11102         \}}
\DoxyCodeLine{11103 }
\DoxyCodeLine{11104         \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11105             drflac\_uint32 mid  = pInputSamples0U32[i] << pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{11106             drflac\_uint32 side = pInputSamples1U32[i] << pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{11107 }
\DoxyCodeLine{11108             mid = (mid << 1) | (side \& 0x01);}
\DoxyCodeLine{11109 }
\DoxyCodeLine{11110             pOutputSamples[i*2+0] = (drflac\_int32)((mid + side) << shift) * factor;}
\DoxyCodeLine{11111             pOutputSamples[i*2+1] = (drflac\_int32)((mid -\/ side) << shift) * factor;}
\DoxyCodeLine{11112         \}}
\DoxyCodeLine{11113     \}}
\DoxyCodeLine{11114 \}}
\DoxyCodeLine{11115 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11116 }
\DoxyCodeLine{11117 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11118 \{}
\DoxyCodeLine{11119 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{11120     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{11121         drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11122     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{11123 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{11124     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{11125         drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11126     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{11127 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11128     \{}
\DoxyCodeLine{11129         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{11130 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{11131         drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11132 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11133         drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11134 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11135     \}}
\DoxyCodeLine{11136 \}}
\DoxyCodeLine{11137 }
\DoxyCodeLine{11138 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{11139 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_reference(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11140 \{}
\DoxyCodeLine{11141     \textcolor{keywordflow}{for} (drflac\_uint64 i = 0; i < frameCount; ++i) \{}
\DoxyCodeLine{11142         pOutputSamples[i*2+0] = (float)((drflac\_int32)((drflac\_uint32)pInputSamples0[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample)) / 2147483648.0);}
\DoxyCodeLine{11143         pOutputSamples[i*2+1] = (float)((drflac\_int32)((drflac\_uint32)pInputSamples1[i] << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample)) / 2147483648.0);}
\DoxyCodeLine{11144     \}}
\DoxyCodeLine{11145 \}}
\DoxyCodeLine{11146 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11147 }
\DoxyCodeLine{11148 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_scalar(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11149 \{}
\DoxyCodeLine{11150     drflac\_uint64 i;}
\DoxyCodeLine{11151     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{11152     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{11153     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{11154     drflac\_uint32 shift0 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample;}
\DoxyCodeLine{11155     drflac\_uint32 shift1 = unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample;}
\DoxyCodeLine{11156     \textcolor{keywordtype}{float} factor = 1 / 2147483648.0;}
\DoxyCodeLine{11157 }
\DoxyCodeLine{11158     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{11159         drflac\_uint32 tempL0 = pInputSamples0U32[i*4+0] << shift0;}
\DoxyCodeLine{11160         drflac\_uint32 tempL1 = pInputSamples0U32[i*4+1] << shift0;}
\DoxyCodeLine{11161         drflac\_uint32 tempL2 = pInputSamples0U32[i*4+2] << shift0;}
\DoxyCodeLine{11162         drflac\_uint32 tempL3 = pInputSamples0U32[i*4+3] << shift0;}
\DoxyCodeLine{11163 }
\DoxyCodeLine{11164         drflac\_uint32 tempR0 = pInputSamples1U32[i*4+0] << shift1;}
\DoxyCodeLine{11165         drflac\_uint32 tempR1 = pInputSamples1U32[i*4+1] << shift1;}
\DoxyCodeLine{11166         drflac\_uint32 tempR2 = pInputSamples1U32[i*4+2] << shift1;}
\DoxyCodeLine{11167         drflac\_uint32 tempR3 = pInputSamples1U32[i*4+3] << shift1;}
\DoxyCodeLine{11168 }
\DoxyCodeLine{11169         pOutputSamples[i*8+0] = (drflac\_int32)tempL0 * factor;}
\DoxyCodeLine{11170         pOutputSamples[i*8+1] = (drflac\_int32)tempR0 * factor;}
\DoxyCodeLine{11171         pOutputSamples[i*8+2] = (drflac\_int32)tempL1 * factor;}
\DoxyCodeLine{11172         pOutputSamples[i*8+3] = (drflac\_int32)tempR1 * factor;}
\DoxyCodeLine{11173         pOutputSamples[i*8+4] = (drflac\_int32)tempL2 * factor;}
\DoxyCodeLine{11174         pOutputSamples[i*8+5] = (drflac\_int32)tempR2 * factor;}
\DoxyCodeLine{11175         pOutputSamples[i*8+6] = (drflac\_int32)tempL3 * factor;}
\DoxyCodeLine{11176         pOutputSamples[i*8+7] = (drflac\_int32)tempR3 * factor;}
\DoxyCodeLine{11177     \}}
\DoxyCodeLine{11178 }
\DoxyCodeLine{11179     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11180         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0) * factor;}
\DoxyCodeLine{11181         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1) * factor;}
\DoxyCodeLine{11182     \}}
\DoxyCodeLine{11183 \}}
\DoxyCodeLine{11184 }
\DoxyCodeLine{11185 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{11186 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_sse2(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11187 \{}
\DoxyCodeLine{11188     drflac\_uint64 i;}
\DoxyCodeLine{11189     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{11190     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{11191     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{11192     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{11193     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{11194 }
\DoxyCodeLine{11195     \textcolor{keywordtype}{float} factor = 1.0f / 8388608.0f;}
\DoxyCodeLine{11196     \_\_m128 factor128 = \_mm\_set1\_ps(factor);}
\DoxyCodeLine{11197 }
\DoxyCodeLine{11198     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{11199         \_\_m128i lefti;}
\DoxyCodeLine{11200         \_\_m128i righti;}
\DoxyCodeLine{11201         \_\_m128 leftf;}
\DoxyCodeLine{11202         \_\_m128 rightf;}
\DoxyCodeLine{11203 }
\DoxyCodeLine{11204         lefti  = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples0 + i), shift0);}
\DoxyCodeLine{11205         righti = \_mm\_slli\_epi32(\_mm\_loadu\_si128((\textcolor{keyword}{const} \_\_m128i*)pInputSamples1 + i), shift1);}
\DoxyCodeLine{11206 }
\DoxyCodeLine{11207         leftf  = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(lefti),  factor128);}
\DoxyCodeLine{11208         rightf = \_mm\_mul\_ps(\_mm\_cvtepi32\_ps(righti), factor128);}
\DoxyCodeLine{11209 }
\DoxyCodeLine{11210         \_mm\_storeu\_ps(pOutputSamples + i*8 + 0, \_mm\_unpacklo\_ps(leftf, rightf));}
\DoxyCodeLine{11211         \_mm\_storeu\_ps(pOutputSamples + i*8 + 4, \_mm\_unpackhi\_ps(leftf, rightf));}
\DoxyCodeLine{11212     \}}
\DoxyCodeLine{11213 }
\DoxyCodeLine{11214     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11215         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0) * factor;}
\DoxyCodeLine{11216         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1) * factor;}
\DoxyCodeLine{11217     \}}
\DoxyCodeLine{11218 \}}
\DoxyCodeLine{11219 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11220 }
\DoxyCodeLine{11221 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{11222 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_neon(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11223 \{}
\DoxyCodeLine{11224     drflac\_uint64 i;}
\DoxyCodeLine{11225     drflac\_uint64 frameCount4 = frameCount >> 2;}
\DoxyCodeLine{11226     \textcolor{keyword}{const} drflac\_uint32* pInputSamples0U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples0;}
\DoxyCodeLine{11227     \textcolor{keyword}{const} drflac\_uint32* pInputSamples1U32 = (\textcolor{keyword}{const} drflac\_uint32*)pInputSamples1;}
\DoxyCodeLine{11228     drflac\_uint32 shift0 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[0].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{11229     drflac\_uint32 shift1 = (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[1].wastedBitsPerSample) -\/ 8;}
\DoxyCodeLine{11230 }
\DoxyCodeLine{11231     \textcolor{keywordtype}{float} factor = 1.0f / 8388608.0f;}
\DoxyCodeLine{11232     float32x4\_t factor4 = vdupq\_n\_f32(factor);}
\DoxyCodeLine{11233     int32x4\_t shift0\_4  = vdupq\_n\_s32(shift0);}
\DoxyCodeLine{11234     int32x4\_t shift1\_4  = vdupq\_n\_s32(shift1);}
\DoxyCodeLine{11235 }
\DoxyCodeLine{11236     \textcolor{keywordflow}{for} (i = 0; i < frameCount4; ++i) \{}
\DoxyCodeLine{11237         int32x4\_t lefti;}
\DoxyCodeLine{11238         int32x4\_t righti;}
\DoxyCodeLine{11239         float32x4\_t leftf;}
\DoxyCodeLine{11240         float32x4\_t rightf;}
\DoxyCodeLine{11241 }
\DoxyCodeLine{11242         lefti  = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples0U32 + i*4), shift0\_4));}
\DoxyCodeLine{11243         righti = vreinterpretq\_s32\_u32(vshlq\_u32(vld1q\_u32(pInputSamples1U32 + i*4), shift1\_4));}
\DoxyCodeLine{11244 }
\DoxyCodeLine{11245         leftf  = vmulq\_f32(vcvtq\_f32\_s32(lefti),  factor4);}
\DoxyCodeLine{11246         rightf = vmulq\_f32(vcvtq\_f32\_s32(righti), factor4);}
\DoxyCodeLine{11247 }
\DoxyCodeLine{11248         drflac\_\_vst2q\_f32(pOutputSamples + i*8, vzipq\_f32(leftf, rightf));}
\DoxyCodeLine{11249     \}}
\DoxyCodeLine{11250 }
\DoxyCodeLine{11251     \textcolor{keywordflow}{for} (i = (frameCount4 << 2); i < frameCount; ++i) \{}
\DoxyCodeLine{11252         pOutputSamples[i*2+0] = (drflac\_int32)(pInputSamples0U32[i] << shift0) * factor;}
\DoxyCodeLine{11253         pOutputSamples[i*2+1] = (drflac\_int32)(pInputSamples1U32[i] << shift1) * factor;}
\DoxyCodeLine{11254     \}}
\DoxyCodeLine{11255 \}}
\DoxyCodeLine{11256 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11257 }
\DoxyCodeLine{11258 \textcolor{keyword}{static} DRFLAC\_INLINE \textcolor{keywordtype}{void} drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 frameCount, drflac\_uint32 unusedBitsPerSample, \textcolor{keyword}{const} drflac\_int32* pInputSamples0, \textcolor{keyword}{const} drflac\_int32* pInputSamples1, \textcolor{keywordtype}{float}* pOutputSamples)}
\DoxyCodeLine{11259 \{}
\DoxyCodeLine{11260 \textcolor{preprocessor}{\#if defined(DRFLAC\_SUPPORT\_SSE2)}}
\DoxyCodeLine{11261     \textcolor{keywordflow}{if} (drflac\_\_gIsSSE2Supported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{11262         drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_sse2(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11263     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{11264 \textcolor{preprocessor}{\#elif defined(DRFLAC\_SUPPORT\_NEON)}}
\DoxyCodeLine{11265     \textcolor{keywordflow}{if} (drflac\_\_gIsNEONSupported \&\& pFlac-\/>bitsPerSample <= 24) \{}
\DoxyCodeLine{11266         drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_neon(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11267     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{11268 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11269     \{}
\DoxyCodeLine{11270         \textcolor{comment}{/* Scalar fallback. */}}
\DoxyCodeLine{11271 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{11272         drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_reference(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11273 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11274         drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo\_\_scalar(pFlac, frameCount, unusedBitsPerSample, pInputSamples0, pInputSamples1, pOutputSamples);}
\DoxyCodeLine{11275 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11276     \}}
\DoxyCodeLine{11277 \}}
\DoxyCodeLine{11278 }
\DoxyCodeLine{11279 DRFLAC\_API drflac\_uint64 drflac\_read\_pcm\_frames\_f32(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 framesToRead, \textcolor{keywordtype}{float}* pBufferOut)}
\DoxyCodeLine{11280 \{}
\DoxyCodeLine{11281     drflac\_uint64 framesRead;}
\DoxyCodeLine{11282     drflac\_uint32 unusedBitsPerSample;}
\DoxyCodeLine{11283 }
\DoxyCodeLine{11284     \textcolor{keywordflow}{if} (pFlac == NULL || framesToRead == 0) \{}
\DoxyCodeLine{11285         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{11286     \}}
\DoxyCodeLine{11287 }
\DoxyCodeLine{11288     \textcolor{keywordflow}{if} (pBufferOut == NULL) \{}
\DoxyCodeLine{11289         \textcolor{keywordflow}{return} drflac\_\_seek\_forward\_by\_pcm\_frames(pFlac, framesToRead);}
\DoxyCodeLine{11290     \}}
\DoxyCodeLine{11291 }
\DoxyCodeLine{11292     DRFLAC\_ASSERT(pFlac-\/>bitsPerSample <= 32);}
\DoxyCodeLine{11293     unusedBitsPerSample = 32 -\/ pFlac-\/>bitsPerSample;}
\DoxyCodeLine{11294 }
\DoxyCodeLine{11295     framesRead = 0;}
\DoxyCodeLine{11296     \textcolor{keywordflow}{while} (framesToRead > 0) \{}
\DoxyCodeLine{11297         \textcolor{comment}{/* If we've run out of samples in this frame, go to the next. */}}
\DoxyCodeLine{11298         \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining == 0) \{}
\DoxyCodeLine{11299             \textcolor{keywordflow}{if} (!drflac\_\_read\_and\_decode\_next\_flac\_frame(pFlac)) \{}
\DoxyCodeLine{11300                 \textcolor{keywordflow}{break};  \textcolor{comment}{/* Couldn't read the next frame, so just break from the loop and return. */}}
\DoxyCodeLine{11301             \}}
\DoxyCodeLine{11302         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11303             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} channelCount = drflac\_\_get\_channel\_count\_from\_channel\_assignment(pFlac-\/>currentFLACFrame.header.channelAssignment);}
\DoxyCodeLine{11304             drflac\_uint64 iFirstPCMFrame = pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames -\/ pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{11305             drflac\_uint64 frameCountThisIteration = framesToRead;}
\DoxyCodeLine{11306 }
\DoxyCodeLine{11307             \textcolor{keywordflow}{if} (frameCountThisIteration > pFlac-\/>currentFLACFrame.pcmFramesRemaining) \{}
\DoxyCodeLine{11308                 frameCountThisIteration = pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{11309             \}}
\DoxyCodeLine{11310 }
\DoxyCodeLine{11311             \textcolor{keywordflow}{if} (channelCount == 2) \{}
\DoxyCodeLine{11312                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples0 = pFlac-\/>currentFLACFrame.subframes[0].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{11313                 \textcolor{keyword}{const} drflac\_int32* pDecodedSamples1 = pFlac-\/>currentFLACFrame.subframes[1].pSamplesS32 + iFirstPCMFrame;}
\DoxyCodeLine{11314 }
\DoxyCodeLine{11315                 \textcolor{keywordflow}{switch} (pFlac-\/>currentFLACFrame.header.channelAssignment)}
\DoxyCodeLine{11316                 \{}
\DoxyCodeLine{11317                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_LEFT\_SIDE:}
\DoxyCodeLine{11318                     \{}
\DoxyCodeLine{11319                         drflac\_read\_pcm\_frames\_f32\_\_decode\_left\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{11320                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{11321 }
\DoxyCodeLine{11322                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_RIGHT\_SIDE:}
\DoxyCodeLine{11323                     \{}
\DoxyCodeLine{11324                         drflac\_read\_pcm\_frames\_f32\_\_decode\_right\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{11325                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{11326 }
\DoxyCodeLine{11327                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_MID\_SIDE:}
\DoxyCodeLine{11328                     \{}
\DoxyCodeLine{11329                         drflac\_read\_pcm\_frames\_f32\_\_decode\_mid\_side(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{11330                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{11331 }
\DoxyCodeLine{11332                     \textcolor{keywordflow}{case} DRFLAC\_CHANNEL\_ASSIGNMENT\_INDEPENDENT:}
\DoxyCodeLine{11333                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11334                     \{}
\DoxyCodeLine{11335                         drflac\_read\_pcm\_frames\_f32\_\_decode\_independent\_stereo(pFlac, frameCountThisIteration, unusedBitsPerSample, pDecodedSamples0, pDecodedSamples1, pBufferOut);}
\DoxyCodeLine{11336                     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{11337                 \}}
\DoxyCodeLine{11338             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11339                 \textcolor{comment}{/* Generic interleaving. */}}
\DoxyCodeLine{11340                 drflac\_uint64 i;}
\DoxyCodeLine{11341                 \textcolor{keywordflow}{for} (i = 0; i < frameCountThisIteration; ++i) \{}
\DoxyCodeLine{11342                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{11343                     \textcolor{keywordflow}{for} (j = 0; j < channelCount; ++j) \{}
\DoxyCodeLine{11344                         drflac\_int32 sampleS32 = (drflac\_int32)((drflac\_uint32)(pFlac-\/>currentFLACFrame.subframes[j].pSamplesS32[iFirstPCMFrame + i]) << (unusedBitsPerSample + pFlac-\/>currentFLACFrame.subframes[j].wastedBitsPerSample));}
\DoxyCodeLine{11345                         pBufferOut[(i*channelCount)+j] = (\textcolor{keywordtype}{float})(sampleS32 / 2147483648.0);}
\DoxyCodeLine{11346                     \}}
\DoxyCodeLine{11347                 \}}
\DoxyCodeLine{11348             \}}
\DoxyCodeLine{11349 }
\DoxyCodeLine{11350             framesRead                += frameCountThisIteration;}
\DoxyCodeLine{11351             pBufferOut                += frameCountThisIteration * channelCount;}
\DoxyCodeLine{11352             framesToRead              -\/= frameCountThisIteration;}
\DoxyCodeLine{11353             pFlac-\/>currentPCMFrame    += frameCountThisIteration;}
\DoxyCodeLine{11354             pFlac-\/>currentFLACFrame.pcmFramesRemaining -\/= (\textcolor{keywordtype}{unsigned} int)frameCountThisIteration;}
\DoxyCodeLine{11355         \}}
\DoxyCodeLine{11356     \}}
\DoxyCodeLine{11357 }
\DoxyCodeLine{11358     \textcolor{keywordflow}{return} framesRead;}
\DoxyCodeLine{11359 \}}
\DoxyCodeLine{11360 }
\DoxyCodeLine{11361 }
\DoxyCodeLine{11362 DRFLAC\_API drflac\_bool32 drflac\_seek\_to\_pcm\_frame(\mbox{\hyperlink{structdrflac}{drflac}}* pFlac, drflac\_uint64 pcmFrameIndex)}
\DoxyCodeLine{11363 \{}
\DoxyCodeLine{11364     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11365         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{11366     \}}
\DoxyCodeLine{11367 }
\DoxyCodeLine{11368     \textcolor{comment}{/* Don't do anything if we're already on the seek point. */}}
\DoxyCodeLine{11369     \textcolor{keywordflow}{if} (pFlac-\/>currentPCMFrame == pcmFrameIndex) \{}
\DoxyCodeLine{11370         \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{11371     \}}
\DoxyCodeLine{11372 }
\DoxyCodeLine{11373     \textcolor{comment}{/*}}
\DoxyCodeLine{11374 \textcolor{comment}{    If we don't know where the first frame begins then we can't seek. This will happen when the STREAMINFO block was not present}}
\DoxyCodeLine{11375 \textcolor{comment}{    when the decoder was opened.}}
\DoxyCodeLine{11376 \textcolor{comment}{    */}}
\DoxyCodeLine{11377     \textcolor{keywordflow}{if} (pFlac-\/>firstFLACFramePosInBytes == 0) \{}
\DoxyCodeLine{11378         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{11379     \}}
\DoxyCodeLine{11380 }
\DoxyCodeLine{11381     \textcolor{keywordflow}{if} (pcmFrameIndex == 0) \{}
\DoxyCodeLine{11382         pFlac-\/>currentPCMFrame = 0;}
\DoxyCodeLine{11383         \textcolor{keywordflow}{return} drflac\_\_seek\_to\_first\_frame(pFlac);}
\DoxyCodeLine{11384     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11385         drflac\_bool32 wasSuccessful = DRFLAC\_FALSE;}
\DoxyCodeLine{11386         drflac\_uint64 originalPCMFrame = pFlac-\/>currentPCMFrame;}
\DoxyCodeLine{11387 }
\DoxyCodeLine{11388         \textcolor{comment}{/* Clamp the sample to the end. */}}
\DoxyCodeLine{11389         \textcolor{keywordflow}{if} (pcmFrameIndex > pFlac-\/>totalPCMFrameCount) \{}
\DoxyCodeLine{11390             pcmFrameIndex = pFlac-\/>totalPCMFrameCount;}
\DoxyCodeLine{11391         \}}
\DoxyCodeLine{11392 }
\DoxyCodeLine{11393         \textcolor{comment}{/* If the target sample and the current sample are in the same frame we just move the position forward. */}}
\DoxyCodeLine{11394         \textcolor{keywordflow}{if} (pcmFrameIndex > pFlac-\/>currentPCMFrame) \{}
\DoxyCodeLine{11395             \textcolor{comment}{/* Forward. */}}
\DoxyCodeLine{11396             drflac\_uint32 offset = (drflac\_uint32)(pcmFrameIndex -\/ pFlac-\/>currentPCMFrame);}
\DoxyCodeLine{11397             \textcolor{keywordflow}{if} (pFlac-\/>currentFLACFrame.pcmFramesRemaining >  offset) \{}
\DoxyCodeLine{11398                 pFlac-\/>currentFLACFrame.pcmFramesRemaining -\/= offset;}
\DoxyCodeLine{11399                 pFlac-\/>currentPCMFrame = pcmFrameIndex;}
\DoxyCodeLine{11400                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{11401             \}}
\DoxyCodeLine{11402         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11403             \textcolor{comment}{/* Backward. */}}
\DoxyCodeLine{11404             drflac\_uint32 offsetAbs = (drflac\_uint32)(pFlac-\/>currentPCMFrame -\/ pcmFrameIndex);}
\DoxyCodeLine{11405             drflac\_uint32 currentFLACFramePCMFrameCount = pFlac-\/>currentFLACFrame.header.blockSizeInPCMFrames;}
\DoxyCodeLine{11406             drflac\_uint32 currentFLACFramePCMFramesConsumed = currentFLACFramePCMFrameCount -\/ pFlac-\/>currentFLACFrame.pcmFramesRemaining;}
\DoxyCodeLine{11407             \textcolor{keywordflow}{if} (currentFLACFramePCMFramesConsumed > offsetAbs) \{}
\DoxyCodeLine{11408                 pFlac-\/>currentFLACFrame.pcmFramesRemaining += offsetAbs;}
\DoxyCodeLine{11409                 pFlac-\/>currentPCMFrame = pcmFrameIndex;}
\DoxyCodeLine{11410                 \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{11411             \}}
\DoxyCodeLine{11412         \}}
\DoxyCodeLine{11413 }
\DoxyCodeLine{11414         \textcolor{comment}{/*}}
\DoxyCodeLine{11415 \textcolor{comment}{        Different techniques depending on encapsulation. Using the native FLAC seektable with Ogg encapsulation is a bit awkward so}}
\DoxyCodeLine{11416 \textcolor{comment}{        we'll instead use Ogg's natural seeking facility.}}
\DoxyCodeLine{11417 \textcolor{comment}{        */}}
\DoxyCodeLine{11418 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_OGG}}
\DoxyCodeLine{11419         \textcolor{keywordflow}{if} (pFlac-\/>container == drflac\_container\_ogg)}
\DoxyCodeLine{11420         \{}
\DoxyCodeLine{11421             wasSuccessful = drflac\_ogg\_\_seek\_to\_pcm\_frame(pFlac, pcmFrameIndex);}
\DoxyCodeLine{11422         \}}
\DoxyCodeLine{11423         \textcolor{keywordflow}{else}}
\DoxyCodeLine{11424 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11425         \{}
\DoxyCodeLine{11426             \textcolor{comment}{/* First try seeking via the seek table. If this fails, fall back to a brute force seek which is much slower. */}}
\DoxyCodeLine{11427             \textcolor{keywordflow}{if} (!pFlac-\/>\_noSeekTableSeek) \{}
\DoxyCodeLine{11428                 wasSuccessful = drflac\_\_seek\_to\_pcm\_frame\_\_seek\_table(pFlac, pcmFrameIndex);}
\DoxyCodeLine{11429             \}}
\DoxyCodeLine{11430 }
\DoxyCodeLine{11431 \textcolor{preprocessor}{\#if !defined(DR\_FLAC\_NO\_CRC)}}
\DoxyCodeLine{11432             \textcolor{comment}{/* Fall back to binary search if seek table seeking fails. This requires the length of the stream to be known. */}}
\DoxyCodeLine{11433             \textcolor{keywordflow}{if} (!wasSuccessful \&\& !pFlac-\/>\_noBinarySearchSeek \&\& pFlac-\/>totalPCMFrameCount > 0) \{}
\DoxyCodeLine{11434                 wasSuccessful = drflac\_\_seek\_to\_pcm\_frame\_\_binary\_search(pFlac, pcmFrameIndex);}
\DoxyCodeLine{11435             \}}
\DoxyCodeLine{11436 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11437 }
\DoxyCodeLine{11438             \textcolor{comment}{/* Fall back to brute force if all else fails. */}}
\DoxyCodeLine{11439             \textcolor{keywordflow}{if} (!wasSuccessful \&\& !pFlac-\/>\_noBruteForceSeek) \{}
\DoxyCodeLine{11440                 wasSuccessful = drflac\_\_seek\_to\_pcm\_frame\_\_brute\_force(pFlac, pcmFrameIndex);}
\DoxyCodeLine{11441             \}}
\DoxyCodeLine{11442         \}}
\DoxyCodeLine{11443 }
\DoxyCodeLine{11444         \textcolor{keywordflow}{if} (wasSuccessful) \{}
\DoxyCodeLine{11445             pFlac-\/>currentPCMFrame = pcmFrameIndex;}
\DoxyCodeLine{11446         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11447             \textcolor{comment}{/* Seek failed. Try putting the decoder back to it's original state. */}}
\DoxyCodeLine{11448             \textcolor{keywordflow}{if} (drflac\_seek\_to\_pcm\_frame(pFlac, originalPCMFrame) == DRFLAC\_FALSE) \{}
\DoxyCodeLine{11449                 \textcolor{comment}{/* Failed to seek back to the original PCM frame. Fall back to 0. */}}
\DoxyCodeLine{11450                 drflac\_seek\_to\_pcm\_frame(pFlac, 0);}
\DoxyCodeLine{11451             \}}
\DoxyCodeLine{11452         \}}
\DoxyCodeLine{11453 }
\DoxyCodeLine{11454         \textcolor{keywordflow}{return} wasSuccessful;}
\DoxyCodeLine{11455     \}}
\DoxyCodeLine{11456 \}}
\DoxyCodeLine{11457 }
\DoxyCodeLine{11458 }
\DoxyCodeLine{11459 }
\DoxyCodeLine{11460 \textcolor{comment}{/* High Level APIs */}}
\DoxyCodeLine{11461 }
\DoxyCodeLine{11462 \textcolor{preprocessor}{\#if defined(SIZE\_MAX)}}
\DoxyCodeLine{11463 \textcolor{preprocessor}{    \#define DRFLAC\_SIZE\_MAX  SIZE\_MAX}}
\DoxyCodeLine{11464 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11465 \textcolor{preprocessor}{    \#if defined(DRFLAC\_64BIT)}}
\DoxyCodeLine{11466 \textcolor{preprocessor}{        \#define DRFLAC\_SIZE\_MAX  ((drflac\_uint64)0xFFFFFFFFFFFFFFFF)}}
\DoxyCodeLine{11467 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{11468 \textcolor{preprocessor}{        \#define DRFLAC\_SIZE\_MAX  0xFFFFFFFF}}
\DoxyCodeLine{11469 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{11470 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11471 }
\DoxyCodeLine{11472 }
\DoxyCodeLine{11473 \textcolor{comment}{/* Using a macro as the definition of the drflac\_\_full\_decode\_and\_close\_*() API family. Sue me. */}}
\DoxyCodeLine{11474 \textcolor{preprocessor}{\#define DRFLAC\_DEFINE\_FULL\_READ\_AND\_CLOSE(extension, type) \(\backslash\)}}
\DoxyCodeLine{11475 \textcolor{preprocessor}{static type* drflac\_\_full\_read\_and\_close\_ \#\# extension (drflac* pFlac, unsigned int* channelsOut, unsigned int* sampleRateOut, drflac\_uint64* totalPCMFrameCountOut)\(\backslash\)}}
\DoxyCodeLine{11476 \textcolor{preprocessor}{\{                                                                                                                                                                   \(\backslash\)}}
\DoxyCodeLine{11477 \textcolor{preprocessor}{    type* pSampleData = NULL;                                                                                                                                       \(\backslash\)}}
\DoxyCodeLine{11478 \textcolor{preprocessor}{    drflac\_uint64 totalPCMFrameCount;                                                                                                                               \(\backslash\)}}
\DoxyCodeLine{11479 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11480 \textcolor{preprocessor}{    DRFLAC\_ASSERT(pFlac != NULL);                                                                                                                                   \(\backslash\)}}
\DoxyCodeLine{11481 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11482 \textcolor{preprocessor}{    totalPCMFrameCount = pFlac-\/>totalPCMFrameCount;                                                                                                                 \(\backslash\)}}
\DoxyCodeLine{11483 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11484 \textcolor{preprocessor}{    if (totalPCMFrameCount == 0) \{                                                                                                                                  \(\backslash\)}}
\DoxyCodeLine{11485 \textcolor{preprocessor}{        type buffer[4096];                                                                                                                                          \(\backslash\)}}
\DoxyCodeLine{11486 \textcolor{preprocessor}{        drflac\_uint64 pcmFramesRead;                                                                                                                                \(\backslash\)}}
\DoxyCodeLine{11487 \textcolor{preprocessor}{        size\_t sampleDataBufferSize = sizeof(buffer);                                                                                                               \(\backslash\)}}
\DoxyCodeLine{11488 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11489 \textcolor{preprocessor}{        pSampleData = (type*)drflac\_\_malloc\_from\_callbacks(sampleDataBufferSize, \&pFlac-\/>allocationCallbacks);                                                      \(\backslash\)}}
\DoxyCodeLine{11490 \textcolor{preprocessor}{        if (pSampleData == NULL) \{                                                                                                                                  \(\backslash\)}}
\DoxyCodeLine{11491 \textcolor{preprocessor}{            goto on\_error;                                                                                                                                          \(\backslash\)}}
\DoxyCodeLine{11492 \textcolor{preprocessor}{        \}                                                                                                                                                           \(\backslash\)}}
\DoxyCodeLine{11493 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11494 \textcolor{preprocessor}{        while ((pcmFramesRead = (drflac\_uint64)drflac\_read\_pcm\_frames\_\#\#extension(pFlac, sizeof(buffer)/sizeof(buffer[0])/pFlac-\/>channels, buffer)) > 0) \{          \(\backslash\)}}
\DoxyCodeLine{11495 \textcolor{preprocessor}{            if (((totalPCMFrameCount + pcmFramesRead) * pFlac-\/>channels * sizeof(type)) > sampleDataBufferSize) \{                                                   \(\backslash\)}}
\DoxyCodeLine{11496 \textcolor{preprocessor}{                type* pNewSampleData;                                                                                                                               \(\backslash\)}}
\DoxyCodeLine{11497 \textcolor{preprocessor}{                size\_t newSampleDataBufferSize;                                                                                                                     \(\backslash\)}}
\DoxyCodeLine{11498 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11499 \textcolor{preprocessor}{                newSampleDataBufferSize = sampleDataBufferSize * 2;                                                                                                 \(\backslash\)}}
\DoxyCodeLine{11500 \textcolor{preprocessor}{                pNewSampleData = (type*)drflac\_\_realloc\_from\_callbacks(pSampleData, newSampleDataBufferSize, sampleDataBufferSize, \&pFlac-\/>allocationCallbacks);    \(\backslash\)}}
\DoxyCodeLine{11501 \textcolor{preprocessor}{                if (pNewSampleData == NULL) \{                                                                                                                       \(\backslash\)}}
\DoxyCodeLine{11502 \textcolor{preprocessor}{                    drflac\_\_free\_from\_callbacks(pSampleData, \&pFlac-\/>allocationCallbacks);                                                                          \(\backslash\)}}
\DoxyCodeLine{11503 \textcolor{preprocessor}{                    goto on\_error;                                                                                                                                  \(\backslash\)}}
\DoxyCodeLine{11504 \textcolor{preprocessor}{                \}                                                                                                                                                   \(\backslash\)}}
\DoxyCodeLine{11505 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11506 \textcolor{preprocessor}{                sampleDataBufferSize = newSampleDataBufferSize;                                                                                                     \(\backslash\)}}
\DoxyCodeLine{11507 \textcolor{preprocessor}{                pSampleData = pNewSampleData;                                                                                                                       \(\backslash\)}}
\DoxyCodeLine{11508 \textcolor{preprocessor}{            \}                                                                                                                                                       \(\backslash\)}}
\DoxyCodeLine{11509 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11510 \textcolor{preprocessor}{            DRFLAC\_COPY\_MEMORY(pSampleData + (totalPCMFrameCount*pFlac-\/>channels), buffer, (size\_t)(pcmFramesRead*pFlac-\/>channels*sizeof(type)));                   \(\backslash\)}}
\DoxyCodeLine{11511 \textcolor{preprocessor}{            totalPCMFrameCount += pcmFramesRead;                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11512 \textcolor{preprocessor}{        \}                                                                                                                                                           \(\backslash\)}}
\DoxyCodeLine{11513 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11514 \textcolor{preprocessor}{        }\textcolor{comment}{/* At this point everything should be decoded, but we just want to fill the unused part buffer with silence -\/ need to                                       \(\backslash\)}}
\DoxyCodeLine{11515 \textcolor{comment}{           protect those ears from random noise! */}\textcolor{preprocessor}{                                                                                                                 \(\backslash\)}}
\DoxyCodeLine{11516 \textcolor{preprocessor}{        DRFLAC\_ZERO\_MEMORY(pSampleData + (totalPCMFrameCount*pFlac-\/>channels), (size\_t)(sampleDataBufferSize -\/ totalPCMFrameCount*pFlac-\/>channels*sizeof(type)));   \(\backslash\)}}
\DoxyCodeLine{11517 \textcolor{preprocessor}{    \} else \{                                                                                                                                                        \(\backslash\)}}
\DoxyCodeLine{11518 \textcolor{preprocessor}{        drflac\_uint64 dataSize = totalPCMFrameCount*pFlac-\/>channels*sizeof(type);                                                                                   \(\backslash\)}}
\DoxyCodeLine{11519 \textcolor{preprocessor}{        if (dataSize > (drflac\_uint64)DRFLAC\_SIZE\_MAX) \{                                                                                                            \(\backslash\)}}
\DoxyCodeLine{11520 \textcolor{preprocessor}{            goto on\_error;  }\textcolor{comment}{/* The decoded data is too big. */}\textcolor{preprocessor}{                                                                                                      \(\backslash\)}}
\DoxyCodeLine{11521 \textcolor{preprocessor}{        \}                                                                                                                                                           \(\backslash\)}}
\DoxyCodeLine{11522 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11523 \textcolor{preprocessor}{        pSampleData = (type*)drflac\_\_malloc\_from\_callbacks((size\_t)dataSize, \&pFlac-\/>allocationCallbacks);    }\textcolor{comment}{/* <-\/-\/ Safe cast as per the check above. */}\textcolor{preprocessor}{           \(\backslash\)}}
\DoxyCodeLine{11524 \textcolor{preprocessor}{        if (pSampleData == NULL) \{                                                                                                                                  \(\backslash\)}}
\DoxyCodeLine{11525 \textcolor{preprocessor}{            goto on\_error;                                                                                                                                          \(\backslash\)}}
\DoxyCodeLine{11526 \textcolor{preprocessor}{        \}                                                                                                                                                           \(\backslash\)}}
\DoxyCodeLine{11527 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11528 \textcolor{preprocessor}{        totalPCMFrameCount = drflac\_read\_pcm\_frames\_\#\#extension(pFlac, pFlac-\/>totalPCMFrameCount, pSampleData);                                                     \(\backslash\)}}
\DoxyCodeLine{11529 \textcolor{preprocessor}{    \}                                                                                                                                                               \(\backslash\)}}
\DoxyCodeLine{11530 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11531 \textcolor{preprocessor}{    if (sampleRateOut) *sampleRateOut = pFlac-\/>sampleRate;                                                                                                          \(\backslash\)}}
\DoxyCodeLine{11532 \textcolor{preprocessor}{    if (channelsOut) *channelsOut = pFlac-\/>channels;                                                                                                                \(\backslash\)}}
\DoxyCodeLine{11533 \textcolor{preprocessor}{    if (totalPCMFrameCountOut) *totalPCMFrameCountOut = totalPCMFrameCount;                                                                                         \(\backslash\)}}
\DoxyCodeLine{11534 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11535 \textcolor{preprocessor}{    drflac\_close(pFlac);                                                                                                                                            \(\backslash\)}}
\DoxyCodeLine{11536 \textcolor{preprocessor}{    return pSampleData;                                                                                                                                             \(\backslash\)}}
\DoxyCodeLine{11537 \textcolor{preprocessor}{                                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11538 \textcolor{preprocessor}{on\_error:                                                                                                                                                           \(\backslash\)}}
\DoxyCodeLine{11539 \textcolor{preprocessor}{    drflac\_close(pFlac);                                                                                                                                            \(\backslash\)}}
\DoxyCodeLine{11540 \textcolor{preprocessor}{    return NULL;                                                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{11541 \textcolor{preprocessor}{\}}}
\DoxyCodeLine{11542 }
\DoxyCodeLine{11543 DRFLAC\_DEFINE\_FULL\_READ\_AND\_CLOSE(s32, drflac\_int32)}
\DoxyCodeLine{11544 DRFLAC\_DEFINE\_FULL\_READ\_AND\_CLOSE(s16, drflac\_int16)}
\DoxyCodeLine{11545 DRFLAC\_DEFINE\_FULL\_READ\_AND\_CLOSE(f32, \textcolor{keywordtype}{float})}
\DoxyCodeLine{11546 }
\DoxyCodeLine{11547 DRFLAC\_API drflac\_int32* drflac\_open\_and\_read\_pcm\_frames\_s32(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channelsOut, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRateOut, drflac\_uint64* totalPCMFrameCountOut, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11548 \{}
\DoxyCodeLine{11549     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11550 }
\DoxyCodeLine{11551     \textcolor{keywordflow}{if} (channelsOut) \{}
\DoxyCodeLine{11552         *channelsOut = 0;}
\DoxyCodeLine{11553     \}}
\DoxyCodeLine{11554     \textcolor{keywordflow}{if} (sampleRateOut) \{}
\DoxyCodeLine{11555         *sampleRateOut = 0;}
\DoxyCodeLine{11556     \}}
\DoxyCodeLine{11557     \textcolor{keywordflow}{if} (totalPCMFrameCountOut) \{}
\DoxyCodeLine{11558         *totalPCMFrameCountOut = 0;}
\DoxyCodeLine{11559     \}}
\DoxyCodeLine{11560 }
\DoxyCodeLine{11561     pFlac = drflac\_open(onRead, onSeek, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{11562     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11563         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11564     \}}
\DoxyCodeLine{11565 }
\DoxyCodeLine{11566     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s32(pFlac, channelsOut, sampleRateOut, totalPCMFrameCountOut);}
\DoxyCodeLine{11567 \}}
\DoxyCodeLine{11568 }
\DoxyCodeLine{11569 DRFLAC\_API drflac\_int16* drflac\_open\_and\_read\_pcm\_frames\_s16(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channelsOut, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRateOut, drflac\_uint64* totalPCMFrameCountOut, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11570 \{}
\DoxyCodeLine{11571     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11572 }
\DoxyCodeLine{11573     \textcolor{keywordflow}{if} (channelsOut) \{}
\DoxyCodeLine{11574         *channelsOut = 0;}
\DoxyCodeLine{11575     \}}
\DoxyCodeLine{11576     \textcolor{keywordflow}{if} (sampleRateOut) \{}
\DoxyCodeLine{11577         *sampleRateOut = 0;}
\DoxyCodeLine{11578     \}}
\DoxyCodeLine{11579     \textcolor{keywordflow}{if} (totalPCMFrameCountOut) \{}
\DoxyCodeLine{11580         *totalPCMFrameCountOut = 0;}
\DoxyCodeLine{11581     \}}
\DoxyCodeLine{11582 }
\DoxyCodeLine{11583     pFlac = drflac\_open(onRead, onSeek, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{11584     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11585         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11586     \}}
\DoxyCodeLine{11587 }
\DoxyCodeLine{11588     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s16(pFlac, channelsOut, sampleRateOut, totalPCMFrameCountOut);}
\DoxyCodeLine{11589 \}}
\DoxyCodeLine{11590 }
\DoxyCodeLine{11591 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_and\_read\_pcm\_frames\_f32(drflac\_read\_proc onRead, drflac\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channelsOut, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRateOut, drflac\_uint64* totalPCMFrameCountOut, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11592 \{}
\DoxyCodeLine{11593     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11594 }
\DoxyCodeLine{11595     \textcolor{keywordflow}{if} (channelsOut) \{}
\DoxyCodeLine{11596         *channelsOut = 0;}
\DoxyCodeLine{11597     \}}
\DoxyCodeLine{11598     \textcolor{keywordflow}{if} (sampleRateOut) \{}
\DoxyCodeLine{11599         *sampleRateOut = 0;}
\DoxyCodeLine{11600     \}}
\DoxyCodeLine{11601     \textcolor{keywordflow}{if} (totalPCMFrameCountOut) \{}
\DoxyCodeLine{11602         *totalPCMFrameCountOut = 0;}
\DoxyCodeLine{11603     \}}
\DoxyCodeLine{11604 }
\DoxyCodeLine{11605     pFlac = drflac\_open(onRead, onSeek, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{11606     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11607         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11608     \}}
\DoxyCodeLine{11609 }
\DoxyCodeLine{11610     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_f32(pFlac, channelsOut, sampleRateOut, totalPCMFrameCountOut);}
\DoxyCodeLine{11611 \}}
\DoxyCodeLine{11612 }
\DoxyCodeLine{11613 \textcolor{preprocessor}{\#ifndef DR\_FLAC\_NO\_STDIO}}
\DoxyCodeLine{11614 DRFLAC\_API drflac\_int32* drflac\_open\_file\_and\_read\_pcm\_frames\_s32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11615 \{}
\DoxyCodeLine{11616     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11617 }
\DoxyCodeLine{11618     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11619         *sampleRate = 0;}
\DoxyCodeLine{11620     \}}
\DoxyCodeLine{11621     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11622         *channels = 0;}
\DoxyCodeLine{11623     \}}
\DoxyCodeLine{11624     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11625         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11626     \}}
\DoxyCodeLine{11627 }
\DoxyCodeLine{11628     pFlac = drflac\_open\_file(filename, pAllocationCallbacks);}
\DoxyCodeLine{11629     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11630         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11631     \}}
\DoxyCodeLine{11632 }
\DoxyCodeLine{11633     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s32(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11634 \}}
\DoxyCodeLine{11635 }
\DoxyCodeLine{11636 DRFLAC\_API drflac\_int16* drflac\_open\_file\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11637 \{}
\DoxyCodeLine{11638     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11639 }
\DoxyCodeLine{11640     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11641         *sampleRate = 0;}
\DoxyCodeLine{11642     \}}
\DoxyCodeLine{11643     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11644         *channels = 0;}
\DoxyCodeLine{11645     \}}
\DoxyCodeLine{11646     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11647         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11648     \}}
\DoxyCodeLine{11649 }
\DoxyCodeLine{11650     pFlac = drflac\_open\_file(filename, pAllocationCallbacks);}
\DoxyCodeLine{11651     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11652         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11653     \}}
\DoxyCodeLine{11654 }
\DoxyCodeLine{11655     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s16(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11656 \}}
\DoxyCodeLine{11657 }
\DoxyCodeLine{11658 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_file\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11659 \{}
\DoxyCodeLine{11660     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11661 }
\DoxyCodeLine{11662     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11663         *sampleRate = 0;}
\DoxyCodeLine{11664     \}}
\DoxyCodeLine{11665     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11666         *channels = 0;}
\DoxyCodeLine{11667     \}}
\DoxyCodeLine{11668     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11669         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11670     \}}
\DoxyCodeLine{11671 }
\DoxyCodeLine{11672     pFlac = drflac\_open\_file(filename, pAllocationCallbacks);}
\DoxyCodeLine{11673     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11674         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11675     \}}
\DoxyCodeLine{11676 }
\DoxyCodeLine{11677     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_f32(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11678 \}}
\DoxyCodeLine{11679 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11680 }
\DoxyCodeLine{11681 DRFLAC\_API drflac\_int32* drflac\_open\_memory\_and\_read\_pcm\_frames\_s32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11682 \{}
\DoxyCodeLine{11683     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11684 }
\DoxyCodeLine{11685     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11686         *sampleRate = 0;}
\DoxyCodeLine{11687     \}}
\DoxyCodeLine{11688     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11689         *channels = 0;}
\DoxyCodeLine{11690     \}}
\DoxyCodeLine{11691     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11692         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11693     \}}
\DoxyCodeLine{11694 }
\DoxyCodeLine{11695     pFlac = drflac\_open\_memory(data, dataSize, pAllocationCallbacks);}
\DoxyCodeLine{11696     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11697         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11698     \}}
\DoxyCodeLine{11699 }
\DoxyCodeLine{11700     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s32(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11701 \}}
\DoxyCodeLine{11702 }
\DoxyCodeLine{11703 DRFLAC\_API drflac\_int16* drflac\_open\_memory\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11704 \{}
\DoxyCodeLine{11705     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11706 }
\DoxyCodeLine{11707     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11708         *sampleRate = 0;}
\DoxyCodeLine{11709     \}}
\DoxyCodeLine{11710     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11711         *channels = 0;}
\DoxyCodeLine{11712     \}}
\DoxyCodeLine{11713     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11714         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11715     \}}
\DoxyCodeLine{11716 }
\DoxyCodeLine{11717     pFlac = drflac\_open\_memory(data, dataSize, pAllocationCallbacks);}
\DoxyCodeLine{11718     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11719         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11720     \}}
\DoxyCodeLine{11721 }
\DoxyCodeLine{11722     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_s16(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11723 \}}
\DoxyCodeLine{11724 }
\DoxyCodeLine{11725 DRFLAC\_API \textcolor{keywordtype}{float}* drflac\_open\_memory\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* channels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}* sampleRate, drflac\_uint64* totalPCMFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11726 \{}
\DoxyCodeLine{11727     \mbox{\hyperlink{structdrflac}{drflac}}* pFlac;}
\DoxyCodeLine{11728 }
\DoxyCodeLine{11729     \textcolor{keywordflow}{if} (sampleRate) \{}
\DoxyCodeLine{11730         *sampleRate = 0;}
\DoxyCodeLine{11731     \}}
\DoxyCodeLine{11732     \textcolor{keywordflow}{if} (channels) \{}
\DoxyCodeLine{11733         *channels = 0;}
\DoxyCodeLine{11734     \}}
\DoxyCodeLine{11735     \textcolor{keywordflow}{if} (totalPCMFrameCount) \{}
\DoxyCodeLine{11736         *totalPCMFrameCount = 0;}
\DoxyCodeLine{11737     \}}
\DoxyCodeLine{11738 }
\DoxyCodeLine{11739     pFlac = drflac\_open\_memory(data, dataSize, pAllocationCallbacks);}
\DoxyCodeLine{11740     \textcolor{keywordflow}{if} (pFlac == NULL) \{}
\DoxyCodeLine{11741         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11742     \}}
\DoxyCodeLine{11743 }
\DoxyCodeLine{11744     \textcolor{keywordflow}{return} drflac\_\_full\_read\_and\_close\_f32(pFlac, channels, sampleRate, totalPCMFrameCount);}
\DoxyCodeLine{11745 \}}
\DoxyCodeLine{11746 }
\DoxyCodeLine{11747 }
\DoxyCodeLine{11748 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_free(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__allocation__callbacks}{drflac\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{11749 \{}
\DoxyCodeLine{11750     \textcolor{keywordflow}{if} (pAllocationCallbacks != NULL) \{}
\DoxyCodeLine{11751         drflac\_\_free\_from\_callbacks(p, pAllocationCallbacks);}
\DoxyCodeLine{11752     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{11753         drflac\_\_free\_default(p, NULL);}
\DoxyCodeLine{11754     \}}
\DoxyCodeLine{11755 \}}
\DoxyCodeLine{11756 }
\DoxyCodeLine{11757 }
\DoxyCodeLine{11758 }
\DoxyCodeLine{11759 }
\DoxyCodeLine{11760 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_init\_vorbis\_comment\_iterator(\mbox{\hyperlink{structdrflac__vorbis__comment__iterator}{drflac\_vorbis\_comment\_iterator}}* pIter, drflac\_uint32 commentCount, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pComments)}
\DoxyCodeLine{11761 \{}
\DoxyCodeLine{11762     \textcolor{keywordflow}{if} (pIter == NULL) \{}
\DoxyCodeLine{11763         \textcolor{keywordflow}{return};}
\DoxyCodeLine{11764     \}}
\DoxyCodeLine{11765 }
\DoxyCodeLine{11766     pIter-\/>countRemaining = commentCount;}
\DoxyCodeLine{11767     pIter-\/>pRunningData   = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pComments;}
\DoxyCodeLine{11768 \}}
\DoxyCodeLine{11769 }
\DoxyCodeLine{11770 DRFLAC\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drflac\_next\_vorbis\_comment(\mbox{\hyperlink{structdrflac__vorbis__comment__iterator}{drflac\_vorbis\_comment\_iterator}}* pIter, drflac\_uint32* pCommentLengthOut)}
\DoxyCodeLine{11771 \{}
\DoxyCodeLine{11772     drflac\_int32 length;}
\DoxyCodeLine{11773     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pComment;}
\DoxyCodeLine{11774 }
\DoxyCodeLine{11775     \textcolor{comment}{/* Safety. */}}
\DoxyCodeLine{11776     \textcolor{keywordflow}{if} (pCommentLengthOut) \{}
\DoxyCodeLine{11777         *pCommentLengthOut = 0;}
\DoxyCodeLine{11778     \}}
\DoxyCodeLine{11779 }
\DoxyCodeLine{11780     \textcolor{keywordflow}{if} (pIter == NULL || pIter-\/>countRemaining == 0 || pIter-\/>pRunningData == NULL) \{}
\DoxyCodeLine{11781         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{11782     \}}
\DoxyCodeLine{11783 }
\DoxyCodeLine{11784     length = drflac\_\_le2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pIter-\/>pRunningData);}
\DoxyCodeLine{11785     pIter-\/>pRunningData += 4;}
\DoxyCodeLine{11786 }
\DoxyCodeLine{11787     pComment = pIter-\/>pRunningData;}
\DoxyCodeLine{11788     pIter-\/>pRunningData += length;}
\DoxyCodeLine{11789     pIter-\/>countRemaining -\/= 1;}
\DoxyCodeLine{11790 }
\DoxyCodeLine{11791     \textcolor{keywordflow}{if} (pCommentLengthOut) \{}
\DoxyCodeLine{11792         *pCommentLengthOut = length;}
\DoxyCodeLine{11793     \}}
\DoxyCodeLine{11794 }
\DoxyCodeLine{11795     \textcolor{keywordflow}{return} pComment;}
\DoxyCodeLine{11796 \}}
\DoxyCodeLine{11797 }
\DoxyCodeLine{11798 }
\DoxyCodeLine{11799 }
\DoxyCodeLine{11800 }
\DoxyCodeLine{11801 DRFLAC\_API \textcolor{keywordtype}{void} drflac\_init\_cuesheet\_track\_iterator(\mbox{\hyperlink{structdrflac__cuesheet__track__iterator}{drflac\_cuesheet\_track\_iterator}}* pIter, drflac\_uint32 trackCount, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pTrackData)}
\DoxyCodeLine{11802 \{}
\DoxyCodeLine{11803     \textcolor{keywordflow}{if} (pIter == NULL) \{}
\DoxyCodeLine{11804         \textcolor{keywordflow}{return};}
\DoxyCodeLine{11805     \}}
\DoxyCodeLine{11806 }
\DoxyCodeLine{11807     pIter-\/>countRemaining = trackCount;}
\DoxyCodeLine{11808     pIter-\/>pRunningData   = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)pTrackData;}
\DoxyCodeLine{11809 \}}
\DoxyCodeLine{11810 }
\DoxyCodeLine{11811 DRFLAC\_API drflac\_bool32 drflac\_next\_cuesheet\_track(\mbox{\hyperlink{structdrflac__cuesheet__track__iterator}{drflac\_cuesheet\_track\_iterator}}* pIter, \mbox{\hyperlink{structdrflac__cuesheet__track}{drflac\_cuesheet\_track}}* pCuesheetTrack)}
\DoxyCodeLine{11812 \{}
\DoxyCodeLine{11813     \mbox{\hyperlink{structdrflac__cuesheet__track}{drflac\_cuesheet\_track}} cuesheetTrack;}
\DoxyCodeLine{11814     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pRunningData;}
\DoxyCodeLine{11815     drflac\_uint64 offsetHi;}
\DoxyCodeLine{11816     drflac\_uint64 offsetLo;}
\DoxyCodeLine{11817 }
\DoxyCodeLine{11818     \textcolor{keywordflow}{if} (pIter == NULL || pIter-\/>countRemaining == 0 || pIter-\/>pRunningData == NULL) \{}
\DoxyCodeLine{11819         \textcolor{keywordflow}{return} DRFLAC\_FALSE;}
\DoxyCodeLine{11820     \}}
\DoxyCodeLine{11821 }
\DoxyCodeLine{11822     pRunningData = pIter-\/>pRunningData;}
\DoxyCodeLine{11823 }
\DoxyCodeLine{11824     offsetHi                   = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{11825     offsetLo                   = drflac\_\_be2host\_32(*(\textcolor{keyword}{const} drflac\_uint32*)pRunningData); pRunningData += 4;}
\DoxyCodeLine{11826     cuesheetTrack.offset       = offsetLo | (offsetHi << 32);}
\DoxyCodeLine{11827     cuesheetTrack.trackNumber  = pRunningData[0];                                         pRunningData += 1;}
\DoxyCodeLine{11828     DRFLAC\_COPY\_MEMORY(cuesheetTrack.ISRC, pRunningData, \textcolor{keyword}{sizeof}(cuesheetTrack.ISRC));     pRunningData += 12;}
\DoxyCodeLine{11829     cuesheetTrack.isAudio      = (pRunningData[0] \& 0x80) != 0;}
\DoxyCodeLine{11830     cuesheetTrack.preEmphasis  = (pRunningData[0] \& 0x40) != 0;                           pRunningData += 14;}
\DoxyCodeLine{11831     cuesheetTrack.indexCount   = pRunningData[0];                                         pRunningData += 1;}
\DoxyCodeLine{11832     cuesheetTrack.pIndexPoints = (\textcolor{keyword}{const} \mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}}*)pRunningData;        pRunningData += cuesheetTrack.indexCount * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrflac__cuesheet__track__index}{drflac\_cuesheet\_track\_index}});}
\DoxyCodeLine{11833 }
\DoxyCodeLine{11834     pIter-\/>pRunningData = pRunningData;}
\DoxyCodeLine{11835     pIter-\/>countRemaining -\/= 1;}
\DoxyCodeLine{11836 }
\DoxyCodeLine{11837     \textcolor{keywordflow}{if} (pCuesheetTrack) \{}
\DoxyCodeLine{11838         *pCuesheetTrack = cuesheetTrack;}
\DoxyCodeLine{11839     \}}
\DoxyCodeLine{11840 }
\DoxyCodeLine{11841     \textcolor{keywordflow}{return} DRFLAC\_TRUE;}
\DoxyCodeLine{11842 \}}
\DoxyCodeLine{11843 }
\DoxyCodeLine{11844 \textcolor{preprocessor}{\#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{11845 \textcolor{preprocessor}{    \#pragma GCC diagnostic pop}}
\DoxyCodeLine{11846 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11847 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* dr\_flac\_c */}\textcolor{preprocessor}{}}
\DoxyCodeLine{11848 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* DR\_FLAC\_IMPLEMENTATION */}\textcolor{preprocessor}{}}
\DoxyCodeLine{11849 }
\DoxyCodeLine{11850 }
\DoxyCodeLine{11851 \textcolor{comment}{/*}}
\DoxyCodeLine{11852 \textcolor{comment}{REVISION HISTORY}}
\DoxyCodeLine{11853 \textcolor{comment}{================}}
\DoxyCodeLine{11854 \textcolor{comment}{v0.12.31 -\/ 2021-\/08-\/16}}
\DoxyCodeLine{11855 \textcolor{comment}{  -\/ Silence some warnings.}}
\DoxyCodeLine{11856 \textcolor{comment}{}}
\DoxyCodeLine{11857 \textcolor{comment}{v0.12.30 -\/ 2021-\/07-\/31}}
\DoxyCodeLine{11858 \textcolor{comment}{  -\/ Fix platform detection for ARM64.}}
\DoxyCodeLine{11859 \textcolor{comment}{}}
\DoxyCodeLine{11860 \textcolor{comment}{v0.12.29 -\/ 2021-\/04-\/02}}
\DoxyCodeLine{11861 \textcolor{comment}{  -\/ Fix a bug where the running PCM frame index is set to an invalid value when over-\/seeking.}}
\DoxyCodeLine{11862 \textcolor{comment}{  -\/ Fix a decoding error due to an incorrect validation check.}}
\DoxyCodeLine{11863 \textcolor{comment}{}}
\DoxyCodeLine{11864 \textcolor{comment}{v0.12.28 -\/ 2021-\/02-\/21}}
\DoxyCodeLine{11865 \textcolor{comment}{  -\/ Fix a warning due to referencing \_MSC\_VER when it is undefined.}}
\DoxyCodeLine{11866 \textcolor{comment}{}}
\DoxyCodeLine{11867 \textcolor{comment}{v0.12.27 -\/ 2021-\/01-\/31}}
\DoxyCodeLine{11868 \textcolor{comment}{  -\/ Fix a static analysis warning.}}
\DoxyCodeLine{11869 \textcolor{comment}{}}
\DoxyCodeLine{11870 \textcolor{comment}{v0.12.26 -\/ 2021-\/01-\/17}}
\DoxyCodeLine{11871 \textcolor{comment}{  -\/ Fix a compilation warning due to \_BSD\_SOURCE being deprecated.}}
\DoxyCodeLine{11872 \textcolor{comment}{}}
\DoxyCodeLine{11873 \textcolor{comment}{v0.12.25 -\/ 2020-\/12-\/26}}
\DoxyCodeLine{11874 \textcolor{comment}{  -\/ Update documentation.}}
\DoxyCodeLine{11875 \textcolor{comment}{}}
\DoxyCodeLine{11876 \textcolor{comment}{v0.12.24 -\/ 2020-\/11-\/29}}
\DoxyCodeLine{11877 \textcolor{comment}{  -\/ Fix ARM64/NEON detection when compiling with MSVC.}}
\DoxyCodeLine{11878 \textcolor{comment}{}}
\DoxyCodeLine{11879 \textcolor{comment}{v0.12.23 -\/ 2020-\/11-\/21}}
\DoxyCodeLine{11880 \textcolor{comment}{  -\/ Fix compilation with OpenWatcom.}}
\DoxyCodeLine{11881 \textcolor{comment}{}}
\DoxyCodeLine{11882 \textcolor{comment}{v0.12.22 -\/ 2020-\/11-\/01}}
\DoxyCodeLine{11883 \textcolor{comment}{  -\/ Fix an error with the previous release.}}
\DoxyCodeLine{11884 \textcolor{comment}{}}
\DoxyCodeLine{11885 \textcolor{comment}{v0.12.21 -\/ 2020-\/11-\/01}}
\DoxyCodeLine{11886 \textcolor{comment}{  -\/ Fix a possible deadlock when seeking.}}
\DoxyCodeLine{11887 \textcolor{comment}{  -\/ Improve compiler support for older versions of GCC.}}
\DoxyCodeLine{11888 \textcolor{comment}{}}
\DoxyCodeLine{11889 \textcolor{comment}{v0.12.20 -\/ 2020-\/09-\/08}}
\DoxyCodeLine{11890 \textcolor{comment}{  -\/ Fix a compilation error on older compilers.}}
\DoxyCodeLine{11891 \textcolor{comment}{}}
\DoxyCodeLine{11892 \textcolor{comment}{v0.12.19 -\/ 2020-\/08-\/30}}
\DoxyCodeLine{11893 \textcolor{comment}{  -\/ Fix a bug due to an undefined 32-\/bit shift.}}
\DoxyCodeLine{11894 \textcolor{comment}{}}
\DoxyCodeLine{11895 \textcolor{comment}{v0.12.18 -\/ 2020-\/08-\/14}}
\DoxyCodeLine{11896 \textcolor{comment}{  -\/ Fix a crash when compiling with clang-\/cl.}}
\DoxyCodeLine{11897 \textcolor{comment}{}}
\DoxyCodeLine{11898 \textcolor{comment}{v0.12.17 -\/ 2020-\/08-\/02}}
\DoxyCodeLine{11899 \textcolor{comment}{  -\/ Simplify sized types.}}
\DoxyCodeLine{11900 \textcolor{comment}{}}
\DoxyCodeLine{11901 \textcolor{comment}{v0.12.16 -\/ 2020-\/07-\/25}}
\DoxyCodeLine{11902 \textcolor{comment}{  -\/ Fix a compilation warning.}}
\DoxyCodeLine{11903 \textcolor{comment}{}}
\DoxyCodeLine{11904 \textcolor{comment}{v0.12.15 -\/ 2020-\/07-\/06}}
\DoxyCodeLine{11905 \textcolor{comment}{  -\/ Check for negative LPC shifts and return an error.}}
\DoxyCodeLine{11906 \textcolor{comment}{}}
\DoxyCodeLine{11907 \textcolor{comment}{v0.12.14 -\/ 2020-\/06-\/23}}
\DoxyCodeLine{11908 \textcolor{comment}{  -\/ Add include guard for the implementation section.}}
\DoxyCodeLine{11909 \textcolor{comment}{}}
\DoxyCodeLine{11910 \textcolor{comment}{v0.12.13 -\/ 2020-\/05-\/16}}
\DoxyCodeLine{11911 \textcolor{comment}{  -\/ Add compile-\/time and run-\/time version querying.}}
\DoxyCodeLine{11912 \textcolor{comment}{    -\/ DRFLAC\_VERSION\_MINOR}}
\DoxyCodeLine{11913 \textcolor{comment}{    -\/ DRFLAC\_VERSION\_MAJOR}}
\DoxyCodeLine{11914 \textcolor{comment}{    -\/ DRFLAC\_VERSION\_REVISION}}
\DoxyCodeLine{11915 \textcolor{comment}{    -\/ DRFLAC\_VERSION\_STRING}}
\DoxyCodeLine{11916 \textcolor{comment}{    -\/ drflac\_version()}}
\DoxyCodeLine{11917 \textcolor{comment}{    -\/ drflac\_version\_string()}}
\DoxyCodeLine{11918 \textcolor{comment}{}}
\DoxyCodeLine{11919 \textcolor{comment}{v0.12.12 -\/ 2020-\/04-\/30}}
\DoxyCodeLine{11920 \textcolor{comment}{  -\/ Fix compilation errors with VC6.}}
\DoxyCodeLine{11921 \textcolor{comment}{}}
\DoxyCodeLine{11922 \textcolor{comment}{v0.12.11 -\/ 2020-\/04-\/19}}
\DoxyCodeLine{11923 \textcolor{comment}{  -\/ Fix some pedantic warnings.}}
\DoxyCodeLine{11924 \textcolor{comment}{  -\/ Fix some undefined behaviour warnings.}}
\DoxyCodeLine{11925 \textcolor{comment}{}}
\DoxyCodeLine{11926 \textcolor{comment}{v0.12.10 -\/ 2020-\/04-\/10}}
\DoxyCodeLine{11927 \textcolor{comment}{  -\/ Fix some bugs when trying to seek with an invalid seek table.}}
\DoxyCodeLine{11928 \textcolor{comment}{}}
\DoxyCodeLine{11929 \textcolor{comment}{v0.12.9 -\/ 2020-\/04-\/05}}
\DoxyCodeLine{11930 \textcolor{comment}{  -\/ Fix warnings.}}
\DoxyCodeLine{11931 \textcolor{comment}{}}
\DoxyCodeLine{11932 \textcolor{comment}{v0.12.8 -\/ 2020-\/04-\/04}}
\DoxyCodeLine{11933 \textcolor{comment}{  -\/ Add drflac\_open\_file\_w() and drflac\_open\_file\_with\_metadata\_w().}}
\DoxyCodeLine{11934 \textcolor{comment}{  -\/ Fix some static analysis warnings.}}
\DoxyCodeLine{11935 \textcolor{comment}{  -\/ Minor documentation updates.}}
\DoxyCodeLine{11936 \textcolor{comment}{}}
\DoxyCodeLine{11937 \textcolor{comment}{v0.12.7 -\/ 2020-\/03-\/14}}
\DoxyCodeLine{11938 \textcolor{comment}{  -\/ Fix compilation errors with VC6.}}
\DoxyCodeLine{11939 \textcolor{comment}{}}
\DoxyCodeLine{11940 \textcolor{comment}{v0.12.6 -\/ 2020-\/03-\/07}}
\DoxyCodeLine{11941 \textcolor{comment}{  -\/ Fix compilation error with Visual Studio .NET 2003.}}
\DoxyCodeLine{11942 \textcolor{comment}{}}
\DoxyCodeLine{11943 \textcolor{comment}{v0.12.5 -\/ 2020-\/01-\/30}}
\DoxyCodeLine{11944 \textcolor{comment}{  -\/ Silence some static analysis warnings.}}
\DoxyCodeLine{11945 \textcolor{comment}{}}
\DoxyCodeLine{11946 \textcolor{comment}{v0.12.4 -\/ 2020-\/01-\/29}}
\DoxyCodeLine{11947 \textcolor{comment}{  -\/ Silence some static analysis warnings.}}
\DoxyCodeLine{11948 \textcolor{comment}{}}
\DoxyCodeLine{11949 \textcolor{comment}{v0.12.3 -\/ 2019-\/12-\/02}}
\DoxyCodeLine{11950 \textcolor{comment}{  -\/ Fix some warnings when compiling with GCC and the -\/Og flag.}}
\DoxyCodeLine{11951 \textcolor{comment}{  -\/ Fix a crash in out-\/of-\/memory situations.}}
\DoxyCodeLine{11952 \textcolor{comment}{  -\/ Fix potential integer overflow bug.}}
\DoxyCodeLine{11953 \textcolor{comment}{  -\/ Fix some static analysis warnings.}}
\DoxyCodeLine{11954 \textcolor{comment}{  -\/ Fix a possible crash when using custom memory allocators without a custom realloc() implementation.}}
\DoxyCodeLine{11955 \textcolor{comment}{  -\/ Fix a bug with binary search seeking where the bits per sample is not a multiple of 8.}}
\DoxyCodeLine{11956 \textcolor{comment}{}}
\DoxyCodeLine{11957 \textcolor{comment}{v0.12.2 -\/ 2019-\/10-\/07}}
\DoxyCodeLine{11958 \textcolor{comment}{  -\/ Internal code clean up.}}
\DoxyCodeLine{11959 \textcolor{comment}{}}
\DoxyCodeLine{11960 \textcolor{comment}{v0.12.1 -\/ 2019-\/09-\/29}}
\DoxyCodeLine{11961 \textcolor{comment}{  -\/ Fix some Clang Static Analyzer warnings.}}
\DoxyCodeLine{11962 \textcolor{comment}{  -\/ Fix an unused variable warning.}}
\DoxyCodeLine{11963 \textcolor{comment}{}}
\DoxyCodeLine{11964 \textcolor{comment}{v0.12.0 -\/ 2019-\/09-\/23}}
\DoxyCodeLine{11965 \textcolor{comment}{  -\/ API CHANGE: Add support for user defined memory allocation routines. This system allows the program to specify their own memory allocation}}
\DoxyCodeLine{11966 \textcolor{comment}{    routines with a user data pointer for client-\/specific contextual data. This adds an extra parameter to the end of the following APIs:}}
\DoxyCodeLine{11967 \textcolor{comment}{    -\/ drflac\_open()}}
\DoxyCodeLine{11968 \textcolor{comment}{    -\/ drflac\_open\_relaxed()}}
\DoxyCodeLine{11969 \textcolor{comment}{    -\/ drflac\_open\_with\_metadata()}}
\DoxyCodeLine{11970 \textcolor{comment}{    -\/ drflac\_open\_with\_metadata\_relaxed()}}
\DoxyCodeLine{11971 \textcolor{comment}{    -\/ drflac\_open\_file()}}
\DoxyCodeLine{11972 \textcolor{comment}{    -\/ drflac\_open\_file\_with\_metadata()}}
\DoxyCodeLine{11973 \textcolor{comment}{    -\/ drflac\_open\_memory()}}
\DoxyCodeLine{11974 \textcolor{comment}{    -\/ drflac\_open\_memory\_with\_metadata()}}
\DoxyCodeLine{11975 \textcolor{comment}{    -\/ drflac\_open\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{11976 \textcolor{comment}{    -\/ drflac\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{11977 \textcolor{comment}{    -\/ drflac\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{11978 \textcolor{comment}{    -\/ drflac\_open\_file\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{11979 \textcolor{comment}{    -\/ drflac\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{11980 \textcolor{comment}{    -\/ drflac\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{11981 \textcolor{comment}{    -\/ drflac\_open\_memory\_and\_read\_pcm\_frames\_s32()}}
\DoxyCodeLine{11982 \textcolor{comment}{    -\/ drflac\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{11983 \textcolor{comment}{    -\/ drflac\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{11984 \textcolor{comment}{    Set this extra parameter to NULL to use defaults which is the same as the previous behaviour. Setting this NULL will use}}
\DoxyCodeLine{11985 \textcolor{comment}{    DRFLAC\_MALLOC, DRFLAC\_REALLOC and DRFLAC\_FREE.}}
\DoxyCodeLine{11986 \textcolor{comment}{  -\/ Remove deprecated APIs:}}
\DoxyCodeLine{11987 \textcolor{comment}{    -\/ drflac\_read\_s32()}}
\DoxyCodeLine{11988 \textcolor{comment}{    -\/ drflac\_read\_s16()}}
\DoxyCodeLine{11989 \textcolor{comment}{    -\/ drflac\_read\_f32()}}
\DoxyCodeLine{11990 \textcolor{comment}{    -\/ drflac\_seek\_to\_sample()}}
\DoxyCodeLine{11991 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_s32()}}
\DoxyCodeLine{11992 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_s16()}}
\DoxyCodeLine{11993 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_f32()}}
\DoxyCodeLine{11994 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_file\_s32()}}
\DoxyCodeLine{11995 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_file\_s16()}}
\DoxyCodeLine{11996 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_file\_f32()}}
\DoxyCodeLine{11997 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_memory\_s32()}}
\DoxyCodeLine{11998 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_memory\_s16()}}
\DoxyCodeLine{11999 \textcolor{comment}{    -\/ drflac\_open\_and\_decode\_memory\_f32()}}
\DoxyCodeLine{12000 \textcolor{comment}{  -\/ Remove drflac.totalSampleCount which is now replaced with drflac.totalPCMFrameCount. You can emulate drflac.totalSampleCount}}
\DoxyCodeLine{12001 \textcolor{comment}{    by doing pFlac-\/>totalPCMFrameCount*pFlac-\/>channels.}}
\DoxyCodeLine{12002 \textcolor{comment}{  -\/ Rename drflac.currentFrame to drflac.currentFLACFrame to remove ambiguity with PCM frames.}}
\DoxyCodeLine{12003 \textcolor{comment}{  -\/ Fix errors when seeking to the end of a stream.}}
\DoxyCodeLine{12004 \textcolor{comment}{  -\/ Optimizations to seeking.}}
\DoxyCodeLine{12005 \textcolor{comment}{  -\/ SSE improvements and optimizations.}}
\DoxyCodeLine{12006 \textcolor{comment}{  -\/ ARM NEON optimizations.}}
\DoxyCodeLine{12007 \textcolor{comment}{  -\/ Optimizations to drflac\_read\_pcm\_frames\_s16().}}
\DoxyCodeLine{12008 \textcolor{comment}{  -\/ Optimizations to drflac\_read\_pcm\_frames\_s32().}}
\DoxyCodeLine{12009 \textcolor{comment}{}}
\DoxyCodeLine{12010 \textcolor{comment}{v0.11.10 -\/ 2019-\/06-\/26}}
\DoxyCodeLine{12011 \textcolor{comment}{  -\/ Fix a compiler error.}}
\DoxyCodeLine{12012 \textcolor{comment}{}}
\DoxyCodeLine{12013 \textcolor{comment}{v0.11.9 -\/ 2019-\/06-\/16}}
\DoxyCodeLine{12014 \textcolor{comment}{  -\/ Silence some ThreadSanitizer warnings.}}
\DoxyCodeLine{12015 \textcolor{comment}{}}
\DoxyCodeLine{12016 \textcolor{comment}{v0.11.8 -\/ 2019-\/05-\/21}}
\DoxyCodeLine{12017 \textcolor{comment}{  -\/ Fix warnings.}}
\DoxyCodeLine{12018 \textcolor{comment}{}}
\DoxyCodeLine{12019 \textcolor{comment}{v0.11.7 -\/ 2019-\/05-\/06}}
\DoxyCodeLine{12020 \textcolor{comment}{  -\/ C89 fixes.}}
\DoxyCodeLine{12021 \textcolor{comment}{}}
\DoxyCodeLine{12022 \textcolor{comment}{v0.11.6 -\/ 2019-\/05-\/05}}
\DoxyCodeLine{12023 \textcolor{comment}{  -\/ Add support for C89.}}
\DoxyCodeLine{12024 \textcolor{comment}{  -\/ Fix a compiler warning when CRC is disabled.}}
\DoxyCodeLine{12025 \textcolor{comment}{  -\/ Change license to choice of public domain or MIT-\/0.}}
\DoxyCodeLine{12026 \textcolor{comment}{}}
\DoxyCodeLine{12027 \textcolor{comment}{v0.11.5 -\/ 2019-\/04-\/19}}
\DoxyCodeLine{12028 \textcolor{comment}{  -\/ Fix a compiler error with GCC.}}
\DoxyCodeLine{12029 \textcolor{comment}{}}
\DoxyCodeLine{12030 \textcolor{comment}{v0.11.4 -\/ 2019-\/04-\/17}}
\DoxyCodeLine{12031 \textcolor{comment}{  -\/ Fix some warnings with GCC when compiling with -\/std=c99.}}
\DoxyCodeLine{12032 \textcolor{comment}{}}
\DoxyCodeLine{12033 \textcolor{comment}{v0.11.3 -\/ 2019-\/04-\/07}}
\DoxyCodeLine{12034 \textcolor{comment}{  -\/ Silence warnings with GCC.}}
\DoxyCodeLine{12035 \textcolor{comment}{}}
\DoxyCodeLine{12036 \textcolor{comment}{v0.11.2 -\/ 2019-\/03-\/10}}
\DoxyCodeLine{12037 \textcolor{comment}{  -\/ Fix a warning.}}
\DoxyCodeLine{12038 \textcolor{comment}{}}
\DoxyCodeLine{12039 \textcolor{comment}{v0.11.1 -\/ 2019-\/02-\/17}}
\DoxyCodeLine{12040 \textcolor{comment}{  -\/ Fix a potential bug with seeking.}}
\DoxyCodeLine{12041 \textcolor{comment}{}}
\DoxyCodeLine{12042 \textcolor{comment}{v0.11.0 -\/ 2018-\/12-\/16}}
\DoxyCodeLine{12043 \textcolor{comment}{  -\/ API CHANGE: Deprecated drflac\_read\_s32(), drflac\_read\_s16() and drflac\_read\_f32() and replaced them with}}
\DoxyCodeLine{12044 \textcolor{comment}{    drflac\_read\_pcm\_frames\_s32(), drflac\_read\_pcm\_frames\_s16() and drflac\_read\_pcm\_frames\_f32(). The new APIs take}}
\DoxyCodeLine{12045 \textcolor{comment}{    and return PCM frame counts instead of sample counts. To upgrade you will need to change the input count by}}
\DoxyCodeLine{12046 \textcolor{comment}{    dividing it by the channel count, and then do the same with the return value.}}
\DoxyCodeLine{12047 \textcolor{comment}{  -\/ API\_CHANGE: Deprecated drflac\_seek\_to\_sample() and replaced with drflac\_seek\_to\_pcm\_frame(). Same rules as}}
\DoxyCodeLine{12048 \textcolor{comment}{    the changes to drflac\_read\_*() apply.}}
\DoxyCodeLine{12049 \textcolor{comment}{  -\/ API CHANGE: Deprecated drflac\_open\_and\_decode\_*() and replaced with drflac\_open\_*\_and\_read\_*(). Same rules as}}
\DoxyCodeLine{12050 \textcolor{comment}{    the changes to drflac\_read\_*() apply.}}
\DoxyCodeLine{12051 \textcolor{comment}{  -\/ Optimizations.}}
\DoxyCodeLine{12052 \textcolor{comment}{}}
\DoxyCodeLine{12053 \textcolor{comment}{v0.10.0 -\/ 2018-\/09-\/11}}
\DoxyCodeLine{12054 \textcolor{comment}{  -\/ Remove the DR\_FLAC\_NO\_WIN32\_IO option and the Win32 file IO functionality. If you need to use Win32 file IO you}}
\DoxyCodeLine{12055 \textcolor{comment}{    need to do it yourself via the callback API.}}
\DoxyCodeLine{12056 \textcolor{comment}{  -\/ Fix the clang build.}}
\DoxyCodeLine{12057 \textcolor{comment}{  -\/ Fix undefined behavior.}}
\DoxyCodeLine{12058 \textcolor{comment}{  -\/ Fix errors with CUESHEET metdata blocks.}}
\DoxyCodeLine{12059 \textcolor{comment}{  -\/ Add an API for iterating over each cuesheet track in the CUESHEET metadata block. This works the same way as the}}
\DoxyCodeLine{12060 \textcolor{comment}{    Vorbis comment API.}}
\DoxyCodeLine{12061 \textcolor{comment}{  -\/ Other miscellaneous bug fixes, mostly relating to invalid FLAC streams.}}
\DoxyCodeLine{12062 \textcolor{comment}{  -\/ Minor optimizations.}}
\DoxyCodeLine{12063 \textcolor{comment}{}}
\DoxyCodeLine{12064 \textcolor{comment}{v0.9.11 -\/ 2018-\/08-\/29}}
\DoxyCodeLine{12065 \textcolor{comment}{  -\/ Fix a bug with sample reconstruction.}}
\DoxyCodeLine{12066 \textcolor{comment}{}}
\DoxyCodeLine{12067 \textcolor{comment}{v0.9.10 -\/ 2018-\/08-\/07}}
\DoxyCodeLine{12068 \textcolor{comment}{  -\/ Improve 64-\/bit detection.}}
\DoxyCodeLine{12069 \textcolor{comment}{}}
\DoxyCodeLine{12070 \textcolor{comment}{v0.9.9 -\/ 2018-\/08-\/05}}
\DoxyCodeLine{12071 \textcolor{comment}{  -\/ Fix C++ build on older versions of GCC.}}
\DoxyCodeLine{12072 \textcolor{comment}{}}
\DoxyCodeLine{12073 \textcolor{comment}{v0.9.8 -\/ 2018-\/07-\/24}}
\DoxyCodeLine{12074 \textcolor{comment}{  -\/ Fix compilation errors.}}
\DoxyCodeLine{12075 \textcolor{comment}{}}
\DoxyCodeLine{12076 \textcolor{comment}{v0.9.7 -\/ 2018-\/07-\/05}}
\DoxyCodeLine{12077 \textcolor{comment}{  -\/ Fix a warning.}}
\DoxyCodeLine{12078 \textcolor{comment}{}}
\DoxyCodeLine{12079 \textcolor{comment}{v0.9.6 -\/ 2018-\/06-\/29}}
\DoxyCodeLine{12080 \textcolor{comment}{  -\/ Fix some typos.}}
\DoxyCodeLine{12081 \textcolor{comment}{}}
\DoxyCodeLine{12082 \textcolor{comment}{v0.9.5 -\/ 2018-\/06-\/23}}
\DoxyCodeLine{12083 \textcolor{comment}{  -\/ Fix some warnings.}}
\DoxyCodeLine{12084 \textcolor{comment}{}}
\DoxyCodeLine{12085 \textcolor{comment}{v0.9.4 -\/ 2018-\/06-\/14}}
\DoxyCodeLine{12086 \textcolor{comment}{  -\/ Optimizations to seeking.}}
\DoxyCodeLine{12087 \textcolor{comment}{  -\/ Clean up.}}
\DoxyCodeLine{12088 \textcolor{comment}{}}
\DoxyCodeLine{12089 \textcolor{comment}{v0.9.3 -\/ 2018-\/05-\/22}}
\DoxyCodeLine{12090 \textcolor{comment}{  -\/ Bug fix.}}
\DoxyCodeLine{12091 \textcolor{comment}{}}
\DoxyCodeLine{12092 \textcolor{comment}{v0.9.2 -\/ 2018-\/05-\/12}}
\DoxyCodeLine{12093 \textcolor{comment}{  -\/ Fix a compilation error due to a missing break statement.}}
\DoxyCodeLine{12094 \textcolor{comment}{}}
\DoxyCodeLine{12095 \textcolor{comment}{v0.9.1 -\/ 2018-\/04-\/29}}
\DoxyCodeLine{12096 \textcolor{comment}{  -\/ Fix compilation error with Clang.}}
\DoxyCodeLine{12097 \textcolor{comment}{}}
\DoxyCodeLine{12098 \textcolor{comment}{v0.9 -\/ 2018-\/04-\/24}}
\DoxyCodeLine{12099 \textcolor{comment}{  -\/ Fix Clang build.}}
\DoxyCodeLine{12100 \textcolor{comment}{  -\/ Start using major.minor.revision versioning.}}
\DoxyCodeLine{12101 \textcolor{comment}{}}
\DoxyCodeLine{12102 \textcolor{comment}{v0.8g -\/ 2018-\/04-\/19}}
\DoxyCodeLine{12103 \textcolor{comment}{  -\/ Fix build on non-\/x86/x64 architectures.}}
\DoxyCodeLine{12104 \textcolor{comment}{}}
\DoxyCodeLine{12105 \textcolor{comment}{v0.8f -\/ 2018-\/02-\/02}}
\DoxyCodeLine{12106 \textcolor{comment}{  -\/ Stop pretending to support changing rate/channels mid stream.}}
\DoxyCodeLine{12107 \textcolor{comment}{}}
\DoxyCodeLine{12108 \textcolor{comment}{v0.8e -\/ 2018-\/02-\/01}}
\DoxyCodeLine{12109 \textcolor{comment}{  -\/ Fix a crash when the block size of a frame is larger than the maximum block size defined by the FLAC stream.}}
\DoxyCodeLine{12110 \textcolor{comment}{  -\/ Fix a crash the the Rice partition order is invalid.}}
\DoxyCodeLine{12111 \textcolor{comment}{}}
\DoxyCodeLine{12112 \textcolor{comment}{v0.8d -\/ 2017-\/09-\/22}}
\DoxyCodeLine{12113 \textcolor{comment}{  -\/ Add support for decoding streams with ID3 tags. ID3 tags are just skipped.}}
\DoxyCodeLine{12114 \textcolor{comment}{}}
\DoxyCodeLine{12115 \textcolor{comment}{v0.8c -\/ 2017-\/09-\/07}}
\DoxyCodeLine{12116 \textcolor{comment}{  -\/ Fix warning on non-\/x86/x64 architectures.}}
\DoxyCodeLine{12117 \textcolor{comment}{}}
\DoxyCodeLine{12118 \textcolor{comment}{v0.8b -\/ 2017-\/08-\/19}}
\DoxyCodeLine{12119 \textcolor{comment}{  -\/ Fix build on non-\/x86/x64 architectures.}}
\DoxyCodeLine{12120 \textcolor{comment}{}}
\DoxyCodeLine{12121 \textcolor{comment}{v0.8a -\/ 2017-\/08-\/13}}
\DoxyCodeLine{12122 \textcolor{comment}{  -\/ A small optimization for the Clang build.}}
\DoxyCodeLine{12123 \textcolor{comment}{}}
\DoxyCodeLine{12124 \textcolor{comment}{v0.8 -\/ 2017-\/08-\/12}}
\DoxyCodeLine{12125 \textcolor{comment}{  -\/ API CHANGE: Rename dr\_* types to drflac\_*.}}
\DoxyCodeLine{12126 \textcolor{comment}{  -\/ Optimizations. This brings dr\_flac back to about the same class of efficiency as the reference implementation.}}
\DoxyCodeLine{12127 \textcolor{comment}{  -\/ Add support for custom implementations of malloc(), realloc(), etc.}}
\DoxyCodeLine{12128 \textcolor{comment}{  -\/ Add CRC checking to Ogg encapsulated streams.}}
\DoxyCodeLine{12129 \textcolor{comment}{  -\/ Fix VC++ 6 build. This is only for the C++ compiler. The C compiler is not currently supported.}}
\DoxyCodeLine{12130 \textcolor{comment}{  -\/ Bug fixes.}}
\DoxyCodeLine{12131 \textcolor{comment}{}}
\DoxyCodeLine{12132 \textcolor{comment}{v0.7 -\/ 2017-\/07-\/23}}
\DoxyCodeLine{12133 \textcolor{comment}{  -\/ Add support for opening a stream without a header block. To do this, use drflac\_open\_relaxed() / drflac\_open\_with\_metadata\_relaxed().}}
\DoxyCodeLine{12134 \textcolor{comment}{}}
\DoxyCodeLine{12135 \textcolor{comment}{v0.6 -\/ 2017-\/07-\/22}}
\DoxyCodeLine{12136 \textcolor{comment}{  -\/ Add support for recovering from invalid frames. With this change, dr\_flac will simply skip over invalid frames as if they}}
\DoxyCodeLine{12137 \textcolor{comment}{    never existed. Frames are checked against their sync code, the CRC-\/8 of the frame header and the CRC-\/16 of the whole frame.}}
\DoxyCodeLine{12138 \textcolor{comment}{}}
\DoxyCodeLine{12139 \textcolor{comment}{v0.5 -\/ 2017-\/07-\/16}}
\DoxyCodeLine{12140 \textcolor{comment}{  -\/ Fix typos.}}
\DoxyCodeLine{12141 \textcolor{comment}{  -\/ Change drflac\_bool* types to unsigned.}}
\DoxyCodeLine{12142 \textcolor{comment}{  -\/ Add CRC checking. This makes dr\_flac slower, but can be disabled with \#define DR\_FLAC\_NO\_CRC.}}
\DoxyCodeLine{12143 \textcolor{comment}{}}
\DoxyCodeLine{12144 \textcolor{comment}{v0.4f -\/ 2017-\/03-\/10}}
\DoxyCodeLine{12145 \textcolor{comment}{  -\/ Fix a couple of bugs with the bitstreaming code.}}
\DoxyCodeLine{12146 \textcolor{comment}{}}
\DoxyCodeLine{12147 \textcolor{comment}{v0.4e -\/ 2017-\/02-\/17}}
\DoxyCodeLine{12148 \textcolor{comment}{  -\/ Fix some warnings.}}
\DoxyCodeLine{12149 \textcolor{comment}{}}
\DoxyCodeLine{12150 \textcolor{comment}{v0.4d -\/ 2016-\/12-\/26}}
\DoxyCodeLine{12151 \textcolor{comment}{  -\/ Add support for 32-\/bit floating-\/point PCM decoding.}}
\DoxyCodeLine{12152 \textcolor{comment}{  -\/ Use drflac\_int* and drflac\_uint* sized types to improve compiler support.}}
\DoxyCodeLine{12153 \textcolor{comment}{  -\/ Minor improvements to documentation.}}
\DoxyCodeLine{12154 \textcolor{comment}{}}
\DoxyCodeLine{12155 \textcolor{comment}{v0.4c -\/ 2016-\/12-\/26}}
\DoxyCodeLine{12156 \textcolor{comment}{  -\/ Add support for signed 16-\/bit integer PCM decoding.}}
\DoxyCodeLine{12157 \textcolor{comment}{}}
\DoxyCodeLine{12158 \textcolor{comment}{v0.4b -\/ 2016-\/10-\/23}}
\DoxyCodeLine{12159 \textcolor{comment}{  -\/ A minor change to drflac\_bool8 and drflac\_bool32 types.}}
\DoxyCodeLine{12160 \textcolor{comment}{}}
\DoxyCodeLine{12161 \textcolor{comment}{v0.4a -\/ 2016-\/10-\/11}}
\DoxyCodeLine{12162 \textcolor{comment}{  -\/ Rename drBool32 to drflac\_bool32 for styling consistency.}}
\DoxyCodeLine{12163 \textcolor{comment}{}}
\DoxyCodeLine{12164 \textcolor{comment}{v0.4 -\/ 2016-\/09-\/29}}
\DoxyCodeLine{12165 \textcolor{comment}{  -\/ API/ABI CHANGE: Use fixed size 32-\/bit booleans instead of the built-\/in bool type.}}
\DoxyCodeLine{12166 \textcolor{comment}{  -\/ API CHANGE: Rename drflac\_open\_and\_decode*() to drflac\_open\_and\_decode*\_s32().}}
\DoxyCodeLine{12167 \textcolor{comment}{  -\/ API CHANGE: Swap the order of "{}channels"{} and "{}sampleRate"{} parameters in drflac\_open\_and\_decode*(). Rationale for this is to}}
\DoxyCodeLine{12168 \textcolor{comment}{    keep it consistent with drflac\_audio.}}
\DoxyCodeLine{12169 \textcolor{comment}{}}
\DoxyCodeLine{12170 \textcolor{comment}{v0.3f -\/ 2016-\/09-\/21}}
\DoxyCodeLine{12171 \textcolor{comment}{  -\/ Fix a warning with GCC.}}
\DoxyCodeLine{12172 \textcolor{comment}{}}
\DoxyCodeLine{12173 \textcolor{comment}{v0.3e -\/ 2016-\/09-\/18}}
\DoxyCodeLine{12174 \textcolor{comment}{  -\/ Fixed a bug where GCC 4.3+ was not getting properly identified.}}
\DoxyCodeLine{12175 \textcolor{comment}{  -\/ Fixed a few typos.}}
\DoxyCodeLine{12176 \textcolor{comment}{  -\/ Changed date formats to ISO 8601 (YYYY-\/MM-\/DD).}}
\DoxyCodeLine{12177 \textcolor{comment}{}}
\DoxyCodeLine{12178 \textcolor{comment}{v0.3d -\/ 2016-\/06-\/11}}
\DoxyCodeLine{12179 \textcolor{comment}{  -\/ Minor clean up.}}
\DoxyCodeLine{12180 \textcolor{comment}{}}
\DoxyCodeLine{12181 \textcolor{comment}{v0.3c -\/ 2016-\/05-\/28}}
\DoxyCodeLine{12182 \textcolor{comment}{  -\/ Fixed compilation error.}}
\DoxyCodeLine{12183 \textcolor{comment}{}}
\DoxyCodeLine{12184 \textcolor{comment}{v0.3b -\/ 2016-\/05-\/16}}
\DoxyCodeLine{12185 \textcolor{comment}{  -\/ Fixed Linux/GCC build.}}
\DoxyCodeLine{12186 \textcolor{comment}{  -\/ Updated documentation.}}
\DoxyCodeLine{12187 \textcolor{comment}{}}
\DoxyCodeLine{12188 \textcolor{comment}{v0.3a -\/ 2016-\/05-\/15}}
\DoxyCodeLine{12189 \textcolor{comment}{  -\/ Minor fixes to documentation.}}
\DoxyCodeLine{12190 \textcolor{comment}{}}
\DoxyCodeLine{12191 \textcolor{comment}{v0.3 -\/ 2016-\/05-\/11}}
\DoxyCodeLine{12192 \textcolor{comment}{  -\/ Optimizations. Now at about parity with the reference implementation on 32-\/bit builds.}}
\DoxyCodeLine{12193 \textcolor{comment}{  -\/ Lots of clean up.}}
\DoxyCodeLine{12194 \textcolor{comment}{}}
\DoxyCodeLine{12195 \textcolor{comment}{v0.2b -\/ 2016-\/05-\/10}}
\DoxyCodeLine{12196 \textcolor{comment}{  -\/ Bug fixes.}}
\DoxyCodeLine{12197 \textcolor{comment}{}}
\DoxyCodeLine{12198 \textcolor{comment}{v0.2a -\/ 2016-\/05-\/10}}
\DoxyCodeLine{12199 \textcolor{comment}{  -\/ Made drflac\_open\_and\_decode() more robust.}}
\DoxyCodeLine{12200 \textcolor{comment}{  -\/ Removed an unused debugging variable}}
\DoxyCodeLine{12201 \textcolor{comment}{}}
\DoxyCodeLine{12202 \textcolor{comment}{v0.2 -\/ 2016-\/05-\/09}}
\DoxyCodeLine{12203 \textcolor{comment}{  -\/ Added support for Ogg encapsulation.}}
\DoxyCodeLine{12204 \textcolor{comment}{  -\/ API CHANGE. Have the onSeek callback take a third argument which specifies whether or not the seek}}
\DoxyCodeLine{12205 \textcolor{comment}{    should be relative to the start or the current position. Also changes the seeking rules such that}}
\DoxyCodeLine{12206 \textcolor{comment}{    seeking offsets will never be negative.}}
\DoxyCodeLine{12207 \textcolor{comment}{  -\/ Have drflac\_open\_and\_decode() fail gracefully if the stream has an unknown total sample count.}}
\DoxyCodeLine{12208 \textcolor{comment}{}}
\DoxyCodeLine{12209 \textcolor{comment}{v0.1b -\/ 2016-\/05-\/07}}
\DoxyCodeLine{12210 \textcolor{comment}{  -\/ Properly close the file handle in drflac\_open\_file() and family when the decoder fails to initialize.}}
\DoxyCodeLine{12211 \textcolor{comment}{  -\/ Removed a stale comment.}}
\DoxyCodeLine{12212 \textcolor{comment}{}}
\DoxyCodeLine{12213 \textcolor{comment}{v0.1a -\/ 2016-\/05-\/05}}
\DoxyCodeLine{12214 \textcolor{comment}{  -\/ Minor formatting changes.}}
\DoxyCodeLine{12215 \textcolor{comment}{  -\/ Fixed a warning on the GCC build.}}
\DoxyCodeLine{12216 \textcolor{comment}{}}
\DoxyCodeLine{12217 \textcolor{comment}{v0.1 -\/ 2016-\/05-\/03}}
\DoxyCodeLine{12218 \textcolor{comment}{  -\/ Initial versioned release.}}
\DoxyCodeLine{12219 \textcolor{comment}{*/}}
\DoxyCodeLine{12220 }
\DoxyCodeLine{12221 \textcolor{comment}{/*}}
\DoxyCodeLine{12222 \textcolor{comment}{This software is available as a choice of the following licenses. Choose}}
\DoxyCodeLine{12223 \textcolor{comment}{whichever you prefer.}}
\DoxyCodeLine{12224 \textcolor{comment}{}}
\DoxyCodeLine{12225 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{12226 \textcolor{comment}{ALTERNATIVE 1 -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{12227 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{12228 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{12229 \textcolor{comment}{}}
\DoxyCodeLine{12230 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{12231 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{12232 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{12233 \textcolor{comment}{}}
\DoxyCodeLine{12234 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{12235 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{12236 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{12237 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{12238 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{12239 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{12240 \textcolor{comment}{}}
\DoxyCodeLine{12241 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{12242 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{12243 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{12244 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{12245 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{12246 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{12247 \textcolor{comment}{}}
\DoxyCodeLine{12248 \textcolor{comment}{For more information, please refer to <http://unlicense.org/>}}
\DoxyCodeLine{12249 \textcolor{comment}{}}
\DoxyCodeLine{12250 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{12251 \textcolor{comment}{ALTERNATIVE 2 -\/ MIT No Attribution}}
\DoxyCodeLine{12252 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{12253 \textcolor{comment}{Copyright 2020 David Reid}}
\DoxyCodeLine{12254 \textcolor{comment}{}}
\DoxyCodeLine{12255 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{12256 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{12257 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{12258 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{12259 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{12260 \textcolor{comment}{so.}}
\DoxyCodeLine{12261 \textcolor{comment}{}}
\DoxyCodeLine{12262 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{12263 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{12264 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{12265 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{12266 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{12267 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{12268 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{12269 \textcolor{comment}{*/}}

\end{DoxyCode}
