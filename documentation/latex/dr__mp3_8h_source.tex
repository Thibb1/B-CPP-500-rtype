\hypertarget{dr__mp3_8h_source}{}\doxysection{dr\+\_\+mp3.\+h}
\label{dr__mp3_8h_source}\index{build/\_deps/raylib-\/src/src/external/dr\_mp3.h@{build/\_deps/raylib-\/src/src/external/dr\_mp3.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{MP3 audio decoder. Choice of public domain or MIT-\/0. See license statements at the end of this file.}}
\DoxyCodeLine{3 \textcolor{comment}{dr\_mp3 -\/ v0.6.31 -\/ 2021-\/08-\/22}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{David Reid -\/ mackron@gmail.com}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{GitHub: https://github.com/mackron/dr\_libs}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{Based on minimp3 (https://github.com/lieff/minimp3) which is where the real work was done. See the bottom of this file for differences between minimp3 and dr\_mp3.}}
\DoxyCodeLine{10 \textcolor{comment}{*/}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{comment}{/*}}
\DoxyCodeLine{13 \textcolor{comment}{RELEASE NOTES -\/ VERSION 0.6}}
\DoxyCodeLine{14 \textcolor{comment}{===========================}}
\DoxyCodeLine{15 \textcolor{comment}{Version 0.6 includes breaking changes with the configuration of decoders. The ability to customize the number of output channels and the sample rate has been}}
\DoxyCodeLine{16 \textcolor{comment}{removed. You must now use the channel count and sample rate reported by the MP3 stream itself, and all channel and sample rate conversion must be done}}
\DoxyCodeLine{17 \textcolor{comment}{yourself.}}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{Changes to Initialization}}
\DoxyCodeLine{21 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{22 \textcolor{comment}{Previously, `drmp3\_init()`, etc. took a pointer to a `drmp3\_config` object that allowed you to customize the output channels and sample rate. This has been}}
\DoxyCodeLine{23 \textcolor{comment}{removed. If you need the old behaviour you will need to convert the data yourself or just not upgrade. The following APIs have changed.}}
\DoxyCodeLine{24 \textcolor{comment}{}}
\DoxyCodeLine{25 \textcolor{comment}{    `drmp3\_init()`}}
\DoxyCodeLine{26 \textcolor{comment}{    `drmp3\_init\_memory()`}}
\DoxyCodeLine{27 \textcolor{comment}{    `drmp3\_init\_file()`}}
\DoxyCodeLine{28 \textcolor{comment}{}}
\DoxyCodeLine{29 \textcolor{comment}{}}
\DoxyCodeLine{30 \textcolor{comment}{Miscellaneous Changes}}
\DoxyCodeLine{31 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{32 \textcolor{comment}{Support for loading a file from a `wchar\_t` string has been added via the `drmp3\_init\_file\_w()` API.}}
\DoxyCodeLine{33 \textcolor{comment}{*/}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{comment}{/*}}
\DoxyCodeLine{36 \textcolor{comment}{Introducation}}
\DoxyCodeLine{37 \textcolor{comment}{=============}}
\DoxyCodeLine{38 \textcolor{comment}{dr\_mp3 is a single file library. To use it, do something like the following in one .c file.}}
\DoxyCodeLine{39 \textcolor{comment}{}}
\DoxyCodeLine{40 \textcolor{comment}{    ```c}}
\DoxyCodeLine{41 \textcolor{comment}{    \#define DR\_MP3\_IMPLEMENTATION}}
\DoxyCodeLine{42 \textcolor{comment}{    \#include "{}dr\_mp3.h"{}}}
\DoxyCodeLine{43 \textcolor{comment}{    ```}}
\DoxyCodeLine{44 \textcolor{comment}{}}
\DoxyCodeLine{45 \textcolor{comment}{You can then \#include this file in other parts of the program as you would with any other header file. To decode audio data, do something like the following:}}
\DoxyCodeLine{46 \textcolor{comment}{}}
\DoxyCodeLine{47 \textcolor{comment}{    ```c}}
\DoxyCodeLine{48 \textcolor{comment}{    drmp3 mp3;}}
\DoxyCodeLine{49 \textcolor{comment}{    if (!drmp3\_init\_file(\&mp3, "{}MySong.mp3"{}, NULL)) \{}}
\DoxyCodeLine{50 \textcolor{comment}{        // Failed to open file}}
\DoxyCodeLine{51 \textcolor{comment}{    \}}}
\DoxyCodeLine{52 \textcolor{comment}{}}
\DoxyCodeLine{53 \textcolor{comment}{    ...}}
\DoxyCodeLine{54 \textcolor{comment}{}}
\DoxyCodeLine{55 \textcolor{comment}{    drmp3\_uint64 framesRead = drmp3\_read\_pcm\_frames\_f32(pMP3, framesToRead, pFrames);}}
\DoxyCodeLine{56 \textcolor{comment}{    ```}}
\DoxyCodeLine{57 \textcolor{comment}{}}
\DoxyCodeLine{58 \textcolor{comment}{The drmp3 object is transparent so you can get access to the channel count and sample rate like so:}}
\DoxyCodeLine{59 \textcolor{comment}{}}
\DoxyCodeLine{60 \textcolor{comment}{    ```}}
\DoxyCodeLine{61 \textcolor{comment}{    drmp3\_uint32 channels = mp3.channels;}}
\DoxyCodeLine{62 \textcolor{comment}{    drmp3\_uint32 sampleRate = mp3.sampleRate;}}
\DoxyCodeLine{63 \textcolor{comment}{    ```}}
\DoxyCodeLine{64 \textcolor{comment}{}}
\DoxyCodeLine{65 \textcolor{comment}{The example above initializes a decoder from a file, but you can also initialize it from a block of memory and read and seek callbacks with}}
\DoxyCodeLine{66 \textcolor{comment}{`drmp3\_init\_memory()` and `drmp3\_init()` respectively.}}
\DoxyCodeLine{67 \textcolor{comment}{}}
\DoxyCodeLine{68 \textcolor{comment}{You do not need to do any annoying memory management when reading PCM frames -\/ this is all managed internally. You can request any number of PCM frames in each}}
\DoxyCodeLine{69 \textcolor{comment}{call to `drmp3\_read\_pcm\_frames\_f32()` and it will return as many PCM frames as it can, up to the requested amount.}}
\DoxyCodeLine{70 \textcolor{comment}{}}
\DoxyCodeLine{71 \textcolor{comment}{You can also decode an entire file in one go with `drmp3\_open\_and\_read\_pcm\_frames\_f32()`, `drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32()` and}}
\DoxyCodeLine{72 \textcolor{comment}{`drmp3\_open\_file\_and\_read\_pcm\_frames\_f32()`.}}
\DoxyCodeLine{73 \textcolor{comment}{}}
\DoxyCodeLine{74 \textcolor{comment}{}}
\DoxyCodeLine{75 \textcolor{comment}{Build Options}}
\DoxyCodeLine{76 \textcolor{comment}{=============}}
\DoxyCodeLine{77 \textcolor{comment}{\#define these options before including this file.}}
\DoxyCodeLine{78 \textcolor{comment}{}}
\DoxyCodeLine{79 \textcolor{comment}{\#define DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{80 \textcolor{comment}{  Disable drmp3\_init\_file(), etc.}}
\DoxyCodeLine{81 \textcolor{comment}{}}
\DoxyCodeLine{82 \textcolor{comment}{\#define DR\_MP3\_NO\_SIMD}}
\DoxyCodeLine{83 \textcolor{comment}{  Disable SIMD optimizations.}}
\DoxyCodeLine{84 \textcolor{comment}{*/}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{preprocessor}{\#ifndef dr\_mp3\_h}}
\DoxyCodeLine{87 \textcolor{preprocessor}{\#define dr\_mp3\_h}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{90 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{91 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{preprocessor}{\#define DRMP3\_STRINGIFY(x)      \#x}}
\DoxyCodeLine{94 \textcolor{preprocessor}{\#define DRMP3\_XSTRINGIFY(x)     DRMP3\_STRINGIFY(x)}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{preprocessor}{\#define DRMP3\_VERSION\_MAJOR     0}}
\DoxyCodeLine{97 \textcolor{preprocessor}{\#define DRMP3\_VERSION\_MINOR     6}}
\DoxyCodeLine{98 \textcolor{preprocessor}{\#define DRMP3\_VERSION\_REVISION  31}}
\DoxyCodeLine{99 \textcolor{preprocessor}{\#define DRMP3\_VERSION\_STRING    DRMP3\_XSTRINGIFY(DRMP3\_VERSION\_MAJOR) "{}."{}} DRMP3\_XSTRINGIFY(DRMP3\_VERSION\_MINOR) "{}."{} DRMP3\_XSTRINGIFY(DRMP3\_VERSION\_REVISION)}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{preprocessor}{\#include <stddef.h>} \textcolor{comment}{/* For size\_t. */}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{comment}{/* Sized types. */}}
\DoxyCodeLine{104 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char}           drmp3\_int8;}
\DoxyCodeLine{105 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}           drmp3\_uint8;}
\DoxyCodeLine{106 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{short}          drmp3\_int16;}
\DoxyCodeLine{107 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}          drmp3\_uint16;}
\DoxyCodeLine{108 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{int}            drmp3\_int32;}
\DoxyCodeLine{109 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}            drmp3\_uint32;}
\DoxyCodeLine{110 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{111     \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \_\_int64    drmp3\_int64;}
\DoxyCodeLine{112     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \_\_int64    drmp3\_uint64;}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{114 \textcolor{preprocessor}{    \#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{115 \textcolor{preprocessor}{        \#pragma GCC diagnostic push}}
\DoxyCodeLine{116 \textcolor{preprocessor}{        \#pragma GCC diagnostic ignored "{}-\/Wlong-\/long"{}}}
\DoxyCodeLine{117 \textcolor{preprocessor}{        \#if defined(\_\_clang\_\_)}}
\DoxyCodeLine{118 \textcolor{preprocessor}{            \#pragma GCC diagnostic ignored "{}-\/Wc++11-\/long-\/long"{}}}
\DoxyCodeLine{119 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{120 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{121     \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  drmp3\_int64;}
\DoxyCodeLine{122     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  drmp3\_uint64;}
\DoxyCodeLine{123 \textcolor{preprocessor}{    \#if defined(\_\_clang\_\_) || (defined(\_\_GNUC\_\_) \&\& (\_\_GNUC\_\_ > 4 || (\_\_GNUC\_\_ == 4 \&\& \_\_GNUC\_MINOR\_\_ >= 6)))}}
\DoxyCodeLine{124 \textcolor{preprocessor}{        \#pragma GCC diagnostic pop}}
\DoxyCodeLine{125 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{126 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{127 \textcolor{preprocessor}{\#if defined(\_\_LP64\_\_) || defined(\_WIN64) || (defined(\_\_x86\_64\_\_) \&\& !defined(\_\_ILP32\_\_)) || defined(\_M\_X64) || defined(\_\_ia64) || defined (\_M\_IA64) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64) || defined(\_\_powerpc64\_\_)}}
\DoxyCodeLine{128     \textcolor{keyword}{typedef} drmp3\_uint64        drmp3\_uintptr;}
\DoxyCodeLine{129 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{130     \textcolor{keyword}{typedef} drmp3\_uint32        drmp3\_uintptr;}
\DoxyCodeLine{131 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{132 \textcolor{keyword}{typedef} drmp3\_uint8             drmp3\_bool8;}
\DoxyCodeLine{133 \textcolor{keyword}{typedef} drmp3\_uint32            drmp3\_bool32;}
\DoxyCodeLine{134 \textcolor{preprocessor}{\#define DRMP3\_TRUE              1}}
\DoxyCodeLine{135 \textcolor{preprocessor}{\#define DRMP3\_FALSE             0}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 \textcolor{preprocessor}{\#if !defined(DRMP3\_API)}}
\DoxyCodeLine{138 \textcolor{preprocessor}{    \#if defined(DRMP3\_DLL)}}
\DoxyCodeLine{139 \textcolor{preprocessor}{        \#if defined(\_WIN32)}}
\DoxyCodeLine{140 \textcolor{preprocessor}{            \#define DRMP3\_DLL\_IMPORT  \_\_declspec(dllimport)}}
\DoxyCodeLine{141 \textcolor{preprocessor}{            \#define DRMP3\_DLL\_EXPORT  \_\_declspec(dllexport)}}
\DoxyCodeLine{142 \textcolor{preprocessor}{            \#define DRMP3\_DLL\_PRIVATE static}}
\DoxyCodeLine{143 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{144 \textcolor{preprocessor}{            \#if defined(\_\_GNUC\_\_) \&\& \_\_GNUC\_\_ >= 4}}
\DoxyCodeLine{145 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_IMPORT  \_\_attribute\_\_((visibility("{}default"{}})))}
\DoxyCodeLine{146 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_EXPORT  \_\_attribute\_\_((visibility("{}default"{}})))}
\DoxyCodeLine{147 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_PRIVATE \_\_attribute\_\_((visibility("{}hidden"{}})))}
\DoxyCodeLine{148 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{149 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_IMPORT}}
\DoxyCodeLine{150 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_EXPORT}}
\DoxyCodeLine{151 \textcolor{preprocessor}{                \#define DRMP3\_DLL\_PRIVATE static}}
\DoxyCodeLine{152 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{153 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{preprocessor}{        \#if defined(DR\_MP3\_IMPLEMENTATION) || defined(DRMP3\_IMPLEMENTATION)}}
\DoxyCodeLine{156 \textcolor{preprocessor}{            \#define DRMP3\_API  DRMP3\_DLL\_EXPORT}}
\DoxyCodeLine{157 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{158 \textcolor{preprocessor}{            \#define DRMP3\_API  DRMP3\_DLL\_IMPORT}}
\DoxyCodeLine{159 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{160 \textcolor{preprocessor}{        \#define DRMP3\_PRIVATE DRMP3\_DLL\_PRIVATE}}
\DoxyCodeLine{161 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{162 \textcolor{preprocessor}{        \#define DRMP3\_API extern}}
\DoxyCodeLine{163 \textcolor{preprocessor}{        \#define DRMP3\_PRIVATE static}}
\DoxyCodeLine{164 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{165 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \textcolor{keyword}{typedef} drmp3\_int32 drmp3\_result;}
\DoxyCodeLine{168 \textcolor{preprocessor}{\#define DRMP3\_SUCCESS                        0}}
\DoxyCodeLine{169 \textcolor{preprocessor}{\#define DRMP3\_ERROR                         -\/1   }\textcolor{comment}{/* A generic error. */}\textcolor{preprocessor}{}}
\DoxyCodeLine{170 \textcolor{preprocessor}{\#define DRMP3\_INVALID\_ARGS                  -\/2}}
\DoxyCodeLine{171 \textcolor{preprocessor}{\#define DRMP3\_INVALID\_OPERATION             -\/3}}
\DoxyCodeLine{172 \textcolor{preprocessor}{\#define DRMP3\_OUT\_OF\_MEMORY                 -\/4}}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#define DRMP3\_OUT\_OF\_RANGE                  -\/5}}
\DoxyCodeLine{174 \textcolor{preprocessor}{\#define DRMP3\_ACCESS\_DENIED                 -\/6}}
\DoxyCodeLine{175 \textcolor{preprocessor}{\#define DRMP3\_DOES\_NOT\_EXIST                -\/7}}
\DoxyCodeLine{176 \textcolor{preprocessor}{\#define DRMP3\_ALREADY\_EXISTS                -\/8}}
\DoxyCodeLine{177 \textcolor{preprocessor}{\#define DRMP3\_TOO\_MANY\_OPEN\_FILES           -\/9}}
\DoxyCodeLine{178 \textcolor{preprocessor}{\#define DRMP3\_INVALID\_FILE                  -\/10}}
\DoxyCodeLine{179 \textcolor{preprocessor}{\#define DRMP3\_TOO\_BIG                       -\/11}}
\DoxyCodeLine{180 \textcolor{preprocessor}{\#define DRMP3\_PATH\_TOO\_LONG                 -\/12}}
\DoxyCodeLine{181 \textcolor{preprocessor}{\#define DRMP3\_NAME\_TOO\_LONG                 -\/13}}
\DoxyCodeLine{182 \textcolor{preprocessor}{\#define DRMP3\_NOT\_DIRECTORY                 -\/14}}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#define DRMP3\_IS\_DIRECTORY                  -\/15}}
\DoxyCodeLine{184 \textcolor{preprocessor}{\#define DRMP3\_DIRECTORY\_NOT\_EMPTY           -\/16}}
\DoxyCodeLine{185 \textcolor{preprocessor}{\#define DRMP3\_END\_OF\_FILE                   -\/17}}
\DoxyCodeLine{186 \textcolor{preprocessor}{\#define DRMP3\_NO\_SPACE                      -\/18}}
\DoxyCodeLine{187 \textcolor{preprocessor}{\#define DRMP3\_BUSY                          -\/19}}
\DoxyCodeLine{188 \textcolor{preprocessor}{\#define DRMP3\_IO\_ERROR                      -\/20}}
\DoxyCodeLine{189 \textcolor{preprocessor}{\#define DRMP3\_INTERRUPT                     -\/21}}
\DoxyCodeLine{190 \textcolor{preprocessor}{\#define DRMP3\_UNAVAILABLE                   -\/22}}
\DoxyCodeLine{191 \textcolor{preprocessor}{\#define DRMP3\_ALREADY\_IN\_USE                -\/23}}
\DoxyCodeLine{192 \textcolor{preprocessor}{\#define DRMP3\_BAD\_ADDRESS                   -\/24}}
\DoxyCodeLine{193 \textcolor{preprocessor}{\#define DRMP3\_BAD\_SEEK                      -\/25}}
\DoxyCodeLine{194 \textcolor{preprocessor}{\#define DRMP3\_BAD\_PIPE                      -\/26}}
\DoxyCodeLine{195 \textcolor{preprocessor}{\#define DRMP3\_DEADLOCK                      -\/27}}
\DoxyCodeLine{196 \textcolor{preprocessor}{\#define DRMP3\_TOO\_MANY\_LINKS                -\/28}}
\DoxyCodeLine{197 \textcolor{preprocessor}{\#define DRMP3\_NOT\_IMPLEMENTED               -\/29}}
\DoxyCodeLine{198 \textcolor{preprocessor}{\#define DRMP3\_NO\_MESSAGE                    -\/30}}
\DoxyCodeLine{199 \textcolor{preprocessor}{\#define DRMP3\_BAD\_MESSAGE                   -\/31}}
\DoxyCodeLine{200 \textcolor{preprocessor}{\#define DRMP3\_NO\_DATA\_AVAILABLE             -\/32}}
\DoxyCodeLine{201 \textcolor{preprocessor}{\#define DRMP3\_INVALID\_DATA                  -\/33}}
\DoxyCodeLine{202 \textcolor{preprocessor}{\#define DRMP3\_TIMEOUT                       -\/34}}
\DoxyCodeLine{203 \textcolor{preprocessor}{\#define DRMP3\_NO\_NETWORK                    -\/35}}
\DoxyCodeLine{204 \textcolor{preprocessor}{\#define DRMP3\_NOT\_UNIQUE                    -\/36}}
\DoxyCodeLine{205 \textcolor{preprocessor}{\#define DRMP3\_NOT\_SOCKET                    -\/37}}
\DoxyCodeLine{206 \textcolor{preprocessor}{\#define DRMP3\_NO\_ADDRESS                    -\/38}}
\DoxyCodeLine{207 \textcolor{preprocessor}{\#define DRMP3\_BAD\_PROTOCOL                  -\/39}}
\DoxyCodeLine{208 \textcolor{preprocessor}{\#define DRMP3\_PROTOCOL\_UNAVAILABLE          -\/40}}
\DoxyCodeLine{209 \textcolor{preprocessor}{\#define DRMP3\_PROTOCOL\_NOT\_SUPPORTED        -\/41}}
\DoxyCodeLine{210 \textcolor{preprocessor}{\#define DRMP3\_PROTOCOL\_FAMILY\_NOT\_SUPPORTED -\/42}}
\DoxyCodeLine{211 \textcolor{preprocessor}{\#define DRMP3\_ADDRESS\_FAMILY\_NOT\_SUPPORTED  -\/43}}
\DoxyCodeLine{212 \textcolor{preprocessor}{\#define DRMP3\_SOCKET\_NOT\_SUPPORTED          -\/44}}
\DoxyCodeLine{213 \textcolor{preprocessor}{\#define DRMP3\_CONNECTION\_RESET              -\/45}}
\DoxyCodeLine{214 \textcolor{preprocessor}{\#define DRMP3\_ALREADY\_CONNECTED             -\/46}}
\DoxyCodeLine{215 \textcolor{preprocessor}{\#define DRMP3\_NOT\_CONNECTED                 -\/47}}
\DoxyCodeLine{216 \textcolor{preprocessor}{\#define DRMP3\_CONNECTION\_REFUSED            -\/48}}
\DoxyCodeLine{217 \textcolor{preprocessor}{\#define DRMP3\_NO\_HOST                       -\/49}}
\DoxyCodeLine{218 \textcolor{preprocessor}{\#define DRMP3\_IN\_PROGRESS                   -\/50}}
\DoxyCodeLine{219 \textcolor{preprocessor}{\#define DRMP3\_CANCELLED                     -\/51}}
\DoxyCodeLine{220 \textcolor{preprocessor}{\#define DRMP3\_MEMORY\_ALREADY\_MAPPED         -\/52}}
\DoxyCodeLine{221 \textcolor{preprocessor}{\#define DRMP3\_AT\_END                        -\/53}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223 }
\DoxyCodeLine{224 \textcolor{preprocessor}{\#define DRMP3\_MAX\_PCM\_FRAMES\_PER\_MP3\_FRAME  1152}}
\DoxyCodeLine{225 \textcolor{preprocessor}{\#define DRMP3\_MAX\_SAMPLES\_PER\_FRAME         (DRMP3\_MAX\_PCM\_FRAMES\_PER\_MP3\_FRAME*2)}}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{228 \textcolor{preprocessor}{    \#define DRMP3\_INLINE \_\_forceinline}}
\DoxyCodeLine{229 \textcolor{preprocessor}{\#elif defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{230     \textcolor{comment}{/*}}
\DoxyCodeLine{231 \textcolor{comment}{    I've had a bug report where GCC is emitting warnings about functions possibly not being inlineable. This warning happens when}}
\DoxyCodeLine{232 \textcolor{comment}{    the \_\_attribute\_\_((always\_inline)) attribute is defined without an "{}inline"{} statement. I think therefore there must be some}}
\DoxyCodeLine{233 \textcolor{comment}{    case where "{}\_\_inline\_\_"{} is not always defined, thus the compiler emitting these warnings. When using -\/std=c89 or -\/ansi on the}}
\DoxyCodeLine{234 \textcolor{comment}{    command line, we cannot use the "{}inline"{} keyword and instead need to use "{}\_\_inline\_\_"{}. In an attempt to work around this issue}}
\DoxyCodeLine{235 \textcolor{comment}{    I am using "{}\_\_inline\_\_"{} only when we're compiling in strict ANSI mode.}}
\DoxyCodeLine{236 \textcolor{comment}{    */}}
\DoxyCodeLine{237 \textcolor{preprocessor}{    \#if defined(\_\_STRICT\_ANSI\_\_)}}
\DoxyCodeLine{238 \textcolor{preprocessor}{        \#define DRMP3\_INLINE \_\_inline\_\_ \_\_attribute\_\_((always\_inline))}}
\DoxyCodeLine{239 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{240 \textcolor{preprocessor}{        \#define DRMP3\_INLINE inline \_\_attribute\_\_((always\_inline))}}
\DoxyCodeLine{241 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{242 \textcolor{preprocessor}{\#elif defined(\_\_WATCOMC\_\_)}}
\DoxyCodeLine{243 \textcolor{preprocessor}{    \#define DRMP3\_INLINE \_\_inline}}
\DoxyCodeLine{244 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{245 \textcolor{preprocessor}{    \#define DRMP3\_INLINE}}
\DoxyCodeLine{246 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248 }
\DoxyCodeLine{249 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_version(drmp3\_uint32* pMajor, drmp3\_uint32* pMinor, drmp3\_uint32* pRevision);}
\DoxyCodeLine{250 DRMP3\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drmp3\_version\_string(\textcolor{keywordtype}{void});}
\DoxyCodeLine{251 }
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{/*}}
\DoxyCodeLine{254 \textcolor{comment}{Low Level Push API}}
\DoxyCodeLine{255 \textcolor{comment}{==================}}
\DoxyCodeLine{256 \textcolor{comment}{*/}}
\DoxyCodeLine{257 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{258 \{}
\DoxyCodeLine{259     \textcolor{keywordtype}{int} frame\_bytes, channels, hz, layer, bitrate\_kbps;}
\DoxyCodeLine{260 \} \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}};}
\DoxyCodeLine{261 }
\DoxyCodeLine{262 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{263 \{}
\DoxyCodeLine{264     \textcolor{keywordtype}{float} mdct\_overlap[2][9*32], qmf\_state[15*2*32];}
\DoxyCodeLine{265     \textcolor{keywordtype}{int} reserv, free\_format\_bytes;}
\DoxyCodeLine{266     drmp3\_uint8 header[4], reserv\_buf[511];}
\DoxyCodeLine{267 \} \mbox{\hyperlink{structdrmp3dec}{drmp3dec}};}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \textcolor{comment}{/* Initializes a low level decoder. */}}
\DoxyCodeLine{270 DRMP3\_API \textcolor{keywordtype}{void} drmp3dec\_init(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *dec);}
\DoxyCodeLine{271 }
\DoxyCodeLine{272 \textcolor{comment}{/* Reads a frame from a low level decoder. */}}
\DoxyCodeLine{273 DRMP3\_API \textcolor{keywordtype}{int} drmp3dec\_decode\_frame(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *dec, \textcolor{keyword}{const} drmp3\_uint8 *mp3, \textcolor{keywordtype}{int} mp3\_bytes, \textcolor{keywordtype}{void} *pcm, \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}} *info);}
\DoxyCodeLine{274 }
\DoxyCodeLine{275 \textcolor{comment}{/* Helper for converting between f32 and s16. */}}
\DoxyCodeLine{276 DRMP3\_API \textcolor{keywordtype}{void} drmp3dec\_f32\_to\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *in, drmp3\_int16 *out, \textcolor{keywordtype}{size\_t} num\_samples);}
\DoxyCodeLine{277 }
\DoxyCodeLine{278 }
\DoxyCodeLine{279 }
\DoxyCodeLine{280 \textcolor{comment}{/*}}
\DoxyCodeLine{281 \textcolor{comment}{Main API (Pull API)}}
\DoxyCodeLine{282 \textcolor{comment}{===================}}
\DoxyCodeLine{283 \textcolor{comment}{*/}}
\DoxyCodeLine{284 \textcolor{keyword}{typedef} \textcolor{keyword}{enum}}
\DoxyCodeLine{285 \{}
\DoxyCodeLine{286     drmp3\_seek\_origin\_start,}
\DoxyCodeLine{287     drmp3\_seek\_origin\_current}
\DoxyCodeLine{288 \} drmp3\_seek\_origin;}
\DoxyCodeLine{289 }
\DoxyCodeLine{290 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{291 \{}
\DoxyCodeLine{292     drmp3\_uint64 seekPosInBytes;        \textcolor{comment}{/* Points to the first byte of an MP3 frame. */}}
\DoxyCodeLine{293     drmp3\_uint64 pcmFrameIndex;         \textcolor{comment}{/* The index of the PCM frame this seek point targets. */}}
\DoxyCodeLine{294     drmp3\_uint16 mp3FramesToDiscard;    \textcolor{comment}{/* The number of whole MP3 frames to be discarded before pcmFramesToDiscard. */}}
\DoxyCodeLine{295     drmp3\_uint16 pcmFramesToDiscard;    \textcolor{comment}{/* The number of leading samples to read and discard. These are discarded after mp3FramesToDiscard. */}}
\DoxyCodeLine{296 \} \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}};}
\DoxyCodeLine{297 }
\DoxyCodeLine{298 \textcolor{comment}{/*}}
\DoxyCodeLine{299 \textcolor{comment}{Callback for when data is read. Return value is the number of bytes actually read.}}
\DoxyCodeLine{300 \textcolor{comment}{}}
\DoxyCodeLine{301 \textcolor{comment}{pUserData   [in]  The user data that was passed to drmp3\_init(), drmp3\_open() and family.}}
\DoxyCodeLine{302 \textcolor{comment}{pBufferOut  [out] The output buffer.}}
\DoxyCodeLine{303 \textcolor{comment}{bytesToRead [in]  The number of bytes to read.}}
\DoxyCodeLine{304 \textcolor{comment}{}}
\DoxyCodeLine{305 \textcolor{comment}{Returns the number of bytes actually read.}}
\DoxyCodeLine{306 \textcolor{comment}{}}
\DoxyCodeLine{307 \textcolor{comment}{A return value of less than bytesToRead indicates the end of the stream. Do \_not\_ return from this callback until}}
\DoxyCodeLine{308 \textcolor{comment}{either the entire bytesToRead is filled or you have reached the end of the stream.}}
\DoxyCodeLine{309 \textcolor{comment}{*/}}
\DoxyCodeLine{310 \textcolor{keyword}{typedef} size\_t (* drmp3\_read\_proc)(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pBufferOut, \textcolor{keywordtype}{size\_t} bytesToRead);}
\DoxyCodeLine{311 }
\DoxyCodeLine{312 \textcolor{comment}{/*}}
\DoxyCodeLine{313 \textcolor{comment}{Callback for when data needs to be seeked.}}
\DoxyCodeLine{314 \textcolor{comment}{}}
\DoxyCodeLine{315 \textcolor{comment}{pUserData [in] The user data that was passed to drmp3\_init(), drmp3\_open() and family.}}
\DoxyCodeLine{316 \textcolor{comment}{offset    [in] The number of bytes to move, relative to the origin. Will never be negative.}}
\DoxyCodeLine{317 \textcolor{comment}{origin    [in] The origin of the seek -\/ the current position or the start of the stream.}}
\DoxyCodeLine{318 \textcolor{comment}{}}
\DoxyCodeLine{319 \textcolor{comment}{Returns whether or not the seek was successful.}}
\DoxyCodeLine{320 \textcolor{comment}{}}
\DoxyCodeLine{321 \textcolor{comment}{Whether or not it is relative to the beginning or current position is determined by the "{}origin"{} parameter which}}
\DoxyCodeLine{322 \textcolor{comment}{will be either drmp3\_seek\_origin\_start or drmp3\_seek\_origin\_current.}}
\DoxyCodeLine{323 \textcolor{comment}{*/}}
\DoxyCodeLine{324 \textcolor{keyword}{typedef} drmp3\_bool32 (* drmp3\_seek\_proc)(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drmp3\_seek\_origin origin);}
\DoxyCodeLine{325 }
\DoxyCodeLine{326 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{327 \{}
\DoxyCodeLine{328     \textcolor{keywordtype}{void}* pUserData;}
\DoxyCodeLine{329     \textcolor{keywordtype}{void}* (* onMalloc)(\textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{330     \textcolor{keywordtype}{void}* (* onRealloc)(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{331     void  (* onFree)(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{void}* pUserData);}
\DoxyCodeLine{332 \} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}};}
\DoxyCodeLine{333 }
\DoxyCodeLine{334 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{335 \{}
\DoxyCodeLine{336     drmp3\_uint32 channels;}
\DoxyCodeLine{337     drmp3\_uint32 sampleRate;}
\DoxyCodeLine{338 \} \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}};}
\DoxyCodeLine{339 }
\DoxyCodeLine{340 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{341 \{}
\DoxyCodeLine{342     \mbox{\hyperlink{structdrmp3dec}{drmp3dec}} decoder;}
\DoxyCodeLine{343     \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}} frameInfo;}
\DoxyCodeLine{344     drmp3\_uint32 channels;}
\DoxyCodeLine{345     drmp3\_uint32 sampleRate;}
\DoxyCodeLine{346     drmp3\_read\_proc onRead;}
\DoxyCodeLine{347     drmp3\_seek\_proc onSeek;}
\DoxyCodeLine{348     \textcolor{keywordtype}{void}* pUserData;}
\DoxyCodeLine{349     \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}} allocationCallbacks;}
\DoxyCodeLine{350     drmp3\_uint32 mp3FrameChannels;      \textcolor{comment}{/* The number of channels in the currently loaded MP3 frame. Internal use only. */}}
\DoxyCodeLine{351     drmp3\_uint32 mp3FrameSampleRate;    \textcolor{comment}{/* The sample rate of the currently loaded MP3 frame. Internal use only. */}}
\DoxyCodeLine{352     drmp3\_uint32 pcmFramesConsumedInMP3Frame;}
\DoxyCodeLine{353     drmp3\_uint32 pcmFramesRemainingInMP3Frame;}
\DoxyCodeLine{354     drmp3\_uint8 pcmFrames[\textcolor{keyword}{sizeof}(float)*DRMP3\_MAX\_SAMPLES\_PER\_FRAME];  \textcolor{comment}{/* <-\/-\/ Multipled by sizeof(float) to ensure there's enough room for DR\_MP3\_FLOAT\_OUTPUT. */}}
\DoxyCodeLine{355     drmp3\_uint64 currentPCMFrame;       \textcolor{comment}{/* The current PCM frame, globally, based on the output sample rate. Mainly used for seeking. */}}
\DoxyCodeLine{356     drmp3\_uint64 streamCursor;          \textcolor{comment}{/* The current byte the decoder is sitting on in the raw stream. */}}
\DoxyCodeLine{357     \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}}* pSeekPoints;      \textcolor{comment}{/* NULL by default. Set with drmp3\_bind\_seek\_table(). Memory is owned by the client. dr\_mp3 will never attempt to free this pointer. */}}
\DoxyCodeLine{358     drmp3\_uint32 seekPointCount;        \textcolor{comment}{/* The number of items in pSeekPoints. When set to 0 assumes to no seek table. Defaults to zero. */}}
\DoxyCodeLine{359     \textcolor{keywordtype}{size\_t} dataSize;}
\DoxyCodeLine{360     \textcolor{keywordtype}{size\_t} dataCapacity;}
\DoxyCodeLine{361     \textcolor{keywordtype}{size\_t} dataConsumed;}
\DoxyCodeLine{362     drmp3\_uint8* pData;}
\DoxyCodeLine{363     drmp3\_bool32 atEnd : 1;}
\DoxyCodeLine{364     \textcolor{keyword}{struct}}
\DoxyCodeLine{365     \{}
\DoxyCodeLine{366         \textcolor{keyword}{const} drmp3\_uint8* pData;}
\DoxyCodeLine{367         \textcolor{keywordtype}{size\_t} dataSize;}
\DoxyCodeLine{368         \textcolor{keywordtype}{size\_t} currentReadPos;}
\DoxyCodeLine{369     \} memory;   \textcolor{comment}{/* Only used for decoders that were opened against a block of memory. */}}
\DoxyCodeLine{370 \} \mbox{\hyperlink{structdrmp3}{drmp3}};}
\DoxyCodeLine{371 }
\DoxyCodeLine{372 \textcolor{comment}{/*}}
\DoxyCodeLine{373 \textcolor{comment}{Initializes an MP3 decoder.}}
\DoxyCodeLine{374 \textcolor{comment}{}}
\DoxyCodeLine{375 \textcolor{comment}{onRead    [in]           The function to call when data needs to be read from the client.}}
\DoxyCodeLine{376 \textcolor{comment}{onSeek    [in]           The function to call when the read position of the client data needs to move.}}
\DoxyCodeLine{377 \textcolor{comment}{pUserData [in, optional] A pointer to application defined data that will be passed to onRead and onSeek.}}
\DoxyCodeLine{378 \textcolor{comment}{}}
\DoxyCodeLine{379 \textcolor{comment}{Returns true if successful; false otherwise.}}
\DoxyCodeLine{380 \textcolor{comment}{}}
\DoxyCodeLine{381 \textcolor{comment}{Close the loader with drmp3\_uninit().}}
\DoxyCodeLine{382 \textcolor{comment}{}}
\DoxyCodeLine{383 \textcolor{comment}{See also: drmp3\_init\_file(), drmp3\_init\_memory(), drmp3\_uninit()}}
\DoxyCodeLine{384 \textcolor{comment}{*/}}
\DoxyCodeLine{385 DRMP3\_API drmp3\_bool32 drmp3\_init(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{386 }
\DoxyCodeLine{387 \textcolor{comment}{/*}}
\DoxyCodeLine{388 \textcolor{comment}{Initializes an MP3 decoder from a block of memory.}}
\DoxyCodeLine{389 \textcolor{comment}{}}
\DoxyCodeLine{390 \textcolor{comment}{This does not create a copy of the data. It is up to the application to ensure the buffer remains valid for}}
\DoxyCodeLine{391 \textcolor{comment}{the lifetime of the drmp3 object.}}
\DoxyCodeLine{392 \textcolor{comment}{}}
\DoxyCodeLine{393 \textcolor{comment}{The buffer should contain the contents of the entire MP3 file.}}
\DoxyCodeLine{394 \textcolor{comment}{*/}}
\DoxyCodeLine{395 DRMP3\_API drmp3\_bool32 drmp3\_init\_memory(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{396 }
\DoxyCodeLine{397 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{398 \textcolor{comment}{/*}}
\DoxyCodeLine{399 \textcolor{comment}{Initializes an MP3 decoder from a file.}}
\DoxyCodeLine{400 \textcolor{comment}{}}
\DoxyCodeLine{401 \textcolor{comment}{This holds the internal FILE object until drmp3\_uninit() is called. Keep this in mind if you're caching drmp3}}
\DoxyCodeLine{402 \textcolor{comment}{objects because the operating system may restrict the number of file handles an application can have open at}}
\DoxyCodeLine{403 \textcolor{comment}{any given time.}}
\DoxyCodeLine{404 \textcolor{comment}{*/}}
\DoxyCodeLine{405 DRMP3\_API drmp3\_bool32 drmp3\_init\_file(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFilePath, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{406 DRMP3\_API drmp3\_bool32 drmp3\_init\_file\_w(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePath, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{407 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{comment}{/*}}
\DoxyCodeLine{410 \textcolor{comment}{Uninitializes an MP3 decoder.}}
\DoxyCodeLine{411 \textcolor{comment}{*/}}
\DoxyCodeLine{412 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_uninit(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3);}
\DoxyCodeLine{413 }
\DoxyCodeLine{414 \textcolor{comment}{/*}}
\DoxyCodeLine{415 \textcolor{comment}{Reads PCM frames as interleaved 32-\/bit IEEE floating point PCM.}}
\DoxyCodeLine{416 \textcolor{comment}{}}
\DoxyCodeLine{417 \textcolor{comment}{Note that framesToRead specifies the number of PCM frames to read, \_not\_ the number of MP3 frames.}}
\DoxyCodeLine{418 \textcolor{comment}{*/}}
\DoxyCodeLine{419 DRMP3\_API drmp3\_uint64 drmp3\_read\_pcm\_frames\_f32(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 framesToRead, \textcolor{keywordtype}{float}* pBufferOut);}
\DoxyCodeLine{420 }
\DoxyCodeLine{421 \textcolor{comment}{/*}}
\DoxyCodeLine{422 \textcolor{comment}{Reads PCM frames as interleaved signed 16-\/bit integer PCM.}}
\DoxyCodeLine{423 \textcolor{comment}{}}
\DoxyCodeLine{424 \textcolor{comment}{Note that framesToRead specifies the number of PCM frames to read, \_not\_ the number of MP3 frames.}}
\DoxyCodeLine{425 \textcolor{comment}{*/}}
\DoxyCodeLine{426 DRMP3\_API drmp3\_uint64 drmp3\_read\_pcm\_frames\_s16(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 framesToRead, drmp3\_int16* pBufferOut);}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{comment}{/*}}
\DoxyCodeLine{429 \textcolor{comment}{Seeks to a specific frame.}}
\DoxyCodeLine{430 \textcolor{comment}{}}
\DoxyCodeLine{431 \textcolor{comment}{Note that this is \_not\_ an MP3 frame, but rather a PCM frame.}}
\DoxyCodeLine{432 \textcolor{comment}{*/}}
\DoxyCodeLine{433 DRMP3\_API drmp3\_bool32 drmp3\_seek\_to\_pcm\_frame(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameIndex);}
\DoxyCodeLine{434 }
\DoxyCodeLine{435 \textcolor{comment}{/*}}
\DoxyCodeLine{436 \textcolor{comment}{Calculates the total number of PCM frames in the MP3 stream. Cannot be used for infinite streams such as internet}}
\DoxyCodeLine{437 \textcolor{comment}{radio. Runs in linear time. Returns 0 on error.}}
\DoxyCodeLine{438 \textcolor{comment}{*/}}
\DoxyCodeLine{439 DRMP3\_API drmp3\_uint64 drmp3\_get\_pcm\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3);}
\DoxyCodeLine{440 }
\DoxyCodeLine{441 \textcolor{comment}{/*}}
\DoxyCodeLine{442 \textcolor{comment}{Calculates the total number of MP3 frames in the MP3 stream. Cannot be used for infinite streams such as internet}}
\DoxyCodeLine{443 \textcolor{comment}{radio. Runs in linear time. Returns 0 on error.}}
\DoxyCodeLine{444 \textcolor{comment}{*/}}
\DoxyCodeLine{445 DRMP3\_API drmp3\_uint64 drmp3\_get\_mp3\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3);}
\DoxyCodeLine{446 }
\DoxyCodeLine{447 \textcolor{comment}{/*}}
\DoxyCodeLine{448 \textcolor{comment}{Calculates the total number of MP3 and PCM frames in the MP3 stream. Cannot be used for infinite streams such as internet}}
\DoxyCodeLine{449 \textcolor{comment}{radio. Runs in linear time. Returns 0 on error.}}
\DoxyCodeLine{450 \textcolor{comment}{}}
\DoxyCodeLine{451 \textcolor{comment}{This is equivalent to calling drmp3\_get\_mp3\_frame\_count() and drmp3\_get\_pcm\_frame\_count() except that it's more efficient.}}
\DoxyCodeLine{452 \textcolor{comment}{*/}}
\DoxyCodeLine{453 DRMP3\_API drmp3\_bool32 drmp3\_get\_mp3\_and\_pcm\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64* pMP3FrameCount, drmp3\_uint64* pPCMFrameCount);}
\DoxyCodeLine{454 }
\DoxyCodeLine{455 \textcolor{comment}{/*}}
\DoxyCodeLine{456 \textcolor{comment}{Calculates the seekpoints based on PCM frames. This is slow.}}
\DoxyCodeLine{457 \textcolor{comment}{}}
\DoxyCodeLine{458 \textcolor{comment}{pSeekpoint count is a pointer to a uint32 containing the seekpoint count. On input it contains the desired count.}}
\DoxyCodeLine{459 \textcolor{comment}{On output it contains the actual count. The reason for this design is that the client may request too many}}
\DoxyCodeLine{460 \textcolor{comment}{seekpoints, in which case dr\_mp3 will return a corrected count.}}
\DoxyCodeLine{461 \textcolor{comment}{}}
\DoxyCodeLine{462 \textcolor{comment}{Note that seektable seeking is not quite sample exact when the MP3 stream contains inconsistent sample rates.}}
\DoxyCodeLine{463 \textcolor{comment}{*/}}
\DoxyCodeLine{464 DRMP3\_API drmp3\_bool32 drmp3\_calculate\_seek\_points(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint32* pSeekPointCount, \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}}* pSeekPoints);}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 \textcolor{comment}{/*}}
\DoxyCodeLine{467 \textcolor{comment}{Binds a seek table to the decoder.}}
\DoxyCodeLine{468 \textcolor{comment}{}}
\DoxyCodeLine{469 \textcolor{comment}{This does \_not\_ make a copy of pSeekPoints -\/ it only references it. It is up to the application to ensure this}}
\DoxyCodeLine{470 \textcolor{comment}{remains valid while it is bound to the decoder.}}
\DoxyCodeLine{471 \textcolor{comment}{}}
\DoxyCodeLine{472 \textcolor{comment}{Use drmp3\_calculate\_seek\_points() to calculate the seek points.}}
\DoxyCodeLine{473 \textcolor{comment}{*/}}
\DoxyCodeLine{474 DRMP3\_API drmp3\_bool32 drmp3\_bind\_seek\_table(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint32 seekPointCount, \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}}* pSeekPoints);}
\DoxyCodeLine{475 }
\DoxyCodeLine{476 }
\DoxyCodeLine{477 \textcolor{comment}{/*}}
\DoxyCodeLine{478 \textcolor{comment}{Opens an decodes an entire MP3 stream as a single operation.}}
\DoxyCodeLine{479 \textcolor{comment}{}}
\DoxyCodeLine{480 \textcolor{comment}{On output pConfig will receive the channel count and sample rate of the stream.}}
\DoxyCodeLine{481 \textcolor{comment}{}}
\DoxyCodeLine{482 \textcolor{comment}{Free the returned pointer with drmp3\_free().}}
\DoxyCodeLine{483 \textcolor{comment}{*/}}
\DoxyCodeLine{484 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_and\_read\_pcm\_frames\_f32(drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{485 DRMP3\_API drmp3\_int16* drmp3\_open\_and\_read\_pcm\_frames\_s16(drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{486 }
\DoxyCodeLine{487 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{488 DRMP3\_API drmp3\_int16* drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{489 }
\DoxyCodeLine{490 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{491 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_file\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filePath, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{492 DRMP3\_API drmp3\_int16* drmp3\_open\_file\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filePath, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{493 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{494 }
\DoxyCodeLine{495 \textcolor{comment}{/*}}
\DoxyCodeLine{496 \textcolor{comment}{Allocates a block of memory on the heap.}}
\DoxyCodeLine{497 \textcolor{comment}{*/}}
\DoxyCodeLine{498 DRMP3\_API \textcolor{keywordtype}{void}* drmp3\_malloc(\textcolor{keywordtype}{size\_t} sz, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{499 }
\DoxyCodeLine{500 \textcolor{comment}{/*}}
\DoxyCodeLine{501 \textcolor{comment}{Frees any memory that was allocated by a public drmp3 API.}}
\DoxyCodeLine{502 \textcolor{comment}{*/}}
\DoxyCodeLine{503 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_free(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks);}
\DoxyCodeLine{504 }
\DoxyCodeLine{505 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{506 \}}
\DoxyCodeLine{507 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{508 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* dr\_mp3\_h */}\textcolor{preprocessor}{}}
\DoxyCodeLine{509 }
\DoxyCodeLine{510 }
\DoxyCodeLine{511 \textcolor{comment}{/************************************************************************************************************************************************************}}
\DoxyCodeLine{512 \textcolor{comment}{ ************************************************************************************************************************************************************}}
\DoxyCodeLine{513 \textcolor{comment}{}}
\DoxyCodeLine{514 \textcolor{comment}{ IMPLEMENTATION}}
\DoxyCodeLine{515 \textcolor{comment}{}}
\DoxyCodeLine{516 \textcolor{comment}{ ************************************************************************************************************************************************************}}
\DoxyCodeLine{517 \textcolor{comment}{ ************************************************************************************************************************************************************/}}
\DoxyCodeLine{518 \textcolor{preprocessor}{\#if defined(DR\_MP3\_IMPLEMENTATION) || defined(DRMP3\_IMPLEMENTATION)}}
\DoxyCodeLine{519 \textcolor{preprocessor}{\#ifndef dr\_mp3\_c}}
\DoxyCodeLine{520 \textcolor{preprocessor}{\#define dr\_mp3\_c}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{523 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{524 \textcolor{preprocessor}{\#include <limits.h>} \textcolor{comment}{/* For INT\_MAX */}}
\DoxyCodeLine{525 }
\DoxyCodeLine{526 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_version(drmp3\_uint32* pMajor, drmp3\_uint32* pMinor, drmp3\_uint32* pRevision)}
\DoxyCodeLine{527 \{}
\DoxyCodeLine{528     \textcolor{keywordflow}{if} (pMajor) \{}
\DoxyCodeLine{529         *pMajor = DRMP3\_VERSION\_MAJOR;}
\DoxyCodeLine{530     \}}
\DoxyCodeLine{531 }
\DoxyCodeLine{532     \textcolor{keywordflow}{if} (pMinor) \{}
\DoxyCodeLine{533         *pMinor = DRMP3\_VERSION\_MINOR;}
\DoxyCodeLine{534     \}}
\DoxyCodeLine{535 }
\DoxyCodeLine{536     \textcolor{keywordflow}{if} (pRevision) \{}
\DoxyCodeLine{537         *pRevision = DRMP3\_VERSION\_REVISION;}
\DoxyCodeLine{538     \}}
\DoxyCodeLine{539 \}}
\DoxyCodeLine{540 }
\DoxyCodeLine{541 DRMP3\_API \textcolor{keyword}{const} \textcolor{keywordtype}{char}* drmp3\_version\_string(\textcolor{keywordtype}{void})}
\DoxyCodeLine{542 \{}
\DoxyCodeLine{543     \textcolor{keywordflow}{return} DRMP3\_VERSION\_STRING;}
\DoxyCodeLine{544 \}}
\DoxyCodeLine{545 }
\DoxyCodeLine{546 \textcolor{comment}{/* Disable SIMD when compiling with TCC for now. */}}
\DoxyCodeLine{547 \textcolor{preprocessor}{\#if defined(\_\_TINYC\_\_)}}
\DoxyCodeLine{548 \textcolor{preprocessor}{\#define DR\_MP3\_NO\_SIMD}}
\DoxyCodeLine{549 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{550 }
\DoxyCodeLine{551 \textcolor{preprocessor}{\#define DRMP3\_OFFSET\_PTR(p, offset) ((void*)((drmp3\_uint8*)(p) + (offset)))}}
\DoxyCodeLine{552 }
\DoxyCodeLine{553 \textcolor{preprocessor}{\#define DRMP3\_MAX\_FREE\_FORMAT\_FRAME\_SIZE  2304    }\textcolor{comment}{/* more than ISO spec's */}\textcolor{preprocessor}{}}
\DoxyCodeLine{554 \textcolor{preprocessor}{\#ifndef DRMP3\_MAX\_FRAME\_SYNC\_MATCHES}}
\DoxyCodeLine{555 \textcolor{preprocessor}{\#define DRMP3\_MAX\_FRAME\_SYNC\_MATCHES      10}}
\DoxyCodeLine{556 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{557 }
\DoxyCodeLine{558 \textcolor{preprocessor}{\#define DRMP3\_MAX\_L3\_FRAME\_PAYLOAD\_BYTES  DRMP3\_MAX\_FREE\_FORMAT\_FRAME\_SIZE }\textcolor{comment}{/* MUST be >= 320000/8/32000*1152 = 1440 */}\textcolor{preprocessor}{}}
\DoxyCodeLine{559 }
\DoxyCodeLine{560 \textcolor{preprocessor}{\#define DRMP3\_MAX\_BITRESERVOIR\_BYTES      511}}
\DoxyCodeLine{561 \textcolor{preprocessor}{\#define DRMP3\_SHORT\_BLOCK\_TYPE            2}}
\DoxyCodeLine{562 \textcolor{preprocessor}{\#define DRMP3\_STOP\_BLOCK\_TYPE             3}}
\DoxyCodeLine{563 \textcolor{preprocessor}{\#define DRMP3\_MODE\_MONO                   3}}
\DoxyCodeLine{564 \textcolor{preprocessor}{\#define DRMP3\_MODE\_JOINT\_STEREO           1}}
\DoxyCodeLine{565 \textcolor{preprocessor}{\#define DRMP3\_HDR\_SIZE                    4}}
\DoxyCodeLine{566 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_MONO(h)              (((h[3]) \& 0xC0) == 0xC0)}}
\DoxyCodeLine{567 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_MS\_STEREO(h)         (((h[3]) \& 0xE0) == 0x60)}}
\DoxyCodeLine{568 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_FREE\_FORMAT(h)       (((h[2]) \& 0xF0) == 0)}}
\DoxyCodeLine{569 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_CRC(h)               (!((h[1]) \& 1))}}
\DoxyCodeLine{570 \textcolor{preprocessor}{\#define DRMP3\_HDR\_TEST\_PADDING(h)         ((h[2]) \& 0x2)}}
\DoxyCodeLine{571 \textcolor{preprocessor}{\#define DRMP3\_HDR\_TEST\_MPEG1(h)           ((h[1]) \& 0x8)}}
\DoxyCodeLine{572 \textcolor{preprocessor}{\#define DRMP3\_HDR\_TEST\_NOT\_MPEG25(h)      ((h[1]) \& 0x10)}}
\DoxyCodeLine{573 \textcolor{preprocessor}{\#define DRMP3\_HDR\_TEST\_I\_STEREO(h)        ((h[3]) \& 0x10)}}
\DoxyCodeLine{574 \textcolor{preprocessor}{\#define DRMP3\_HDR\_TEST\_MS\_STEREO(h)       ((h[3]) \& 0x20)}}
\DoxyCodeLine{575 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_STEREO\_MODE(h)      (((h[3]) >> 6) \& 3)}}
\DoxyCodeLine{576 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_STEREO\_MODE\_EXT(h)  (((h[3]) >> 4) \& 3)}}
\DoxyCodeLine{577 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_LAYER(h)            (((h[1]) >> 1) \& 3)}}
\DoxyCodeLine{578 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_BITRATE(h)          ((h[2]) >> 4)}}
\DoxyCodeLine{579 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_SAMPLE\_RATE(h)      (((h[2]) >> 2) \& 3)}}
\DoxyCodeLine{580 \textcolor{preprocessor}{\#define DRMP3\_HDR\_GET\_MY\_SAMPLE\_RATE(h)   (DRMP3\_HDR\_GET\_SAMPLE\_RATE(h) + (((h[1] >> 3) \& 1) + ((h[1] >> 4) \& 1))*3)}}
\DoxyCodeLine{581 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_FRAME\_576(h)         ((h[1] \& 14) == 2)}}
\DoxyCodeLine{582 \textcolor{preprocessor}{\#define DRMP3\_HDR\_IS\_LAYER\_1(h)           ((h[1] \& 6) == 6)}}
\DoxyCodeLine{583 }
\DoxyCodeLine{584 \textcolor{preprocessor}{\#define DRMP3\_BITS\_DEQUANTIZER\_OUT        -\/1}}
\DoxyCodeLine{585 \textcolor{preprocessor}{\#define DRMP3\_MAX\_SCF                     (255 + DRMP3\_BITS\_DEQUANTIZER\_OUT*4 -\/ 210)}}
\DoxyCodeLine{586 \textcolor{preprocessor}{\#define DRMP3\_MAX\_SCFI                    ((DRMP3\_MAX\_SCF + 3) \& \string~3)}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588 \textcolor{preprocessor}{\#define DRMP3\_MIN(a, b)           ((a) > (b) ? (b) : (a))}}
\DoxyCodeLine{589 \textcolor{preprocessor}{\#define DRMP3\_MAX(a, b)           ((a) < (b) ? (b) : (a))}}
\DoxyCodeLine{590 }
\DoxyCodeLine{591 \textcolor{preprocessor}{\#if !defined(DR\_MP3\_NO\_SIMD)}}
\DoxyCodeLine{592 }
\DoxyCodeLine{593 \textcolor{preprocessor}{\#if !defined(DR\_MP3\_ONLY\_SIMD) \&\& (defined(\_M\_X64) || defined(\_\_x86\_64\_\_) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64))}}
\DoxyCodeLine{594 \textcolor{comment}{/* x64 always have SSE2, arm64 always have neon, no need for generic code */}}
\DoxyCodeLine{595 \textcolor{preprocessor}{\#define DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{596 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{597 }
\DoxyCodeLine{598 \textcolor{preprocessor}{\#if ((defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400) \&\& (defined(\_M\_IX86) || defined(\_M\_X64))) || ((defined(\_\_i386\_\_) || defined(\_\_x86\_64\_\_)) \&\& defined(\_\_SSE2\_\_))}}
\DoxyCodeLine{599 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{600 \textcolor{preprocessor}{\#include <intrin.h>}}
\DoxyCodeLine{601 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{602 \textcolor{preprocessor}{\#include <emmintrin.h>}}
\DoxyCodeLine{603 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SSE 1}}
\DoxyCodeLine{604 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SIMD 1}}
\DoxyCodeLine{605 \textcolor{preprocessor}{\#define DRMP3\_VSTORE \_mm\_storeu\_ps}}
\DoxyCodeLine{606 \textcolor{preprocessor}{\#define DRMP3\_VLD \_mm\_loadu\_ps}}
\DoxyCodeLine{607 \textcolor{preprocessor}{\#define DRMP3\_VSET \_mm\_set1\_ps}}
\DoxyCodeLine{608 \textcolor{preprocessor}{\#define DRMP3\_VADD \_mm\_add\_ps}}
\DoxyCodeLine{609 \textcolor{preprocessor}{\#define DRMP3\_VSUB \_mm\_sub\_ps}}
\DoxyCodeLine{610 \textcolor{preprocessor}{\#define DRMP3\_VMUL \_mm\_mul\_ps}}
\DoxyCodeLine{611 \textcolor{preprocessor}{\#define DRMP3\_VMAC(a, x, y) \_mm\_add\_ps(a, \_mm\_mul\_ps(x, y))}}
\DoxyCodeLine{612 \textcolor{preprocessor}{\#define DRMP3\_VMSB(a, x, y) \_mm\_sub\_ps(a, \_mm\_mul\_ps(x, y))}}
\DoxyCodeLine{613 \textcolor{preprocessor}{\#define DRMP3\_VMUL\_S(x, s)  \_mm\_mul\_ps(x, \_mm\_set1\_ps(s))}}
\DoxyCodeLine{614 \textcolor{preprocessor}{\#define DRMP3\_VREV(x) \_mm\_shuffle\_ps(x, x, \_MM\_SHUFFLE(0, 1, 2, 3))}}
\DoxyCodeLine{615 \textcolor{keyword}{typedef} \_\_m128 drmp3\_f4;}
\DoxyCodeLine{616 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) || defined(DR\_MP3\_ONLY\_SIMD)}}
\DoxyCodeLine{617 \textcolor{preprocessor}{\#define drmp3\_cpuid \_\_cpuid}}
\DoxyCodeLine{618 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{619 \textcolor{keyword}{static} \_\_inline\_\_ \_\_attribute\_\_((always\_inline)) \textcolor{keywordtype}{void} drmp3\_cpuid(\textcolor{keywordtype}{int} CPUInfo[], \textcolor{keyword}{const} \textcolor{keywordtype}{int} InfoType)}
\DoxyCodeLine{620 \{}
\DoxyCodeLine{621 \textcolor{preprocessor}{\#if defined(\_\_PIC\_\_)}}
\DoxyCodeLine{622     \_\_asm\_\_ \_\_volatile\_\_(}
\DoxyCodeLine{623 \#\textcolor{keywordflow}{if} defined(\_\_x86\_64\_\_)}
\DoxyCodeLine{624         \textcolor{stringliteral}{"{}push \%\%rbx\(\backslash\)n"{}}}
\DoxyCodeLine{625         \textcolor{stringliteral}{"{}cpuid\(\backslash\)n"{}}}
\DoxyCodeLine{626         \textcolor{stringliteral}{"{}xchgl \%\%ebx, \%1\(\backslash\)n"{}}}
\DoxyCodeLine{627         \textcolor{stringliteral}{"{}pop  \%\%rbx\(\backslash\)n"{}}}
\DoxyCodeLine{628 \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{629         \textcolor{stringliteral}{"{}xchgl \%\%ebx, \%1\(\backslash\)n"{}}}
\DoxyCodeLine{630         \textcolor{stringliteral}{"{}cpuid\(\backslash\)n"{}}}
\DoxyCodeLine{631         \textcolor{stringliteral}{"{}xchgl \%\%ebx, \%1\(\backslash\)n"{}}}
\DoxyCodeLine{632 \#endif}
\DoxyCodeLine{633         : \textcolor{stringliteral}{"{}=a"{}} (CPUInfo[0]), \textcolor{stringliteral}{"{}=r"{}} (CPUInfo[1]), \textcolor{stringliteral}{"{}=c"{}} (CPUInfo[2]), \textcolor{stringliteral}{"{}=d"{}} (CPUInfo[3])}
\DoxyCodeLine{634         : \textcolor{stringliteral}{"{}a"{}} (InfoType));}
\DoxyCodeLine{635 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{636     \_\_asm\_\_ \_\_volatile\_\_(}
\DoxyCodeLine{637         \textcolor{stringliteral}{"{}cpuid"{}}}
\DoxyCodeLine{638         : \textcolor{stringliteral}{"{}=a"{}} (CPUInfo[0]), \textcolor{stringliteral}{"{}=b"{}} (CPUInfo[1]), \textcolor{stringliteral}{"{}=c"{}} (CPUInfo[2]), \textcolor{stringliteral}{"{}=d"{}} (CPUInfo[3])}
\DoxyCodeLine{639         : \textcolor{stringliteral}{"{}a"{}} (InfoType));}
\DoxyCodeLine{640 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{641 \}}
\DoxyCodeLine{642 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{643 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_have\_simd(\textcolor{keywordtype}{void})}
\DoxyCodeLine{644 \{}
\DoxyCodeLine{645 \textcolor{preprocessor}{\#ifdef DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{646     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{647 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{648     \textcolor{keyword}{static} \textcolor{keywordtype}{int} g\_have\_simd;}
\DoxyCodeLine{649     \textcolor{keywordtype}{int} CPUInfo[4];}
\DoxyCodeLine{650 \textcolor{preprocessor}{\#ifdef MINIMP3\_TEST}}
\DoxyCodeLine{651     \textcolor{keyword}{static} \textcolor{keywordtype}{int} g\_counter;}
\DoxyCodeLine{652     \textcolor{keywordflow}{if} (g\_counter++ > 100)}
\DoxyCodeLine{653         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{654 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{655     \textcolor{keywordflow}{if} (g\_have\_simd)}
\DoxyCodeLine{656         \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{657     drmp3\_cpuid(CPUInfo, 0);}
\DoxyCodeLine{658     \textcolor{keywordflow}{if} (CPUInfo[0] > 0)}
\DoxyCodeLine{659     \{}
\DoxyCodeLine{660         drmp3\_cpuid(CPUInfo, 1);}
\DoxyCodeLine{661         g\_have\_simd = (CPUInfo[3] \& (1 << 26)) + 1; \textcolor{comment}{/* SSE2 */}}
\DoxyCodeLine{662         \textcolor{keywordflow}{return} g\_have\_simd -\/ 1;}
\DoxyCodeLine{663     \}}
\DoxyCodeLine{664 }
\DoxyCodeLine{665 end:}
\DoxyCodeLine{666     \textcolor{keywordflow}{return} g\_have\_simd -\/ 1;}
\DoxyCodeLine{667 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{668 \}}
\DoxyCodeLine{669 \textcolor{preprocessor}{\#elif defined(\_\_ARM\_NEON) || defined(\_\_aarch64\_\_) || defined(\_M\_ARM64)}}
\DoxyCodeLine{670 \textcolor{preprocessor}{\#include <arm\_neon.h>}}
\DoxyCodeLine{671 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SSE 0}}
\DoxyCodeLine{672 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SIMD 1}}
\DoxyCodeLine{673 \textcolor{preprocessor}{\#define DRMP3\_VSTORE vst1q\_f32}}
\DoxyCodeLine{674 \textcolor{preprocessor}{\#define DRMP3\_VLD vld1q\_f32}}
\DoxyCodeLine{675 \textcolor{preprocessor}{\#define DRMP3\_VSET vmovq\_n\_f32}}
\DoxyCodeLine{676 \textcolor{preprocessor}{\#define DRMP3\_VADD vaddq\_f32}}
\DoxyCodeLine{677 \textcolor{preprocessor}{\#define DRMP3\_VSUB vsubq\_f32}}
\DoxyCodeLine{678 \textcolor{preprocessor}{\#define DRMP3\_VMUL vmulq\_f32}}
\DoxyCodeLine{679 \textcolor{preprocessor}{\#define DRMP3\_VMAC(a, x, y) vmlaq\_f32(a, x, y)}}
\DoxyCodeLine{680 \textcolor{preprocessor}{\#define DRMP3\_VMSB(a, x, y) vmlsq\_f32(a, x, y)}}
\DoxyCodeLine{681 \textcolor{preprocessor}{\#define DRMP3\_VMUL\_S(x, s)  vmulq\_f32(x, vmovq\_n\_f32(s))}}
\DoxyCodeLine{682 \textcolor{preprocessor}{\#define DRMP3\_VREV(x) vcombine\_f32(vget\_high\_f32(vrev64q\_f32(x)), vget\_low\_f32(vrev64q\_f32(x)))}}
\DoxyCodeLine{683 \textcolor{keyword}{typedef} float32x4\_t drmp3\_f4;}
\DoxyCodeLine{684 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_have\_simd(\textcolor{keywordtype}{void})}
\DoxyCodeLine{685 \{   \textcolor{comment}{/* TODO: detect neon for !DR\_MP3\_ONLY\_SIMD */}}
\DoxyCodeLine{686     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{687 \}}
\DoxyCodeLine{688 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{689 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SSE 0}}
\DoxyCodeLine{690 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SIMD 0}}
\DoxyCodeLine{691 \textcolor{preprocessor}{\#ifdef DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{692 \textcolor{preprocessor}{\#error DR\_MP3\_ONLY\_SIMD used, but SSE/NEON not enabled}}
\DoxyCodeLine{693 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{694 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{695 }
\DoxyCodeLine{696 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{697 }
\DoxyCodeLine{698 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_SIMD 0}}
\DoxyCodeLine{699 }
\DoxyCodeLine{700 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{701 }
\DoxyCodeLine{702 \textcolor{preprocessor}{\#if defined(\_\_ARM\_ARCH) \&\& (\_\_ARM\_ARCH >= 6) \&\& !defined(\_\_aarch64\_\_) \&\& !defined(\_M\_ARM64)}}
\DoxyCodeLine{703 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_ARMV6 1}}
\DoxyCodeLine{704 \textcolor{keyword}{static} \_\_inline\_\_ \_\_attribute\_\_((always\_inline)) drmp3\_int32 drmp3\_clip\_int16\_arm(drmp3\_int32 a)}
\DoxyCodeLine{705 \{}
\DoxyCodeLine{706     drmp3\_int32 x = 0;}
\DoxyCodeLine{707     \_\_asm\_\_ (\textcolor{stringliteral}{"{}ssat \%0, \#16, \%1"{}} : \textcolor{stringliteral}{"{}=r"{}}(x) : \textcolor{stringliteral}{"{}r"{}}(a));}
\DoxyCodeLine{708     \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{709 \}}
\DoxyCodeLine{710 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{711 \textcolor{preprocessor}{\#define DRMP3\_HAVE\_ARMV6 0}}
\DoxyCodeLine{712 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{713 }
\DoxyCodeLine{714 }
\DoxyCodeLine{715 \textcolor{comment}{/* Standard library stuff. */}}
\DoxyCodeLine{716 \textcolor{preprocessor}{\#ifndef DRMP3\_ASSERT}}
\DoxyCodeLine{717 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{718 \textcolor{preprocessor}{\#define DRMP3\_ASSERT(expression) assert(expression)}}
\DoxyCodeLine{719 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{720 \textcolor{preprocessor}{\#ifndef DRMP3\_COPY\_MEMORY}}
\DoxyCodeLine{721 \textcolor{preprocessor}{\#define DRMP3\_COPY\_MEMORY(dst, src, sz) memcpy((dst), (src), (sz))}}
\DoxyCodeLine{722 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{723 \textcolor{preprocessor}{\#ifndef DRMP3\_MOVE\_MEMORY}}
\DoxyCodeLine{724 \textcolor{preprocessor}{\#define DRMP3\_MOVE\_MEMORY(dst, src, sz) memmove((dst), (src), (sz))}}
\DoxyCodeLine{725 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{726 \textcolor{preprocessor}{\#ifndef DRMP3\_ZERO\_MEMORY}}
\DoxyCodeLine{727 \textcolor{preprocessor}{\#define DRMP3\_ZERO\_MEMORY(p, sz) memset((p), 0, (sz))}}
\DoxyCodeLine{728 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{729 \textcolor{preprocessor}{\#define DRMP3\_ZERO\_OBJECT(p) DRMP3\_ZERO\_MEMORY((p), sizeof(*(p)))}}
\DoxyCodeLine{730 \textcolor{preprocessor}{\#ifndef DRMP3\_MALLOC}}
\DoxyCodeLine{731 \textcolor{preprocessor}{\#define DRMP3\_MALLOC(sz) malloc((sz))}}
\DoxyCodeLine{732 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{733 \textcolor{preprocessor}{\#ifndef DRMP3\_REALLOC}}
\DoxyCodeLine{734 \textcolor{preprocessor}{\#define DRMP3\_REALLOC(p, sz) realloc((p), (sz))}}
\DoxyCodeLine{735 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{736 \textcolor{preprocessor}{\#ifndef DRMP3\_FREE}}
\DoxyCodeLine{737 \textcolor{preprocessor}{\#define DRMP3\_FREE(p) free((p))}}
\DoxyCodeLine{738 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{739 }
\DoxyCodeLine{740 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{741 \{}
\DoxyCodeLine{742     \textcolor{keyword}{const} drmp3\_uint8 *buf;}
\DoxyCodeLine{743     \textcolor{keywordtype}{int} pos, limit;}
\DoxyCodeLine{744 \} drmp3\_bs;}
\DoxyCodeLine{745 }
\DoxyCodeLine{746 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{747 \{}
\DoxyCodeLine{748     \textcolor{keywordtype}{float} scf[3*64];}
\DoxyCodeLine{749     drmp3\_uint8 total\_bands, stereo\_bands, bitalloc[64], scfcod[64];}
\DoxyCodeLine{750 \} drmp3\_L12\_scale\_info;}
\DoxyCodeLine{751 }
\DoxyCodeLine{752 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{753 \{}
\DoxyCodeLine{754     drmp3\_uint8 tab\_offset, code\_tab\_width, band\_count;}
\DoxyCodeLine{755 \} drmp3\_L12\_subband\_alloc;}
\DoxyCodeLine{756 }
\DoxyCodeLine{757 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{758 \{}
\DoxyCodeLine{759     \textcolor{keyword}{const} drmp3\_uint8 *sfbtab;}
\DoxyCodeLine{760     drmp3\_uint16 part\_23\_length, big\_values, scalefac\_compress;}
\DoxyCodeLine{761     drmp3\_uint8 global\_gain, block\_type, mixed\_block\_flag, n\_long\_sfb, n\_short\_sfb;}
\DoxyCodeLine{762     drmp3\_uint8 table\_select[3], region\_count[3], subblock\_gain[3];}
\DoxyCodeLine{763     drmp3\_uint8 preflag, scalefac\_scale, count1\_table, scfsi;}
\DoxyCodeLine{764 \} drmp3\_L3\_gr\_info;}
\DoxyCodeLine{765 }
\DoxyCodeLine{766 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{767 \{}
\DoxyCodeLine{768     drmp3\_bs bs;}
\DoxyCodeLine{769     drmp3\_uint8 maindata[DRMP3\_MAX\_BITRESERVOIR\_BYTES + DRMP3\_MAX\_L3\_FRAME\_PAYLOAD\_BYTES];}
\DoxyCodeLine{770     drmp3\_L3\_gr\_info gr\_info[4];}
\DoxyCodeLine{771     \textcolor{keywordtype}{float} grbuf[2][576], scf[40], syn[18 + 15][2*32];}
\DoxyCodeLine{772     drmp3\_uint8 ist\_pos[2][39];}
\DoxyCodeLine{773 \} drmp3dec\_scratch;}
\DoxyCodeLine{774 }
\DoxyCodeLine{775 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_bs\_init(drmp3\_bs *bs, \textcolor{keyword}{const} drmp3\_uint8 *data, \textcolor{keywordtype}{int} bytes)}
\DoxyCodeLine{776 \{}
\DoxyCodeLine{777     bs-\/>buf   = data;}
\DoxyCodeLine{778     bs-\/>pos   = 0;}
\DoxyCodeLine{779     bs-\/>limit = bytes*8;}
\DoxyCodeLine{780 \}}
\DoxyCodeLine{781 }
\DoxyCodeLine{782 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_bs\_get\_bits(drmp3\_bs *bs, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{783 \{}
\DoxyCodeLine{784     drmp3\_uint32 next, cache = 0, s = bs-\/>pos \& 7;}
\DoxyCodeLine{785     \textcolor{keywordtype}{int} shl = n + s;}
\DoxyCodeLine{786     \textcolor{keyword}{const} drmp3\_uint8 *p = bs-\/>buf + (bs-\/>pos >> 3);}
\DoxyCodeLine{787     \textcolor{keywordflow}{if} ((bs-\/>pos += n) > bs-\/>limit)}
\DoxyCodeLine{788         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{789     next = *p++ \& (255 >> s);}
\DoxyCodeLine{790     \textcolor{keywordflow}{while} ((shl -\/= 8) > 0)}
\DoxyCodeLine{791     \{}
\DoxyCodeLine{792         cache |= next << shl;}
\DoxyCodeLine{793         next = *p++;}
\DoxyCodeLine{794     \}}
\DoxyCodeLine{795     \textcolor{keywordflow}{return} cache | (next >> -\/shl);}
\DoxyCodeLine{796 \}}
\DoxyCodeLine{797 }
\DoxyCodeLine{798 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_hdr\_valid(\textcolor{keyword}{const} drmp3\_uint8 *h)}
\DoxyCodeLine{799 \{}
\DoxyCodeLine{800     \textcolor{keywordflow}{return} h[0] == 0xff \&\&}
\DoxyCodeLine{801         ((h[1] \& 0xF0) == 0xf0 || (h[1] \& 0xFE) == 0xe2) \&\&}
\DoxyCodeLine{802         (DRMP3\_HDR\_GET\_LAYER(h) != 0) \&\&}
\DoxyCodeLine{803         (DRMP3\_HDR\_GET\_BITRATE(h) != 15) \&\&}
\DoxyCodeLine{804         (DRMP3\_HDR\_GET\_SAMPLE\_RATE(h) != 3);}
\DoxyCodeLine{805 \}}
\DoxyCodeLine{806 }
\DoxyCodeLine{807 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_hdr\_compare(\textcolor{keyword}{const} drmp3\_uint8 *h1, \textcolor{keyword}{const} drmp3\_uint8 *h2)}
\DoxyCodeLine{808 \{}
\DoxyCodeLine{809     \textcolor{keywordflow}{return} drmp3\_hdr\_valid(h2) \&\&}
\DoxyCodeLine{810         ((h1[1] \string^ h2[1]) \& 0xFE) == 0 \&\&}
\DoxyCodeLine{811         ((h1[2] \string^ h2[2]) \& 0x0C) == 0 \&\&}
\DoxyCodeLine{812         !(DRMP3\_HDR\_IS\_FREE\_FORMAT(h1) \string^ DRMP3\_HDR\_IS\_FREE\_FORMAT(h2));}
\DoxyCodeLine{813 \}}
\DoxyCodeLine{814 }
\DoxyCodeLine{815 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} drmp3\_hdr\_bitrate\_kbps(\textcolor{keyword}{const} drmp3\_uint8 *h)}
\DoxyCodeLine{816 \{}
\DoxyCodeLine{817     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 halfrate[2][3][15] = \{}
\DoxyCodeLine{818         \{ \{ 0,4,8,12,16,20,24,28,32,40,48,56,64,72,80 \}, \{ 0,4,8,12,16,20,24,28,32,40,48,56,64,72,80 \}, \{ 0,16,24,28,32,40,48,56,64,72,80,88,96,112,128 \} \},}
\DoxyCodeLine{819         \{ \{ 0,16,20,24,28,32,40,48,56,64,80,96,112,128,160 \}, \{ 0,16,24,28,32,40,48,56,64,80,96,112,128,160,192 \}, \{ 0,16,32,48,64,80,96,112,128,144,160,176,192,208,224 \} \},}
\DoxyCodeLine{820     \};}
\DoxyCodeLine{821     \textcolor{keywordflow}{return} 2*halfrate[!!DRMP3\_HDR\_TEST\_MPEG1(h)][DRMP3\_HDR\_GET\_LAYER(h) -\/ 1][DRMP3\_HDR\_GET\_BITRATE(h)];}
\DoxyCodeLine{822 \}}
\DoxyCodeLine{823 }
\DoxyCodeLine{824 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} drmp3\_hdr\_sample\_rate\_hz(\textcolor{keyword}{const} drmp3\_uint8 *h)}
\DoxyCodeLine{825 \{}
\DoxyCodeLine{826     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} g\_hz[3] = \{ 44100, 48000, 32000 \};}
\DoxyCodeLine{827     \textcolor{keywordflow}{return} g\_hz[DRMP3\_HDR\_GET\_SAMPLE\_RATE(h)] >> (int)!DRMP3\_HDR\_TEST\_MPEG1(h) >> (int)!DRMP3\_HDR\_TEST\_NOT\_MPEG25(h);}
\DoxyCodeLine{828 \}}
\DoxyCodeLine{829 }
\DoxyCodeLine{830 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} drmp3\_hdr\_frame\_samples(\textcolor{keyword}{const} drmp3\_uint8 *h)}
\DoxyCodeLine{831 \{}
\DoxyCodeLine{832     \textcolor{keywordflow}{return} DRMP3\_HDR\_IS\_LAYER\_1(h) ? 384 : (1152 >> (int)DRMP3\_HDR\_IS\_FRAME\_576(h));}
\DoxyCodeLine{833 \}}
\DoxyCodeLine{834 }
\DoxyCodeLine{835 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_hdr\_frame\_bytes(\textcolor{keyword}{const} drmp3\_uint8 *h, \textcolor{keywordtype}{int} free\_format\_size)}
\DoxyCodeLine{836 \{}
\DoxyCodeLine{837     \textcolor{keywordtype}{int} frame\_bytes = drmp3\_hdr\_frame\_samples(h)*drmp3\_hdr\_bitrate\_kbps(h)*125/drmp3\_hdr\_sample\_rate\_hz(h);}
\DoxyCodeLine{838     \textcolor{keywordflow}{if} (DRMP3\_HDR\_IS\_LAYER\_1(h))}
\DoxyCodeLine{839     \{}
\DoxyCodeLine{840         frame\_bytes \&= \string~3; \textcolor{comment}{/* slot align */}}
\DoxyCodeLine{841     \}}
\DoxyCodeLine{842     \textcolor{keywordflow}{return} frame\_bytes ? frame\_bytes : free\_format\_size;}
\DoxyCodeLine{843 \}}
\DoxyCodeLine{844 }
\DoxyCodeLine{845 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_hdr\_padding(\textcolor{keyword}{const} drmp3\_uint8 *h)}
\DoxyCodeLine{846 \{}
\DoxyCodeLine{847     \textcolor{keywordflow}{return} DRMP3\_HDR\_TEST\_PADDING(h) ? (DRMP3\_HDR\_IS\_LAYER\_1(h) ? 4 : 1) : 0;}
\DoxyCodeLine{848 \}}
\DoxyCodeLine{849 }
\DoxyCodeLine{850 \textcolor{preprocessor}{\#ifndef DR\_MP3\_ONLY\_MP3}}
\DoxyCodeLine{851 \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc *drmp3\_L12\_subband\_alloc\_table(\textcolor{keyword}{const} drmp3\_uint8 *hdr, drmp3\_L12\_scale\_info *sci)}
\DoxyCodeLine{852 \{}
\DoxyCodeLine{853     \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc *alloc;}
\DoxyCodeLine{854     \textcolor{keywordtype}{int} mode = DRMP3\_HDR\_GET\_STEREO\_MODE(hdr);}
\DoxyCodeLine{855     \textcolor{keywordtype}{int} nbands, stereo\_bands = (mode == DRMP3\_MODE\_MONO) ? 0 : (mode == DRMP3\_MODE\_JOINT\_STEREO) ? (DRMP3\_HDR\_GET\_STEREO\_MODE\_EXT(hdr) << 2) + 4 : 32;}
\DoxyCodeLine{856 }
\DoxyCodeLine{857     \textcolor{keywordflow}{if} (DRMP3\_HDR\_IS\_LAYER\_1(hdr))}
\DoxyCodeLine{858     \{}
\DoxyCodeLine{859         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc g\_alloc\_L1[] = \{ \{ 76, 4, 32 \} \};}
\DoxyCodeLine{860         alloc = g\_alloc\_L1;}
\DoxyCodeLine{861         nbands = 32;}
\DoxyCodeLine{862     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!DRMP3\_HDR\_TEST\_MPEG1(hdr))}
\DoxyCodeLine{863     \{}
\DoxyCodeLine{864         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc g\_alloc\_L2M2[] = \{ \{ 60, 4, 4 \}, \{ 44, 3, 7 \}, \{ 44, 2, 19 \} \};}
\DoxyCodeLine{865         alloc = g\_alloc\_L2M2;}
\DoxyCodeLine{866         nbands = 30;}
\DoxyCodeLine{867     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{868     \{}
\DoxyCodeLine{869         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc g\_alloc\_L2M1[] = \{ \{ 0, 4, 3 \}, \{ 16, 4, 8 \}, \{ 32, 3, 12 \}, \{ 40, 2, 7 \} \};}
\DoxyCodeLine{870         \textcolor{keywordtype}{int} sample\_rate\_idx = DRMP3\_HDR\_GET\_SAMPLE\_RATE(hdr);}
\DoxyCodeLine{871         \textcolor{keywordtype}{unsigned} kbps = drmp3\_hdr\_bitrate\_kbps(hdr) >> (int)(mode != DRMP3\_MODE\_MONO);}
\DoxyCodeLine{872         \textcolor{keywordflow}{if} (!kbps) \textcolor{comment}{/* free-\/format */}}
\DoxyCodeLine{873         \{}
\DoxyCodeLine{874             kbps = 192;}
\DoxyCodeLine{875         \}}
\DoxyCodeLine{876 }
\DoxyCodeLine{877         alloc = g\_alloc\_L2M1;}
\DoxyCodeLine{878         nbands = 27;}
\DoxyCodeLine{879         \textcolor{keywordflow}{if} (kbps < 56)}
\DoxyCodeLine{880         \{}
\DoxyCodeLine{881             \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc g\_alloc\_L2M1\_lowrate[] = \{ \{ 44, 4, 2 \}, \{ 44, 3, 10 \} \};}
\DoxyCodeLine{882             alloc = g\_alloc\_L2M1\_lowrate;}
\DoxyCodeLine{883             nbands = sample\_rate\_idx == 2 ? 12 : 8;}
\DoxyCodeLine{884         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (kbps >= 96 \&\& sample\_rate\_idx != 1)}
\DoxyCodeLine{885         \{}
\DoxyCodeLine{886             nbands = 30;}
\DoxyCodeLine{887         \}}
\DoxyCodeLine{888     \}}
\DoxyCodeLine{889 }
\DoxyCodeLine{890     sci-\/>total\_bands = (drmp3\_uint8)nbands;}
\DoxyCodeLine{891     sci-\/>stereo\_bands = (drmp3\_uint8)DRMP3\_MIN(stereo\_bands, nbands);}
\DoxyCodeLine{892 }
\DoxyCodeLine{893     \textcolor{keywordflow}{return} alloc;}
\DoxyCodeLine{894 \}}
\DoxyCodeLine{895 }
\DoxyCodeLine{896 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L12\_read\_scalefactors(drmp3\_bs *bs, drmp3\_uint8 *pba, drmp3\_uint8 *scfcod, \textcolor{keywordtype}{int} bands, \textcolor{keywordtype}{float} *scf)}
\DoxyCodeLine{897 \{}
\DoxyCodeLine{898     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_deq\_L12[18*3] = \{}
\DoxyCodeLine{899 \textcolor{preprocessor}{\#define DRMP3\_DQ(x) 9.53674316e-\/07f/x, 7.56931807e-\/07f/x, 6.00777173e-\/07f/x}}
\DoxyCodeLine{900         DRMP3\_DQ(3),DRMP3\_DQ(7),DRMP3\_DQ(15),DRMP3\_DQ(31),DRMP3\_DQ(63),DRMP3\_DQ(127),DRMP3\_DQ(255),DRMP3\_DQ(511),DRMP3\_DQ(1023),DRMP3\_DQ(2047),DRMP3\_DQ(4095),DRMP3\_DQ(8191),DRMP3\_DQ(16383),DRMP3\_DQ(32767),DRMP3\_DQ(65535),DRMP3\_DQ(3),DRMP3\_DQ(5),DRMP3\_DQ(9)}
\DoxyCodeLine{901     \};}
\DoxyCodeLine{902     \textcolor{keywordtype}{int} i, m;}
\DoxyCodeLine{903     \textcolor{keywordflow}{for} (i = 0; i < bands; i++)}
\DoxyCodeLine{904     \{}
\DoxyCodeLine{905         \textcolor{keywordtype}{float} s = 0;}
\DoxyCodeLine{906         \textcolor{keywordtype}{int} ba = *pba++;}
\DoxyCodeLine{907         \textcolor{keywordtype}{int} mask = ba ? 4 + ((19 >> scfcod[i]) \& 3) : 0;}
\DoxyCodeLine{908         \textcolor{keywordflow}{for} (m = 4; m; m >>= 1)}
\DoxyCodeLine{909         \{}
\DoxyCodeLine{910             \textcolor{keywordflow}{if} (mask \& m)}
\DoxyCodeLine{911             \{}
\DoxyCodeLine{912                 \textcolor{keywordtype}{int} b = drmp3\_bs\_get\_bits(bs, 6);}
\DoxyCodeLine{913                 s = g\_deq\_L12[ba*3 -\/ 6 + b \% 3]*(int)(1 << 21 >> b/3);}
\DoxyCodeLine{914             \}}
\DoxyCodeLine{915             *scf++ = s;}
\DoxyCodeLine{916         \}}
\DoxyCodeLine{917     \}}
\DoxyCodeLine{918 \}}
\DoxyCodeLine{919 }
\DoxyCodeLine{920 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L12\_read\_scale\_info(\textcolor{keyword}{const} drmp3\_uint8 *hdr, drmp3\_bs *bs, drmp3\_L12\_scale\_info *sci)}
\DoxyCodeLine{921 \{}
\DoxyCodeLine{922     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_bitalloc\_code\_tab[] = \{}
\DoxyCodeLine{923         0,17, 3, 4, 5,6,7, 8,9,10,11,12,13,14,15,16,}
\DoxyCodeLine{924         0,17,18, 3,19,4,5, 6,7, 8, 9,10,11,12,13,16,}
\DoxyCodeLine{925         0,17,18, 3,19,4,5,16,}
\DoxyCodeLine{926         0,17,18,16,}
\DoxyCodeLine{927         0,17,18,19, 4,5,6, 7,8, 9,10,11,12,13,14,15,}
\DoxyCodeLine{928         0,17,18, 3,19,4,5, 6,7, 8, 9,10,11,12,13,14,}
\DoxyCodeLine{929         0, 2, 3, 4, 5,6,7, 8,9,10,11,12,13,14,15,16}
\DoxyCodeLine{930     \};}
\DoxyCodeLine{931     \textcolor{keyword}{const} drmp3\_L12\_subband\_alloc *subband\_alloc = drmp3\_L12\_subband\_alloc\_table(hdr, sci);}
\DoxyCodeLine{932 }
\DoxyCodeLine{933     \textcolor{keywordtype}{int} i, k = 0, ba\_bits = 0;}
\DoxyCodeLine{934     \textcolor{keyword}{const} drmp3\_uint8 *ba\_code\_tab = g\_bitalloc\_code\_tab;}
\DoxyCodeLine{935 }
\DoxyCodeLine{936     \textcolor{keywordflow}{for} (i = 0; i < sci-\/>total\_bands; i++)}
\DoxyCodeLine{937     \{}
\DoxyCodeLine{938         drmp3\_uint8 ba;}
\DoxyCodeLine{939         \textcolor{keywordflow}{if} (i == k)}
\DoxyCodeLine{940         \{}
\DoxyCodeLine{941             k += subband\_alloc-\/>band\_count;}
\DoxyCodeLine{942             ba\_bits = subband\_alloc-\/>code\_tab\_width;}
\DoxyCodeLine{943             ba\_code\_tab = g\_bitalloc\_code\_tab + subband\_alloc-\/>tab\_offset;}
\DoxyCodeLine{944             subband\_alloc++;}
\DoxyCodeLine{945         \}}
\DoxyCodeLine{946         ba = ba\_code\_tab[drmp3\_bs\_get\_bits(bs, ba\_bits)];}
\DoxyCodeLine{947         sci-\/>bitalloc[2*i] = ba;}
\DoxyCodeLine{948         \textcolor{keywordflow}{if} (i < sci-\/>stereo\_bands)}
\DoxyCodeLine{949         \{}
\DoxyCodeLine{950             ba = ba\_code\_tab[drmp3\_bs\_get\_bits(bs, ba\_bits)];}
\DoxyCodeLine{951         \}}
\DoxyCodeLine{952         sci-\/>bitalloc[2*i + 1] = sci-\/>stereo\_bands ? ba : 0;}
\DoxyCodeLine{953     \}}
\DoxyCodeLine{954 }
\DoxyCodeLine{955     \textcolor{keywordflow}{for} (i = 0; i < 2*sci-\/>total\_bands; i++)}
\DoxyCodeLine{956     \{}
\DoxyCodeLine{957         sci-\/>scfcod[i] = (drmp3\_uint8)(sci-\/>bitalloc[i] ? DRMP3\_HDR\_IS\_LAYER\_1(hdr) ? 2 : drmp3\_bs\_get\_bits(bs, 2) : 6);}
\DoxyCodeLine{958     \}}
\DoxyCodeLine{959 }
\DoxyCodeLine{960     drmp3\_L12\_read\_scalefactors(bs, sci-\/>bitalloc, sci-\/>scfcod, sci-\/>total\_bands*2, sci-\/>scf);}
\DoxyCodeLine{961 }
\DoxyCodeLine{962     \textcolor{keywordflow}{for} (i = sci-\/>stereo\_bands; i < sci-\/>total\_bands; i++)}
\DoxyCodeLine{963     \{}
\DoxyCodeLine{964         sci-\/>bitalloc[2*i + 1] = 0;}
\DoxyCodeLine{965     \}}
\DoxyCodeLine{966 \}}
\DoxyCodeLine{967 }
\DoxyCodeLine{968 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_L12\_dequantize\_granule(\textcolor{keywordtype}{float} *grbuf, drmp3\_bs *bs, drmp3\_L12\_scale\_info *sci, \textcolor{keywordtype}{int} group\_size)}
\DoxyCodeLine{969 \{}
\DoxyCodeLine{970     \textcolor{keywordtype}{int} i, j, k, choff = 576;}
\DoxyCodeLine{971     \textcolor{keywordflow}{for} (j = 0; j < 4; j++)}
\DoxyCodeLine{972     \{}
\DoxyCodeLine{973         \textcolor{keywordtype}{float} *dst = grbuf + group\_size*j;}
\DoxyCodeLine{974         \textcolor{keywordflow}{for} (i = 0; i < 2*sci-\/>total\_bands; i++)}
\DoxyCodeLine{975         \{}
\DoxyCodeLine{976             \textcolor{keywordtype}{int} ba = sci-\/>bitalloc[i];}
\DoxyCodeLine{977             \textcolor{keywordflow}{if} (ba != 0)}
\DoxyCodeLine{978             \{}
\DoxyCodeLine{979                 \textcolor{keywordflow}{if} (ba < 17)}
\DoxyCodeLine{980                 \{}
\DoxyCodeLine{981                     \textcolor{keywordtype}{int} half = (1 << (ba -\/ 1)) -\/ 1;}
\DoxyCodeLine{982                     \textcolor{keywordflow}{for} (k = 0; k < group\_size; k++)}
\DoxyCodeLine{983                     \{}
\DoxyCodeLine{984                         dst[k] = (float)((\textcolor{keywordtype}{int})drmp3\_bs\_get\_bits(bs, ba) -\/ half);}
\DoxyCodeLine{985                     \}}
\DoxyCodeLine{986                 \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{987                 \{}
\DoxyCodeLine{988                     \textcolor{keywordtype}{unsigned} mod = (2 << (ba -\/ 17)) + 1;    \textcolor{comment}{/* 3, 5, 9 */}}
\DoxyCodeLine{989                     \textcolor{keywordtype}{unsigned} code = drmp3\_bs\_get\_bits(bs, mod + 2 -\/ (mod >> 3));  \textcolor{comment}{/* 5, 7, 10 */}}
\DoxyCodeLine{990                     \textcolor{keywordflow}{for} (k = 0; k < group\_size; k++, code /= mod)}
\DoxyCodeLine{991                     \{}
\DoxyCodeLine{992                         dst[k] = (float)((\textcolor{keywordtype}{int})(code \% mod -\/ mod/2));}
\DoxyCodeLine{993                     \}}
\DoxyCodeLine{994                 \}}
\DoxyCodeLine{995             \}}
\DoxyCodeLine{996             dst += choff;}
\DoxyCodeLine{997             choff = 18 -\/ choff;}
\DoxyCodeLine{998         \}}
\DoxyCodeLine{999     \}}
\DoxyCodeLine{1000     \textcolor{keywordflow}{return} group\_size*4;}
\DoxyCodeLine{1001 \}}
\DoxyCodeLine{1002 }
\DoxyCodeLine{1003 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L12\_apply\_scf\_384(drmp3\_L12\_scale\_info *sci, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *scf, \textcolor{keywordtype}{float} *dst)}
\DoxyCodeLine{1004 \{}
\DoxyCodeLine{1005     \textcolor{keywordtype}{int} i, k;}
\DoxyCodeLine{1006     DRMP3\_COPY\_MEMORY(dst + 576 + sci-\/>stereo\_bands*18, dst + sci-\/>stereo\_bands*18, (sci-\/>total\_bands -\/ sci-\/>stereo\_bands)*18*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1007     \textcolor{keywordflow}{for} (i = 0; i < sci-\/>total\_bands; i++, dst += 18, scf += 6)}
\DoxyCodeLine{1008     \{}
\DoxyCodeLine{1009         \textcolor{keywordflow}{for} (k = 0; k < 12; k++)}
\DoxyCodeLine{1010         \{}
\DoxyCodeLine{1011             dst[k + 0]   *= scf[0];}
\DoxyCodeLine{1012             dst[k + 576] *= scf[3];}
\DoxyCodeLine{1013         \}}
\DoxyCodeLine{1014     \}}
\DoxyCodeLine{1015 \}}
\DoxyCodeLine{1016 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1017 }
\DoxyCodeLine{1018 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_L3\_read\_side\_info(drmp3\_bs *bs, drmp3\_L3\_gr\_info *gr, \textcolor{keyword}{const} drmp3\_uint8 *hdr)}
\DoxyCodeLine{1019 \{}
\DoxyCodeLine{1020     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_scf\_long[8][23] = \{}
\DoxyCodeLine{1021         \{ 6,6,6,6,6,6,8,10,12,14,16,20,24,28,32,38,46,52,60,68,58,54,0 \},}
\DoxyCodeLine{1022         \{ 12,12,12,12,12,12,16,20,24,28,32,40,48,56,64,76,90,2,2,2,2,2,0 \},}
\DoxyCodeLine{1023         \{ 6,6,6,6,6,6,8,10,12,14,16,20,24,28,32,38,46,52,60,68,58,54,0 \},}
\DoxyCodeLine{1024         \{ 6,6,6,6,6,6,8,10,12,14,16,18,22,26,32,38,46,54,62,70,76,36,0 \},}
\DoxyCodeLine{1025         \{ 6,6,6,6,6,6,8,10,12,14,16,20,24,28,32,38,46,52,60,68,58,54,0 \},}
\DoxyCodeLine{1026         \{ 4,4,4,4,4,4,6,6,8,8,10,12,16,20,24,28,34,42,50,54,76,158,0 \},}
\DoxyCodeLine{1027         \{ 4,4,4,4,4,4,6,6,6,8,10,12,16,18,22,28,34,40,46,54,54,192,0 \},}
\DoxyCodeLine{1028         \{ 4,4,4,4,4,4,6,6,8,10,12,16,20,24,30,38,46,56,68,84,102,26,0 \}}
\DoxyCodeLine{1029     \};}
\DoxyCodeLine{1030     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_scf\_short[8][40] = \{}
\DoxyCodeLine{1031         \{ 4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18,0 \},}
\DoxyCodeLine{1032         \{ 8,8,8,8,8,8,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26,0 \},}
\DoxyCodeLine{1033         \{ 4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18,0 \},}
\DoxyCodeLine{1034         \{ 4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12,0 \},}
\DoxyCodeLine{1035         \{ 4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18,0 \},}
\DoxyCodeLine{1036         \{ 4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56,0 \},}
\DoxyCodeLine{1037         \{ 4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66,0 \},}
\DoxyCodeLine{1038         \{ 4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12,0 \}}
\DoxyCodeLine{1039     \};}
\DoxyCodeLine{1040     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_scf\_mixed[8][40] = \{}
\DoxyCodeLine{1041         \{ 6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18,0 \},}
\DoxyCodeLine{1042         \{ 12,12,12,4,4,4,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26,0 \},}
\DoxyCodeLine{1043         \{ 6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18,0 \},}
\DoxyCodeLine{1044         \{ 6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12,0 \},}
\DoxyCodeLine{1045         \{ 6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18,0 \},}
\DoxyCodeLine{1046         \{ 4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56,0 \},}
\DoxyCodeLine{1047         \{ 4,4,4,4,4,4,6,6,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66,0 \},}
\DoxyCodeLine{1048         \{ 4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12,0 \}}
\DoxyCodeLine{1049     \};}
\DoxyCodeLine{1050 }
\DoxyCodeLine{1051     \textcolor{keywordtype}{unsigned} tables, scfsi = 0;}
\DoxyCodeLine{1052     \textcolor{keywordtype}{int} main\_data\_begin, part\_23\_sum = 0;}
\DoxyCodeLine{1053     \textcolor{keywordtype}{int} gr\_count = DRMP3\_HDR\_IS\_MONO(hdr) ? 1 : 2;}
\DoxyCodeLine{1054     \textcolor{keywordtype}{int} sr\_idx = DRMP3\_HDR\_GET\_MY\_SAMPLE\_RATE(hdr); sr\_idx -\/= (sr\_idx != 0);}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056     \textcolor{keywordflow}{if} (DRMP3\_HDR\_TEST\_MPEG1(hdr))}
\DoxyCodeLine{1057     \{}
\DoxyCodeLine{1058         gr\_count *= 2;}
\DoxyCodeLine{1059         main\_data\_begin = drmp3\_bs\_get\_bits(bs, 9);}
\DoxyCodeLine{1060         scfsi = drmp3\_bs\_get\_bits(bs, 7 + gr\_count);}
\DoxyCodeLine{1061     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1062     \{}
\DoxyCodeLine{1063         main\_data\_begin = drmp3\_bs\_get\_bits(bs, 8 + gr\_count) >> gr\_count;}
\DoxyCodeLine{1064     \}}
\DoxyCodeLine{1065 }
\DoxyCodeLine{1066     \textcolor{keywordflow}{do}}
\DoxyCodeLine{1067     \{}
\DoxyCodeLine{1068         \textcolor{keywordflow}{if} (DRMP3\_HDR\_IS\_MONO(hdr))}
\DoxyCodeLine{1069         \{}
\DoxyCodeLine{1070             scfsi <<= 4;}
\DoxyCodeLine{1071         \}}
\DoxyCodeLine{1072         gr-\/>part\_23\_length = (drmp3\_uint16)drmp3\_bs\_get\_bits(bs, 12);}
\DoxyCodeLine{1073         part\_23\_sum += gr-\/>part\_23\_length;}
\DoxyCodeLine{1074         gr-\/>big\_values = (drmp3\_uint16)drmp3\_bs\_get\_bits(bs,  9);}
\DoxyCodeLine{1075         \textcolor{keywordflow}{if} (gr-\/>big\_values > 288)}
\DoxyCodeLine{1076         \{}
\DoxyCodeLine{1077             \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{1078         \}}
\DoxyCodeLine{1079         gr-\/>global\_gain = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 8);}
\DoxyCodeLine{1080         gr-\/>scalefac\_compress = (drmp3\_uint16)drmp3\_bs\_get\_bits(bs, DRMP3\_HDR\_TEST\_MPEG1(hdr) ? 4 : 9);}
\DoxyCodeLine{1081         gr-\/>sfbtab = g\_scf\_long[sr\_idx];}
\DoxyCodeLine{1082         gr-\/>n\_long\_sfb  = 22;}
\DoxyCodeLine{1083         gr-\/>n\_short\_sfb = 0;}
\DoxyCodeLine{1084         \textcolor{keywordflow}{if} (drmp3\_bs\_get\_bits(bs, 1))}
\DoxyCodeLine{1085         \{}
\DoxyCodeLine{1086             gr-\/>block\_type = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 2);}
\DoxyCodeLine{1087             \textcolor{keywordflow}{if} (!gr-\/>block\_type)}
\DoxyCodeLine{1088             \{}
\DoxyCodeLine{1089                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{1090             \}}
\DoxyCodeLine{1091             gr-\/>mixed\_block\_flag = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 1);}
\DoxyCodeLine{1092             gr-\/>region\_count[0] = 7;}
\DoxyCodeLine{1093             gr-\/>region\_count[1] = 255;}
\DoxyCodeLine{1094             \textcolor{keywordflow}{if} (gr-\/>block\_type == DRMP3\_SHORT\_BLOCK\_TYPE)}
\DoxyCodeLine{1095             \{}
\DoxyCodeLine{1096                 scfsi \&= 0x0F0F;}
\DoxyCodeLine{1097                 \textcolor{keywordflow}{if} (!gr-\/>mixed\_block\_flag)}
\DoxyCodeLine{1098                 \{}
\DoxyCodeLine{1099                     gr-\/>region\_count[0] = 8;}
\DoxyCodeLine{1100                     gr-\/>sfbtab = g\_scf\_short[sr\_idx];}
\DoxyCodeLine{1101                     gr-\/>n\_long\_sfb = 0;}
\DoxyCodeLine{1102                     gr-\/>n\_short\_sfb = 39;}
\DoxyCodeLine{1103                 \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1104                 \{}
\DoxyCodeLine{1105                     gr-\/>sfbtab = g\_scf\_mixed[sr\_idx];}
\DoxyCodeLine{1106                     gr-\/>n\_long\_sfb = DRMP3\_HDR\_TEST\_MPEG1(hdr) ? 8 : 6;}
\DoxyCodeLine{1107                     gr-\/>n\_short\_sfb = 30;}
\DoxyCodeLine{1108                 \}}
\DoxyCodeLine{1109             \}}
\DoxyCodeLine{1110             tables = drmp3\_bs\_get\_bits(bs, 10);}
\DoxyCodeLine{1111             tables <<= 5;}
\DoxyCodeLine{1112             gr-\/>subblock\_gain[0] = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 3);}
\DoxyCodeLine{1113             gr-\/>subblock\_gain[1] = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 3);}
\DoxyCodeLine{1114             gr-\/>subblock\_gain[2] = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 3);}
\DoxyCodeLine{1115         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1116         \{}
\DoxyCodeLine{1117             gr-\/>block\_type = 0;}
\DoxyCodeLine{1118             gr-\/>mixed\_block\_flag = 0;}
\DoxyCodeLine{1119             tables = drmp3\_bs\_get\_bits(bs, 15);}
\DoxyCodeLine{1120             gr-\/>region\_count[0] = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 4);}
\DoxyCodeLine{1121             gr-\/>region\_count[1] = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 3);}
\DoxyCodeLine{1122             gr-\/>region\_count[2] = 255;}
\DoxyCodeLine{1123         \}}
\DoxyCodeLine{1124         gr-\/>table\_select[0] = (drmp3\_uint8)(tables >> 10);}
\DoxyCodeLine{1125         gr-\/>table\_select[1] = (drmp3\_uint8)((tables >> 5) \& 31);}
\DoxyCodeLine{1126         gr-\/>table\_select[2] = (drmp3\_uint8)((tables) \& 31);}
\DoxyCodeLine{1127         gr-\/>preflag = (drmp3\_uint8)(DRMP3\_HDR\_TEST\_MPEG1(hdr) ? drmp3\_bs\_get\_bits(bs, 1) : (gr-\/>scalefac\_compress >= 500));}
\DoxyCodeLine{1128         gr-\/>scalefac\_scale = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 1);}
\DoxyCodeLine{1129         gr-\/>count1\_table = (drmp3\_uint8)drmp3\_bs\_get\_bits(bs, 1);}
\DoxyCodeLine{1130         gr-\/>scfsi = (drmp3\_uint8)((scfsi >> 12) \& 15);}
\DoxyCodeLine{1131         scfsi <<= 4;}
\DoxyCodeLine{1132         gr++;}
\DoxyCodeLine{1133     \} \textcolor{keywordflow}{while}(-\/-\/gr\_count);}
\DoxyCodeLine{1134 }
\DoxyCodeLine{1135     \textcolor{keywordflow}{if} (part\_23\_sum + bs-\/>pos > bs-\/>limit + main\_data\_begin*8)}
\DoxyCodeLine{1136     \{}
\DoxyCodeLine{1137         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{1138     \}}
\DoxyCodeLine{1139 }
\DoxyCodeLine{1140     \textcolor{keywordflow}{return} main\_data\_begin;}
\DoxyCodeLine{1141 \}}
\DoxyCodeLine{1142 }
\DoxyCodeLine{1143 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_read\_scalefactors(drmp3\_uint8 *scf, drmp3\_uint8 *ist\_pos, \textcolor{keyword}{const} drmp3\_uint8 *scf\_size, \textcolor{keyword}{const} drmp3\_uint8 *scf\_count, drmp3\_bs *bitbuf, \textcolor{keywordtype}{int} scfsi)}
\DoxyCodeLine{1144 \{}
\DoxyCodeLine{1145     \textcolor{keywordtype}{int} i, k;}
\DoxyCodeLine{1146     \textcolor{keywordflow}{for} (i = 0; i < 4 \&\& scf\_count[i]; i++, scfsi *= 2)}
\DoxyCodeLine{1147     \{}
\DoxyCodeLine{1148         \textcolor{keywordtype}{int} cnt = scf\_count[i];}
\DoxyCodeLine{1149         \textcolor{keywordflow}{if} (scfsi \& 8)}
\DoxyCodeLine{1150         \{}
\DoxyCodeLine{1151             DRMP3\_COPY\_MEMORY(scf, ist\_pos, cnt);}
\DoxyCodeLine{1152         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1153         \{}
\DoxyCodeLine{1154             \textcolor{keywordtype}{int} bits = scf\_size[i];}
\DoxyCodeLine{1155             \textcolor{keywordflow}{if} (!bits)}
\DoxyCodeLine{1156             \{}
\DoxyCodeLine{1157                 DRMP3\_ZERO\_MEMORY(scf, cnt);}
\DoxyCodeLine{1158                 DRMP3\_ZERO\_MEMORY(ist\_pos, cnt);}
\DoxyCodeLine{1159             \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1160             \{}
\DoxyCodeLine{1161                 \textcolor{keywordtype}{int} max\_scf = (scfsi < 0) ? (1 << bits) -\/ 1 : -\/1;}
\DoxyCodeLine{1162                 \textcolor{keywordflow}{for} (k = 0; k < cnt; k++)}
\DoxyCodeLine{1163                 \{}
\DoxyCodeLine{1164                     \textcolor{keywordtype}{int} s = drmp3\_bs\_get\_bits(bitbuf, bits);}
\DoxyCodeLine{1165                     ist\_pos[k] = (drmp3\_uint8)(s == max\_scf ? -\/1 : s);}
\DoxyCodeLine{1166                     scf[k] = (drmp3\_uint8)s;}
\DoxyCodeLine{1167                 \}}
\DoxyCodeLine{1168             \}}
\DoxyCodeLine{1169         \}}
\DoxyCodeLine{1170         ist\_pos += cnt;}
\DoxyCodeLine{1171         scf += cnt;}
\DoxyCodeLine{1172     \}}
\DoxyCodeLine{1173     scf[0] = scf[1] = scf[2] = 0;}
\DoxyCodeLine{1174 \}}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176 \textcolor{keyword}{static} \textcolor{keywordtype}{float} drmp3\_L3\_ldexp\_q2(\textcolor{keywordtype}{float} y, \textcolor{keywordtype}{int} exp\_q2)}
\DoxyCodeLine{1177 \{}
\DoxyCodeLine{1178     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_expfrac[4] = \{ 9.31322575e-\/10f,7.83145814e-\/10f,6.58544508e-\/10f,5.53767716e-\/10f \};}
\DoxyCodeLine{1179     \textcolor{keywordtype}{int} e;}
\DoxyCodeLine{1180     \textcolor{keywordflow}{do}}
\DoxyCodeLine{1181     \{}
\DoxyCodeLine{1182         e = DRMP3\_MIN(30*4, exp\_q2);}
\DoxyCodeLine{1183         y *= g\_expfrac[e \& 3]*(1 << 30 >> (e >> 2));}
\DoxyCodeLine{1184     \} \textcolor{keywordflow}{while} ((exp\_q2 -\/= e) > 0);}
\DoxyCodeLine{1185     \textcolor{keywordflow}{return} y;}
\DoxyCodeLine{1186 \}}
\DoxyCodeLine{1187 }
\DoxyCodeLine{1188 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_decode\_scalefactors(\textcolor{keyword}{const} drmp3\_uint8 *hdr, drmp3\_uint8 *ist\_pos, drmp3\_bs *bs, \textcolor{keyword}{const} drmp3\_L3\_gr\_info *gr, \textcolor{keywordtype}{float} *scf, \textcolor{keywordtype}{int} ch)}
\DoxyCodeLine{1189 \{}
\DoxyCodeLine{1190     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_scf\_partitions[3][28] = \{}
\DoxyCodeLine{1191         \{ 6,5,5, 5,6,5,5,5,6,5, 7,3,11,10,0,0, 7, 7, 7,0, 6, 6,6,3, 8, 8,5,0 \},}
\DoxyCodeLine{1192         \{ 8,9,6,12,6,9,9,9,6,9,12,6,15,18,0,0, 6,15,12,0, 6,12,9,6, 6,18,9,0 \},}
\DoxyCodeLine{1193         \{ 9,9,6,12,9,9,9,9,9,9,12,6,18,18,0,0,12,12,12,0,12, 9,9,6,15,12,9,0 \}}
\DoxyCodeLine{1194     \};}
\DoxyCodeLine{1195     \textcolor{keyword}{const} drmp3\_uint8 *scf\_partition = g\_scf\_partitions[!!gr-\/>n\_short\_sfb + !gr-\/>n\_long\_sfb];}
\DoxyCodeLine{1196     drmp3\_uint8 scf\_size[4], iscf[40];}
\DoxyCodeLine{1197     \textcolor{keywordtype}{int} i, scf\_shift = gr-\/>scalefac\_scale + 1, gain\_exp, scfsi = gr-\/>scfsi;}
\DoxyCodeLine{1198     \textcolor{keywordtype}{float} gain;}
\DoxyCodeLine{1199 }
\DoxyCodeLine{1200     \textcolor{keywordflow}{if} (DRMP3\_HDR\_TEST\_MPEG1(hdr))}
\DoxyCodeLine{1201     \{}
\DoxyCodeLine{1202         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_scfc\_decode[16] = \{ 0,1,2,3, 12,5,6,7, 9,10,11,13, 14,15,18,19 \};}
\DoxyCodeLine{1203         \textcolor{keywordtype}{int} part = g\_scfc\_decode[gr-\/>scalefac\_compress];}
\DoxyCodeLine{1204         scf\_size[1] = scf\_size[0] = (drmp3\_uint8)(part >> 2);}
\DoxyCodeLine{1205         scf\_size[3] = scf\_size[2] = (drmp3\_uint8)(part \& 3);}
\DoxyCodeLine{1206     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1207     \{}
\DoxyCodeLine{1208         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_mod[6*4] = \{ 5,5,4,4,5,5,4,1,4,3,1,1,5,6,6,1,4,4,4,1,4,3,1,1 \};}
\DoxyCodeLine{1209         \textcolor{keywordtype}{int} k, modprod, sfc, ist = DRMP3\_HDR\_TEST\_I\_STEREO(hdr) \&\& ch;}
\DoxyCodeLine{1210         sfc = gr-\/>scalefac\_compress >> ist;}
\DoxyCodeLine{1211         \textcolor{keywordflow}{for} (k = ist*3*4; sfc >= 0; sfc -\/= modprod, k += 4)}
\DoxyCodeLine{1212         \{}
\DoxyCodeLine{1213             \textcolor{keywordflow}{for} (modprod = 1, i = 3; i >= 0; i-\/-\/)}
\DoxyCodeLine{1214             \{}
\DoxyCodeLine{1215                 scf\_size[i] = (drmp3\_uint8)(sfc / modprod \% g\_mod[k + i]);}
\DoxyCodeLine{1216                 modprod *= g\_mod[k + i];}
\DoxyCodeLine{1217             \}}
\DoxyCodeLine{1218         \}}
\DoxyCodeLine{1219         scf\_partition += k;}
\DoxyCodeLine{1220         scfsi = -\/16;}
\DoxyCodeLine{1221     \}}
\DoxyCodeLine{1222     drmp3\_L3\_read\_scalefactors(iscf, ist\_pos, scf\_size, scf\_partition, bs, scfsi);}
\DoxyCodeLine{1223 }
\DoxyCodeLine{1224     \textcolor{keywordflow}{if} (gr-\/>n\_short\_sfb)}
\DoxyCodeLine{1225     \{}
\DoxyCodeLine{1226         \textcolor{keywordtype}{int} sh = 3 -\/ scf\_shift;}
\DoxyCodeLine{1227         \textcolor{keywordflow}{for} (i = 0; i < gr-\/>n\_short\_sfb; i += 3)}
\DoxyCodeLine{1228         \{}
\DoxyCodeLine{1229             iscf[gr-\/>n\_long\_sfb + i + 0] = (drmp3\_uint8)(iscf[gr-\/>n\_long\_sfb + i + 0] + (gr-\/>subblock\_gain[0] << sh));}
\DoxyCodeLine{1230             iscf[gr-\/>n\_long\_sfb + i + 1] = (drmp3\_uint8)(iscf[gr-\/>n\_long\_sfb + i + 1] + (gr-\/>subblock\_gain[1] << sh));}
\DoxyCodeLine{1231             iscf[gr-\/>n\_long\_sfb + i + 2] = (drmp3\_uint8)(iscf[gr-\/>n\_long\_sfb + i + 2] + (gr-\/>subblock\_gain[2] << sh));}
\DoxyCodeLine{1232         \}}
\DoxyCodeLine{1233     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (gr-\/>preflag)}
\DoxyCodeLine{1234     \{}
\DoxyCodeLine{1235         \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_preamp[10] = \{ 1,1,1,1,2,2,3,3,3,2 \};}
\DoxyCodeLine{1236         \textcolor{keywordflow}{for} (i = 0; i < 10; i++)}
\DoxyCodeLine{1237         \{}
\DoxyCodeLine{1238             iscf[11 + i] = (drmp3\_uint8)(iscf[11 + i] + g\_preamp[i]);}
\DoxyCodeLine{1239         \}}
\DoxyCodeLine{1240     \}}
\DoxyCodeLine{1241 }
\DoxyCodeLine{1242     gain\_exp = gr-\/>global\_gain + DRMP3\_BITS\_DEQUANTIZER\_OUT*4 -\/ 210 -\/ (DRMP3\_HDR\_IS\_MS\_STEREO(hdr) ? 2 : 0);}
\DoxyCodeLine{1243     gain = drmp3\_L3\_ldexp\_q2(1 << (DRMP3\_MAX\_SCFI/4),  DRMP3\_MAX\_SCFI -\/ gain\_exp);}
\DoxyCodeLine{1244     \textcolor{keywordflow}{for} (i = 0; i < (int)(gr-\/>n\_long\_sfb + gr-\/>n\_short\_sfb); i++)}
\DoxyCodeLine{1245     \{}
\DoxyCodeLine{1246         scf[i] = drmp3\_L3\_ldexp\_q2(gain, iscf[i] << scf\_shift);}
\DoxyCodeLine{1247     \}}
\DoxyCodeLine{1248 \}}
\DoxyCodeLine{1249 }
\DoxyCodeLine{1250 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_drmp3\_pow43[129 + 16] = \{}
\DoxyCodeLine{1251     0,-\/1,-\/2.519842f,-\/4.326749f,-\/6.349604f,-\/8.549880f,-\/10.902724f,-\/13.390518f,-\/16.000000f,-\/18.720754f,-\/21.544347f,-\/24.463781f,-\/27.473142f,-\/30.567351f,-\/33.741992f,-\/36.993181f,}
\DoxyCodeLine{1252     0,1,2.519842f,4.326749f,6.349604f,8.549880f,10.902724f,13.390518f,16.000000f,18.720754f,21.544347f,24.463781f,27.473142f,30.567351f,33.741992f,36.993181f,40.317474f,43.711787f,47.173345f,50.699631f,54.288352f,57.937408f,61.644865f,65.408941f,69.227979f,73.100443f,77.024898f,81.000000f,85.024491f,89.097188f,93.216975f,97.382800f,101.593667f,105.848633f,110.146801f,114.487321f,118.869381f,123.292209f,127.755065f,132.257246f,136.798076f,141.376907f,145.993119f,150.646117f,155.335327f,160.060199f,164.820202f,169.614826f,174.443577f,179.305980f,184.201575f,189.129918f,194.090580f,199.083145f,204.107210f,209.162385f,214.248292f,219.364564f,224.510845f,229.686789f,234.892058f,240.126328f,245.389280f,250.680604f,256.000000f,261.347174f,266.721841f,272.123723f,277.552547f,283.008049f,288.489971f,293.998060f,299.532071f,305.091761f,310.676898f,316.287249f,321.922592f,327.582707f,333.267377f,338.976394f,344.709550f,350.466646f,356.247482f,362.051866f,367.879608f,373.730522f,379.604427f,385.501143f,391.420496f,397.362314f,403.326427f,409.312672f,415.320884f,421.350905f,427.402579f,433.475750f,439.570269f,445.685987f,451.822757f,457.980436f,464.158883f,470.357960f,476.577530f,482.817459f,489.077615f,495.357868f,501.658090f,507.978156f,514.317941f,520.677324f,527.056184f,533.454404f,539.871867f,546.308458f,552.764065f,559.238575f,565.731879f,572.243870f,578.774440f,585.323483f,591.890898f,598.476581f,605.080431f,611.702349f,618.342238f,625.000000f,631.675540f,638.368763f,645.079578f}
\DoxyCodeLine{1253 \};}
\DoxyCodeLine{1254 }
\DoxyCodeLine{1255 \textcolor{keyword}{static} \textcolor{keywordtype}{float} drmp3\_L3\_pow\_43(\textcolor{keywordtype}{int} x)}
\DoxyCodeLine{1256 \{}
\DoxyCodeLine{1257     \textcolor{keywordtype}{float} frac;}
\DoxyCodeLine{1258     \textcolor{keywordtype}{int} sign, mult = 256;}
\DoxyCodeLine{1259 }
\DoxyCodeLine{1260     \textcolor{keywordflow}{if} (x < 129)}
\DoxyCodeLine{1261     \{}
\DoxyCodeLine{1262         \textcolor{keywordflow}{return} g\_drmp3\_pow43[16 + x];}
\DoxyCodeLine{1263     \}}
\DoxyCodeLine{1264 }
\DoxyCodeLine{1265     \textcolor{keywordflow}{if} (x < 1024)}
\DoxyCodeLine{1266     \{}
\DoxyCodeLine{1267         mult = 16;}
\DoxyCodeLine{1268         x <<= 3;}
\DoxyCodeLine{1269     \}}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271     sign = 2*x \& 64;}
\DoxyCodeLine{1272     frac = (float)((x \& 63) -\/ sign) / ((x \& \string~63) + sign);}
\DoxyCodeLine{1273     \textcolor{keywordflow}{return} g\_drmp3\_pow43[16 + ((x + sign) >> 6)]*(1.f + frac*((4.f/3) + frac*(2.f/9)))*mult;}
\DoxyCodeLine{1274 \}}
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_huffman(\textcolor{keywordtype}{float} *dst, drmp3\_bs *bs, \textcolor{keyword}{const} drmp3\_L3\_gr\_info *gr\_info, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *scf, \textcolor{keywordtype}{int} layer3gr\_limit)}
\DoxyCodeLine{1277 \{}
\DoxyCodeLine{1278     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_int16 tabs[] = \{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,}
\DoxyCodeLine{1279         785,785,785,785,784,784,784,784,513,513,513,513,513,513,513,513,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,}
\DoxyCodeLine{1280         -\/255,1313,1298,1282,785,785,785,785,784,784,784,784,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,290,288,}
\DoxyCodeLine{1281         -\/255,1313,1298,1282,769,769,769,769,529,529,529,529,529,529,529,529,528,528,528,528,528,528,528,528,512,512,512,512,512,512,512,512,290,288,}
\DoxyCodeLine{1282         -\/253,-\/318,-\/351,-\/367,785,785,785,785,784,784,784,784,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,819,818,547,547,275,275,275,275,561,560,515,546,289,274,288,258,}
\DoxyCodeLine{1283         -\/254,-\/287,1329,1299,1314,1312,1057,1057,1042,1042,1026,1026,784,784,784,784,529,529,529,529,529,529,529,529,769,769,769,769,768,768,768,768,563,560,306,306,291,259,}
\DoxyCodeLine{1284         -\/252,-\/413,-\/477,-\/542,1298,-\/575,1041,1041,784,784,784,784,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,-\/383,-\/399,1107,1092,1106,1061,849,849,789,789,1104,1091,773,773,1076,1075,341,340,325,309,834,804,577,577,532,532,516,516,832,818,803,816,561,561,531,531,515,546,289,289,288,258,}
\DoxyCodeLine{1285         -\/252,-\/429,-\/493,-\/559,1057,1057,1042,1042,529,529,529,529,529,529,529,529,784,784,784,784,769,769,769,769,512,512,512,512,512,512,512,512,-\/382,1077,-\/415,1106,1061,1104,849,849,789,789,1091,1076,1029,1075,834,834,597,581,340,340,339,324,804,833,532,532,832,772,818,803,817,787,816,771,290,290,290,290,288,258,}
\DoxyCodeLine{1286         -\/253,-\/349,-\/414,-\/447,-\/463,1329,1299,-\/479,1314,1312,1057,1057,1042,1042,1026,1026,785,785,785,785,784,784,784,784,769,769,769,769,768,768,768,768,-\/319,851,821,-\/335,836,850,805,849,341,340,325,336,533,533,579,579,564,564,773,832,578,548,563,516,321,276,306,291,304,259,}
\DoxyCodeLine{1287         -\/251,-\/572,-\/733,-\/830,-\/863,-\/879,1041,1041,784,784,784,784,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,-\/511,-\/527,-\/543,1396,1351,1381,1366,1395,1335,1380,-\/559,1334,1138,1138,1063,1063,1350,1392,1031,1031,1062,1062,1364,1363,1120,1120,1333,1348,881,881,881,881,375,374,359,373,343,358,341,325,791,791,1123,1122,-\/703,1105,1045,-\/719,865,865,790,790,774,774,1104,1029,338,293,323,308,-\/799,-\/815,833,788,772,818,803,816,322,292,307,320,561,531,515,546,289,274,288,258,}
\DoxyCodeLine{1288         -\/251,-\/525,-\/605,-\/685,-\/765,-\/831,-\/846,1298,1057,1057,1312,1282,785,785,785,785,784,784,784,784,769,769,769,769,512,512,512,512,512,512,512,512,1399,1398,1383,1367,1382,1396,1351,-\/511,1381,1366,1139,1139,1079,1079,1124,1124,1364,1349,1363,1333,882,882,882,882,807,807,807,807,1094,1094,1136,1136,373,341,535,535,881,775,867,822,774,-\/591,324,338,-\/671,849,550,550,866,864,609,609,293,336,534,534,789,835,773,-\/751,834,804,308,307,833,788,832,772,562,562,547,547,305,275,560,515,290,290,}
\DoxyCodeLine{1289         -\/252,-\/397,-\/477,-\/557,-\/622,-\/653,-\/719,-\/735,-\/750,1329,1299,1314,1057,1057,1042,1042,1312,1282,1024,1024,785,785,785,785,784,784,784,784,769,769,769,769,-\/383,1127,1141,1111,1126,1140,1095,1110,869,869,883,883,1079,1109,882,882,375,374,807,868,838,881,791,-\/463,867,822,368,263,852,837,836,-\/543,610,610,550,550,352,336,534,534,865,774,851,821,850,805,593,533,579,564,773,832,578,578,548,548,577,577,307,276,306,291,516,560,259,259,}
\DoxyCodeLine{1290         -\/250,-\/2107,-\/2507,-\/2764,-\/2909,-\/2974,-\/3007,-\/3023,1041,1041,1040,1040,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,-\/767,-\/1052,-\/1213,-\/1277,-\/1358,-\/1405,-\/1469,-\/1535,-\/1550,-\/1582,-\/1614,-\/1647,-\/1662,-\/1694,-\/1726,-\/1759,-\/1774,-\/1807,-\/1822,-\/1854,-\/1886,1565,-\/1919,-\/1935,-\/1951,-\/1967,1731,1730,1580,1717,-\/1983,1729,1564,-\/1999,1548,-\/2015,-\/2031,1715,1595,-\/2047,1714,-\/2063,1610,-\/2079,1609,-\/2095,1323,1323,1457,1457,1307,1307,1712,1547,1641,1700,1699,1594,1685,1625,1442,1442,1322,1322,-\/780,-\/973,-\/910,1279,1278,1277,1262,1276,1261,1275,1215,1260,1229,-\/959,974,974,989,989,-\/943,735,478,478,495,463,506,414,-\/1039,1003,958,1017,927,942,987,957,431,476,1272,1167,1228,-\/1183,1256,-\/1199,895,895,941,941,1242,1227,1212,1135,1014,1014,490,489,503,487,910,1013,985,925,863,894,970,955,1012,847,-\/1343,831,755,755,984,909,428,366,754,559,-\/1391,752,486,457,924,997,698,698,983,893,740,740,908,877,739,739,667,667,953,938,497,287,271,271,683,606,590,712,726,574,302,302,738,736,481,286,526,725,605,711,636,724,696,651,589,681,666,710,364,467,573,695,466,466,301,465,379,379,709,604,665,679,316,316,634,633,436,436,464,269,424,394,452,332,438,363,347,408,393,448,331,422,362,407,392,421,346,406,391,376,375,359,1441,1306,-\/2367,1290,-\/2383,1337,-\/2399,-\/2415,1426,1321,-\/2431,1411,1336,-\/2447,-\/2463,-\/2479,1169,1169,1049,1049,1424,1289,1412,1352,1319,-\/2495,1154,1154,1064,1064,1153,1153,416,390,360,404,403,389,344,374,373,343,358,372,327,357,342,311,356,326,1395,1394,1137,1137,1047,1047,1365,1392,1287,1379,1334,1364,1349,1378,1318,1363,792,792,792,792,1152,1152,1032,1032,1121,1121,1046,1046,1120,1120,1030,1030,-\/2895,1106,1061,1104,849,849,789,789,1091,1076,1029,1090,1060,1075,833,833,309,324,532,532,832,772,818,803,561,561,531,560,515,546,289,274,288,258,}
\DoxyCodeLine{1291         -\/250,-\/1179,-\/1579,-\/1836,-\/1996,-\/2124,-\/2253,-\/2333,-\/2413,-\/2477,-\/2542,-\/2574,-\/2607,-\/2622,-\/2655,1314,1313,1298,1312,1282,785,785,785,785,1040,1040,1025,1025,768,768,768,768,-\/766,-\/798,-\/830,-\/862,-\/895,-\/911,-\/927,-\/943,-\/959,-\/975,-\/991,-\/1007,-\/1023,-\/1039,-\/1055,-\/1070,1724,1647,-\/1103,-\/1119,1631,1767,1662,1738,1708,1723,-\/1135,1780,1615,1779,1599,1677,1646,1778,1583,-\/1151,1777,1567,1737,1692,1765,1722,1707,1630,1751,1661,1764,1614,1736,1676,1763,1750,1645,1598,1721,1691,1762,1706,1582,1761,1566,-\/1167,1749,1629,767,766,751,765,494,494,735,764,719,749,734,763,447,447,748,718,477,506,431,491,446,476,461,505,415,430,475,445,504,399,460,489,414,503,383,474,429,459,502,502,746,752,488,398,501,473,413,472,486,271,480,270,-\/1439,-\/1455,1357,-\/1471,-\/1487,-\/1503,1341,1325,-\/1519,1489,1463,1403,1309,-\/1535,1372,1448,1418,1476,1356,1462,1387,-\/1551,1475,1340,1447,1402,1386,-\/1567,1068,1068,1474,1461,455,380,468,440,395,425,410,454,364,467,466,464,453,269,409,448,268,432,1371,1473,1432,1417,1308,1460,1355,1446,1459,1431,1083,1083,1401,1416,1458,1445,1067,1067,1370,1457,1051,1051,1291,1430,1385,1444,1354,1415,1400,1443,1082,1082,1173,1113,1186,1066,1185,1050,-\/1967,1158,1128,1172,1097,1171,1081,-\/1983,1157,1112,416,266,375,400,1170,1142,1127,1065,793,793,1169,1033,1156,1096,1141,1111,1155,1080,1126,1140,898,898,808,808,897,897,792,792,1095,1152,1032,1125,1110,1139,1079,1124,882,807,838,881,853,791,-\/2319,867,368,263,822,852,837,866,806,865,-\/2399,851,352,262,534,534,821,836,594,594,549,549,593,593,533,533,848,773,579,579,564,578,548,563,276,276,577,576,306,291,516,560,305,305,275,259,}
\DoxyCodeLine{1292         -\/251,-\/892,-\/2058,-\/2620,-\/2828,-\/2957,-\/3023,-\/3039,1041,1041,1040,1040,769,769,769,769,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,-\/511,-\/527,-\/543,-\/559,1530,-\/575,-\/591,1528,1527,1407,1526,1391,1023,1023,1023,1023,1525,1375,1268,1268,1103,1103,1087,1087,1039,1039,1523,-\/604,815,815,815,815,510,495,509,479,508,463,507,447,431,505,415,399,-\/734,-\/782,1262,-\/815,1259,1244,-\/831,1258,1228,-\/847,-\/863,1196,-\/879,1253,987,987,748,-\/767,493,493,462,477,414,414,686,669,478,446,461,445,474,429,487,458,412,471,1266,1264,1009,1009,799,799,-\/1019,-\/1276,-\/1452,-\/1581,-\/1677,-\/1757,-\/1821,-\/1886,-\/1933,-\/1997,1257,1257,1483,1468,1512,1422,1497,1406,1467,1496,1421,1510,1134,1134,1225,1225,1466,1451,1374,1405,1252,1252,1358,1480,1164,1164,1251,1251,1238,1238,1389,1465,-\/1407,1054,1101,-\/1423,1207,-\/1439,830,830,1248,1038,1237,1117,1223,1148,1236,1208,411,426,395,410,379,269,1193,1222,1132,1235,1221,1116,976,976,1192,1162,1177,1220,1131,1191,963,963,-\/1647,961,780,-\/1663,558,558,994,993,437,408,393,407,829,978,813,797,947,-\/1743,721,721,377,392,844,950,828,890,706,706,812,859,796,960,948,843,934,874,571,571,-\/1919,690,555,689,421,346,539,539,944,779,918,873,932,842,903,888,570,570,931,917,674,674,-\/2575,1562,-\/2591,1609,-\/2607,1654,1322,1322,1441,1441,1696,1546,1683,1593,1669,1624,1426,1426,1321,1321,1639,1680,1425,1425,1305,1305,1545,1668,1608,1623,1667,1592,1638,1666,1320,1320,1652,1607,1409,1409,1304,1304,1288,1288,1664,1637,1395,1395,1335,1335,1622,1636,1394,1394,1319,1319,1606,1621,1392,1392,1137,1137,1137,1137,345,390,360,375,404,373,1047,-\/2751,-\/2767,-\/2783,1062,1121,1046,-\/2799,1077,-\/2815,1106,1061,789,789,1105,1104,263,355,310,340,325,354,352,262,339,324,1091,1076,1029,1090,1060,1075,833,833,788,788,1088,1028,818,818,803,803,561,561,531,531,816,771,546,546,289,274,288,258,}
\DoxyCodeLine{1293         -\/253,-\/317,-\/381,-\/446,-\/478,-\/509,1279,1279,-\/811,-\/1179,-\/1451,-\/1756,-\/1900,-\/2028,-\/2189,-\/2253,-\/2333,-\/2414,-\/2445,-\/2511,-\/2526,1313,1298,-\/2559,1041,1041,1040,1040,1025,1025,1024,1024,1022,1007,1021,991,1020,975,1019,959,687,687,1018,1017,671,671,655,655,1016,1015,639,639,758,758,623,623,757,607,756,591,755,575,754,559,543,543,1009,783,-\/575,-\/621,-\/685,-\/749,496,-\/590,750,749,734,748,974,989,1003,958,988,973,1002,942,987,957,972,1001,926,986,941,971,956,1000,910,985,925,999,894,970,-\/1071,-\/1087,-\/1102,1390,-\/1135,1436,1509,1451,1374,-\/1151,1405,1358,1480,1420,-\/1167,1507,1494,1389,1342,1465,1435,1450,1326,1505,1310,1493,1373,1479,1404,1492,1464,1419,428,443,472,397,736,526,464,464,486,457,442,471,484,482,1357,1449,1434,1478,1388,1491,1341,1490,1325,1489,1463,1403,1309,1477,1372,1448,1418,1433,1476,1356,1462,1387,-\/1439,1475,1340,1447,1402,1474,1324,1461,1371,1473,269,448,1432,1417,1308,1460,-\/1711,1459,-\/1727,1441,1099,1099,1446,1386,1431,1401,-\/1743,1289,1083,1083,1160,1160,1458,1445,1067,1067,1370,1457,1307,1430,1129,1129,1098,1098,268,432,267,416,266,400,-\/1887,1144,1187,1082,1173,1113,1186,1066,1050,1158,1128,1143,1172,1097,1171,1081,420,391,1157,1112,1170,1142,1127,1065,1169,1049,1156,1096,1141,1111,1155,1080,1126,1154,1064,1153,1140,1095,1048,-\/2159,1125,1110,1137,-\/2175,823,823,1139,1138,807,807,384,264,368,263,868,838,853,791,867,822,852,837,866,806,865,790,-\/2319,851,821,836,352,262,850,805,849,-\/2399,533,533,835,820,336,261,578,548,563,577,532,532,832,772,562,562,547,547,305,275,560,515,290,290,288,258 \};}
\DoxyCodeLine{1294     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 tab32[] = \{ 130,162,193,209,44,28,76,140,9,9,9,9,9,9,9,9,190,254,222,238,126,94,157,157,109,61,173,205\};}
\DoxyCodeLine{1295     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 tab33[] = \{ 252,236,220,204,188,172,156,140,124,108,92,76,60,44,28,12 \};}
\DoxyCodeLine{1296     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_int16 tabindex[2*16] = \{ 0,32,64,98,0,132,180,218,292,364,426,538,648,746,0,1126,1460,1460,1460,1460,1460,1460,1460,1460,1842,1842,1842,1842,1842,1842,1842,1842 \};}
\DoxyCodeLine{1297     \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_uint8 g\_linbits[] =  \{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,6,8,10,13,4,5,6,7,8,9,11,13 \};}
\DoxyCodeLine{1298 }
\DoxyCodeLine{1299 \textcolor{preprocessor}{\#define DRMP3\_PEEK\_BITS(n)    (bs\_cache >> (32 -\/ n))}}
\DoxyCodeLine{1300 \textcolor{preprocessor}{\#define DRMP3\_FLUSH\_BITS(n)   \{ bs\_cache <<= (n); bs\_sh += (n); \}}}
\DoxyCodeLine{1301 \textcolor{preprocessor}{\#define DRMP3\_CHECK\_BITS      while (bs\_sh >= 0) \{ bs\_cache |= (drmp3\_uint32)*bs\_next\_ptr++ << bs\_sh; bs\_sh -\/= 8; \}}}
\DoxyCodeLine{1302 \textcolor{preprocessor}{\#define DRMP3\_BSPOS           ((bs\_next\_ptr -\/ bs-\/>buf)*8 -\/ 24 + bs\_sh)}}
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304     \textcolor{keywordtype}{float} one = 0.0f;}
\DoxyCodeLine{1305     \textcolor{keywordtype}{int} ireg = 0, big\_val\_cnt = gr\_info-\/>big\_values;}
\DoxyCodeLine{1306     \textcolor{keyword}{const} drmp3\_uint8 *sfb = gr\_info-\/>sfbtab;}
\DoxyCodeLine{1307     \textcolor{keyword}{const} drmp3\_uint8 *bs\_next\_ptr = bs-\/>buf + bs-\/>pos/8;}
\DoxyCodeLine{1308     drmp3\_uint32 bs\_cache = (((bs\_next\_ptr[0]*256u + bs\_next\_ptr[1])*256u + bs\_next\_ptr[2])*256u + bs\_next\_ptr[3]) << (bs-\/>pos \& 7);}
\DoxyCodeLine{1309     \textcolor{keywordtype}{int} pairs\_to\_decode, np, bs\_sh = (bs-\/>pos \& 7) -\/ 8;}
\DoxyCodeLine{1310     bs\_next\_ptr += 4;}
\DoxyCodeLine{1311 }
\DoxyCodeLine{1312     \textcolor{keywordflow}{while} (big\_val\_cnt > 0)}
\DoxyCodeLine{1313     \{}
\DoxyCodeLine{1314         \textcolor{keywordtype}{int} tab\_num = gr\_info-\/>table\_select[ireg];}
\DoxyCodeLine{1315         \textcolor{keywordtype}{int} sfb\_cnt = gr\_info-\/>region\_count[ireg++];}
\DoxyCodeLine{1316         \textcolor{keyword}{const} drmp3\_int16 *codebook = tabs + tabindex[tab\_num];}
\DoxyCodeLine{1317         \textcolor{keywordtype}{int} linbits = g\_linbits[tab\_num];}
\DoxyCodeLine{1318         \textcolor{keywordflow}{if} (linbits)}
\DoxyCodeLine{1319         \{}
\DoxyCodeLine{1320             \textcolor{keywordflow}{do}}
\DoxyCodeLine{1321             \{}
\DoxyCodeLine{1322                 np = *sfb++ / 2;}
\DoxyCodeLine{1323                 pairs\_to\_decode = DRMP3\_MIN(big\_val\_cnt, np);}
\DoxyCodeLine{1324                 one = *scf++;}
\DoxyCodeLine{1325                 \textcolor{keywordflow}{do}}
\DoxyCodeLine{1326                 \{}
\DoxyCodeLine{1327                     \textcolor{keywordtype}{int} j, w = 5;}
\DoxyCodeLine{1328                     \textcolor{keywordtype}{int} leaf = codebook[DRMP3\_PEEK\_BITS(w)];}
\DoxyCodeLine{1329                     \textcolor{keywordflow}{while} (leaf < 0)}
\DoxyCodeLine{1330                     \{}
\DoxyCodeLine{1331                         DRMP3\_FLUSH\_BITS(w);}
\DoxyCodeLine{1332                         w = leaf \& 7;}
\DoxyCodeLine{1333                         leaf = codebook[DRMP3\_PEEK\_BITS(w) -\/ (leaf >> 3)];}
\DoxyCodeLine{1334                     \}}
\DoxyCodeLine{1335                     DRMP3\_FLUSH\_BITS(leaf >> 8);}
\DoxyCodeLine{1336 }
\DoxyCodeLine{1337                     \textcolor{keywordflow}{for} (j = 0; j < 2; j++, dst++, leaf >>= 4)}
\DoxyCodeLine{1338                     \{}
\DoxyCodeLine{1339                         \textcolor{keywordtype}{int} lsb = leaf \& 0x0F;}
\DoxyCodeLine{1340                         \textcolor{keywordflow}{if} (lsb == 15)}
\DoxyCodeLine{1341                         \{}
\DoxyCodeLine{1342                             lsb += DRMP3\_PEEK\_BITS(linbits);}
\DoxyCodeLine{1343                             DRMP3\_FLUSH\_BITS(linbits);}
\DoxyCodeLine{1344                             DRMP3\_CHECK\_BITS;}
\DoxyCodeLine{1345                             *dst = one*drmp3\_L3\_pow\_43(lsb)*((drmp3\_int32)bs\_cache < 0 ? -\/1: 1);}
\DoxyCodeLine{1346                         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1347                         \{}
\DoxyCodeLine{1348                             *dst = g\_drmp3\_pow43[16 + lsb -\/ 16*(bs\_cache >> 31)]*one;}
\DoxyCodeLine{1349                         \}}
\DoxyCodeLine{1350                         DRMP3\_FLUSH\_BITS(lsb ? 1 : 0);}
\DoxyCodeLine{1351                     \}}
\DoxyCodeLine{1352                     DRMP3\_CHECK\_BITS;}
\DoxyCodeLine{1353                 \} \textcolor{keywordflow}{while} (-\/-\/pairs\_to\_decode);}
\DoxyCodeLine{1354             \} \textcolor{keywordflow}{while} ((big\_val\_cnt -\/= np) > 0 \&\& -\/-\/sfb\_cnt >= 0);}
\DoxyCodeLine{1355         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1356         \{}
\DoxyCodeLine{1357             \textcolor{keywordflow}{do}}
\DoxyCodeLine{1358             \{}
\DoxyCodeLine{1359                 np = *sfb++ / 2;}
\DoxyCodeLine{1360                 pairs\_to\_decode = DRMP3\_MIN(big\_val\_cnt, np);}
\DoxyCodeLine{1361                 one = *scf++;}
\DoxyCodeLine{1362                 \textcolor{keywordflow}{do}}
\DoxyCodeLine{1363                 \{}
\DoxyCodeLine{1364                     \textcolor{keywordtype}{int} j, w = 5;}
\DoxyCodeLine{1365                     \textcolor{keywordtype}{int} leaf = codebook[DRMP3\_PEEK\_BITS(w)];}
\DoxyCodeLine{1366                     \textcolor{keywordflow}{while} (leaf < 0)}
\DoxyCodeLine{1367                     \{}
\DoxyCodeLine{1368                         DRMP3\_FLUSH\_BITS(w);}
\DoxyCodeLine{1369                         w = leaf \& 7;}
\DoxyCodeLine{1370                         leaf = codebook[DRMP3\_PEEK\_BITS(w) -\/ (leaf >> 3)];}
\DoxyCodeLine{1371                     \}}
\DoxyCodeLine{1372                     DRMP3\_FLUSH\_BITS(leaf >> 8);}
\DoxyCodeLine{1373 }
\DoxyCodeLine{1374                     \textcolor{keywordflow}{for} (j = 0; j < 2; j++, dst++, leaf >>= 4)}
\DoxyCodeLine{1375                     \{}
\DoxyCodeLine{1376                         \textcolor{keywordtype}{int} lsb = leaf \& 0x0F;}
\DoxyCodeLine{1377                         *dst = g\_drmp3\_pow43[16 + lsb -\/ 16*(bs\_cache >> 31)]*one;}
\DoxyCodeLine{1378                         DRMP3\_FLUSH\_BITS(lsb ? 1 : 0);}
\DoxyCodeLine{1379                     \}}
\DoxyCodeLine{1380                     DRMP3\_CHECK\_BITS;}
\DoxyCodeLine{1381                 \} \textcolor{keywordflow}{while} (-\/-\/pairs\_to\_decode);}
\DoxyCodeLine{1382             \} \textcolor{keywordflow}{while} ((big\_val\_cnt -\/= np) > 0 \&\& -\/-\/sfb\_cnt >= 0);}
\DoxyCodeLine{1383         \}}
\DoxyCodeLine{1384     \}}
\DoxyCodeLine{1385 }
\DoxyCodeLine{1386     \textcolor{keywordflow}{for} (np = 1 -\/ big\_val\_cnt;; dst += 4)}
\DoxyCodeLine{1387     \{}
\DoxyCodeLine{1388         \textcolor{keyword}{const} drmp3\_uint8 *codebook\_count1 = (gr\_info-\/>count1\_table) ? tab33 : tab32;}
\DoxyCodeLine{1389         \textcolor{keywordtype}{int} leaf = codebook\_count1[DRMP3\_PEEK\_BITS(4)];}
\DoxyCodeLine{1390         \textcolor{keywordflow}{if} (!(leaf \& 8))}
\DoxyCodeLine{1391         \{}
\DoxyCodeLine{1392             leaf = codebook\_count1[(leaf >> 3) + (bs\_cache << 4 >> (32 -\/ (leaf \& 3)))];}
\DoxyCodeLine{1393         \}}
\DoxyCodeLine{1394         DRMP3\_FLUSH\_BITS(leaf \& 7);}
\DoxyCodeLine{1395         \textcolor{keywordflow}{if} (DRMP3\_BSPOS > layer3gr\_limit)}
\DoxyCodeLine{1396         \{}
\DoxyCodeLine{1397             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1398         \}}
\DoxyCodeLine{1399 \textcolor{preprocessor}{\#define DRMP3\_RELOAD\_SCALEFACTOR  if (!-\/-\/np) \{ np = *sfb++/2; if (!np) break; one = *scf++; \}}}
\DoxyCodeLine{1400 \textcolor{preprocessor}{\#define DRMP3\_DEQ\_COUNT1(s) if (leaf \& (128 >> s)) \{ dst[s] = ((drmp3\_int32)bs\_cache < 0) ? -\/one : one; DRMP3\_FLUSH\_BITS(1) \}}}
\DoxyCodeLine{1401         DRMP3\_RELOAD\_SCALEFACTOR;}
\DoxyCodeLine{1402         DRMP3\_DEQ\_COUNT1(0);}
\DoxyCodeLine{1403         DRMP3\_DEQ\_COUNT1(1);}
\DoxyCodeLine{1404         DRMP3\_RELOAD\_SCALEFACTOR;}
\DoxyCodeLine{1405         DRMP3\_DEQ\_COUNT1(2);}
\DoxyCodeLine{1406         DRMP3\_DEQ\_COUNT1(3);}
\DoxyCodeLine{1407         DRMP3\_CHECK\_BITS;}
\DoxyCodeLine{1408     \}}
\DoxyCodeLine{1409 }
\DoxyCodeLine{1410     bs-\/>pos = layer3gr\_limit;}
\DoxyCodeLine{1411 \}}
\DoxyCodeLine{1412 }
\DoxyCodeLine{1413 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_midside\_stereo(\textcolor{keywordtype}{float} *left, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1414 \{}
\DoxyCodeLine{1415     \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{1416     \textcolor{keywordtype}{float} *right = left + 576;}
\DoxyCodeLine{1417 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{1418     \textcolor{keywordflow}{if} (drmp3\_have\_simd())}
\DoxyCodeLine{1419     \{}
\DoxyCodeLine{1420         \textcolor{keywordflow}{for} (; i < n -\/ 3; i += 4)}
\DoxyCodeLine{1421         \{}
\DoxyCodeLine{1422             drmp3\_f4 vl = DRMP3\_VLD(left + i);}
\DoxyCodeLine{1423             drmp3\_f4 vr = DRMP3\_VLD(right + i);}
\DoxyCodeLine{1424             DRMP3\_VSTORE(left + i, DRMP3\_VADD(vl, vr));}
\DoxyCodeLine{1425             DRMP3\_VSTORE(right + i, DRMP3\_VSUB(vl, vr));}
\DoxyCodeLine{1426         \}}
\DoxyCodeLine{1427 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{1428         \textcolor{comment}{/* Workaround for spurious -\/Waggressive-\/loop-\/optimizations warning from gcc.}}
\DoxyCodeLine{1429 \textcolor{comment}{         * For more info see: https://github.com/lieff/minimp3/issues/88}}
\DoxyCodeLine{1430 \textcolor{comment}{         */}}
\DoxyCodeLine{1431         \textcolor{keywordflow}{if} (\_\_builtin\_constant\_p(n \% 4 == 0) \&\& n \% 4 == 0)}
\DoxyCodeLine{1432             \textcolor{keywordflow}{return};}
\DoxyCodeLine{1433 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1434     \}}
\DoxyCodeLine{1435 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1436     \textcolor{keywordflow}{for} (; i < n; i++)}
\DoxyCodeLine{1437     \{}
\DoxyCodeLine{1438         \textcolor{keywordtype}{float} a = left[i];}
\DoxyCodeLine{1439         \textcolor{keywordtype}{float} b = right[i];}
\DoxyCodeLine{1440         left[i] = a + b;}
\DoxyCodeLine{1441         right[i] = a -\/ b;}
\DoxyCodeLine{1442     \}}
\DoxyCodeLine{1443 \}}
\DoxyCodeLine{1444 }
\DoxyCodeLine{1445 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_intensity\_stereo\_band(\textcolor{keywordtype}{float} *left, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} kl, \textcolor{keywordtype}{float} kr)}
\DoxyCodeLine{1446 \{}
\DoxyCodeLine{1447     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1448     \textcolor{keywordflow}{for} (i = 0; i < n; i++)}
\DoxyCodeLine{1449     \{}
\DoxyCodeLine{1450         left[i + 576] = left[i]*kr;}
\DoxyCodeLine{1451         left[i] = left[i]*kl;}
\DoxyCodeLine{1452     \}}
\DoxyCodeLine{1453 \}}
\DoxyCodeLine{1454 }
\DoxyCodeLine{1455 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_stereo\_top\_band(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *right, \textcolor{keyword}{const} drmp3\_uint8 *sfb, \textcolor{keywordtype}{int} nbands, \textcolor{keywordtype}{int} max\_band[3])}
\DoxyCodeLine{1456 \{}
\DoxyCodeLine{1457     \textcolor{keywordtype}{int} i, k;}
\DoxyCodeLine{1458 }
\DoxyCodeLine{1459     max\_band[0] = max\_band[1] = max\_band[2] = -\/1;}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461     \textcolor{keywordflow}{for} (i = 0; i < nbands; i++)}
\DoxyCodeLine{1462     \{}
\DoxyCodeLine{1463         \textcolor{keywordflow}{for} (k = 0; k < sfb[i]; k += 2)}
\DoxyCodeLine{1464         \{}
\DoxyCodeLine{1465             \textcolor{keywordflow}{if} (right[k] != 0 || right[k + 1] != 0)}
\DoxyCodeLine{1466             \{}
\DoxyCodeLine{1467                 max\_band[i \% 3] = i;}
\DoxyCodeLine{1468                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1469             \}}
\DoxyCodeLine{1470         \}}
\DoxyCodeLine{1471         right += sfb[i];}
\DoxyCodeLine{1472     \}}
\DoxyCodeLine{1473 \}}
\DoxyCodeLine{1474 }
\DoxyCodeLine{1475 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_stereo\_process(\textcolor{keywordtype}{float} *left, \textcolor{keyword}{const} drmp3\_uint8 *ist\_pos, \textcolor{keyword}{const} drmp3\_uint8 *sfb, \textcolor{keyword}{const} drmp3\_uint8 *hdr, \textcolor{keywordtype}{int} max\_band[3], \textcolor{keywordtype}{int} mpeg2\_sh)}
\DoxyCodeLine{1476 \{}
\DoxyCodeLine{1477     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_pan[7*2] = \{ 0,1,0.21132487f,0.78867513f,0.36602540f,0.63397460f,0.5f,0.5f,0.63397460f,0.36602540f,0.78867513f,0.21132487f,1,0 \};}
\DoxyCodeLine{1478     \textcolor{keywordtype}{unsigned} i, max\_pos = DRMP3\_HDR\_TEST\_MPEG1(hdr) ? 7 : 64;}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480     \textcolor{keywordflow}{for} (i = 0; sfb[i]; i++)}
\DoxyCodeLine{1481     \{}
\DoxyCodeLine{1482         \textcolor{keywordtype}{unsigned} ipos = ist\_pos[i];}
\DoxyCodeLine{1483         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int})i > max\_band[i \% 3] \&\& ipos < max\_pos)}
\DoxyCodeLine{1484         \{}
\DoxyCodeLine{1485             \textcolor{keywordtype}{float} kl, kr, s = DRMP3\_HDR\_TEST\_MS\_STEREO(hdr) ? 1.41421356f : 1;}
\DoxyCodeLine{1486             \textcolor{keywordflow}{if} (DRMP3\_HDR\_TEST\_MPEG1(hdr))}
\DoxyCodeLine{1487             \{}
\DoxyCodeLine{1488                 kl = g\_pan[2*ipos];}
\DoxyCodeLine{1489                 kr = g\_pan[2*ipos + 1];}
\DoxyCodeLine{1490             \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1491             \{}
\DoxyCodeLine{1492                 kl = 1;}
\DoxyCodeLine{1493                 kr = drmp3\_L3\_ldexp\_q2(1, (ipos + 1) >> 1 << mpeg2\_sh);}
\DoxyCodeLine{1494                 \textcolor{keywordflow}{if} (ipos \& 1)}
\DoxyCodeLine{1495                 \{}
\DoxyCodeLine{1496                     kl = kr;}
\DoxyCodeLine{1497                     kr = 1;}
\DoxyCodeLine{1498                 \}}
\DoxyCodeLine{1499             \}}
\DoxyCodeLine{1500             drmp3\_L3\_intensity\_stereo\_band(left, sfb[i], kl*s, kr*s);}
\DoxyCodeLine{1501         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (DRMP3\_HDR\_TEST\_MS\_STEREO(hdr))}
\DoxyCodeLine{1502         \{}
\DoxyCodeLine{1503             drmp3\_L3\_midside\_stereo(left, sfb[i]);}
\DoxyCodeLine{1504         \}}
\DoxyCodeLine{1505         left += sfb[i];}
\DoxyCodeLine{1506     \}}
\DoxyCodeLine{1507 \}}
\DoxyCodeLine{1508 }
\DoxyCodeLine{1509 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_intensity\_stereo(\textcolor{keywordtype}{float} *left, drmp3\_uint8 *ist\_pos, \textcolor{keyword}{const} drmp3\_L3\_gr\_info *gr, \textcolor{keyword}{const} drmp3\_uint8 *hdr)}
\DoxyCodeLine{1510 \{}
\DoxyCodeLine{1511     \textcolor{keywordtype}{int} max\_band[3], n\_sfb = gr-\/>n\_long\_sfb + gr-\/>n\_short\_sfb;}
\DoxyCodeLine{1512     \textcolor{keywordtype}{int} i, max\_blocks = gr-\/>n\_short\_sfb ? 3 : 1;}
\DoxyCodeLine{1513 }
\DoxyCodeLine{1514     drmp3\_L3\_stereo\_top\_band(left + 576, gr-\/>sfbtab, n\_sfb, max\_band);}
\DoxyCodeLine{1515     \textcolor{keywordflow}{if} (gr-\/>n\_long\_sfb)}
\DoxyCodeLine{1516     \{}
\DoxyCodeLine{1517         max\_band[0] = max\_band[1] = max\_band[2] = DRMP3\_MAX(DRMP3\_MAX(max\_band[0], max\_band[1]), max\_band[2]);}
\DoxyCodeLine{1518     \}}
\DoxyCodeLine{1519     \textcolor{keywordflow}{for} (i = 0; i < max\_blocks; i++)}
\DoxyCodeLine{1520     \{}
\DoxyCodeLine{1521         \textcolor{keywordtype}{int} default\_pos = DRMP3\_HDR\_TEST\_MPEG1(hdr) ? 3 : 0;}
\DoxyCodeLine{1522         \textcolor{keywordtype}{int} itop = n\_sfb -\/ max\_blocks + i;}
\DoxyCodeLine{1523         \textcolor{keywordtype}{int} prev = itop -\/ max\_blocks;}
\DoxyCodeLine{1524         ist\_pos[itop] = (drmp3\_uint8)(max\_band[i] >= prev ? default\_pos : ist\_pos[prev]);}
\DoxyCodeLine{1525     \}}
\DoxyCodeLine{1526     drmp3\_L3\_stereo\_process(left, ist\_pos, gr-\/>sfbtab, hdr, max\_band, gr[1].scalefac\_compress \& 1);}
\DoxyCodeLine{1527 \}}
\DoxyCodeLine{1528 }
\DoxyCodeLine{1529 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_reorder(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{float} *scratch, \textcolor{keyword}{const} drmp3\_uint8 *sfb)}
\DoxyCodeLine{1530 \{}
\DoxyCodeLine{1531     \textcolor{keywordtype}{int} i, len;}
\DoxyCodeLine{1532     \textcolor{keywordtype}{float} *src = grbuf, *dst = scratch;}
\DoxyCodeLine{1533 }
\DoxyCodeLine{1534     \textcolor{keywordflow}{for} (;0 != (len = *sfb); sfb += 3, src += 2*len)}
\DoxyCodeLine{1535     \{}
\DoxyCodeLine{1536         \textcolor{keywordflow}{for} (i = 0; i < len; i++, src++)}
\DoxyCodeLine{1537         \{}
\DoxyCodeLine{1538             *dst++ = src[0*len];}
\DoxyCodeLine{1539             *dst++ = src[1*len];}
\DoxyCodeLine{1540             *dst++ = src[2*len];}
\DoxyCodeLine{1541         \}}
\DoxyCodeLine{1542     \}}
\DoxyCodeLine{1543     DRMP3\_COPY\_MEMORY(grbuf, scratch, (dst -\/ scratch)*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1544 \}}
\DoxyCodeLine{1545 }
\DoxyCodeLine{1546 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_antialias(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{int} nbands)}
\DoxyCodeLine{1547 \{}
\DoxyCodeLine{1548     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_aa[2][8] = \{}
\DoxyCodeLine{1549         \{0.85749293f,0.88174200f,0.94962865f,0.98331459f,0.99551782f,0.99916056f,0.99989920f,0.99999316f\},}
\DoxyCodeLine{1550         \{0.51449576f,0.47173197f,0.31337745f,0.18191320f,0.09457419f,0.04096558f,0.01419856f,0.00369997f\}}
\DoxyCodeLine{1551     \};}
\DoxyCodeLine{1552 }
\DoxyCodeLine{1553     \textcolor{keywordflow}{for} (; nbands > 0; nbands-\/-\/, grbuf += 18)}
\DoxyCodeLine{1554     \{}
\DoxyCodeLine{1555         \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{1556 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{1557         \textcolor{keywordflow}{if} (drmp3\_have\_simd()) \textcolor{keywordflow}{for} (; i < 8; i += 4)}
\DoxyCodeLine{1558         \{}
\DoxyCodeLine{1559             drmp3\_f4 vu = DRMP3\_VLD(grbuf + 18 + i);}
\DoxyCodeLine{1560             drmp3\_f4 vd = DRMP3\_VLD(grbuf + 14 -\/ i);}
\DoxyCodeLine{1561             drmp3\_f4 vc0 = DRMP3\_VLD(g\_aa[0] + i);}
\DoxyCodeLine{1562             drmp3\_f4 vc1 = DRMP3\_VLD(g\_aa[1] + i);}
\DoxyCodeLine{1563             vd = DRMP3\_VREV(vd);}
\DoxyCodeLine{1564             DRMP3\_VSTORE(grbuf + 18 + i, DRMP3\_VSUB(DRMP3\_VMUL(vu, vc0), DRMP3\_VMUL(vd, vc1)));}
\DoxyCodeLine{1565             vd = DRMP3\_VADD(DRMP3\_VMUL(vu, vc1), DRMP3\_VMUL(vd, vc0));}
\DoxyCodeLine{1566             DRMP3\_VSTORE(grbuf + 14 -\/ i, DRMP3\_VREV(vd));}
\DoxyCodeLine{1567         \}}
\DoxyCodeLine{1568 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1569 \textcolor{preprocessor}{\#ifndef DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{1570         \textcolor{keywordflow}{for}(; i < 8; i++)}
\DoxyCodeLine{1571         \{}
\DoxyCodeLine{1572             \textcolor{keywordtype}{float} u = grbuf[18 + i];}
\DoxyCodeLine{1573             \textcolor{keywordtype}{float} d = grbuf[17 -\/ i];}
\DoxyCodeLine{1574             grbuf[18 + i] = u*g\_aa[0][i] -\/ d*g\_aa[1][i];}
\DoxyCodeLine{1575             grbuf[17 -\/ i] = u*g\_aa[1][i] + d*g\_aa[0][i];}
\DoxyCodeLine{1576         \}}
\DoxyCodeLine{1577 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1578     \}}
\DoxyCodeLine{1579 \}}
\DoxyCodeLine{1580 }
\DoxyCodeLine{1581 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_dct3\_9(\textcolor{keywordtype}{float} *y)}
\DoxyCodeLine{1582 \{}
\DoxyCodeLine{1583     \textcolor{keywordtype}{float} s0, s1, s2, s3, s4, s5, s6, s7, s8, t0, t2, t4;}
\DoxyCodeLine{1584 }
\DoxyCodeLine{1585     s0 = y[0]; s2 = y[2]; s4 = y[4]; s6 = y[6]; s8 = y[8];}
\DoxyCodeLine{1586     t0 = s0 + s6*0.5f;}
\DoxyCodeLine{1587     s0 -\/= s6;}
\DoxyCodeLine{1588     t4 = (s4 + s2)*0.93969262f;}
\DoxyCodeLine{1589     t2 = (s8 + s2)*0.76604444f;}
\DoxyCodeLine{1590     s6 = (s4 -\/ s8)*0.17364818f;}
\DoxyCodeLine{1591     s4 += s8 -\/ s2;}
\DoxyCodeLine{1592 }
\DoxyCodeLine{1593     s2 = s0 -\/ s4*0.5f;}
\DoxyCodeLine{1594     y[4] = s4 + s0;}
\DoxyCodeLine{1595     s8 = t0 -\/ t2 + s6;}
\DoxyCodeLine{1596     s0 = t0 -\/ t4 + t2;}
\DoxyCodeLine{1597     s4 = t0 + t4 -\/ s6;}
\DoxyCodeLine{1598 }
\DoxyCodeLine{1599     s1 = y[1]; s3 = y[3]; s5 = y[5]; s7 = y[7];}
\DoxyCodeLine{1600 }
\DoxyCodeLine{1601     s3 *= 0.86602540f;}
\DoxyCodeLine{1602     t0 = (s5 + s1)*0.98480775f;}
\DoxyCodeLine{1603     t4 = (s5 -\/ s7)*0.34202014f;}
\DoxyCodeLine{1604     t2 = (s1 + s7)*0.64278761f;}
\DoxyCodeLine{1605     s1 = (s1 -\/ s5 -\/ s7)*0.86602540f;}
\DoxyCodeLine{1606 }
\DoxyCodeLine{1607     s5 = t0 -\/ s3 -\/ t2;}
\DoxyCodeLine{1608     s7 = t4 -\/ s3 -\/ t0;}
\DoxyCodeLine{1609     s3 = t4 + s3 -\/ t2;}
\DoxyCodeLine{1610 }
\DoxyCodeLine{1611     y[0] = s4 -\/ s7;}
\DoxyCodeLine{1612     y[1] = s2 + s1;}
\DoxyCodeLine{1613     y[2] = s0 -\/ s3;}
\DoxyCodeLine{1614     y[3] = s8 + s5;}
\DoxyCodeLine{1615     y[5] = s8 -\/ s5;}
\DoxyCodeLine{1616     y[6] = s0 + s3;}
\DoxyCodeLine{1617     y[7] = s2 -\/ s1;}
\DoxyCodeLine{1618     y[8] = s4 + s7;}
\DoxyCodeLine{1619 \}}
\DoxyCodeLine{1620 }
\DoxyCodeLine{1621 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_imdct36(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{float} *overlap, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *window, \textcolor{keywordtype}{int} nbands)}
\DoxyCodeLine{1622 \{}
\DoxyCodeLine{1623     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{1624     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_twid9[18] = \{}
\DoxyCodeLine{1625         0.73727734f,0.79335334f,0.84339145f,0.88701083f,0.92387953f,0.95371695f,0.97629601f,0.99144486f,0.99904822f,0.67559021f,0.60876143f,0.53729961f,0.46174861f,0.38268343f,0.30070580f,0.21643961f,0.13052619f,0.04361938f}
\DoxyCodeLine{1626     \};}
\DoxyCodeLine{1627 }
\DoxyCodeLine{1628     \textcolor{keywordflow}{for} (j = 0; j < nbands; j++, grbuf += 18, overlap += 9)}
\DoxyCodeLine{1629     \{}
\DoxyCodeLine{1630         \textcolor{keywordtype}{float} co[9], si[9];}
\DoxyCodeLine{1631         co[0] = -\/grbuf[0];}
\DoxyCodeLine{1632         si[0] = grbuf[17];}
\DoxyCodeLine{1633         \textcolor{keywordflow}{for} (i = 0; i < 4; i++)}
\DoxyCodeLine{1634         \{}
\DoxyCodeLine{1635             si[8 -\/ 2*i] =   grbuf[4*i + 1] -\/ grbuf[4*i + 2];}
\DoxyCodeLine{1636             co[1 + 2*i] =   grbuf[4*i + 1] + grbuf[4*i + 2];}
\DoxyCodeLine{1637             si[7 -\/ 2*i] =   grbuf[4*i + 4] -\/ grbuf[4*i + 3];}
\DoxyCodeLine{1638             co[2 + 2*i] = -\/(grbuf[4*i + 3] + grbuf[4*i + 4]);}
\DoxyCodeLine{1639         \}}
\DoxyCodeLine{1640         drmp3\_L3\_dct3\_9(co);}
\DoxyCodeLine{1641         drmp3\_L3\_dct3\_9(si);}
\DoxyCodeLine{1642 }
\DoxyCodeLine{1643         si[1] = -\/si[1];}
\DoxyCodeLine{1644         si[3] = -\/si[3];}
\DoxyCodeLine{1645         si[5] = -\/si[5];}
\DoxyCodeLine{1646         si[7] = -\/si[7];}
\DoxyCodeLine{1647 }
\DoxyCodeLine{1648         i = 0;}
\DoxyCodeLine{1649 }
\DoxyCodeLine{1650 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{1651         \textcolor{keywordflow}{if} (drmp3\_have\_simd()) \textcolor{keywordflow}{for} (; i < 8; i += 4)}
\DoxyCodeLine{1652         \{}
\DoxyCodeLine{1653             drmp3\_f4 vovl = DRMP3\_VLD(overlap + i);}
\DoxyCodeLine{1654             drmp3\_f4 vc = DRMP3\_VLD(co + i);}
\DoxyCodeLine{1655             drmp3\_f4 vs = DRMP3\_VLD(si + i);}
\DoxyCodeLine{1656             drmp3\_f4 vr0 = DRMP3\_VLD(g\_twid9 + i);}
\DoxyCodeLine{1657             drmp3\_f4 vr1 = DRMP3\_VLD(g\_twid9 + 9 + i);}
\DoxyCodeLine{1658             drmp3\_f4 vw0 = DRMP3\_VLD(window + i);}
\DoxyCodeLine{1659             drmp3\_f4 vw1 = DRMP3\_VLD(window + 9 + i);}
\DoxyCodeLine{1660             drmp3\_f4 vsum = DRMP3\_VADD(DRMP3\_VMUL(vc, vr1), DRMP3\_VMUL(vs, vr0));}
\DoxyCodeLine{1661             DRMP3\_VSTORE(overlap + i, DRMP3\_VSUB(DRMP3\_VMUL(vc, vr0), DRMP3\_VMUL(vs, vr1)));}
\DoxyCodeLine{1662             DRMP3\_VSTORE(grbuf + i, DRMP3\_VSUB(DRMP3\_VMUL(vovl, vw0), DRMP3\_VMUL(vsum, vw1)));}
\DoxyCodeLine{1663             vsum = DRMP3\_VADD(DRMP3\_VMUL(vovl, vw1), DRMP3\_VMUL(vsum, vw0));}
\DoxyCodeLine{1664             DRMP3\_VSTORE(grbuf + 14 -\/ i, DRMP3\_VREV(vsum));}
\DoxyCodeLine{1665         \}}
\DoxyCodeLine{1666 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1667         \textcolor{keywordflow}{for} (; i < 9; i++)}
\DoxyCodeLine{1668         \{}
\DoxyCodeLine{1669             \textcolor{keywordtype}{float} ovl  = overlap[i];}
\DoxyCodeLine{1670             \textcolor{keywordtype}{float} sum  = co[i]*g\_twid9[9 + i] + si[i]*g\_twid9[0 + i];}
\DoxyCodeLine{1671             overlap[i] = co[i]*g\_twid9[0 + i] -\/ si[i]*g\_twid9[9 + i];}
\DoxyCodeLine{1672             grbuf[i]      = ovl*window[0 + i] -\/ sum*window[9 + i];}
\DoxyCodeLine{1673             grbuf[17 -\/ i] = ovl*window[9 + i] + sum*window[0 + i];}
\DoxyCodeLine{1674         \}}
\DoxyCodeLine{1675     \}}
\DoxyCodeLine{1676 \}}
\DoxyCodeLine{1677 }
\DoxyCodeLine{1678 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_idct3(\textcolor{keywordtype}{float} x0, \textcolor{keywordtype}{float} x1, \textcolor{keywordtype}{float} x2, \textcolor{keywordtype}{float} *dst)}
\DoxyCodeLine{1679 \{}
\DoxyCodeLine{1680     \textcolor{keywordtype}{float} m1 = x1*0.86602540f;}
\DoxyCodeLine{1681     \textcolor{keywordtype}{float} a1 = x0 -\/ x2*0.5f;}
\DoxyCodeLine{1682     dst[1] = x0 + x2;}
\DoxyCodeLine{1683     dst[0] = a1 + m1;}
\DoxyCodeLine{1684     dst[2] = a1 -\/ m1;}
\DoxyCodeLine{1685 \}}
\DoxyCodeLine{1686 }
\DoxyCodeLine{1687 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_imdct12(\textcolor{keywordtype}{float} *x, \textcolor{keywordtype}{float} *dst, \textcolor{keywordtype}{float} *overlap)}
\DoxyCodeLine{1688 \{}
\DoxyCodeLine{1689     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_twid3[6] = \{ 0.79335334f,0.92387953f,0.99144486f, 0.60876143f,0.38268343f,0.13052619f \};}
\DoxyCodeLine{1690     \textcolor{keywordtype}{float} co[3], si[3];}
\DoxyCodeLine{1691     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693     drmp3\_L3\_idct3(-\/x[0], x[6] + x[3], x[12] + x[9], co);}
\DoxyCodeLine{1694     drmp3\_L3\_idct3(x[15], x[12] -\/ x[9], x[6] -\/ x[3], si);}
\DoxyCodeLine{1695     si[1] = -\/si[1];}
\DoxyCodeLine{1696 }
\DoxyCodeLine{1697     \textcolor{keywordflow}{for} (i = 0; i < 3; i++)}
\DoxyCodeLine{1698     \{}
\DoxyCodeLine{1699         \textcolor{keywordtype}{float} ovl  = overlap[i];}
\DoxyCodeLine{1700         \textcolor{keywordtype}{float} sum  = co[i]*g\_twid3[3 + i] + si[i]*g\_twid3[0 + i];}
\DoxyCodeLine{1701         overlap[i] = co[i]*g\_twid3[0 + i] -\/ si[i]*g\_twid3[3 + i];}
\DoxyCodeLine{1702         dst[i]     = ovl*g\_twid3[2 -\/ i] -\/ sum*g\_twid3[5 -\/ i];}
\DoxyCodeLine{1703         dst[5 -\/ i] = ovl*g\_twid3[5 -\/ i] + sum*g\_twid3[2 -\/ i];}
\DoxyCodeLine{1704     \}}
\DoxyCodeLine{1705 \}}
\DoxyCodeLine{1706 }
\DoxyCodeLine{1707 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_imdct\_short(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{float} *overlap, \textcolor{keywordtype}{int} nbands)}
\DoxyCodeLine{1708 \{}
\DoxyCodeLine{1709     \textcolor{keywordflow}{for} (;nbands > 0; nbands-\/-\/, overlap += 9, grbuf += 18)}
\DoxyCodeLine{1710     \{}
\DoxyCodeLine{1711         \textcolor{keywordtype}{float} tmp[18];}
\DoxyCodeLine{1712         DRMP3\_COPY\_MEMORY(tmp, grbuf, \textcolor{keyword}{sizeof}(tmp));}
\DoxyCodeLine{1713         DRMP3\_COPY\_MEMORY(grbuf, overlap, 6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1714         drmp3\_L3\_imdct12(tmp, grbuf + 6, overlap + 6);}
\DoxyCodeLine{1715         drmp3\_L3\_imdct12(tmp + 1, grbuf + 12, overlap + 6);}
\DoxyCodeLine{1716         drmp3\_L3\_imdct12(tmp + 2, overlap, overlap + 6);}
\DoxyCodeLine{1717     \}}
\DoxyCodeLine{1718 \}}
\DoxyCodeLine{1719 }
\DoxyCodeLine{1720 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_change\_sign(\textcolor{keywordtype}{float} *grbuf)}
\DoxyCodeLine{1721 \{}
\DoxyCodeLine{1722     \textcolor{keywordtype}{int} b, i;}
\DoxyCodeLine{1723     \textcolor{keywordflow}{for} (b = 0, grbuf += 18; b < 32; b += 2, grbuf += 36)}
\DoxyCodeLine{1724         \textcolor{keywordflow}{for} (i = 1; i < 18; i += 2)}
\DoxyCodeLine{1725             grbuf[i] = -\/grbuf[i];}
\DoxyCodeLine{1726 \}}
\DoxyCodeLine{1727 }
\DoxyCodeLine{1728 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_imdct\_gr(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{float} *overlap, \textcolor{keywordtype}{unsigned} block\_type, \textcolor{keywordtype}{unsigned} n\_long\_bands)}
\DoxyCodeLine{1729 \{}
\DoxyCodeLine{1730     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_mdct\_window[2][18] = \{}
\DoxyCodeLine{1731         \{ 0.99904822f,0.99144486f,0.97629601f,0.95371695f,0.92387953f,0.88701083f,0.84339145f,0.79335334f,0.73727734f,0.04361938f,0.13052619f,0.21643961f,0.30070580f,0.38268343f,0.46174861f,0.53729961f,0.60876143f,0.67559021f \},}
\DoxyCodeLine{1732         \{ 1,1,1,1,1,1,0.99144486f,0.92387953f,0.79335334f,0,0,0,0,0,0,0.13052619f,0.38268343f,0.60876143f \}}
\DoxyCodeLine{1733     \};}
\DoxyCodeLine{1734     \textcolor{keywordflow}{if} (n\_long\_bands)}
\DoxyCodeLine{1735     \{}
\DoxyCodeLine{1736         drmp3\_L3\_imdct36(grbuf, overlap, g\_mdct\_window[0], n\_long\_bands);}
\DoxyCodeLine{1737         grbuf += 18*n\_long\_bands;}
\DoxyCodeLine{1738         overlap += 9*n\_long\_bands;}
\DoxyCodeLine{1739     \}}
\DoxyCodeLine{1740     \textcolor{keywordflow}{if} (block\_type == DRMP3\_SHORT\_BLOCK\_TYPE)}
\DoxyCodeLine{1741         drmp3\_L3\_imdct\_short(grbuf, overlap, 32 -\/ n\_long\_bands);}
\DoxyCodeLine{1742     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1743         drmp3\_L3\_imdct36(grbuf, overlap, g\_mdct\_window[block\_type == DRMP3\_STOP\_BLOCK\_TYPE], 32 -\/ n\_long\_bands);}
\DoxyCodeLine{1744 \}}
\DoxyCodeLine{1745 }
\DoxyCodeLine{1746 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_save\_reservoir(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *h, drmp3dec\_scratch *s)}
\DoxyCodeLine{1747 \{}
\DoxyCodeLine{1748     \textcolor{keywordtype}{int} pos = (s-\/>bs.pos + 7)/8u;}
\DoxyCodeLine{1749     \textcolor{keywordtype}{int} remains = s-\/>bs.limit/8u -\/ pos;}
\DoxyCodeLine{1750     \textcolor{keywordflow}{if} (remains > DRMP3\_MAX\_BITRESERVOIR\_BYTES)}
\DoxyCodeLine{1751     \{}
\DoxyCodeLine{1752         pos += remains -\/ DRMP3\_MAX\_BITRESERVOIR\_BYTES;}
\DoxyCodeLine{1753         remains = DRMP3\_MAX\_BITRESERVOIR\_BYTES;}
\DoxyCodeLine{1754     \}}
\DoxyCodeLine{1755     \textcolor{keywordflow}{if} (remains > 0)}
\DoxyCodeLine{1756     \{}
\DoxyCodeLine{1757         DRMP3\_MOVE\_MEMORY(h-\/>reserv\_buf, s-\/>maindata + pos, remains);}
\DoxyCodeLine{1758     \}}
\DoxyCodeLine{1759     h-\/>reserv = remains;}
\DoxyCodeLine{1760 \}}
\DoxyCodeLine{1761 }
\DoxyCodeLine{1762 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3\_L3\_restore\_reservoir(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *h, drmp3\_bs *bs, drmp3dec\_scratch *s, \textcolor{keywordtype}{int} main\_data\_begin)}
\DoxyCodeLine{1763 \{}
\DoxyCodeLine{1764     \textcolor{keywordtype}{int} frame\_bytes = (bs-\/>limit -\/ bs-\/>pos)/8;}
\DoxyCodeLine{1765     \textcolor{keywordtype}{int} bytes\_have = DRMP3\_MIN(h-\/>reserv, main\_data\_begin);}
\DoxyCodeLine{1766     DRMP3\_COPY\_MEMORY(s-\/>maindata, h-\/>reserv\_buf + DRMP3\_MAX(0, h-\/>reserv -\/ main\_data\_begin), DRMP3\_MIN(h-\/>reserv, main\_data\_begin));}
\DoxyCodeLine{1767     DRMP3\_COPY\_MEMORY(s-\/>maindata + bytes\_have, bs-\/>buf + bs-\/>pos/8, frame\_bytes);}
\DoxyCodeLine{1768     drmp3\_bs\_init(\&s-\/>bs, s-\/>maindata, bytes\_have + frame\_bytes);}
\DoxyCodeLine{1769     \textcolor{keywordflow}{return} h-\/>reserv >= main\_data\_begin;}
\DoxyCodeLine{1770 \}}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_L3\_decode(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *h, drmp3dec\_scratch *s, drmp3\_L3\_gr\_info *gr\_info, \textcolor{keywordtype}{int} nch)}
\DoxyCodeLine{1773 \{}
\DoxyCodeLine{1774     \textcolor{keywordtype}{int} ch;}
\DoxyCodeLine{1775 }
\DoxyCodeLine{1776     \textcolor{keywordflow}{for} (ch = 0; ch < nch; ch++)}
\DoxyCodeLine{1777     \{}
\DoxyCodeLine{1778         \textcolor{keywordtype}{int} layer3gr\_limit = s-\/>bs.pos + gr\_info[ch].part\_23\_length;}
\DoxyCodeLine{1779         drmp3\_L3\_decode\_scalefactors(h-\/>header, s-\/>ist\_pos[ch], \&s-\/>bs, gr\_info + ch, s-\/>scf, ch);}
\DoxyCodeLine{1780         drmp3\_L3\_huffman(s-\/>grbuf[ch], \&s-\/>bs, gr\_info + ch, s-\/>scf, layer3gr\_limit);}
\DoxyCodeLine{1781     \}}
\DoxyCodeLine{1782 }
\DoxyCodeLine{1783     \textcolor{keywordflow}{if} (DRMP3\_HDR\_TEST\_I\_STEREO(h-\/>header))}
\DoxyCodeLine{1784     \{}
\DoxyCodeLine{1785         drmp3\_L3\_intensity\_stereo(s-\/>grbuf[0], s-\/>ist\_pos[1], gr\_info, h-\/>header);}
\DoxyCodeLine{1786     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (DRMP3\_HDR\_IS\_MS\_STEREO(h-\/>header))}
\DoxyCodeLine{1787     \{}
\DoxyCodeLine{1788         drmp3\_L3\_midside\_stereo(s-\/>grbuf[0], 576);}
\DoxyCodeLine{1789     \}}
\DoxyCodeLine{1790 }
\DoxyCodeLine{1791     \textcolor{keywordflow}{for} (ch = 0; ch < nch; ch++, gr\_info++)}
\DoxyCodeLine{1792     \{}
\DoxyCodeLine{1793         \textcolor{keywordtype}{int} aa\_bands = 31;}
\DoxyCodeLine{1794         \textcolor{keywordtype}{int} n\_long\_bands = (gr\_info-\/>mixed\_block\_flag ? 2 : 0) << (\textcolor{keywordtype}{int})(DRMP3\_HDR\_GET\_MY\_SAMPLE\_RATE(h-\/>header) == 2);}
\DoxyCodeLine{1795 }
\DoxyCodeLine{1796         \textcolor{keywordflow}{if} (gr\_info-\/>n\_short\_sfb)}
\DoxyCodeLine{1797         \{}
\DoxyCodeLine{1798             aa\_bands = n\_long\_bands -\/ 1;}
\DoxyCodeLine{1799             drmp3\_L3\_reorder(s-\/>grbuf[ch] + n\_long\_bands*18, s-\/>syn[0], gr\_info-\/>sfbtab + gr\_info-\/>n\_long\_sfb);}
\DoxyCodeLine{1800         \}}
\DoxyCodeLine{1801 }
\DoxyCodeLine{1802         drmp3\_L3\_antialias(s-\/>grbuf[ch], aa\_bands);}
\DoxyCodeLine{1803         drmp3\_L3\_imdct\_gr(s-\/>grbuf[ch], h-\/>mdct\_overlap[ch], gr\_info-\/>block\_type, n\_long\_bands);}
\DoxyCodeLine{1804         drmp3\_L3\_change\_sign(s-\/>grbuf[ch]);}
\DoxyCodeLine{1805     \}}
\DoxyCodeLine{1806 \}}
\DoxyCodeLine{1807 }
\DoxyCodeLine{1808 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3d\_DCT\_II(\textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1809 \{}
\DoxyCodeLine{1810     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_sec[24] = \{}
\DoxyCodeLine{1811         10.19000816f,0.50060302f,0.50241929f,3.40760851f,0.50547093f,0.52249861f,2.05778098f,0.51544732f,0.56694406f,1.48416460f,0.53104258f,0.64682180f,1.16943991f,0.55310392f,0.78815460f,0.97256821f,0.58293498f,1.06067765f,0.83934963f,0.62250412f,1.72244716f,0.74453628f,0.67480832f,5.10114861f}
\DoxyCodeLine{1812     \};}
\DoxyCodeLine{1813     \textcolor{keywordtype}{int} i, k = 0;}
\DoxyCodeLine{1814 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{1815     \textcolor{keywordflow}{if} (drmp3\_have\_simd()) \textcolor{keywordflow}{for} (; k < n; k += 4)}
\DoxyCodeLine{1816     \{}
\DoxyCodeLine{1817         drmp3\_f4 t[4][8], *x;}
\DoxyCodeLine{1818         \textcolor{keywordtype}{float} *y = grbuf + k;}
\DoxyCodeLine{1819 }
\DoxyCodeLine{1820         \textcolor{keywordflow}{for} (x = t[0], i = 0; i < 8; i++, x++)}
\DoxyCodeLine{1821         \{}
\DoxyCodeLine{1822             drmp3\_f4 x0 = DRMP3\_VLD(\&y[i*18]);}
\DoxyCodeLine{1823             drmp3\_f4 x1 = DRMP3\_VLD(\&y[(15 -\/ i)*18]);}
\DoxyCodeLine{1824             drmp3\_f4 x2 = DRMP3\_VLD(\&y[(16 + i)*18]);}
\DoxyCodeLine{1825             drmp3\_f4 x3 = DRMP3\_VLD(\&y[(31 -\/ i)*18]);}
\DoxyCodeLine{1826             drmp3\_f4 t0 = DRMP3\_VADD(x0, x3);}
\DoxyCodeLine{1827             drmp3\_f4 t1 = DRMP3\_VADD(x1, x2);}
\DoxyCodeLine{1828             drmp3\_f4 t2 = DRMP3\_VMUL\_S(DRMP3\_VSUB(x1, x2), g\_sec[3*i + 0]);}
\DoxyCodeLine{1829             drmp3\_f4 t3 = DRMP3\_VMUL\_S(DRMP3\_VSUB(x0, x3), g\_sec[3*i + 1]);}
\DoxyCodeLine{1830             x[0] = DRMP3\_VADD(t0, t1);}
\DoxyCodeLine{1831             x[8] = DRMP3\_VMUL\_S(DRMP3\_VSUB(t0, t1), g\_sec[3*i + 2]);}
\DoxyCodeLine{1832             x[16] = DRMP3\_VADD(t3, t2);}
\DoxyCodeLine{1833             x[24] = DRMP3\_VMUL\_S(DRMP3\_VSUB(t3, t2), g\_sec[3*i + 2]);}
\DoxyCodeLine{1834         \}}
\DoxyCodeLine{1835         \textcolor{keywordflow}{for} (x = t[0], i = 0; i < 4; i++, x += 8)}
\DoxyCodeLine{1836         \{}
\DoxyCodeLine{1837             drmp3\_f4 x0 = x[0], x1 = x[1], x2 = x[2], x3 = x[3], x4 = x[4], x5 = x[5], x6 = x[6], x7 = x[7], xt;}
\DoxyCodeLine{1838             xt = DRMP3\_VSUB(x0, x7); x0 = DRMP3\_VADD(x0, x7);}
\DoxyCodeLine{1839             x7 = DRMP3\_VSUB(x1, x6); x1 = DRMP3\_VADD(x1, x6);}
\DoxyCodeLine{1840             x6 = DRMP3\_VSUB(x2, x5); x2 = DRMP3\_VADD(x2, x5);}
\DoxyCodeLine{1841             x5 = DRMP3\_VSUB(x3, x4); x3 = DRMP3\_VADD(x3, x4);}
\DoxyCodeLine{1842             x4 = DRMP3\_VSUB(x0, x3); x0 = DRMP3\_VADD(x0, x3);}
\DoxyCodeLine{1843             x3 = DRMP3\_VSUB(x1, x2); x1 = DRMP3\_VADD(x1, x2);}
\DoxyCodeLine{1844             x[0] = DRMP3\_VADD(x0, x1);}
\DoxyCodeLine{1845             x[4] = DRMP3\_VMUL\_S(DRMP3\_VSUB(x0, x1), 0.70710677f);}
\DoxyCodeLine{1846             x5 = DRMP3\_VADD(x5, x6);}
\DoxyCodeLine{1847             x6 = DRMP3\_VMUL\_S(DRMP3\_VADD(x6, x7), 0.70710677f);}
\DoxyCodeLine{1848             x7 = DRMP3\_VADD(x7, xt);}
\DoxyCodeLine{1849             x3 = DRMP3\_VMUL\_S(DRMP3\_VADD(x3, x4), 0.70710677f);}
\DoxyCodeLine{1850             x5 = DRMP3\_VSUB(x5, DRMP3\_VMUL\_S(x7, 0.198912367f)); \textcolor{comment}{/* rotate by PI/8 */}}
\DoxyCodeLine{1851             x7 = DRMP3\_VADD(x7, DRMP3\_VMUL\_S(x5, 0.382683432f));}
\DoxyCodeLine{1852             x5 = DRMP3\_VSUB(x5, DRMP3\_VMUL\_S(x7, 0.198912367f));}
\DoxyCodeLine{1853             x0 = DRMP3\_VSUB(xt, x6); xt = DRMP3\_VADD(xt, x6);}
\DoxyCodeLine{1854             x[1] = DRMP3\_VMUL\_S(DRMP3\_VADD(xt, x7), 0.50979561f);}
\DoxyCodeLine{1855             x[2] = DRMP3\_VMUL\_S(DRMP3\_VADD(x4, x3), 0.54119611f);}
\DoxyCodeLine{1856             x[3] = DRMP3\_VMUL\_S(DRMP3\_VSUB(x0, x5), 0.60134488f);}
\DoxyCodeLine{1857             x[5] = DRMP3\_VMUL\_S(DRMP3\_VADD(x0, x5), 0.89997619f);}
\DoxyCodeLine{1858             x[6] = DRMP3\_VMUL\_S(DRMP3\_VSUB(x4, x3), 1.30656302f);}
\DoxyCodeLine{1859             x[7] = DRMP3\_VMUL\_S(DRMP3\_VSUB(xt, x7), 2.56291556f);}
\DoxyCodeLine{1860         \}}
\DoxyCodeLine{1861 }
\DoxyCodeLine{1862         \textcolor{keywordflow}{if} (k > n -\/ 3)}
\DoxyCodeLine{1863         \{}
\DoxyCodeLine{1864 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SSE}}
\DoxyCodeLine{1865 \textcolor{preprocessor}{\#define DRMP3\_VSAVE2(i, v) \_mm\_storel\_pi((\_\_m64 *)(void*)\&y[i*18], v)}}
\DoxyCodeLine{1866 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1867 \textcolor{preprocessor}{\#define DRMP3\_VSAVE2(i, v) vst1\_f32((float32\_t *)\&y[i*18],  vget\_low\_f32(v))}}
\DoxyCodeLine{1868 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1869             \textcolor{keywordflow}{for} (i = 0; i < 7; i++, y += 4*18)}
\DoxyCodeLine{1870             \{}
\DoxyCodeLine{1871                 drmp3\_f4 s = DRMP3\_VADD(t[3][i], t[3][i + 1]);}
\DoxyCodeLine{1872                 DRMP3\_VSAVE2(0, t[0][i]);}
\DoxyCodeLine{1873                 DRMP3\_VSAVE2(1, DRMP3\_VADD(t[2][i], s));}
\DoxyCodeLine{1874                 DRMP3\_VSAVE2(2, DRMP3\_VADD(t[1][i], t[1][i + 1]));}
\DoxyCodeLine{1875                 DRMP3\_VSAVE2(3, DRMP3\_VADD(t[2][1 + i], s));}
\DoxyCodeLine{1876             \}}
\DoxyCodeLine{1877             DRMP3\_VSAVE2(0, t[0][7]);}
\DoxyCodeLine{1878             DRMP3\_VSAVE2(1, DRMP3\_VADD(t[2][7], t[3][7]));}
\DoxyCodeLine{1879             DRMP3\_VSAVE2(2, t[1][7]);}
\DoxyCodeLine{1880             DRMP3\_VSAVE2(3, t[3][7]);}
\DoxyCodeLine{1881         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1882         \{}
\DoxyCodeLine{1883 \textcolor{preprocessor}{\#define DRMP3\_VSAVE4(i, v) DRMP3\_VSTORE(\&y[i*18], v)}}
\DoxyCodeLine{1884             \textcolor{keywordflow}{for} (i = 0; i < 7; i++, y += 4*18)}
\DoxyCodeLine{1885             \{}
\DoxyCodeLine{1886                 drmp3\_f4 s = DRMP3\_VADD(t[3][i], t[3][i + 1]);}
\DoxyCodeLine{1887                 DRMP3\_VSAVE4(0, t[0][i]);}
\DoxyCodeLine{1888                 DRMP3\_VSAVE4(1, DRMP3\_VADD(t[2][i], s));}
\DoxyCodeLine{1889                 DRMP3\_VSAVE4(2, DRMP3\_VADD(t[1][i], t[1][i + 1]));}
\DoxyCodeLine{1890                 DRMP3\_VSAVE4(3, DRMP3\_VADD(t[2][1 + i], s));}
\DoxyCodeLine{1891             \}}
\DoxyCodeLine{1892             DRMP3\_VSAVE4(0, t[0][7]);}
\DoxyCodeLine{1893             DRMP3\_VSAVE4(1, DRMP3\_VADD(t[2][7], t[3][7]));}
\DoxyCodeLine{1894             DRMP3\_VSAVE4(2, t[1][7]);}
\DoxyCodeLine{1895             DRMP3\_VSAVE4(3, t[3][7]);}
\DoxyCodeLine{1896         \}}
\DoxyCodeLine{1897     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1898 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1899 \textcolor{preprocessor}{\#ifdef DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{1900     \{\} \textcolor{comment}{/* for HAVE\_SIMD=1, MINIMP3\_ONLY\_SIMD=1 case we do not need non-\/intrinsic "{}else"{} branch */}}
\DoxyCodeLine{1901 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1902     \textcolor{keywordflow}{for} (; k < n; k++)}
\DoxyCodeLine{1903     \{}
\DoxyCodeLine{1904         \textcolor{keywordtype}{float} t[4][8], *x, *y = grbuf + k;}
\DoxyCodeLine{1905 }
\DoxyCodeLine{1906         \textcolor{keywordflow}{for} (x = t[0], i = 0; i < 8; i++, x++)}
\DoxyCodeLine{1907         \{}
\DoxyCodeLine{1908             \textcolor{keywordtype}{float} x0 = y[i*18];}
\DoxyCodeLine{1909             \textcolor{keywordtype}{float} x1 = y[(15 -\/ i)*18];}
\DoxyCodeLine{1910             \textcolor{keywordtype}{float} x2 = y[(16 + i)*18];}
\DoxyCodeLine{1911             \textcolor{keywordtype}{float} x3 = y[(31 -\/ i)*18];}
\DoxyCodeLine{1912             \textcolor{keywordtype}{float} t0 = x0 + x3;}
\DoxyCodeLine{1913             \textcolor{keywordtype}{float} t1 = x1 + x2;}
\DoxyCodeLine{1914             \textcolor{keywordtype}{float} t2 = (x1 -\/ x2)*g\_sec[3*i + 0];}
\DoxyCodeLine{1915             \textcolor{keywordtype}{float} t3 = (x0 -\/ x3)*g\_sec[3*i + 1];}
\DoxyCodeLine{1916             x[0] = t0 + t1;}
\DoxyCodeLine{1917             x[8] = (t0 -\/ t1)*g\_sec[3*i + 2];}
\DoxyCodeLine{1918             x[16] = t3 + t2;}
\DoxyCodeLine{1919             x[24] = (t3 -\/ t2)*g\_sec[3*i + 2];}
\DoxyCodeLine{1920         \}}
\DoxyCodeLine{1921         \textcolor{keywordflow}{for} (x = t[0], i = 0; i < 4; i++, x += 8)}
\DoxyCodeLine{1922         \{}
\DoxyCodeLine{1923             \textcolor{keywordtype}{float} x0 = x[0], x1 = x[1], x2 = x[2], x3 = x[3], x4 = x[4], x5 = x[5], x6 = x[6], x7 = x[7], xt;}
\DoxyCodeLine{1924             xt = x0 -\/ x7; x0 += x7;}
\DoxyCodeLine{1925             x7 = x1 -\/ x6; x1 += x6;}
\DoxyCodeLine{1926             x6 = x2 -\/ x5; x2 += x5;}
\DoxyCodeLine{1927             x5 = x3 -\/ x4; x3 += x4;}
\DoxyCodeLine{1928             x4 = x0 -\/ x3; x0 += x3;}
\DoxyCodeLine{1929             x3 = x1 -\/ x2; x1 += x2;}
\DoxyCodeLine{1930             x[0] = x0 + x1;}
\DoxyCodeLine{1931             x[4] = (x0 -\/ x1)*0.70710677f;}
\DoxyCodeLine{1932             x5 =  x5 + x6;}
\DoxyCodeLine{1933             x6 = (x6 + x7)*0.70710677f;}
\DoxyCodeLine{1934             x7 =  x7 + xt;}
\DoxyCodeLine{1935             x3 = (x3 + x4)*0.70710677f;}
\DoxyCodeLine{1936             x5 -\/= x7*0.198912367f;  \textcolor{comment}{/* rotate by PI/8 */}}
\DoxyCodeLine{1937             x7 += x5*0.382683432f;}
\DoxyCodeLine{1938             x5 -\/= x7*0.198912367f;}
\DoxyCodeLine{1939             x0 = xt -\/ x6; xt += x6;}
\DoxyCodeLine{1940             x[1] = (xt + x7)*0.50979561f;}
\DoxyCodeLine{1941             x[2] = (x4 + x3)*0.54119611f;}
\DoxyCodeLine{1942             x[3] = (x0 -\/ x5)*0.60134488f;}
\DoxyCodeLine{1943             x[5] = (x0 + x5)*0.89997619f;}
\DoxyCodeLine{1944             x[6] = (x4 -\/ x3)*1.30656302f;}
\DoxyCodeLine{1945             x[7] = (xt -\/ x7)*2.56291556f;}
\DoxyCodeLine{1946 }
\DoxyCodeLine{1947         \}}
\DoxyCodeLine{1948         \textcolor{keywordflow}{for} (i = 0; i < 7; i++, y += 4*18)}
\DoxyCodeLine{1949         \{}
\DoxyCodeLine{1950             y[0*18] = t[0][i];}
\DoxyCodeLine{1951             y[1*18] = t[2][i] + t[3][i] + t[3][i + 1];}
\DoxyCodeLine{1952             y[2*18] = t[1][i] + t[1][i + 1];}
\DoxyCodeLine{1953             y[3*18] = t[2][i + 1] + t[3][i] + t[3][i + 1];}
\DoxyCodeLine{1954         \}}
\DoxyCodeLine{1955         y[0*18] = t[0][7];}
\DoxyCodeLine{1956         y[1*18] = t[2][7] + t[3][7];}
\DoxyCodeLine{1957         y[2*18] = t[1][7];}
\DoxyCodeLine{1958         y[3*18] = t[3][7];}
\DoxyCodeLine{1959     \}}
\DoxyCodeLine{1960 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1961 \}}
\DoxyCodeLine{1962 }
\DoxyCodeLine{1963 \textcolor{preprocessor}{\#ifndef DR\_MP3\_FLOAT\_OUTPUT}}
\DoxyCodeLine{1964 \textcolor{keyword}{typedef} drmp3\_int16 drmp3d\_sample\_t;}
\DoxyCodeLine{1965 }
\DoxyCodeLine{1966 \textcolor{keyword}{static} drmp3\_int16 drmp3d\_scale\_pcm(\textcolor{keywordtype}{float} \mbox{\hyperlink{structsample}{sample}})}
\DoxyCodeLine{1967 \{}
\DoxyCodeLine{1968     drmp3\_int16 s;}
\DoxyCodeLine{1969 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_ARMV6}}
\DoxyCodeLine{1970     drmp3\_int32 s32 = (drmp3\_int32)(\mbox{\hyperlink{structsample}{sample}} + .5f);}
\DoxyCodeLine{1971     s32 -\/= (s32 < 0);}
\DoxyCodeLine{1972     s = (drmp3\_int16)drmp3\_clip\_int16\_arm(s32);}
\DoxyCodeLine{1973 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1974     \textcolor{keywordflow}{if} (\mbox{\hyperlink{structsample}{sample}} >=  32766.5) \textcolor{keywordflow}{return} (drmp3\_int16) 32767;}
\DoxyCodeLine{1975     \textcolor{keywordflow}{if} (\mbox{\hyperlink{structsample}{sample}} <= -\/32767.5) \textcolor{keywordflow}{return} (drmp3\_int16)-\/32768;}
\DoxyCodeLine{1976     s = (drmp3\_int16)(\mbox{\hyperlink{structsample}{sample}} + .5f);}
\DoxyCodeLine{1977     s -\/= (s < 0);   \textcolor{comment}{/* away from zero, to be compliant */}}
\DoxyCodeLine{1978 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1979     \textcolor{keywordflow}{return} s;}
\DoxyCodeLine{1980 \}}
\DoxyCodeLine{1981 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1982 \textcolor{keyword}{typedef} \textcolor{keywordtype}{float} drmp3d\_sample\_t;}
\DoxyCodeLine{1983 }
\DoxyCodeLine{1984 \textcolor{keyword}{static} \textcolor{keywordtype}{float} drmp3d\_scale\_pcm(\textcolor{keywordtype}{float} \mbox{\hyperlink{structsample}{sample}})}
\DoxyCodeLine{1985 \{}
\DoxyCodeLine{1986     \textcolor{keywordflow}{return} \mbox{\hyperlink{structsample}{sample}}*(1.f/32768.f);}
\DoxyCodeLine{1987 \}}
\DoxyCodeLine{1988 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1989 }
\DoxyCodeLine{1990 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3d\_synth\_pair(drmp3d\_sample\_t *pcm, \textcolor{keywordtype}{int} nch, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *z)}
\DoxyCodeLine{1991 \{}
\DoxyCodeLine{1992     \textcolor{keywordtype}{float} a;}
\DoxyCodeLine{1993     a  = (z[14*64] -\/ z[    0]) * 29;}
\DoxyCodeLine{1994     a += (z[ 1*64] + z[13*64]) * 213;}
\DoxyCodeLine{1995     a += (z[12*64] -\/ z[ 2*64]) * 459;}
\DoxyCodeLine{1996     a += (z[ 3*64] + z[11*64]) * 2037;}
\DoxyCodeLine{1997     a += (z[10*64] -\/ z[ 4*64]) * 5153;}
\DoxyCodeLine{1998     a += (z[ 5*64] + z[ 9*64]) * 6574;}
\DoxyCodeLine{1999     a += (z[ 8*64] -\/ z[ 6*64]) * 37489;}
\DoxyCodeLine{2000     a +=  z[ 7*64]             * 75038;}
\DoxyCodeLine{2001     pcm[0] = drmp3d\_scale\_pcm(a);}
\DoxyCodeLine{2002 }
\DoxyCodeLine{2003     z += 2;}
\DoxyCodeLine{2004     a  = z[14*64] * 104;}
\DoxyCodeLine{2005     a += z[12*64] * 1567;}
\DoxyCodeLine{2006     a += z[10*64] * 9727;}
\DoxyCodeLine{2007     a += z[ 8*64] * 64019;}
\DoxyCodeLine{2008     a += z[ 6*64] * -\/9975;}
\DoxyCodeLine{2009     a += z[ 4*64] * -\/45;}
\DoxyCodeLine{2010     a += z[ 2*64] * 146;}
\DoxyCodeLine{2011     a += z[ 0*64] * -\/5;}
\DoxyCodeLine{2012     pcm[16*nch] = drmp3d\_scale\_pcm(a);}
\DoxyCodeLine{2013 \}}
\DoxyCodeLine{2014 }
\DoxyCodeLine{2015 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3d\_synth(\textcolor{keywordtype}{float} *xl, drmp3d\_sample\_t *dstl, \textcolor{keywordtype}{int} nch, \textcolor{keywordtype}{float} *lins)}
\DoxyCodeLine{2016 \{}
\DoxyCodeLine{2017     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{2018     \textcolor{keywordtype}{float} *xr = xl + 576*(nch -\/ 1);}
\DoxyCodeLine{2019     drmp3d\_sample\_t *dstr = dstl + (nch -\/ 1);}
\DoxyCodeLine{2020 }
\DoxyCodeLine{2021     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} g\_win[] = \{}
\DoxyCodeLine{2022         -\/1,26,-\/31,208,218,401,-\/519,2063,2000,4788,-\/5517,7134,5959,35640,-\/39336,74992,}
\DoxyCodeLine{2023         -\/1,24,-\/35,202,222,347,-\/581,2080,1952,4425,-\/5879,7640,5288,33791,-\/41176,74856,}
\DoxyCodeLine{2024         -\/1,21,-\/38,196,225,294,-\/645,2087,1893,4063,-\/6237,8092,4561,31947,-\/43006,74630,}
\DoxyCodeLine{2025         -\/1,19,-\/41,190,227,244,-\/711,2085,1822,3705,-\/6589,8492,3776,30112,-\/44821,74313,}
\DoxyCodeLine{2026         -\/1,17,-\/45,183,228,197,-\/779,2075,1739,3351,-\/6935,8840,2935,28289,-\/46617,73908,}
\DoxyCodeLine{2027         -\/1,16,-\/49,176,228,153,-\/848,2057,1644,3004,-\/7271,9139,2037,26482,-\/48390,73415,}
\DoxyCodeLine{2028         -\/2,14,-\/53,169,227,111,-\/919,2032,1535,2663,-\/7597,9389,1082,24694,-\/50137,72835,}
\DoxyCodeLine{2029         -\/2,13,-\/58,161,224,72,-\/991,2001,1414,2330,-\/7910,9592,70,22929,-\/51853,72169,}
\DoxyCodeLine{2030         -\/2,11,-\/63,154,221,36,-\/1064,1962,1280,2006,-\/8209,9750,-\/998,21189,-\/53534,71420,}
\DoxyCodeLine{2031         -\/2,10,-\/68,147,215,2,-\/1137,1919,1131,1692,-\/8491,9863,-\/2122,19478,-\/55178,70590,}
\DoxyCodeLine{2032         -\/3,9,-\/73,139,208,-\/29,-\/1210,1870,970,1388,-\/8755,9935,-\/3300,17799,-\/56778,69679,}
\DoxyCodeLine{2033         -\/3,8,-\/79,132,200,-\/57,-\/1283,1817,794,1095,-\/8998,9966,-\/4533,16155,-\/58333,68692,}
\DoxyCodeLine{2034         -\/4,7,-\/85,125,189,-\/83,-\/1356,1759,605,814,-\/9219,9959,-\/5818,14548,-\/59838,67629,}
\DoxyCodeLine{2035         -\/4,7,-\/91,117,177,-\/106,-\/1428,1698,402,545,-\/9416,9916,-\/7154,12980,-\/61289,66494,}
\DoxyCodeLine{2036         -\/5,6,-\/97,111,163,-\/127,-\/1498,1634,185,288,-\/9585,9838,-\/8540,11455,-\/62684,65290}
\DoxyCodeLine{2037     \};}
\DoxyCodeLine{2038     \textcolor{keywordtype}{float} *zlin = lins + 15*64;}
\DoxyCodeLine{2039     \textcolor{keyword}{const} \textcolor{keywordtype}{float} *w = g\_win;}
\DoxyCodeLine{2040 }
\DoxyCodeLine{2041     zlin[4*15]     = xl[18*16];}
\DoxyCodeLine{2042     zlin[4*15 + 1] = xr[18*16];}
\DoxyCodeLine{2043     zlin[4*15 + 2] = xl[0];}
\DoxyCodeLine{2044     zlin[4*15 + 3] = xr[0];}
\DoxyCodeLine{2045 }
\DoxyCodeLine{2046     zlin[4*31]     = xl[1 + 18*16];}
\DoxyCodeLine{2047     zlin[4*31 + 1] = xr[1 + 18*16];}
\DoxyCodeLine{2048     zlin[4*31 + 2] = xl[1];}
\DoxyCodeLine{2049     zlin[4*31 + 3] = xr[1];}
\DoxyCodeLine{2050 }
\DoxyCodeLine{2051     drmp3d\_synth\_pair(dstr, nch, lins + 4*15 + 1);}
\DoxyCodeLine{2052     drmp3d\_synth\_pair(dstr + 32*nch, nch, lins + 4*15 + 64 + 1);}
\DoxyCodeLine{2053     drmp3d\_synth\_pair(dstl, nch, lins + 4*15);}
\DoxyCodeLine{2054     drmp3d\_synth\_pair(dstl + 32*nch, nch, lins + 4*15 + 64);}
\DoxyCodeLine{2055 }
\DoxyCodeLine{2056 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{2057     \textcolor{keywordflow}{if} (drmp3\_have\_simd()) \textcolor{keywordflow}{for} (i = 14; i >= 0; i-\/-\/)}
\DoxyCodeLine{2058     \{}
\DoxyCodeLine{2059 \textcolor{preprocessor}{\#define DRMP3\_VLOAD(k) drmp3\_f4 w0 = DRMP3\_VSET(*w++); drmp3\_f4 w1 = DRMP3\_VSET(*w++); drmp3\_f4 vz = DRMP3\_VLD(\&zlin[4*i -\/ 64*k]); drmp3\_f4 vy = DRMP3\_VLD(\&zlin[4*i -\/ 64*(15 -\/ k)]);}}
\DoxyCodeLine{2060 \textcolor{preprocessor}{\#define DRMP3\_V0(k) \{ DRMP3\_VLOAD(k) b =               DRMP3\_VADD(DRMP3\_VMUL(vz, w1), DRMP3\_VMUL(vy, w0)) ; a =               DRMP3\_VSUB(DRMP3\_VMUL(vz, w0), DRMP3\_VMUL(vy, w1));  \}}}
\DoxyCodeLine{2061 \textcolor{preprocessor}{\#define DRMP3\_V1(k) \{ DRMP3\_VLOAD(k) b = DRMP3\_VADD(b, DRMP3\_VADD(DRMP3\_VMUL(vz, w1), DRMP3\_VMUL(vy, w0))); a = DRMP3\_VADD(a, DRMP3\_VSUB(DRMP3\_VMUL(vz, w0), DRMP3\_VMUL(vy, w1))); \}}}
\DoxyCodeLine{2062 \textcolor{preprocessor}{\#define DRMP3\_V2(k) \{ DRMP3\_VLOAD(k) b = DRMP3\_VADD(b, DRMP3\_VADD(DRMP3\_VMUL(vz, w1), DRMP3\_VMUL(vy, w0))); a = DRMP3\_VADD(a, DRMP3\_VSUB(DRMP3\_VMUL(vy, w1), DRMP3\_VMUL(vz, w0))); \}}}
\DoxyCodeLine{2063         drmp3\_f4 a, b;}
\DoxyCodeLine{2064         zlin[4*i]     = xl[18*(31 -\/ i)];}
\DoxyCodeLine{2065         zlin[4*i + 1] = xr[18*(31 -\/ i)];}
\DoxyCodeLine{2066         zlin[4*i + 2] = xl[1 + 18*(31 -\/ i)];}
\DoxyCodeLine{2067         zlin[4*i + 3] = xr[1 + 18*(31 -\/ i)];}
\DoxyCodeLine{2068         zlin[4*i + 64] = xl[1 + 18*(1 + i)];}
\DoxyCodeLine{2069         zlin[4*i + 64 + 1] = xr[1 + 18*(1 + i)];}
\DoxyCodeLine{2070         zlin[4*i -\/ 64 + 2] = xl[18*(1 + i)];}
\DoxyCodeLine{2071         zlin[4*i -\/ 64 + 3] = xr[18*(1 + i)];}
\DoxyCodeLine{2072 }
\DoxyCodeLine{2073         DRMP3\_V0(0) DRMP3\_V2(1) DRMP3\_V1(2) DRMP3\_V2(3) DRMP3\_V1(4) DRMP3\_V2(5) DRMP3\_V1(6) DRMP3\_V2(7)}
\DoxyCodeLine{2074 }
\DoxyCodeLine{2075         \{}
\DoxyCodeLine{2076 \textcolor{preprocessor}{\#ifndef DR\_MP3\_FLOAT\_OUTPUT}}
\DoxyCodeLine{2077 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SSE}}
\DoxyCodeLine{2078             \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_f4 g\_max = \{ 32767.0f, 32767.0f, 32767.0f, 32767.0f \};}
\DoxyCodeLine{2079             \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_f4 g\_min = \{ -\/32768.0f, -\/32768.0f, -\/32768.0f, -\/32768.0f \};}
\DoxyCodeLine{2080             \_\_m128i pcm8 = \_mm\_packs\_epi32(\_mm\_cvtps\_epi32(\_mm\_max\_ps(\_mm\_min\_ps(a, g\_max), g\_min)),}
\DoxyCodeLine{2081                                            \_mm\_cvtps\_epi32(\_mm\_max\_ps(\_mm\_min\_ps(b, g\_max), g\_min)));}
\DoxyCodeLine{2082             dstr[(15 -\/ i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 1);}
\DoxyCodeLine{2083             dstr[(17 + i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 5);}
\DoxyCodeLine{2084             dstl[(15 -\/ i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 0);}
\DoxyCodeLine{2085             dstl[(17 + i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 4);}
\DoxyCodeLine{2086             dstr[(47 -\/ i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 3);}
\DoxyCodeLine{2087             dstr[(49 + i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 7);}
\DoxyCodeLine{2088             dstl[(47 -\/ i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 2);}
\DoxyCodeLine{2089             dstl[(49 + i)*nch] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 6);}
\DoxyCodeLine{2090 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2091             int16x4\_t pcma, pcmb;}
\DoxyCodeLine{2092             a = DRMP3\_VADD(a, DRMP3\_VSET(0.5f));}
\DoxyCodeLine{2093             b = DRMP3\_VADD(b, DRMP3\_VSET(0.5f));}
\DoxyCodeLine{2094             pcma = vqmovn\_s32(vqaddq\_s32(vcvtq\_s32\_f32(a), vreinterpretq\_s32\_u32(vcltq\_f32(a, DRMP3\_VSET(0)))));}
\DoxyCodeLine{2095             pcmb = vqmovn\_s32(vqaddq\_s32(vcvtq\_s32\_f32(b), vreinterpretq\_s32\_u32(vcltq\_f32(b, DRMP3\_VSET(0)))));}
\DoxyCodeLine{2096             vst1\_lane\_s16(dstr + (15 -\/ i)*nch, pcma, 1);}
\DoxyCodeLine{2097             vst1\_lane\_s16(dstr + (17 + i)*nch, pcmb, 1);}
\DoxyCodeLine{2098             vst1\_lane\_s16(dstl + (15 -\/ i)*nch, pcma, 0);}
\DoxyCodeLine{2099             vst1\_lane\_s16(dstl + (17 + i)*nch, pcmb, 0);}
\DoxyCodeLine{2100             vst1\_lane\_s16(dstr + (47 -\/ i)*nch, pcma, 3);}
\DoxyCodeLine{2101             vst1\_lane\_s16(dstr + (49 + i)*nch, pcmb, 3);}
\DoxyCodeLine{2102             vst1\_lane\_s16(dstl + (47 -\/ i)*nch, pcma, 2);}
\DoxyCodeLine{2103             vst1\_lane\_s16(dstl + (49 + i)*nch, pcmb, 2);}
\DoxyCodeLine{2104 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2105 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2106             \textcolor{keyword}{static} \textcolor{keyword}{const} drmp3\_f4 g\_scale = \{ 1.0f/32768.0f, 1.0f/32768.0f, 1.0f/32768.0f, 1.0f/32768.0f \};}
\DoxyCodeLine{2107             a = DRMP3\_VMUL(a, g\_scale);}
\DoxyCodeLine{2108             b = DRMP3\_VMUL(b, g\_scale);}
\DoxyCodeLine{2109 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SSE}}
\DoxyCodeLine{2110             \_mm\_store\_ss(dstr + (15 -\/ i)*nch, \_mm\_shuffle\_ps(a, a, \_MM\_SHUFFLE(1, 1, 1, 1)));}
\DoxyCodeLine{2111             \_mm\_store\_ss(dstr + (17 + i)*nch, \_mm\_shuffle\_ps(b, b, \_MM\_SHUFFLE(1, 1, 1, 1)));}
\DoxyCodeLine{2112             \_mm\_store\_ss(dstl + (15 -\/ i)*nch, \_mm\_shuffle\_ps(a, a, \_MM\_SHUFFLE(0, 0, 0, 0)));}
\DoxyCodeLine{2113             \_mm\_store\_ss(dstl + (17 + i)*nch, \_mm\_shuffle\_ps(b, b, \_MM\_SHUFFLE(0, 0, 0, 0)));}
\DoxyCodeLine{2114             \_mm\_store\_ss(dstr + (47 -\/ i)*nch, \_mm\_shuffle\_ps(a, a, \_MM\_SHUFFLE(3, 3, 3, 3)));}
\DoxyCodeLine{2115             \_mm\_store\_ss(dstr + (49 + i)*nch, \_mm\_shuffle\_ps(b, b, \_MM\_SHUFFLE(3, 3, 3, 3)));}
\DoxyCodeLine{2116             \_mm\_store\_ss(dstl + (47 -\/ i)*nch, \_mm\_shuffle\_ps(a, a, \_MM\_SHUFFLE(2, 2, 2, 2)));}
\DoxyCodeLine{2117             \_mm\_store\_ss(dstl + (49 + i)*nch, \_mm\_shuffle\_ps(b, b, \_MM\_SHUFFLE(2, 2, 2, 2)));}
\DoxyCodeLine{2118 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2119             vst1q\_lane\_f32(dstr + (15 -\/ i)*nch, a, 1);}
\DoxyCodeLine{2120             vst1q\_lane\_f32(dstr + (17 + i)*nch, b, 1);}
\DoxyCodeLine{2121             vst1q\_lane\_f32(dstl + (15 -\/ i)*nch, a, 0);}
\DoxyCodeLine{2122             vst1q\_lane\_f32(dstl + (17 + i)*nch, b, 0);}
\DoxyCodeLine{2123             vst1q\_lane\_f32(dstr + (47 -\/ i)*nch, a, 3);}
\DoxyCodeLine{2124             vst1q\_lane\_f32(dstr + (49 + i)*nch, b, 3);}
\DoxyCodeLine{2125             vst1q\_lane\_f32(dstl + (47 -\/ i)*nch, a, 2);}
\DoxyCodeLine{2126             vst1q\_lane\_f32(dstl + (49 + i)*nch, b, 2);}
\DoxyCodeLine{2127 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2128 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* DR\_MP3\_FLOAT\_OUTPUT */}\textcolor{preprocessor}{}}
\DoxyCodeLine{2129         \}}
\DoxyCodeLine{2130     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{2131 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2132 \textcolor{preprocessor}{\#ifdef DR\_MP3\_ONLY\_SIMD}}
\DoxyCodeLine{2133     \{\} \textcolor{comment}{/* for HAVE\_SIMD=1, MINIMP3\_ONLY\_SIMD=1 case we do not need non-\/intrinsic "{}else"{} branch */}}
\DoxyCodeLine{2134 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2135     \textcolor{keywordflow}{for} (i = 14; i >= 0; i-\/-\/)}
\DoxyCodeLine{2136     \{}
\DoxyCodeLine{2137 \textcolor{preprocessor}{\#define DRMP3\_LOAD(k) float w0 = *w++; float w1 = *w++; float *vz = \&zlin[4*i -\/ k*64]; float *vy = \&zlin[4*i -\/ (15 -\/ k)*64];}}
\DoxyCodeLine{2138 \textcolor{preprocessor}{\#define DRMP3\_S0(k) \{ int j; DRMP3\_LOAD(k); for (j = 0; j < 4; j++) b[j]  = vz[j]*w1 + vy[j]*w0, a[j]  = vz[j]*w0 -\/ vy[j]*w1; \}}}
\DoxyCodeLine{2139 \textcolor{preprocessor}{\#define DRMP3\_S1(k) \{ int j; DRMP3\_LOAD(k); for (j = 0; j < 4; j++) b[j] += vz[j]*w1 + vy[j]*w0, a[j] += vz[j]*w0 -\/ vy[j]*w1; \}}}
\DoxyCodeLine{2140 \textcolor{preprocessor}{\#define DRMP3\_S2(k) \{ int j; DRMP3\_LOAD(k); for (j = 0; j < 4; j++) b[j] += vz[j]*w1 + vy[j]*w0, a[j] += vy[j]*w1 -\/ vz[j]*w0; \}}}
\DoxyCodeLine{2141         \textcolor{keywordtype}{float} a[4], b[4];}
\DoxyCodeLine{2142 }
\DoxyCodeLine{2143         zlin[4*i]     = xl[18*(31 -\/ i)];}
\DoxyCodeLine{2144         zlin[4*i + 1] = xr[18*(31 -\/ i)];}
\DoxyCodeLine{2145         zlin[4*i + 2] = xl[1 + 18*(31 -\/ i)];}
\DoxyCodeLine{2146         zlin[4*i + 3] = xr[1 + 18*(31 -\/ i)];}
\DoxyCodeLine{2147         zlin[4*(i + 16)]   = xl[1 + 18*(1 + i)];}
\DoxyCodeLine{2148         zlin[4*(i + 16) + 1] = xr[1 + 18*(1 + i)];}
\DoxyCodeLine{2149         zlin[4*(i -\/ 16) + 2] = xl[18*(1 + i)];}
\DoxyCodeLine{2150         zlin[4*(i -\/ 16) + 3] = xr[18*(1 + i)];}
\DoxyCodeLine{2151 }
\DoxyCodeLine{2152         DRMP3\_S0(0) DRMP3\_S2(1) DRMP3\_S1(2) DRMP3\_S2(3) DRMP3\_S1(4) DRMP3\_S2(5) DRMP3\_S1(6) DRMP3\_S2(7)}
\DoxyCodeLine{2153 }
\DoxyCodeLine{2154         dstr[(15 -\/ i)*nch] = drmp3d\_scale\_pcm(a[1]);}
\DoxyCodeLine{2155         dstr[(17 + i)*nch] = drmp3d\_scale\_pcm(b[1]);}
\DoxyCodeLine{2156         dstl[(15 -\/ i)*nch] = drmp3d\_scale\_pcm(a[0]);}
\DoxyCodeLine{2157         dstl[(17 + i)*nch] = drmp3d\_scale\_pcm(b[0]);}
\DoxyCodeLine{2158         dstr[(47 -\/ i)*nch] = drmp3d\_scale\_pcm(a[3]);}
\DoxyCodeLine{2159         dstr[(49 + i)*nch] = drmp3d\_scale\_pcm(b[3]);}
\DoxyCodeLine{2160         dstl[(47 -\/ i)*nch] = drmp3d\_scale\_pcm(a[2]);}
\DoxyCodeLine{2161         dstl[(49 + i)*nch] = drmp3d\_scale\_pcm(b[2]);}
\DoxyCodeLine{2162     \}}
\DoxyCodeLine{2163 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2164 \}}
\DoxyCodeLine{2165 }
\DoxyCodeLine{2166 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3d\_synth\_granule(\textcolor{keywordtype}{float} *qmf\_state, \textcolor{keywordtype}{float} *grbuf, \textcolor{keywordtype}{int} nbands, \textcolor{keywordtype}{int} nch, drmp3d\_sample\_t *pcm, \textcolor{keywordtype}{float} *lins)}
\DoxyCodeLine{2167 \{}
\DoxyCodeLine{2168     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{2169     \textcolor{keywordflow}{for} (i = 0; i < nch; i++)}
\DoxyCodeLine{2170     \{}
\DoxyCodeLine{2171         drmp3d\_DCT\_II(grbuf + 576*i, nbands);}
\DoxyCodeLine{2172     \}}
\DoxyCodeLine{2173 }
\DoxyCodeLine{2174     DRMP3\_COPY\_MEMORY(lins, qmf\_state, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*15*64);}
\DoxyCodeLine{2175 }
\DoxyCodeLine{2176     \textcolor{keywordflow}{for} (i = 0; i < nbands; i += 2)}
\DoxyCodeLine{2177     \{}
\DoxyCodeLine{2178         drmp3d\_synth(grbuf + i, pcm + 32*nch*i, nch, lins + i*64);}
\DoxyCodeLine{2179     \}}
\DoxyCodeLine{2180 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NONSTANDARD\_BUT\_LOGICAL}}
\DoxyCodeLine{2181     \textcolor{keywordflow}{if} (nch == 1)}
\DoxyCodeLine{2182     \{}
\DoxyCodeLine{2183         \textcolor{keywordflow}{for} (i = 0; i < 15*64; i += 2)}
\DoxyCodeLine{2184         \{}
\DoxyCodeLine{2185             qmf\_state[i] = lins[nbands*64 + i];}
\DoxyCodeLine{2186         \}}
\DoxyCodeLine{2187     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{2188 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2189     \{}
\DoxyCodeLine{2190         DRMP3\_COPY\_MEMORY(qmf\_state, lins + nbands*64, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*15*64);}
\DoxyCodeLine{2191     \}}
\DoxyCodeLine{2192 \}}
\DoxyCodeLine{2193 }
\DoxyCodeLine{2194 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3d\_match\_frame(\textcolor{keyword}{const} drmp3\_uint8 *hdr, \textcolor{keywordtype}{int} mp3\_bytes, \textcolor{keywordtype}{int} frame\_bytes)}
\DoxyCodeLine{2195 \{}
\DoxyCodeLine{2196     \textcolor{keywordtype}{int} i, nmatch;}
\DoxyCodeLine{2197     \textcolor{keywordflow}{for} (i = 0, nmatch = 0; nmatch < DRMP3\_MAX\_FRAME\_SYNC\_MATCHES; nmatch++)}
\DoxyCodeLine{2198     \{}
\DoxyCodeLine{2199         i += drmp3\_hdr\_frame\_bytes(hdr + i, frame\_bytes) + drmp3\_hdr\_padding(hdr + i);}
\DoxyCodeLine{2200         \textcolor{keywordflow}{if} (i + DRMP3\_HDR\_SIZE > mp3\_bytes)}
\DoxyCodeLine{2201             \textcolor{keywordflow}{return} nmatch > 0;}
\DoxyCodeLine{2202         \textcolor{keywordflow}{if} (!drmp3\_hdr\_compare(hdr, hdr + i))}
\DoxyCodeLine{2203             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2204     \}}
\DoxyCodeLine{2205     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2206 \}}
\DoxyCodeLine{2207 }
\DoxyCodeLine{2208 \textcolor{keyword}{static} \textcolor{keywordtype}{int} drmp3d\_find\_frame(\textcolor{keyword}{const} drmp3\_uint8 *mp3, \textcolor{keywordtype}{int} mp3\_bytes, \textcolor{keywordtype}{int} *free\_format\_bytes, \textcolor{keywordtype}{int} *ptr\_frame\_bytes)}
\DoxyCodeLine{2209 \{}
\DoxyCodeLine{2210     \textcolor{keywordtype}{int} i, k;}
\DoxyCodeLine{2211     \textcolor{keywordflow}{for} (i = 0; i < mp3\_bytes -\/ DRMP3\_HDR\_SIZE; i++, mp3++)}
\DoxyCodeLine{2212     \{}
\DoxyCodeLine{2213         \textcolor{keywordflow}{if} (drmp3\_hdr\_valid(mp3))}
\DoxyCodeLine{2214         \{}
\DoxyCodeLine{2215             \textcolor{keywordtype}{int} frame\_bytes = drmp3\_hdr\_frame\_bytes(mp3, *free\_format\_bytes);}
\DoxyCodeLine{2216             \textcolor{keywordtype}{int} frame\_and\_padding = frame\_bytes + drmp3\_hdr\_padding(mp3);}
\DoxyCodeLine{2217 }
\DoxyCodeLine{2218             \textcolor{keywordflow}{for} (k = DRMP3\_HDR\_SIZE; !frame\_bytes \&\& k < DRMP3\_MAX\_FREE\_FORMAT\_FRAME\_SIZE \&\& i + 2*k < mp3\_bytes -\/ DRMP3\_HDR\_SIZE; k++)}
\DoxyCodeLine{2219             \{}
\DoxyCodeLine{2220                 \textcolor{keywordflow}{if} (drmp3\_hdr\_compare(mp3, mp3 + k))}
\DoxyCodeLine{2221                 \{}
\DoxyCodeLine{2222                     \textcolor{keywordtype}{int} fb = k -\/ drmp3\_hdr\_padding(mp3);}
\DoxyCodeLine{2223                     \textcolor{keywordtype}{int} nextfb = fb + drmp3\_hdr\_padding(mp3 + k);}
\DoxyCodeLine{2224                     \textcolor{keywordflow}{if} (i + k + nextfb + DRMP3\_HDR\_SIZE > mp3\_bytes || !drmp3\_hdr\_compare(mp3, mp3 + k + nextfb))}
\DoxyCodeLine{2225                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2226                     frame\_and\_padding = k;}
\DoxyCodeLine{2227                     frame\_bytes = fb;}
\DoxyCodeLine{2228                     *free\_format\_bytes = fb;}
\DoxyCodeLine{2229                 \}}
\DoxyCodeLine{2230             \}}
\DoxyCodeLine{2231 }
\DoxyCodeLine{2232             \textcolor{keywordflow}{if} ((frame\_bytes \&\& i + frame\_and\_padding <= mp3\_bytes \&\&}
\DoxyCodeLine{2233                 drmp3d\_match\_frame(mp3, mp3\_bytes -\/ i, frame\_bytes)) ||}
\DoxyCodeLine{2234                 (!i \&\& frame\_and\_padding == mp3\_bytes))}
\DoxyCodeLine{2235             \{}
\DoxyCodeLine{2236                 *ptr\_frame\_bytes = frame\_and\_padding;}
\DoxyCodeLine{2237                 \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{2238             \}}
\DoxyCodeLine{2239             *free\_format\_bytes = 0;}
\DoxyCodeLine{2240         \}}
\DoxyCodeLine{2241     \}}
\DoxyCodeLine{2242     *ptr\_frame\_bytes = 0;}
\DoxyCodeLine{2243     \textcolor{keywordflow}{return} mp3\_bytes;}
\DoxyCodeLine{2244 \}}
\DoxyCodeLine{2245 }
\DoxyCodeLine{2246 DRMP3\_API \textcolor{keywordtype}{void} drmp3dec\_init(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *dec)}
\DoxyCodeLine{2247 \{}
\DoxyCodeLine{2248     dec-\/>header[0] = 0;}
\DoxyCodeLine{2249 \}}
\DoxyCodeLine{2250 }
\DoxyCodeLine{2251 DRMP3\_API \textcolor{keywordtype}{int} drmp3dec\_decode\_frame(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}} *dec, \textcolor{keyword}{const} drmp3\_uint8 *mp3, \textcolor{keywordtype}{int} mp3\_bytes, \textcolor{keywordtype}{void} *pcm, \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}} *info)}
\DoxyCodeLine{2252 \{}
\DoxyCodeLine{2253     \textcolor{keywordtype}{int} i = 0, igr, frame\_size = 0, success = 1;}
\DoxyCodeLine{2254     \textcolor{keyword}{const} drmp3\_uint8 *hdr;}
\DoxyCodeLine{2255     drmp3\_bs bs\_frame[1];}
\DoxyCodeLine{2256     drmp3dec\_scratch scratch;}
\DoxyCodeLine{2257 }
\DoxyCodeLine{2258     \textcolor{keywordflow}{if} (mp3\_bytes > 4 \&\& dec-\/>header[0] == 0xff \&\& drmp3\_hdr\_compare(dec-\/>header, mp3))}
\DoxyCodeLine{2259     \{}
\DoxyCodeLine{2260         frame\_size = drmp3\_hdr\_frame\_bytes(mp3, dec-\/>free\_format\_bytes) + drmp3\_hdr\_padding(mp3);}
\DoxyCodeLine{2261         \textcolor{keywordflow}{if} (frame\_size != mp3\_bytes \&\& (frame\_size + DRMP3\_HDR\_SIZE > mp3\_bytes || !drmp3\_hdr\_compare(mp3, mp3 + frame\_size)))}
\DoxyCodeLine{2262         \{}
\DoxyCodeLine{2263             frame\_size = 0;}
\DoxyCodeLine{2264         \}}
\DoxyCodeLine{2265     \}}
\DoxyCodeLine{2266     \textcolor{keywordflow}{if} (!frame\_size)}
\DoxyCodeLine{2267     \{}
\DoxyCodeLine{2268         DRMP3\_ZERO\_MEMORY(dec, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdrmp3dec}{drmp3dec}}));}
\DoxyCodeLine{2269         i = drmp3d\_find\_frame(mp3, mp3\_bytes, \&dec-\/>free\_format\_bytes, \&frame\_size);}
\DoxyCodeLine{2270         \textcolor{keywordflow}{if} (!frame\_size || i + frame\_size > mp3\_bytes)}
\DoxyCodeLine{2271         \{}
\DoxyCodeLine{2272             info-\/>frame\_bytes = i;}
\DoxyCodeLine{2273             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2274         \}}
\DoxyCodeLine{2275     \}}
\DoxyCodeLine{2276 }
\DoxyCodeLine{2277     hdr = mp3 + i;}
\DoxyCodeLine{2278     DRMP3\_COPY\_MEMORY(dec-\/>header, hdr, DRMP3\_HDR\_SIZE);}
\DoxyCodeLine{2279     info-\/>frame\_bytes = i + frame\_size;}
\DoxyCodeLine{2280     info-\/>channels = DRMP3\_HDR\_IS\_MONO(hdr) ? 1 : 2;}
\DoxyCodeLine{2281     info-\/>hz = drmp3\_hdr\_sample\_rate\_hz(hdr);}
\DoxyCodeLine{2282     info-\/>layer = 4 -\/ DRMP3\_HDR\_GET\_LAYER(hdr);}
\DoxyCodeLine{2283     info-\/>bitrate\_kbps = drmp3\_hdr\_bitrate\_kbps(hdr);}
\DoxyCodeLine{2284 }
\DoxyCodeLine{2285     drmp3\_bs\_init(bs\_frame, hdr + DRMP3\_HDR\_SIZE, frame\_size -\/ DRMP3\_HDR\_SIZE);}
\DoxyCodeLine{2286     \textcolor{keywordflow}{if} (DRMP3\_HDR\_IS\_CRC(hdr))}
\DoxyCodeLine{2287     \{}
\DoxyCodeLine{2288         drmp3\_bs\_get\_bits(bs\_frame, 16);}
\DoxyCodeLine{2289     \}}
\DoxyCodeLine{2290 }
\DoxyCodeLine{2291     \textcolor{keywordflow}{if} (info-\/>layer == 3)}
\DoxyCodeLine{2292     \{}
\DoxyCodeLine{2293         \textcolor{keywordtype}{int} main\_data\_begin = drmp3\_L3\_read\_side\_info(bs\_frame, scratch.gr\_info, hdr);}
\DoxyCodeLine{2294         \textcolor{keywordflow}{if} (main\_data\_begin < 0 || bs\_frame-\/>pos > bs\_frame-\/>limit)}
\DoxyCodeLine{2295         \{}
\DoxyCodeLine{2296             drmp3dec\_init(dec);}
\DoxyCodeLine{2297             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2298         \}}
\DoxyCodeLine{2299         success = drmp3\_L3\_restore\_reservoir(dec, bs\_frame, \&scratch, main\_data\_begin);}
\DoxyCodeLine{2300         \textcolor{keywordflow}{if} (success \&\& pcm != NULL)}
\DoxyCodeLine{2301         \{}
\DoxyCodeLine{2302             \textcolor{keywordflow}{for} (igr = 0; igr < (DRMP3\_HDR\_TEST\_MPEG1(hdr) ? 2 : 1); igr++, pcm = DRMP3\_OFFSET\_PTR(pcm, \textcolor{keyword}{sizeof}(drmp3d\_sample\_t)*576*info-\/>channels))}
\DoxyCodeLine{2303             \{}
\DoxyCodeLine{2304                 DRMP3\_ZERO\_MEMORY(scratch.grbuf[0], 576*2*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{2305                 drmp3\_L3\_decode(dec, \&scratch, scratch.gr\_info + igr*info-\/>channels, info-\/>channels);}
\DoxyCodeLine{2306                 drmp3d\_synth\_granule(dec-\/>qmf\_state, scratch.grbuf[0], 18, info-\/>channels, (drmp3d\_sample\_t*)pcm, scratch.syn[0]);}
\DoxyCodeLine{2307             \}}
\DoxyCodeLine{2308         \}}
\DoxyCodeLine{2309         drmp3\_L3\_save\_reservoir(dec, \&scratch);}
\DoxyCodeLine{2310     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{2311     \{}
\DoxyCodeLine{2312 \textcolor{preprocessor}{\#ifdef DR\_MP3\_ONLY\_MP3}}
\DoxyCodeLine{2313         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2314 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2315         drmp3\_L12\_scale\_info sci[1];}
\DoxyCodeLine{2316 }
\DoxyCodeLine{2317         \textcolor{keywordflow}{if} (pcm == NULL) \{}
\DoxyCodeLine{2318             \textcolor{keywordflow}{return} drmp3\_hdr\_frame\_samples(hdr);}
\DoxyCodeLine{2319         \}}
\DoxyCodeLine{2320 }
\DoxyCodeLine{2321         drmp3\_L12\_read\_scale\_info(hdr, bs\_frame, sci);}
\DoxyCodeLine{2322 }
\DoxyCodeLine{2323         DRMP3\_ZERO\_MEMORY(scratch.grbuf[0], 576*2*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{2324         \textcolor{keywordflow}{for} (i = 0, igr = 0; igr < 3; igr++)}
\DoxyCodeLine{2325         \{}
\DoxyCodeLine{2326             \textcolor{keywordflow}{if} (12 == (i += drmp3\_L12\_dequantize\_granule(scratch.grbuf[0] + i, bs\_frame, sci, info-\/>layer | 1)))}
\DoxyCodeLine{2327             \{}
\DoxyCodeLine{2328                 i = 0;}
\DoxyCodeLine{2329                 drmp3\_L12\_apply\_scf\_384(sci, sci-\/>scf + igr, scratch.grbuf[0]);}
\DoxyCodeLine{2330                 drmp3d\_synth\_granule(dec-\/>qmf\_state, scratch.grbuf[0], 12, info-\/>channels, (drmp3d\_sample\_t*)pcm, scratch.syn[0]);}
\DoxyCodeLine{2331                 DRMP3\_ZERO\_MEMORY(scratch.grbuf[0], 576*2*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{2332                 pcm = DRMP3\_OFFSET\_PTR(pcm, \textcolor{keyword}{sizeof}(drmp3d\_sample\_t)*384*info-\/>channels);}
\DoxyCodeLine{2333             \}}
\DoxyCodeLine{2334             \textcolor{keywordflow}{if} (bs\_frame-\/>pos > bs\_frame-\/>limit)}
\DoxyCodeLine{2335             \{}
\DoxyCodeLine{2336                 drmp3dec\_init(dec);}
\DoxyCodeLine{2337                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2338             \}}
\DoxyCodeLine{2339         \}}
\DoxyCodeLine{2340 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2341     \}}
\DoxyCodeLine{2342 }
\DoxyCodeLine{2343     \textcolor{keywordflow}{return} success*drmp3\_hdr\_frame\_samples(dec-\/>header);}
\DoxyCodeLine{2344 \}}
\DoxyCodeLine{2345 }
\DoxyCodeLine{2346 DRMP3\_API \textcolor{keywordtype}{void} drmp3dec\_f32\_to\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *in, drmp3\_int16 *out, \textcolor{keywordtype}{size\_t} num\_samples)}
\DoxyCodeLine{2347 \{}
\DoxyCodeLine{2348     \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{2349 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SIMD}}
\DoxyCodeLine{2350     \textcolor{keywordtype}{size\_t} aligned\_count = num\_samples \& \string~7;}
\DoxyCodeLine{2351     \textcolor{keywordflow}{for}(; i < aligned\_count; i+=8)}
\DoxyCodeLine{2352     \{}
\DoxyCodeLine{2353         drmp3\_f4 scale = DRMP3\_VSET(32768.0f);}
\DoxyCodeLine{2354         drmp3\_f4 a = DRMP3\_VMUL(DRMP3\_VLD(\&in[i  ]), scale);}
\DoxyCodeLine{2355         drmp3\_f4 b = DRMP3\_VMUL(DRMP3\_VLD(\&in[i+4]), scale);}
\DoxyCodeLine{2356 \textcolor{preprocessor}{\#if DRMP3\_HAVE\_SSE}}
\DoxyCodeLine{2357         drmp3\_f4 s16max = DRMP3\_VSET( 32767.0f);}
\DoxyCodeLine{2358         drmp3\_f4 s16min = DRMP3\_VSET(-\/32768.0f);}
\DoxyCodeLine{2359         \_\_m128i pcm8 = \_mm\_packs\_epi32(\_mm\_cvtps\_epi32(\_mm\_max\_ps(\_mm\_min\_ps(a, s16max), s16min)),}
\DoxyCodeLine{2360                                         \_mm\_cvtps\_epi32(\_mm\_max\_ps(\_mm\_min\_ps(b, s16max), s16min)));}
\DoxyCodeLine{2361         out[i  ] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 0);}
\DoxyCodeLine{2362         out[i+1] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 1);}
\DoxyCodeLine{2363         out[i+2] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 2);}
\DoxyCodeLine{2364         out[i+3] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 3);}
\DoxyCodeLine{2365         out[i+4] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 4);}
\DoxyCodeLine{2366         out[i+5] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 5);}
\DoxyCodeLine{2367         out[i+6] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 6);}
\DoxyCodeLine{2368         out[i+7] = (drmp3\_int16)\_mm\_extract\_epi16(pcm8, 7);}
\DoxyCodeLine{2369 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2370         int16x4\_t pcma, pcmb;}
\DoxyCodeLine{2371         a = DRMP3\_VADD(a, DRMP3\_VSET(0.5f));}
\DoxyCodeLine{2372         b = DRMP3\_VADD(b, DRMP3\_VSET(0.5f));}
\DoxyCodeLine{2373         pcma = vqmovn\_s32(vqaddq\_s32(vcvtq\_s32\_f32(a), vreinterpretq\_s32\_u32(vcltq\_f32(a, DRMP3\_VSET(0)))));}
\DoxyCodeLine{2374         pcmb = vqmovn\_s32(vqaddq\_s32(vcvtq\_s32\_f32(b), vreinterpretq\_s32\_u32(vcltq\_f32(b, DRMP3\_VSET(0)))));}
\DoxyCodeLine{2375         vst1\_lane\_s16(out+i  , pcma, 0);}
\DoxyCodeLine{2376         vst1\_lane\_s16(out+i+1, pcma, 1);}
\DoxyCodeLine{2377         vst1\_lane\_s16(out+i+2, pcma, 2);}
\DoxyCodeLine{2378         vst1\_lane\_s16(out+i+3, pcma, 3);}
\DoxyCodeLine{2379         vst1\_lane\_s16(out+i+4, pcmb, 0);}
\DoxyCodeLine{2380         vst1\_lane\_s16(out+i+5, pcmb, 1);}
\DoxyCodeLine{2381         vst1\_lane\_s16(out+i+6, pcmb, 2);}
\DoxyCodeLine{2382         vst1\_lane\_s16(out+i+7, pcmb, 3);}
\DoxyCodeLine{2383 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2384     \}}
\DoxyCodeLine{2385 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2386     \textcolor{keywordflow}{for}(; i < num\_samples; i++)}
\DoxyCodeLine{2387     \{}
\DoxyCodeLine{2388         \textcolor{keywordtype}{float} \mbox{\hyperlink{structsample}{sample}} = in[i] * 32768.0f;}
\DoxyCodeLine{2389         \textcolor{keywordflow}{if} (\mbox{\hyperlink{structsample}{sample}} >=  32766.5)}
\DoxyCodeLine{2390             out[i] = (drmp3\_int16) 32767;}
\DoxyCodeLine{2391         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{structsample}{sample}} <= -\/32767.5)}
\DoxyCodeLine{2392             out[i] = (drmp3\_int16)-\/32768;}
\DoxyCodeLine{2393         \textcolor{keywordflow}{else}}
\DoxyCodeLine{2394         \{}
\DoxyCodeLine{2395             \textcolor{keywordtype}{short} s = (drmp3\_int16)(\mbox{\hyperlink{structsample}{sample}} + .5f);}
\DoxyCodeLine{2396             s -\/= (s < 0);   \textcolor{comment}{/* away from zero, to be compliant */}}
\DoxyCodeLine{2397             out[i] = s;}
\DoxyCodeLine{2398         \}}
\DoxyCodeLine{2399     \}}
\DoxyCodeLine{2400 \}}
\DoxyCodeLine{2401 }
\DoxyCodeLine{2402 }
\DoxyCodeLine{2403 }
\DoxyCodeLine{2404 \textcolor{comment}{/************************************************************************************************************************************************************}}
\DoxyCodeLine{2405 \textcolor{comment}{}}
\DoxyCodeLine{2406 \textcolor{comment}{ Main Public API}}
\DoxyCodeLine{2407 \textcolor{comment}{}}
\DoxyCodeLine{2408 \textcolor{comment}{ ************************************************************************************************************************************************************/}}
\DoxyCodeLine{2409 \textcolor{preprocessor}{\#include <math.h>}   \textcolor{comment}{/* For sin() and exp(). */}}
\DoxyCodeLine{2410 }
\DoxyCodeLine{2411 \textcolor{preprocessor}{\#if defined(SIZE\_MAX)}}
\DoxyCodeLine{2412 \textcolor{preprocessor}{    \#define DRMP3\_SIZE\_MAX  SIZE\_MAX}}
\DoxyCodeLine{2413 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2414 \textcolor{preprocessor}{    \#if defined(\_WIN64) || defined(\_LP64) || defined(\_\_LP64\_\_)}}
\DoxyCodeLine{2415 \textcolor{preprocessor}{        \#define DRMP3\_SIZE\_MAX  ((drmp3\_uint64)0xFFFFFFFFFFFFFFFF)}}
\DoxyCodeLine{2416 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{2417 \textcolor{preprocessor}{        \#define DRMP3\_SIZE\_MAX  0xFFFFFFFF}}
\DoxyCodeLine{2418 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2419 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2420 }
\DoxyCodeLine{2421 \textcolor{comment}{/* Options. */}}
\DoxyCodeLine{2422 \textcolor{preprocessor}{\#ifndef DRMP3\_SEEK\_LEADING\_MP3\_FRAMES}}
\DoxyCodeLine{2423 \textcolor{preprocessor}{\#define DRMP3\_SEEK\_LEADING\_MP3\_FRAMES   2}}
\DoxyCodeLine{2424 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2425 }
\DoxyCodeLine{2426 \textcolor{preprocessor}{\#define DRMP3\_MIN\_DATA\_CHUNK\_SIZE   16384}}
\DoxyCodeLine{2427 }
\DoxyCodeLine{2428 \textcolor{comment}{/* The size in bytes of each chunk of data to read from the MP3 stream. minimp3 recommends at least 16K, but in an attempt to reduce data movement I'm making this slightly larger. */}}
\DoxyCodeLine{2429 \textcolor{preprocessor}{\#ifndef DRMP3\_DATA\_CHUNK\_SIZE}}
\DoxyCodeLine{2430 \textcolor{preprocessor}{\#define DRMP3\_DATA\_CHUNK\_SIZE  DRMP3\_MIN\_DATA\_CHUNK\_SIZE*4}}
\DoxyCodeLine{2431 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2432 }
\DoxyCodeLine{2433 }
\DoxyCodeLine{2434 \textcolor{preprocessor}{\#define DRMP3\_COUNTOF(x)        (sizeof(x) / sizeof(x[0]))}}
\DoxyCodeLine{2435 \textcolor{preprocessor}{\#define DRMP3\_CLAMP(x, lo, hi)  (DRMP3\_MAX(lo, DRMP3\_MIN(x, hi)))}}
\DoxyCodeLine{2436 }
\DoxyCodeLine{2437 \textcolor{preprocessor}{\#ifndef DRMP3\_PI\_D}}
\DoxyCodeLine{2438 \textcolor{preprocessor}{\#define DRMP3\_PI\_D    3.14159265358979323846264}}
\DoxyCodeLine{2439 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2440 }
\DoxyCodeLine{2441 \textcolor{preprocessor}{\#define DRMP3\_DEFAULT\_RESAMPLER\_LPF\_ORDER   2}}
\DoxyCodeLine{2442 }
\DoxyCodeLine{2443 \textcolor{keyword}{static} DRMP3\_INLINE \textcolor{keywordtype}{float} drmp3\_mix\_f32(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} a)}
\DoxyCodeLine{2444 \{}
\DoxyCodeLine{2445     \textcolor{keywordflow}{return} x*(1-\/a) + y*a;}
\DoxyCodeLine{2446 \}}
\DoxyCodeLine{2447 \textcolor{keyword}{static} DRMP3\_INLINE \textcolor{keywordtype}{float} drmp3\_mix\_f32\_fast(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} a)}
\DoxyCodeLine{2448 \{}
\DoxyCodeLine{2449     \textcolor{keywordtype}{float} r0 = (y -\/ x);}
\DoxyCodeLine{2450     \textcolor{keywordtype}{float} r1 = r0*a;}
\DoxyCodeLine{2451     \textcolor{keywordflow}{return} x + r1;}
\DoxyCodeLine{2452     \textcolor{comment}{/*return x + (y -\/ x)*a;*/}}
\DoxyCodeLine{2453 \}}
\DoxyCodeLine{2454 }
\DoxyCodeLine{2455 }
\DoxyCodeLine{2456 \textcolor{comment}{/*}}
\DoxyCodeLine{2457 \textcolor{comment}{Greatest common factor using Euclid's algorithm iteratively.}}
\DoxyCodeLine{2458 \textcolor{comment}{*/}}
\DoxyCodeLine{2459 \textcolor{keyword}{static} DRMP3\_INLINE drmp3\_uint32 drmp3\_gcf\_u32(drmp3\_uint32 a, drmp3\_uint32 b)}
\DoxyCodeLine{2460 \{}
\DoxyCodeLine{2461     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{2462         \textcolor{keywordflow}{if} (b == 0) \{}
\DoxyCodeLine{2463             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2464         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2465             drmp3\_uint32 t = a;}
\DoxyCodeLine{2466             a = b;}
\DoxyCodeLine{2467             b = t \% a;}
\DoxyCodeLine{2468         \}}
\DoxyCodeLine{2469     \}}
\DoxyCodeLine{2470 }
\DoxyCodeLine{2471     \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{2472 \}}
\DoxyCodeLine{2473 }
\DoxyCodeLine{2474 }
\DoxyCodeLine{2475 \textcolor{keyword}{static} DRMP3\_INLINE \textcolor{keywordtype}{double} drmp3\_sin(\textcolor{keywordtype}{double} x)}
\DoxyCodeLine{2476 \{}
\DoxyCodeLine{2477     \textcolor{comment}{/* TODO: Implement custom sin(x). */}}
\DoxyCodeLine{2478     \textcolor{keywordflow}{return} sin(x);}
\DoxyCodeLine{2479 \}}
\DoxyCodeLine{2480 }
\DoxyCodeLine{2481 \textcolor{keyword}{static} DRMP3\_INLINE \textcolor{keywordtype}{double} drmp3\_exp(\textcolor{keywordtype}{double} x)}
\DoxyCodeLine{2482 \{}
\DoxyCodeLine{2483     \textcolor{comment}{/* TODO: Implement custom exp(x). */}}
\DoxyCodeLine{2484     \textcolor{keywordflow}{return} exp(x);}
\DoxyCodeLine{2485 \}}
\DoxyCodeLine{2486 }
\DoxyCodeLine{2487 \textcolor{keyword}{static} DRMP3\_INLINE \textcolor{keywordtype}{double} drmp3\_cos(\textcolor{keywordtype}{double} x)}
\DoxyCodeLine{2488 \{}
\DoxyCodeLine{2489     \textcolor{keywordflow}{return} drmp3\_sin((DRMP3\_PI\_D*0.5) -\/ x);}
\DoxyCodeLine{2490 \}}
\DoxyCodeLine{2491 }
\DoxyCodeLine{2492 }
\DoxyCodeLine{2493 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drmp3\_\_malloc\_default(\textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{2494 \{}
\DoxyCodeLine{2495     (void)pUserData;}
\DoxyCodeLine{2496     \textcolor{keywordflow}{return} DRMP3\_MALLOC(sz);}
\DoxyCodeLine{2497 \}}
\DoxyCodeLine{2498 }
\DoxyCodeLine{2499 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drmp3\_\_realloc\_default(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} sz, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{2500 \{}
\DoxyCodeLine{2501     (void)pUserData;}
\DoxyCodeLine{2502     \textcolor{keywordflow}{return} DRMP3\_REALLOC(p, sz);}
\DoxyCodeLine{2503 \}}
\DoxyCodeLine{2504 }
\DoxyCodeLine{2505 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_\_free\_default(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{void}* pUserData)}
\DoxyCodeLine{2506 \{}
\DoxyCodeLine{2507     (void)pUserData;}
\DoxyCodeLine{2508     DRMP3\_FREE(p);}
\DoxyCodeLine{2509 \}}
\DoxyCodeLine{2510 }
\DoxyCodeLine{2511 }
\DoxyCodeLine{2512 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drmp3\_\_malloc\_from\_callbacks(\textcolor{keywordtype}{size\_t} sz, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2513 \{}
\DoxyCodeLine{2514     \textcolor{keywordflow}{if} (pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{2515         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{2516     \}}
\DoxyCodeLine{2517 }
\DoxyCodeLine{2518     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onMalloc != NULL) \{}
\DoxyCodeLine{2519         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onMalloc(sz, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2520     \}}
\DoxyCodeLine{2521 }
\DoxyCodeLine{2522     \textcolor{comment}{/* Try using realloc(). */}}
\DoxyCodeLine{2523     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onRealloc != NULL) \{}
\DoxyCodeLine{2524         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onRealloc(NULL, sz, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2525     \}}
\DoxyCodeLine{2526 }
\DoxyCodeLine{2527     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{2528 \}}
\DoxyCodeLine{2529 }
\DoxyCodeLine{2530 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* drmp3\_\_realloc\_from\_callbacks(\textcolor{keywordtype}{void}* p, \textcolor{keywordtype}{size\_t} szNew, \textcolor{keywordtype}{size\_t} szOld, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2531 \{}
\DoxyCodeLine{2532     \textcolor{keywordflow}{if} (pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{2533         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{2534     \}}
\DoxyCodeLine{2535 }
\DoxyCodeLine{2536     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onRealloc != NULL) \{}
\DoxyCodeLine{2537         \textcolor{keywordflow}{return} pAllocationCallbacks-\/>onRealloc(p, szNew, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2538     \}}
\DoxyCodeLine{2539 }
\DoxyCodeLine{2540     \textcolor{comment}{/* Try emulating realloc() in terms of malloc()/free(). */}}
\DoxyCodeLine{2541     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onMalloc != NULL \&\& pAllocationCallbacks-\/>onFree != NULL) \{}
\DoxyCodeLine{2542         \textcolor{keywordtype}{void}* p2;}
\DoxyCodeLine{2543 }
\DoxyCodeLine{2544         p2 = pAllocationCallbacks-\/>onMalloc(szNew, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2545         \textcolor{keywordflow}{if} (p2 == NULL) \{}
\DoxyCodeLine{2546             \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{2547         \}}
\DoxyCodeLine{2548 }
\DoxyCodeLine{2549         \textcolor{keywordflow}{if} (p != NULL) \{}
\DoxyCodeLine{2550             DRMP3\_COPY\_MEMORY(p2, p, szOld);}
\DoxyCodeLine{2551             pAllocationCallbacks-\/>onFree(p, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2552         \}}
\DoxyCodeLine{2553 }
\DoxyCodeLine{2554         \textcolor{keywordflow}{return} p2;}
\DoxyCodeLine{2555     \}}
\DoxyCodeLine{2556 }
\DoxyCodeLine{2557     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{2558 \}}
\DoxyCodeLine{2559 }
\DoxyCodeLine{2560 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_\_free\_from\_callbacks(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2561 \{}
\DoxyCodeLine{2562     \textcolor{keywordflow}{if} (p == NULL || pAllocationCallbacks == NULL) \{}
\DoxyCodeLine{2563         \textcolor{keywordflow}{return};}
\DoxyCodeLine{2564     \}}
\DoxyCodeLine{2565 }
\DoxyCodeLine{2566     \textcolor{keywordflow}{if} (pAllocationCallbacks-\/>onFree != NULL) \{}
\DoxyCodeLine{2567         pAllocationCallbacks-\/>onFree(p, pAllocationCallbacks-\/>pUserData);}
\DoxyCodeLine{2568     \}}
\DoxyCodeLine{2569 \}}
\DoxyCodeLine{2570 }
\DoxyCodeLine{2571 }
\DoxyCodeLine{2572 \textcolor{keyword}{static} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}} drmp3\_copy\_allocation\_callbacks\_or\_defaults(\textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2573 \{}
\DoxyCodeLine{2574     \textcolor{keywordflow}{if} (pAllocationCallbacks != NULL) \{}
\DoxyCodeLine{2575         \textcolor{comment}{/* Copy. */}}
\DoxyCodeLine{2576         \textcolor{keywordflow}{return} *pAllocationCallbacks;}
\DoxyCodeLine{2577     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2578         \textcolor{comment}{/* Defaults. */}}
\DoxyCodeLine{2579         \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}} allocationCallbacks;}
\DoxyCodeLine{2580         allocationCallbacks.pUserData = NULL;}
\DoxyCodeLine{2581         allocationCallbacks.onMalloc  = drmp3\_\_malloc\_default;}
\DoxyCodeLine{2582         allocationCallbacks.onRealloc = drmp3\_\_realloc\_default;}
\DoxyCodeLine{2583         allocationCallbacks.onFree    = drmp3\_\_free\_default;}
\DoxyCodeLine{2584         \textcolor{keywordflow}{return} allocationCallbacks;}
\DoxyCodeLine{2585     \}}
\DoxyCodeLine{2586 \}}
\DoxyCodeLine{2587 }
\DoxyCodeLine{2588 }
\DoxyCodeLine{2589 }
\DoxyCodeLine{2590 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drmp3\_\_on\_read(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keywordtype}{void}* pBufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{2591 \{}
\DoxyCodeLine{2592     \textcolor{keywordtype}{size\_t} bytesRead = pMP3-\/>onRead(pMP3-\/>pUserData, pBufferOut, bytesToRead);}
\DoxyCodeLine{2593     pMP3-\/>streamCursor += bytesRead;}
\DoxyCodeLine{2594     \textcolor{keywordflow}{return} bytesRead;}
\DoxyCodeLine{2595 \}}
\DoxyCodeLine{2596 }
\DoxyCodeLine{2597 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_\_on\_seek(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keywordtype}{int} offset, drmp3\_seek\_origin origin)}
\DoxyCodeLine{2598 \{}
\DoxyCodeLine{2599     DRMP3\_ASSERT(offset >= 0);}
\DoxyCodeLine{2600 }
\DoxyCodeLine{2601     \textcolor{keywordflow}{if} (!pMP3-\/>onSeek(pMP3-\/>pUserData, offset, origin)) \{}
\DoxyCodeLine{2602         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2603     \}}
\DoxyCodeLine{2604 }
\DoxyCodeLine{2605     \textcolor{keywordflow}{if} (origin == drmp3\_seek\_origin\_start) \{}
\DoxyCodeLine{2606         pMP3-\/>streamCursor = (drmp3\_uint64)offset;}
\DoxyCodeLine{2607     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2608         pMP3-\/>streamCursor += offset;}
\DoxyCodeLine{2609     \}}
\DoxyCodeLine{2610 }
\DoxyCodeLine{2611     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{2612 \}}
\DoxyCodeLine{2613 }
\DoxyCodeLine{2614 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_\_on\_seek\_64(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 offset, drmp3\_seek\_origin origin)}
\DoxyCodeLine{2615 \{}
\DoxyCodeLine{2616     \textcolor{keywordflow}{if} (offset <= 0x7FFFFFFF) \{}
\DoxyCodeLine{2617         \textcolor{keywordflow}{return} drmp3\_\_on\_seek(pMP3, (\textcolor{keywordtype}{int})offset, origin);}
\DoxyCodeLine{2618     \}}
\DoxyCodeLine{2619 }
\DoxyCodeLine{2620 }
\DoxyCodeLine{2621     \textcolor{comment}{/* Getting here "{}offset"{} is too large for a 32-\/bit integer. We just keep seeking forward until we hit the offset. */}}
\DoxyCodeLine{2622     \textcolor{keywordflow}{if} (!drmp3\_\_on\_seek(pMP3, 0x7FFFFFFF, drmp3\_seek\_origin\_start)) \{}
\DoxyCodeLine{2623         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2624     \}}
\DoxyCodeLine{2625 }
\DoxyCodeLine{2626     offset -\/= 0x7FFFFFFF;}
\DoxyCodeLine{2627     \textcolor{keywordflow}{while} (offset > 0) \{}
\DoxyCodeLine{2628         \textcolor{keywordflow}{if} (offset <= 0x7FFFFFFF) \{}
\DoxyCodeLine{2629             \textcolor{keywordflow}{if} (!drmp3\_\_on\_seek(pMP3, (\textcolor{keywordtype}{int})offset, drmp3\_seek\_origin\_current)) \{}
\DoxyCodeLine{2630                 \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2631             \}}
\DoxyCodeLine{2632             offset = 0;}
\DoxyCodeLine{2633         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2634             \textcolor{keywordflow}{if} (!drmp3\_\_on\_seek(pMP3, 0x7FFFFFFF, drmp3\_seek\_origin\_current)) \{}
\DoxyCodeLine{2635                 \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2636             \}}
\DoxyCodeLine{2637             offset -\/= 0x7FFFFFFF;}
\DoxyCodeLine{2638         \}}
\DoxyCodeLine{2639     \}}
\DoxyCodeLine{2640 }
\DoxyCodeLine{2641     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{2642 \}}
\DoxyCodeLine{2643 }
\DoxyCodeLine{2644 }
\DoxyCodeLine{2645 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_decode\_next\_frame\_ex\_\_callbacks(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3d\_sample\_t* pPCMFrames)}
\DoxyCodeLine{2646 \{}
\DoxyCodeLine{2647     drmp3\_uint32 pcmFramesRead = 0;}
\DoxyCodeLine{2648 }
\DoxyCodeLine{2649     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2650     DRMP3\_ASSERT(pMP3-\/>onRead != NULL);}
\DoxyCodeLine{2651 }
\DoxyCodeLine{2652     \textcolor{keywordflow}{if} (pMP3-\/>atEnd) \{}
\DoxyCodeLine{2653         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2654     \}}
\DoxyCodeLine{2655 }
\DoxyCodeLine{2656     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{2657         \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}} info;}
\DoxyCodeLine{2658 }
\DoxyCodeLine{2659         \textcolor{comment}{/* minimp3 recommends doing data submission in chunks of at least 16K. If we don't have at least 16K bytes available, get more. */}}
\DoxyCodeLine{2660         \textcolor{keywordflow}{if} (pMP3-\/>dataSize < DRMP3\_MIN\_DATA\_CHUNK\_SIZE) \{}
\DoxyCodeLine{2661             \textcolor{keywordtype}{size\_t} bytesRead;}
\DoxyCodeLine{2662 }
\DoxyCodeLine{2663             \textcolor{comment}{/* First we need to move the data down. */}}
\DoxyCodeLine{2664             \textcolor{keywordflow}{if} (pMP3-\/>pData != NULL) \{}
\DoxyCodeLine{2665                 DRMP3\_MOVE\_MEMORY(pMP3-\/>pData, pMP3-\/>pData + pMP3-\/>dataConsumed, pMP3-\/>dataSize);}
\DoxyCodeLine{2666             \}}
\DoxyCodeLine{2667 }
\DoxyCodeLine{2668             pMP3-\/>dataConsumed = 0;}
\DoxyCodeLine{2669 }
\DoxyCodeLine{2670             \textcolor{keywordflow}{if} (pMP3-\/>dataCapacity < DRMP3\_DATA\_CHUNK\_SIZE) \{}
\DoxyCodeLine{2671                 drmp3\_uint8* pNewData;}
\DoxyCodeLine{2672                 \textcolor{keywordtype}{size\_t} newDataCap;}
\DoxyCodeLine{2673 }
\DoxyCodeLine{2674                 newDataCap = DRMP3\_DATA\_CHUNK\_SIZE;}
\DoxyCodeLine{2675 }
\DoxyCodeLine{2676                 pNewData = (drmp3\_uint8*)drmp3\_\_realloc\_from\_callbacks(pMP3-\/>pData, newDataCap, pMP3-\/>dataCapacity, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{2677                 \textcolor{keywordflow}{if} (pNewData == NULL) \{}
\DoxyCodeLine{2678                     \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* Out of memory. */}}
\DoxyCodeLine{2679                 \}}
\DoxyCodeLine{2680 }
\DoxyCodeLine{2681                 pMP3-\/>pData = pNewData;}
\DoxyCodeLine{2682                 pMP3-\/>dataCapacity = newDataCap;}
\DoxyCodeLine{2683             \}}
\DoxyCodeLine{2684 }
\DoxyCodeLine{2685             bytesRead = drmp3\_\_on\_read(pMP3, pMP3-\/>pData + pMP3-\/>dataSize, (pMP3-\/>dataCapacity -\/ pMP3-\/>dataSize));}
\DoxyCodeLine{2686             \textcolor{keywordflow}{if} (bytesRead == 0) \{}
\DoxyCodeLine{2687                 \textcolor{keywordflow}{if} (pMP3-\/>dataSize == 0) \{}
\DoxyCodeLine{2688                     pMP3-\/>atEnd = DRMP3\_TRUE;}
\DoxyCodeLine{2689                     \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* No data. */}}
\DoxyCodeLine{2690                 \}}
\DoxyCodeLine{2691             \}}
\DoxyCodeLine{2692 }
\DoxyCodeLine{2693             pMP3-\/>dataSize += bytesRead;}
\DoxyCodeLine{2694         \}}
\DoxyCodeLine{2695 }
\DoxyCodeLine{2696         \textcolor{keywordflow}{if} (pMP3-\/>dataSize > INT\_MAX) \{}
\DoxyCodeLine{2697             pMP3-\/>atEnd = DRMP3\_TRUE;}
\DoxyCodeLine{2698             \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* File too big. */}}
\DoxyCodeLine{2699         \}}
\DoxyCodeLine{2700 }
\DoxyCodeLine{2701         DRMP3\_ASSERT(pMP3-\/>pData != NULL);}
\DoxyCodeLine{2702         DRMP3\_ASSERT(pMP3-\/>dataCapacity > 0);}
\DoxyCodeLine{2703 }
\DoxyCodeLine{2704         pcmFramesRead = drmp3dec\_decode\_frame(\&pMP3-\/>decoder, pMP3-\/>pData + pMP3-\/>dataConsumed, (\textcolor{keywordtype}{int})pMP3-\/>dataSize, pPCMFrames, \&info);    \textcolor{comment}{/* <-\/-\/ Safe size\_t -\/> int conversion thanks to the check above. */}}
\DoxyCodeLine{2705 }
\DoxyCodeLine{2706         \textcolor{comment}{/* Consume the data. */}}
\DoxyCodeLine{2707         \textcolor{keywordflow}{if} (info.frame\_bytes > 0) \{}
\DoxyCodeLine{2708             pMP3-\/>dataConsumed += (size\_t)info.frame\_bytes;}
\DoxyCodeLine{2709             pMP3-\/>dataSize     -\/= (\textcolor{keywordtype}{size\_t})info.frame\_bytes;}
\DoxyCodeLine{2710         \}}
\DoxyCodeLine{2711 }
\DoxyCodeLine{2712         \textcolor{comment}{/* pcmFramesRead will be equal to 0 if decoding failed. If it is zero and info.frame\_bytes > 0 then we have successfully decoded the frame. */}}
\DoxyCodeLine{2713         \textcolor{keywordflow}{if} (pcmFramesRead > 0) \{}
\DoxyCodeLine{2714             pcmFramesRead = drmp3\_hdr\_frame\_samples(pMP3-\/>decoder.header);}
\DoxyCodeLine{2715             pMP3-\/>pcmFramesConsumedInMP3Frame = 0;}
\DoxyCodeLine{2716             pMP3-\/>pcmFramesRemainingInMP3Frame = pcmFramesRead;}
\DoxyCodeLine{2717             pMP3-\/>mp3FrameChannels = info.channels;}
\DoxyCodeLine{2718             pMP3-\/>mp3FrameSampleRate = info.hz;}
\DoxyCodeLine{2719             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2720         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.frame\_bytes == 0) \{}
\DoxyCodeLine{2721             \textcolor{comment}{/* Need more data. minimp3 recommends doing data submission in 16K chunks. */}}
\DoxyCodeLine{2722             \textcolor{keywordtype}{size\_t} bytesRead;}
\DoxyCodeLine{2723 }
\DoxyCodeLine{2724             \textcolor{comment}{/* First we need to move the data down. */}}
\DoxyCodeLine{2725             DRMP3\_MOVE\_MEMORY(pMP3-\/>pData, pMP3-\/>pData + pMP3-\/>dataConsumed, pMP3-\/>dataSize);}
\DoxyCodeLine{2726             pMP3-\/>dataConsumed = 0;}
\DoxyCodeLine{2727 }
\DoxyCodeLine{2728             \textcolor{keywordflow}{if} (pMP3-\/>dataCapacity == pMP3-\/>dataSize) \{}
\DoxyCodeLine{2729                 \textcolor{comment}{/* No room. Expand. */}}
\DoxyCodeLine{2730                 drmp3\_uint8* pNewData;}
\DoxyCodeLine{2731                 \textcolor{keywordtype}{size\_t} newDataCap;}
\DoxyCodeLine{2732 }
\DoxyCodeLine{2733                 newDataCap = pMP3-\/>dataCapacity + DRMP3\_DATA\_CHUNK\_SIZE;}
\DoxyCodeLine{2734 }
\DoxyCodeLine{2735                 pNewData = (drmp3\_uint8*)drmp3\_\_realloc\_from\_callbacks(pMP3-\/>pData, newDataCap, pMP3-\/>dataCapacity, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{2736                 \textcolor{keywordflow}{if} (pNewData == NULL) \{}
\DoxyCodeLine{2737                     \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* Out of memory. */}}
\DoxyCodeLine{2738                 \}}
\DoxyCodeLine{2739 }
\DoxyCodeLine{2740                 pMP3-\/>pData = pNewData;}
\DoxyCodeLine{2741                 pMP3-\/>dataCapacity = newDataCap;}
\DoxyCodeLine{2742             \}}
\DoxyCodeLine{2743 }
\DoxyCodeLine{2744             \textcolor{comment}{/* Fill in a chunk. */}}
\DoxyCodeLine{2745             bytesRead = drmp3\_\_on\_read(pMP3, pMP3-\/>pData + pMP3-\/>dataSize, (pMP3-\/>dataCapacity -\/ pMP3-\/>dataSize));}
\DoxyCodeLine{2746             \textcolor{keywordflow}{if} (bytesRead == 0) \{}
\DoxyCodeLine{2747                 pMP3-\/>atEnd = DRMP3\_TRUE;}
\DoxyCodeLine{2748                 \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* Error reading more data. */}}
\DoxyCodeLine{2749             \}}
\DoxyCodeLine{2750 }
\DoxyCodeLine{2751             pMP3-\/>dataSize += bytesRead;}
\DoxyCodeLine{2752         \}}
\DoxyCodeLine{2753     \};}
\DoxyCodeLine{2754 }
\DoxyCodeLine{2755     \textcolor{keywordflow}{return} pcmFramesRead;}
\DoxyCodeLine{2756 \}}
\DoxyCodeLine{2757 }
\DoxyCodeLine{2758 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_decode\_next\_frame\_ex\_\_memory(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3d\_sample\_t* pPCMFrames)}
\DoxyCodeLine{2759 \{}
\DoxyCodeLine{2760     drmp3\_uint32 pcmFramesRead = 0;}
\DoxyCodeLine{2761     \mbox{\hyperlink{structdrmp3dec__frame__info}{drmp3dec\_frame\_info}} info;}
\DoxyCodeLine{2762 }
\DoxyCodeLine{2763     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2764     DRMP3\_ASSERT(pMP3-\/>memory.pData != NULL);}
\DoxyCodeLine{2765 }
\DoxyCodeLine{2766     \textcolor{keywordflow}{if} (pMP3-\/>atEnd) \{}
\DoxyCodeLine{2767         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2768     \}}
\DoxyCodeLine{2769 }
\DoxyCodeLine{2770     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{2771         pcmFramesRead = drmp3dec\_decode\_frame(\&pMP3-\/>decoder, pMP3-\/>memory.pData + pMP3-\/>memory.currentReadPos, (\textcolor{keywordtype}{int})(pMP3-\/>memory.dataSize -\/ pMP3-\/>memory.currentReadPos), pPCMFrames, \&info);}
\DoxyCodeLine{2772         \textcolor{keywordflow}{if} (pcmFramesRead > 0) \{}
\DoxyCodeLine{2773             pcmFramesRead = drmp3\_hdr\_frame\_samples(pMP3-\/>decoder.header);}
\DoxyCodeLine{2774             pMP3-\/>pcmFramesConsumedInMP3Frame  = 0;}
\DoxyCodeLine{2775             pMP3-\/>pcmFramesRemainingInMP3Frame = pcmFramesRead;}
\DoxyCodeLine{2776             pMP3-\/>mp3FrameChannels             = info.channels;}
\DoxyCodeLine{2777             pMP3-\/>mp3FrameSampleRate           = info.hz;}
\DoxyCodeLine{2778             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2779         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.frame\_bytes > 0) \{}
\DoxyCodeLine{2780             \textcolor{comment}{/* No frames were read, but it looks like we skipped past one. Read the next MP3 frame. */}}
\DoxyCodeLine{2781             pMP3-\/>memory.currentReadPos += (size\_t)info.frame\_bytes;}
\DoxyCodeLine{2782         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2783             \textcolor{comment}{/* Nothing at all was read. Abort. */}}
\DoxyCodeLine{2784             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2785         \}}
\DoxyCodeLine{2786     \}}
\DoxyCodeLine{2787 }
\DoxyCodeLine{2788     \textcolor{comment}{/* Consume the data. */}}
\DoxyCodeLine{2789     pMP3-\/>memory.currentReadPos += (size\_t)info.frame\_bytes;}
\DoxyCodeLine{2790 }
\DoxyCodeLine{2791     \textcolor{keywordflow}{return} pcmFramesRead;}
\DoxyCodeLine{2792 \}}
\DoxyCodeLine{2793 }
\DoxyCodeLine{2794 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_decode\_next\_frame\_ex(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3d\_sample\_t* pPCMFrames)}
\DoxyCodeLine{2795 \{}
\DoxyCodeLine{2796     \textcolor{keywordflow}{if} (pMP3-\/>memory.pData != NULL \&\& pMP3-\/>memory.dataSize > 0) \{}
\DoxyCodeLine{2797         \textcolor{keywordflow}{return} drmp3\_decode\_next\_frame\_ex\_\_memory(pMP3, pPCMFrames);}
\DoxyCodeLine{2798     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2799         \textcolor{keywordflow}{return} drmp3\_decode\_next\_frame\_ex\_\_callbacks(pMP3, pPCMFrames);}
\DoxyCodeLine{2800     \}}
\DoxyCodeLine{2801 \}}
\DoxyCodeLine{2802 }
\DoxyCodeLine{2803 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_decode\_next\_frame(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{2804 \{}
\DoxyCodeLine{2805     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2806     \textcolor{keywordflow}{return} drmp3\_decode\_next\_frame\_ex(pMP3, (drmp3d\_sample\_t*)pMP3-\/>pcmFrames);}
\DoxyCodeLine{2807 \}}
\DoxyCodeLine{2808 }
\DoxyCodeLine{2809 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{2810 \textcolor{keyword}{static} drmp3\_uint32 drmp3\_seek\_next\_frame(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{2811 \{}
\DoxyCodeLine{2812     drmp3\_uint32 pcmFrameCount;}
\DoxyCodeLine{2813 }
\DoxyCodeLine{2814     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2815 }
\DoxyCodeLine{2816     pcmFrameCount = drmp3\_decode\_next\_frame\_ex(pMP3, NULL);}
\DoxyCodeLine{2817     \textcolor{keywordflow}{if} (pcmFrameCount == 0) \{}
\DoxyCodeLine{2818         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2819     \}}
\DoxyCodeLine{2820 }
\DoxyCodeLine{2821     \textcolor{comment}{/* We have essentially just skipped past the frame, so just set the remaining samples to 0. */}}
\DoxyCodeLine{2822     pMP3-\/>currentPCMFrame             += pcmFrameCount;}
\DoxyCodeLine{2823     pMP3-\/>pcmFramesConsumedInMP3Frame  = pcmFrameCount;}
\DoxyCodeLine{2824     pMP3-\/>pcmFramesRemainingInMP3Frame = 0;}
\DoxyCodeLine{2825 }
\DoxyCodeLine{2826     \textcolor{keywordflow}{return} pcmFrameCount;}
\DoxyCodeLine{2827 \}}
\DoxyCodeLine{2828 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2829 }
\DoxyCodeLine{2830 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_init\_internal(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2831 \{}
\DoxyCodeLine{2832     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2833     DRMP3\_ASSERT(onRead != NULL);}
\DoxyCodeLine{2834 }
\DoxyCodeLine{2835     \textcolor{comment}{/* This function assumes the output object has already been reset to 0. Do not do that here, otherwise things will break. */}}
\DoxyCodeLine{2836     drmp3dec\_init(\&pMP3-\/>decoder);}
\DoxyCodeLine{2837 }
\DoxyCodeLine{2838     pMP3-\/>onRead = onRead;}
\DoxyCodeLine{2839     pMP3-\/>onSeek = onSeek;}
\DoxyCodeLine{2840     pMP3-\/>pUserData = pUserData;}
\DoxyCodeLine{2841     pMP3-\/>allocationCallbacks = drmp3\_copy\_allocation\_callbacks\_or\_defaults(pAllocationCallbacks);}
\DoxyCodeLine{2842 }
\DoxyCodeLine{2843     \textcolor{keywordflow}{if} (pMP3-\/>allocationCallbacks.onFree == NULL || (pMP3-\/>allocationCallbacks.onMalloc == NULL \&\& pMP3-\/>allocationCallbacks.onRealloc == NULL)) \{}
\DoxyCodeLine{2844         \textcolor{keywordflow}{return} DRMP3\_FALSE;    \textcolor{comment}{/* Invalid allocation callbacks. */}}
\DoxyCodeLine{2845     \}}
\DoxyCodeLine{2846 }
\DoxyCodeLine{2847     \textcolor{comment}{/* Decode the first frame to confirm that it is indeed a valid MP3 stream. */}}
\DoxyCodeLine{2848     \textcolor{keywordflow}{if} (drmp3\_decode\_next\_frame(pMP3) == 0) \{}
\DoxyCodeLine{2849         drmp3\_\_free\_from\_callbacks(pMP3-\/>pData, \&pMP3-\/>allocationCallbacks);    \textcolor{comment}{/* The call above may have allocated memory. Need to make sure it's freed before aborting. */}}
\DoxyCodeLine{2850         \textcolor{keywordflow}{return} DRMP3\_FALSE; \textcolor{comment}{/* Not a valid MP3 stream. */}}
\DoxyCodeLine{2851     \}}
\DoxyCodeLine{2852 }
\DoxyCodeLine{2853     pMP3-\/>channels   = pMP3-\/>mp3FrameChannels;}
\DoxyCodeLine{2854     pMP3-\/>sampleRate = pMP3-\/>mp3FrameSampleRate;}
\DoxyCodeLine{2855 }
\DoxyCodeLine{2856     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{2857 \}}
\DoxyCodeLine{2858 }
\DoxyCodeLine{2859 DRMP3\_API drmp3\_bool32 drmp3\_init(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2860 \{}
\DoxyCodeLine{2861     \textcolor{keywordflow}{if} (pMP3 == NULL || onRead == NULL) \{}
\DoxyCodeLine{2862         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2863     \}}
\DoxyCodeLine{2864 }
\DoxyCodeLine{2865     DRMP3\_ZERO\_OBJECT(pMP3);}
\DoxyCodeLine{2866     \textcolor{keywordflow}{return} drmp3\_init\_internal(pMP3, onRead, onSeek, pUserData, pAllocationCallbacks);}
\DoxyCodeLine{2867 \}}
\DoxyCodeLine{2868 }
\DoxyCodeLine{2869 }
\DoxyCodeLine{2870 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drmp3\_\_on\_read\_memory(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pBufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{2871 \{}
\DoxyCodeLine{2872     \mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3 = (\mbox{\hyperlink{structdrmp3}{drmp3}}*)pUserData;}
\DoxyCodeLine{2873     \textcolor{keywordtype}{size\_t} bytesRemaining;}
\DoxyCodeLine{2874 }
\DoxyCodeLine{2875     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2876     DRMP3\_ASSERT(pMP3-\/>memory.dataSize >= pMP3-\/>memory.currentReadPos);}
\DoxyCodeLine{2877 }
\DoxyCodeLine{2878     bytesRemaining = pMP3-\/>memory.dataSize -\/ pMP3-\/>memory.currentReadPos;}
\DoxyCodeLine{2879     \textcolor{keywordflow}{if} (bytesToRead > bytesRemaining) \{}
\DoxyCodeLine{2880         bytesToRead = bytesRemaining;}
\DoxyCodeLine{2881     \}}
\DoxyCodeLine{2882 }
\DoxyCodeLine{2883     \textcolor{keywordflow}{if} (bytesToRead > 0) \{}
\DoxyCodeLine{2884         DRMP3\_COPY\_MEMORY(pBufferOut, pMP3-\/>memory.pData + pMP3-\/>memory.currentReadPos, bytesToRead);}
\DoxyCodeLine{2885         pMP3-\/>memory.currentReadPos += bytesToRead;}
\DoxyCodeLine{2886     \}}
\DoxyCodeLine{2887 }
\DoxyCodeLine{2888     \textcolor{keywordflow}{return} bytesToRead;}
\DoxyCodeLine{2889 \}}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_\_on\_seek\_memory(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} byteOffset, drmp3\_seek\_origin origin)}
\DoxyCodeLine{2892 \{}
\DoxyCodeLine{2893     \mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3 = (\mbox{\hyperlink{structdrmp3}{drmp3}}*)pUserData;}
\DoxyCodeLine{2894 }
\DoxyCodeLine{2895     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{2896 }
\DoxyCodeLine{2897     \textcolor{keywordflow}{if} (origin == drmp3\_seek\_origin\_current) \{}
\DoxyCodeLine{2898         \textcolor{keywordflow}{if} (byteOffset > 0) \{}
\DoxyCodeLine{2899             \textcolor{keywordflow}{if} (pMP3-\/>memory.currentReadPos + byteOffset > pMP3-\/>memory.dataSize) \{}
\DoxyCodeLine{2900                 byteOffset = (int)(pMP3-\/>memory.dataSize -\/ pMP3-\/>memory.currentReadPos);  \textcolor{comment}{/* Trying to seek too far forward. */}}
\DoxyCodeLine{2901             \}}
\DoxyCodeLine{2902         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2903             \textcolor{keywordflow}{if} (pMP3-\/>memory.currentReadPos < (\textcolor{keywordtype}{size\_t})-\/byteOffset) \{}
\DoxyCodeLine{2904                 byteOffset = -\/(int)pMP3-\/>memory.currentReadPos;  \textcolor{comment}{/* Trying to seek too far backwards. */}}
\DoxyCodeLine{2905             \}}
\DoxyCodeLine{2906         \}}
\DoxyCodeLine{2907 }
\DoxyCodeLine{2908         \textcolor{comment}{/* This will never underflow thanks to the clamps above. */}}
\DoxyCodeLine{2909         pMP3-\/>memory.currentReadPos += byteOffset;}
\DoxyCodeLine{2910     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2911         \textcolor{keywordflow}{if} ((drmp3\_uint32)byteOffset <= pMP3-\/>memory.dataSize) \{}
\DoxyCodeLine{2912             pMP3-\/>memory.currentReadPos = byteOffset;}
\DoxyCodeLine{2913         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2914             pMP3-\/>memory.currentReadPos = pMP3-\/>memory.dataSize;  \textcolor{comment}{/* Trying to seek too far forward. */}}
\DoxyCodeLine{2915         \}}
\DoxyCodeLine{2916     \}}
\DoxyCodeLine{2917 }
\DoxyCodeLine{2918     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{2919 \}}
\DoxyCodeLine{2920 }
\DoxyCodeLine{2921 DRMP3\_API drmp3\_bool32 drmp3\_init\_memory(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{2922 \{}
\DoxyCodeLine{2923     \textcolor{keywordflow}{if} (pMP3 == NULL) \{}
\DoxyCodeLine{2924         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2925     \}}
\DoxyCodeLine{2926 }
\DoxyCodeLine{2927     DRMP3\_ZERO\_OBJECT(pMP3);}
\DoxyCodeLine{2928 }
\DoxyCodeLine{2929     \textcolor{keywordflow}{if} (pData == NULL || dataSize == 0) \{}
\DoxyCodeLine{2930         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{2931     \}}
\DoxyCodeLine{2932 }
\DoxyCodeLine{2933     pMP3-\/>memory.pData = (\textcolor{keyword}{const} drmp3\_uint8*)pData;}
\DoxyCodeLine{2934     pMP3-\/>memory.dataSize = dataSize;}
\DoxyCodeLine{2935     pMP3-\/>memory.currentReadPos = 0;}
\DoxyCodeLine{2936 }
\DoxyCodeLine{2937     \textcolor{keywordflow}{return} drmp3\_init\_internal(pMP3, drmp3\_\_on\_read\_memory, drmp3\_\_on\_seek\_memory, pMP3, pAllocationCallbacks);}
\DoxyCodeLine{2938 \}}
\DoxyCodeLine{2939 }
\DoxyCodeLine{2940 }
\DoxyCodeLine{2941 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{2942 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{2943 \textcolor{preprocessor}{\#include <wchar.h>}      \textcolor{comment}{/* For wcslen(), wcsrtombs() */}}
\DoxyCodeLine{2944 }
\DoxyCodeLine{2945 \textcolor{comment}{/* drmp3\_result\_from\_errno() is only used inside DR\_MP3\_NO\_STDIO for now. Move this out if it's ever used elsewhere. */}}
\DoxyCodeLine{2946 \textcolor{preprocessor}{\#include <errno.h>}}
\DoxyCodeLine{2947 \textcolor{keyword}{static} drmp3\_result drmp3\_result\_from\_errno(\textcolor{keywordtype}{int} e)}
\DoxyCodeLine{2948 \{}
\DoxyCodeLine{2949     \textcolor{keywordflow}{switch} (e)}
\DoxyCodeLine{2950     \{}
\DoxyCodeLine{2951         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} DRMP3\_SUCCESS;}
\DoxyCodeLine{2952 \textcolor{preprocessor}{    \#ifdef EPERM}}
\DoxyCodeLine{2953         \textcolor{keywordflow}{case} EPERM: \textcolor{keywordflow}{return} DRMP3\_INVALID\_OPERATION;}
\DoxyCodeLine{2954 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2955 \textcolor{preprocessor}{    \#ifdef ENOENT}}
\DoxyCodeLine{2956         \textcolor{keywordflow}{case} ENOENT: \textcolor{keywordflow}{return} DRMP3\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{2957 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2958 \textcolor{preprocessor}{    \#ifdef ESRCH}}
\DoxyCodeLine{2959         \textcolor{keywordflow}{case} ESRCH: \textcolor{keywordflow}{return} DRMP3\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{2960 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2961 \textcolor{preprocessor}{    \#ifdef EINTR}}
\DoxyCodeLine{2962         \textcolor{keywordflow}{case} EINTR: \textcolor{keywordflow}{return} DRMP3\_INTERRUPT;}
\DoxyCodeLine{2963 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2964 \textcolor{preprocessor}{    \#ifdef EIO}}
\DoxyCodeLine{2965         \textcolor{keywordflow}{case} EIO: \textcolor{keywordflow}{return} DRMP3\_IO\_ERROR;}
\DoxyCodeLine{2966 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2967 \textcolor{preprocessor}{    \#ifdef ENXIO}}
\DoxyCodeLine{2968         \textcolor{keywordflow}{case} ENXIO: \textcolor{keywordflow}{return} DRMP3\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{2969 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2970 \textcolor{preprocessor}{    \#ifdef E2BIG}}
\DoxyCodeLine{2971         \textcolor{keywordflow}{case} E2BIG: \textcolor{keywordflow}{return} DRMP3\_INVALID\_ARGS;}
\DoxyCodeLine{2972 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2973 \textcolor{preprocessor}{    \#ifdef ENOEXEC}}
\DoxyCodeLine{2974         \textcolor{keywordflow}{case} ENOEXEC: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{2975 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2976 \textcolor{preprocessor}{    \#ifdef EBADF}}
\DoxyCodeLine{2977         \textcolor{keywordflow}{case} EBADF: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{2978 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2979 \textcolor{preprocessor}{    \#ifdef ECHILD}}
\DoxyCodeLine{2980         \textcolor{keywordflow}{case} ECHILD: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{2981 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2982 \textcolor{preprocessor}{    \#ifdef EAGAIN}}
\DoxyCodeLine{2983         \textcolor{keywordflow}{case} EAGAIN: \textcolor{keywordflow}{return} DRMP3\_UNAVAILABLE;}
\DoxyCodeLine{2984 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2985 \textcolor{preprocessor}{    \#ifdef ENOMEM}}
\DoxyCodeLine{2986         \textcolor{keywordflow}{case} ENOMEM: \textcolor{keywordflow}{return} DRMP3\_OUT\_OF\_MEMORY;}
\DoxyCodeLine{2987 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2988 \textcolor{preprocessor}{    \#ifdef EACCES}}
\DoxyCodeLine{2989         \textcolor{keywordflow}{case} EACCES: \textcolor{keywordflow}{return} DRMP3\_ACCESS\_DENIED;}
\DoxyCodeLine{2990 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2991 \textcolor{preprocessor}{    \#ifdef EFAULT}}
\DoxyCodeLine{2992         \textcolor{keywordflow}{case} EFAULT: \textcolor{keywordflow}{return} DRMP3\_BAD\_ADDRESS;}
\DoxyCodeLine{2993 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2994 \textcolor{preprocessor}{    \#ifdef ENOTBLK}}
\DoxyCodeLine{2995         \textcolor{keywordflow}{case} ENOTBLK: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{2996 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{2997 \textcolor{preprocessor}{    \#ifdef EBUSY}}
\DoxyCodeLine{2998         \textcolor{keywordflow}{case} EBUSY: \textcolor{keywordflow}{return} DRMP3\_BUSY;}
\DoxyCodeLine{2999 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3000 \textcolor{preprocessor}{    \#ifdef EEXIST}}
\DoxyCodeLine{3001         \textcolor{keywordflow}{case} EEXIST: \textcolor{keywordflow}{return} DRMP3\_ALREADY\_EXISTS;}
\DoxyCodeLine{3002 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3003 \textcolor{preprocessor}{    \#ifdef EXDEV}}
\DoxyCodeLine{3004         \textcolor{keywordflow}{case} EXDEV: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3005 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3006 \textcolor{preprocessor}{    \#ifdef ENODEV}}
\DoxyCodeLine{3007         \textcolor{keywordflow}{case} ENODEV: \textcolor{keywordflow}{return} DRMP3\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{3008 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3009 \textcolor{preprocessor}{    \#ifdef ENOTDIR}}
\DoxyCodeLine{3010         \textcolor{keywordflow}{case} ENOTDIR: \textcolor{keywordflow}{return} DRMP3\_NOT\_DIRECTORY;}
\DoxyCodeLine{3011 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3012 \textcolor{preprocessor}{    \#ifdef EISDIR}}
\DoxyCodeLine{3013         \textcolor{keywordflow}{case} EISDIR: \textcolor{keywordflow}{return} DRMP3\_IS\_DIRECTORY;}
\DoxyCodeLine{3014 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3015 \textcolor{preprocessor}{    \#ifdef EINVAL}}
\DoxyCodeLine{3016         \textcolor{keywordflow}{case} EINVAL: \textcolor{keywordflow}{return} DRMP3\_INVALID\_ARGS;}
\DoxyCodeLine{3017 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3018 \textcolor{preprocessor}{    \#ifdef ENFILE}}
\DoxyCodeLine{3019         \textcolor{keywordflow}{case} ENFILE: \textcolor{keywordflow}{return} DRMP3\_TOO\_MANY\_OPEN\_FILES;}
\DoxyCodeLine{3020 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3021 \textcolor{preprocessor}{    \#ifdef EMFILE}}
\DoxyCodeLine{3022         \textcolor{keywordflow}{case} EMFILE: \textcolor{keywordflow}{return} DRMP3\_TOO\_MANY\_OPEN\_FILES;}
\DoxyCodeLine{3023 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3024 \textcolor{preprocessor}{    \#ifdef ENOTTY}}
\DoxyCodeLine{3025         \textcolor{keywordflow}{case} ENOTTY: \textcolor{keywordflow}{return} DRMP3\_INVALID\_OPERATION;}
\DoxyCodeLine{3026 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3027 \textcolor{preprocessor}{    \#ifdef ETXTBSY}}
\DoxyCodeLine{3028         \textcolor{keywordflow}{case} ETXTBSY: \textcolor{keywordflow}{return} DRMP3\_BUSY;}
\DoxyCodeLine{3029 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3030 \textcolor{preprocessor}{    \#ifdef EFBIG}}
\DoxyCodeLine{3031         \textcolor{keywordflow}{case} EFBIG: \textcolor{keywordflow}{return} DRMP3\_TOO\_BIG;}
\DoxyCodeLine{3032 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3033 \textcolor{preprocessor}{    \#ifdef ENOSPC}}
\DoxyCodeLine{3034         \textcolor{keywordflow}{case} ENOSPC: \textcolor{keywordflow}{return} DRMP3\_NO\_SPACE;}
\DoxyCodeLine{3035 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3036 \textcolor{preprocessor}{    \#ifdef ESPIPE}}
\DoxyCodeLine{3037         \textcolor{keywordflow}{case} ESPIPE: \textcolor{keywordflow}{return} DRMP3\_BAD\_SEEK;}
\DoxyCodeLine{3038 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3039 \textcolor{preprocessor}{    \#ifdef EROFS}}
\DoxyCodeLine{3040         \textcolor{keywordflow}{case} EROFS: \textcolor{keywordflow}{return} DRMP3\_ACCESS\_DENIED;}
\DoxyCodeLine{3041 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3042 \textcolor{preprocessor}{    \#ifdef EMLINK}}
\DoxyCodeLine{3043         \textcolor{keywordflow}{case} EMLINK: \textcolor{keywordflow}{return} DRMP3\_TOO\_MANY\_LINKS;}
\DoxyCodeLine{3044 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3045 \textcolor{preprocessor}{    \#ifdef EPIPE}}
\DoxyCodeLine{3046         \textcolor{keywordflow}{case} EPIPE: \textcolor{keywordflow}{return} DRMP3\_BAD\_PIPE;}
\DoxyCodeLine{3047 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3048 \textcolor{preprocessor}{    \#ifdef EDOM}}
\DoxyCodeLine{3049         \textcolor{keywordflow}{case} EDOM: \textcolor{keywordflow}{return} DRMP3\_OUT\_OF\_RANGE;}
\DoxyCodeLine{3050 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3051 \textcolor{preprocessor}{    \#ifdef ERANGE}}
\DoxyCodeLine{3052         \textcolor{keywordflow}{case} ERANGE: \textcolor{keywordflow}{return} DRMP3\_OUT\_OF\_RANGE;}
\DoxyCodeLine{3053 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3054 \textcolor{preprocessor}{    \#ifdef EDEADLK}}
\DoxyCodeLine{3055         \textcolor{keywordflow}{case} EDEADLK: \textcolor{keywordflow}{return} DRMP3\_DEADLOCK;}
\DoxyCodeLine{3056 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3057 \textcolor{preprocessor}{    \#ifdef ENAMETOOLONG}}
\DoxyCodeLine{3058         \textcolor{keywordflow}{case} ENAMETOOLONG: \textcolor{keywordflow}{return} DRMP3\_PATH\_TOO\_LONG;}
\DoxyCodeLine{3059 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3060 \textcolor{preprocessor}{    \#ifdef ENOLCK}}
\DoxyCodeLine{3061         \textcolor{keywordflow}{case} ENOLCK: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3062 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3063 \textcolor{preprocessor}{    \#ifdef ENOSYS}}
\DoxyCodeLine{3064         \textcolor{keywordflow}{case} ENOSYS: \textcolor{keywordflow}{return} DRMP3\_NOT\_IMPLEMENTED;}
\DoxyCodeLine{3065 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3066 \textcolor{preprocessor}{    \#ifdef ENOTEMPTY}}
\DoxyCodeLine{3067         \textcolor{keywordflow}{case} ENOTEMPTY: \textcolor{keywordflow}{return} DRMP3\_DIRECTORY\_NOT\_EMPTY;}
\DoxyCodeLine{3068 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3069 \textcolor{preprocessor}{    \#ifdef ELOOP}}
\DoxyCodeLine{3070         \textcolor{keywordflow}{case} ELOOP: \textcolor{keywordflow}{return} DRMP3\_TOO\_MANY\_LINKS;}
\DoxyCodeLine{3071 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3072 \textcolor{preprocessor}{    \#ifdef ENOMSG}}
\DoxyCodeLine{3073         \textcolor{keywordflow}{case} ENOMSG: \textcolor{keywordflow}{return} DRMP3\_NO\_MESSAGE;}
\DoxyCodeLine{3074 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3075 \textcolor{preprocessor}{    \#ifdef EIDRM}}
\DoxyCodeLine{3076         \textcolor{keywordflow}{case} EIDRM: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3077 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3078 \textcolor{preprocessor}{    \#ifdef ECHRNG}}
\DoxyCodeLine{3079         \textcolor{keywordflow}{case} ECHRNG: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3080 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3081 \textcolor{preprocessor}{    \#ifdef EL2NSYNC}}
\DoxyCodeLine{3082         \textcolor{keywordflow}{case} EL2NSYNC: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3083 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3084 \textcolor{preprocessor}{    \#ifdef EL3HLT}}
\DoxyCodeLine{3085         \textcolor{keywordflow}{case} EL3HLT: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3086 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3087 \textcolor{preprocessor}{    \#ifdef EL3RST}}
\DoxyCodeLine{3088         \textcolor{keywordflow}{case} EL3RST: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3089 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3090 \textcolor{preprocessor}{    \#ifdef ELNRNG}}
\DoxyCodeLine{3091         \textcolor{keywordflow}{case} ELNRNG: \textcolor{keywordflow}{return} DRMP3\_OUT\_OF\_RANGE;}
\DoxyCodeLine{3092 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3093 \textcolor{preprocessor}{    \#ifdef EUNATCH}}
\DoxyCodeLine{3094         \textcolor{keywordflow}{case} EUNATCH: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3095 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3096 \textcolor{preprocessor}{    \#ifdef ENOCSI}}
\DoxyCodeLine{3097         \textcolor{keywordflow}{case} ENOCSI: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3098 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3099 \textcolor{preprocessor}{    \#ifdef EL2HLT}}
\DoxyCodeLine{3100         \textcolor{keywordflow}{case} EL2HLT: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3101 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3102 \textcolor{preprocessor}{    \#ifdef EBADE}}
\DoxyCodeLine{3103         \textcolor{keywordflow}{case} EBADE: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3104 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3105 \textcolor{preprocessor}{    \#ifdef EBADR}}
\DoxyCodeLine{3106         \textcolor{keywordflow}{case} EBADR: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3107 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3108 \textcolor{preprocessor}{    \#ifdef EXFULL}}
\DoxyCodeLine{3109         \textcolor{keywordflow}{case} EXFULL: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3110 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3111 \textcolor{preprocessor}{    \#ifdef ENOANO}}
\DoxyCodeLine{3112         \textcolor{keywordflow}{case} ENOANO: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3113 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3114 \textcolor{preprocessor}{    \#ifdef EBADRQC}}
\DoxyCodeLine{3115         \textcolor{keywordflow}{case} EBADRQC: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3116 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3117 \textcolor{preprocessor}{    \#ifdef EBADSLT}}
\DoxyCodeLine{3118         \textcolor{keywordflow}{case} EBADSLT: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3119 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3120 \textcolor{preprocessor}{    \#ifdef EBFONT}}
\DoxyCodeLine{3121         \textcolor{keywordflow}{case} EBFONT: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{3122 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3123 \textcolor{preprocessor}{    \#ifdef ENOSTR}}
\DoxyCodeLine{3124         \textcolor{keywordflow}{case} ENOSTR: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3125 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3126 \textcolor{preprocessor}{    \#ifdef ENODATA}}
\DoxyCodeLine{3127         \textcolor{keywordflow}{case} ENODATA: \textcolor{keywordflow}{return} DRMP3\_NO\_DATA\_AVAILABLE;}
\DoxyCodeLine{3128 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3129 \textcolor{preprocessor}{    \#ifdef ETIME}}
\DoxyCodeLine{3130         \textcolor{keywordflow}{case} ETIME: \textcolor{keywordflow}{return} DRMP3\_TIMEOUT;}
\DoxyCodeLine{3131 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3132 \textcolor{preprocessor}{    \#ifdef ENOSR}}
\DoxyCodeLine{3133         \textcolor{keywordflow}{case} ENOSR: \textcolor{keywordflow}{return} DRMP3\_NO\_DATA\_AVAILABLE;}
\DoxyCodeLine{3134 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3135 \textcolor{preprocessor}{    \#ifdef ENONET}}
\DoxyCodeLine{3136         \textcolor{keywordflow}{case} ENONET: \textcolor{keywordflow}{return} DRMP3\_NO\_NETWORK;}
\DoxyCodeLine{3137 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3138 \textcolor{preprocessor}{    \#ifdef ENOPKG}}
\DoxyCodeLine{3139         \textcolor{keywordflow}{case} ENOPKG: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3140 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3141 \textcolor{preprocessor}{    \#ifdef EREMOTE}}
\DoxyCodeLine{3142         \textcolor{keywordflow}{case} EREMOTE: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3143 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3144 \textcolor{preprocessor}{    \#ifdef ENOLINK}}
\DoxyCodeLine{3145         \textcolor{keywordflow}{case} ENOLINK: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3146 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3147 \textcolor{preprocessor}{    \#ifdef EADV}}
\DoxyCodeLine{3148         \textcolor{keywordflow}{case} EADV: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3149 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3150 \textcolor{preprocessor}{    \#ifdef ESRMNT}}
\DoxyCodeLine{3151         \textcolor{keywordflow}{case} ESRMNT: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3152 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3153 \textcolor{preprocessor}{    \#ifdef ECOMM}}
\DoxyCodeLine{3154         \textcolor{keywordflow}{case} ECOMM: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3155 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3156 \textcolor{preprocessor}{    \#ifdef EPROTO}}
\DoxyCodeLine{3157         \textcolor{keywordflow}{case} EPROTO: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3158 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3159 \textcolor{preprocessor}{    \#ifdef EMULTIHOP}}
\DoxyCodeLine{3160         \textcolor{keywordflow}{case} EMULTIHOP: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3161 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3162 \textcolor{preprocessor}{    \#ifdef EDOTDOT}}
\DoxyCodeLine{3163         \textcolor{keywordflow}{case} EDOTDOT: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3164 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3165 \textcolor{preprocessor}{    \#ifdef EBADMSG}}
\DoxyCodeLine{3166         \textcolor{keywordflow}{case} EBADMSG: \textcolor{keywordflow}{return} DRMP3\_BAD\_MESSAGE;}
\DoxyCodeLine{3167 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3168 \textcolor{preprocessor}{    \#ifdef EOVERFLOW}}
\DoxyCodeLine{3169         \textcolor{keywordflow}{case} EOVERFLOW: \textcolor{keywordflow}{return} DRMP3\_TOO\_BIG;}
\DoxyCodeLine{3170 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3171 \textcolor{preprocessor}{    \#ifdef ENOTUNIQ}}
\DoxyCodeLine{3172         \textcolor{keywordflow}{case} ENOTUNIQ: \textcolor{keywordflow}{return} DRMP3\_NOT\_UNIQUE;}
\DoxyCodeLine{3173 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3174 \textcolor{preprocessor}{    \#ifdef EBADFD}}
\DoxyCodeLine{3175         \textcolor{keywordflow}{case} EBADFD: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3176 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3177 \textcolor{preprocessor}{    \#ifdef EREMCHG}}
\DoxyCodeLine{3178         \textcolor{keywordflow}{case} EREMCHG: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3179 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3180 \textcolor{preprocessor}{    \#ifdef ELIBACC}}
\DoxyCodeLine{3181         \textcolor{keywordflow}{case} ELIBACC: \textcolor{keywordflow}{return} DRMP3\_ACCESS\_DENIED;}
\DoxyCodeLine{3182 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3183 \textcolor{preprocessor}{    \#ifdef ELIBBAD}}
\DoxyCodeLine{3184         \textcolor{keywordflow}{case} ELIBBAD: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{3185 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3186 \textcolor{preprocessor}{    \#ifdef ELIBSCN}}
\DoxyCodeLine{3187         \textcolor{keywordflow}{case} ELIBSCN: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{3188 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3189 \textcolor{preprocessor}{    \#ifdef ELIBMAX}}
\DoxyCodeLine{3190         \textcolor{keywordflow}{case} ELIBMAX: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3191 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3192 \textcolor{preprocessor}{    \#ifdef ELIBEXEC}}
\DoxyCodeLine{3193         \textcolor{keywordflow}{case} ELIBEXEC: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3194 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3195 \textcolor{preprocessor}{    \#ifdef EILSEQ}}
\DoxyCodeLine{3196         \textcolor{keywordflow}{case} EILSEQ: \textcolor{keywordflow}{return} DRMP3\_INVALID\_DATA;}
\DoxyCodeLine{3197 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3198 \textcolor{preprocessor}{    \#ifdef ERESTART}}
\DoxyCodeLine{3199         \textcolor{keywordflow}{case} ERESTART: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3200 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3201 \textcolor{preprocessor}{    \#ifdef ESTRPIPE}}
\DoxyCodeLine{3202         \textcolor{keywordflow}{case} ESTRPIPE: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3203 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3204 \textcolor{preprocessor}{    \#ifdef EUSERS}}
\DoxyCodeLine{3205         \textcolor{keywordflow}{case} EUSERS: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3206 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3207 \textcolor{preprocessor}{    \#ifdef ENOTSOCK}}
\DoxyCodeLine{3208         \textcolor{keywordflow}{case} ENOTSOCK: \textcolor{keywordflow}{return} DRMP3\_NOT\_SOCKET;}
\DoxyCodeLine{3209 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3210 \textcolor{preprocessor}{    \#ifdef EDESTADDRREQ}}
\DoxyCodeLine{3211         \textcolor{keywordflow}{case} EDESTADDRREQ: \textcolor{keywordflow}{return} DRMP3\_NO\_ADDRESS;}
\DoxyCodeLine{3212 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3213 \textcolor{preprocessor}{    \#ifdef EMSGSIZE}}
\DoxyCodeLine{3214         \textcolor{keywordflow}{case} EMSGSIZE: \textcolor{keywordflow}{return} DRMP3\_TOO\_BIG;}
\DoxyCodeLine{3215 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3216 \textcolor{preprocessor}{    \#ifdef EPROTOTYPE}}
\DoxyCodeLine{3217         \textcolor{keywordflow}{case} EPROTOTYPE: \textcolor{keywordflow}{return} DRMP3\_BAD\_PROTOCOL;}
\DoxyCodeLine{3218 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3219 \textcolor{preprocessor}{    \#ifdef ENOPROTOOPT}}
\DoxyCodeLine{3220         \textcolor{keywordflow}{case} ENOPROTOOPT: \textcolor{keywordflow}{return} DRMP3\_PROTOCOL\_UNAVAILABLE;}
\DoxyCodeLine{3221 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3222 \textcolor{preprocessor}{    \#ifdef EPROTONOSUPPORT}}
\DoxyCodeLine{3223         \textcolor{keywordflow}{case} EPROTONOSUPPORT: \textcolor{keywordflow}{return} DRMP3\_PROTOCOL\_NOT\_SUPPORTED;}
\DoxyCodeLine{3224 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3225 \textcolor{preprocessor}{    \#ifdef ESOCKTNOSUPPORT}}
\DoxyCodeLine{3226         \textcolor{keywordflow}{case} ESOCKTNOSUPPORT: \textcolor{keywordflow}{return} DRMP3\_SOCKET\_NOT\_SUPPORTED;}
\DoxyCodeLine{3227 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3228 \textcolor{preprocessor}{    \#ifdef EOPNOTSUPP}}
\DoxyCodeLine{3229         \textcolor{keywordflow}{case} EOPNOTSUPP: \textcolor{keywordflow}{return} DRMP3\_INVALID\_OPERATION;}
\DoxyCodeLine{3230 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3231 \textcolor{preprocessor}{    \#ifdef EPFNOSUPPORT}}
\DoxyCodeLine{3232         \textcolor{keywordflow}{case} EPFNOSUPPORT: \textcolor{keywordflow}{return} DRMP3\_PROTOCOL\_FAMILY\_NOT\_SUPPORTED;}
\DoxyCodeLine{3233 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3234 \textcolor{preprocessor}{    \#ifdef EAFNOSUPPORT}}
\DoxyCodeLine{3235         \textcolor{keywordflow}{case} EAFNOSUPPORT: \textcolor{keywordflow}{return} DRMP3\_ADDRESS\_FAMILY\_NOT\_SUPPORTED;}
\DoxyCodeLine{3236 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3237 \textcolor{preprocessor}{    \#ifdef EADDRINUSE}}
\DoxyCodeLine{3238         \textcolor{keywordflow}{case} EADDRINUSE: \textcolor{keywordflow}{return} DRMP3\_ALREADY\_IN\_USE;}
\DoxyCodeLine{3239 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3240 \textcolor{preprocessor}{    \#ifdef EADDRNOTAVAIL}}
\DoxyCodeLine{3241         \textcolor{keywordflow}{case} EADDRNOTAVAIL: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3242 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3243 \textcolor{preprocessor}{    \#ifdef ENETDOWN}}
\DoxyCodeLine{3244         \textcolor{keywordflow}{case} ENETDOWN: \textcolor{keywordflow}{return} DRMP3\_NO\_NETWORK;}
\DoxyCodeLine{3245 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3246 \textcolor{preprocessor}{    \#ifdef ENETUNREACH}}
\DoxyCodeLine{3247         \textcolor{keywordflow}{case} ENETUNREACH: \textcolor{keywordflow}{return} DRMP3\_NO\_NETWORK;}
\DoxyCodeLine{3248 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3249 \textcolor{preprocessor}{    \#ifdef ENETRESET}}
\DoxyCodeLine{3250         \textcolor{keywordflow}{case} ENETRESET: \textcolor{keywordflow}{return} DRMP3\_NO\_NETWORK;}
\DoxyCodeLine{3251 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3252 \textcolor{preprocessor}{    \#ifdef ECONNABORTED}}
\DoxyCodeLine{3253         \textcolor{keywordflow}{case} ECONNABORTED: \textcolor{keywordflow}{return} DRMP3\_NO\_NETWORK;}
\DoxyCodeLine{3254 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3255 \textcolor{preprocessor}{    \#ifdef ECONNRESET}}
\DoxyCodeLine{3256         \textcolor{keywordflow}{case} ECONNRESET: \textcolor{keywordflow}{return} DRMP3\_CONNECTION\_RESET;}
\DoxyCodeLine{3257 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3258 \textcolor{preprocessor}{    \#ifdef ENOBUFS}}
\DoxyCodeLine{3259         \textcolor{keywordflow}{case} ENOBUFS: \textcolor{keywordflow}{return} DRMP3\_NO\_SPACE;}
\DoxyCodeLine{3260 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3261 \textcolor{preprocessor}{    \#ifdef EISCONN}}
\DoxyCodeLine{3262         \textcolor{keywordflow}{case} EISCONN: \textcolor{keywordflow}{return} DRMP3\_ALREADY\_CONNECTED;}
\DoxyCodeLine{3263 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3264 \textcolor{preprocessor}{    \#ifdef ENOTCONN}}
\DoxyCodeLine{3265         \textcolor{keywordflow}{case} ENOTCONN: \textcolor{keywordflow}{return} DRMP3\_NOT\_CONNECTED;}
\DoxyCodeLine{3266 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3267 \textcolor{preprocessor}{    \#ifdef ESHUTDOWN}}
\DoxyCodeLine{3268         \textcolor{keywordflow}{case} ESHUTDOWN: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3269 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3270 \textcolor{preprocessor}{    \#ifdef ETOOMANYREFS}}
\DoxyCodeLine{3271         \textcolor{keywordflow}{case} ETOOMANYREFS: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3272 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3273 \textcolor{preprocessor}{    \#ifdef ETIMEDOUT}}
\DoxyCodeLine{3274         \textcolor{keywordflow}{case} ETIMEDOUT: \textcolor{keywordflow}{return} DRMP3\_TIMEOUT;}
\DoxyCodeLine{3275 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3276 \textcolor{preprocessor}{    \#ifdef ECONNREFUSED}}
\DoxyCodeLine{3277         \textcolor{keywordflow}{case} ECONNREFUSED: \textcolor{keywordflow}{return} DRMP3\_CONNECTION\_REFUSED;}
\DoxyCodeLine{3278 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3279 \textcolor{preprocessor}{    \#ifdef EHOSTDOWN}}
\DoxyCodeLine{3280         \textcolor{keywordflow}{case} EHOSTDOWN: \textcolor{keywordflow}{return} DRMP3\_NO\_HOST;}
\DoxyCodeLine{3281 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3282 \textcolor{preprocessor}{    \#ifdef EHOSTUNREACH}}
\DoxyCodeLine{3283         \textcolor{keywordflow}{case} EHOSTUNREACH: \textcolor{keywordflow}{return} DRMP3\_NO\_HOST;}
\DoxyCodeLine{3284 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3285 \textcolor{preprocessor}{    \#ifdef EALREADY}}
\DoxyCodeLine{3286         \textcolor{keywordflow}{case} EALREADY: \textcolor{keywordflow}{return} DRMP3\_IN\_PROGRESS;}
\DoxyCodeLine{3287 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3288 \textcolor{preprocessor}{    \#ifdef EINPROGRESS}}
\DoxyCodeLine{3289         \textcolor{keywordflow}{case} EINPROGRESS: \textcolor{keywordflow}{return} DRMP3\_IN\_PROGRESS;}
\DoxyCodeLine{3290 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3291 \textcolor{preprocessor}{    \#ifdef ESTALE}}
\DoxyCodeLine{3292         \textcolor{keywordflow}{case} ESTALE: \textcolor{keywordflow}{return} DRMP3\_INVALID\_FILE;}
\DoxyCodeLine{3293 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3294 \textcolor{preprocessor}{    \#ifdef EUCLEAN}}
\DoxyCodeLine{3295         \textcolor{keywordflow}{case} EUCLEAN: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3296 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3297 \textcolor{preprocessor}{    \#ifdef ENOTNAM}}
\DoxyCodeLine{3298         \textcolor{keywordflow}{case} ENOTNAM: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3299 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3300 \textcolor{preprocessor}{    \#ifdef ENAVAIL}}
\DoxyCodeLine{3301         \textcolor{keywordflow}{case} ENAVAIL: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3302 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3303 \textcolor{preprocessor}{    \#ifdef EISNAM}}
\DoxyCodeLine{3304         \textcolor{keywordflow}{case} EISNAM: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3305 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3306 \textcolor{preprocessor}{    \#ifdef EREMOTEIO}}
\DoxyCodeLine{3307         \textcolor{keywordflow}{case} EREMOTEIO: \textcolor{keywordflow}{return} DRMP3\_IO\_ERROR;}
\DoxyCodeLine{3308 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3309 \textcolor{preprocessor}{    \#ifdef EDQUOT}}
\DoxyCodeLine{3310         \textcolor{keywordflow}{case} EDQUOT: \textcolor{keywordflow}{return} DRMP3\_NO\_SPACE;}
\DoxyCodeLine{3311 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3312 \textcolor{preprocessor}{    \#ifdef ENOMEDIUM}}
\DoxyCodeLine{3313         \textcolor{keywordflow}{case} ENOMEDIUM: \textcolor{keywordflow}{return} DRMP3\_DOES\_NOT\_EXIST;}
\DoxyCodeLine{3314 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3315 \textcolor{preprocessor}{    \#ifdef EMEDIUMTYPE}}
\DoxyCodeLine{3316         \textcolor{keywordflow}{case} EMEDIUMTYPE: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3317 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3318 \textcolor{preprocessor}{    \#ifdef ECANCELED}}
\DoxyCodeLine{3319         \textcolor{keywordflow}{case} ECANCELED: \textcolor{keywordflow}{return} DRMP3\_CANCELLED;}
\DoxyCodeLine{3320 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3321 \textcolor{preprocessor}{    \#ifdef ENOKEY}}
\DoxyCodeLine{3322         \textcolor{keywordflow}{case} ENOKEY: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3323 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3324 \textcolor{preprocessor}{    \#ifdef EKEYEXPIRED}}
\DoxyCodeLine{3325         \textcolor{keywordflow}{case} EKEYEXPIRED: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3326 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3327 \textcolor{preprocessor}{    \#ifdef EKEYREVOKED}}
\DoxyCodeLine{3328         \textcolor{keywordflow}{case} EKEYREVOKED: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3329 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3330 \textcolor{preprocessor}{    \#ifdef EKEYREJECTED}}
\DoxyCodeLine{3331         \textcolor{keywordflow}{case} EKEYREJECTED: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3332 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3333 \textcolor{preprocessor}{    \#ifdef EOWNERDEAD}}
\DoxyCodeLine{3334         \textcolor{keywordflow}{case} EOWNERDEAD: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3335 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3336 \textcolor{preprocessor}{    \#ifdef ENOTRECOVERABLE}}
\DoxyCodeLine{3337         \textcolor{keywordflow}{case} ENOTRECOVERABLE: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3338 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3339 \textcolor{preprocessor}{    \#ifdef ERFKILL}}
\DoxyCodeLine{3340         \textcolor{keywordflow}{case} ERFKILL: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3341 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3342 \textcolor{preprocessor}{    \#ifdef EHWPOISON}}
\DoxyCodeLine{3343         \textcolor{keywordflow}{case} EHWPOISON: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3344 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3345         \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3346     \}}
\DoxyCodeLine{3347 \}}
\DoxyCodeLine{3348 }
\DoxyCodeLine{3349 \textcolor{keyword}{static} drmp3\_result drmp3\_fopen(FILE** ppFile, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFilePath, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pOpenMode)}
\DoxyCodeLine{3350 \{}
\DoxyCodeLine{3351 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{3352     errno\_t err;}
\DoxyCodeLine{3353 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3354 }
\DoxyCodeLine{3355     \textcolor{keywordflow}{if} (ppFile != NULL) \{}
\DoxyCodeLine{3356         *ppFile = NULL;  \textcolor{comment}{/* Safety. */}}
\DoxyCodeLine{3357     \}}
\DoxyCodeLine{3358 }
\DoxyCodeLine{3359     \textcolor{keywordflow}{if} (pFilePath == NULL || pOpenMode == NULL || ppFile == NULL) \{}
\DoxyCodeLine{3360         \textcolor{keywordflow}{return} DRMP3\_INVALID\_ARGS;}
\DoxyCodeLine{3361     \}}
\DoxyCodeLine{3362 }
\DoxyCodeLine{3363 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{3364     err = fopen\_s(ppFile, pFilePath, pOpenMode);}
\DoxyCodeLine{3365     \textcolor{keywordflow}{if} (err != 0) \{}
\DoxyCodeLine{3366         \textcolor{keywordflow}{return} drmp3\_result\_from\_errno(err);}
\DoxyCodeLine{3367     \}}
\DoxyCodeLine{3368 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3369 \textcolor{preprocessor}{\#if defined(\_WIN32) || defined(\_\_APPLE\_\_)}}
\DoxyCodeLine{3370     *ppFile = fopen(pFilePath, pOpenMode);}
\DoxyCodeLine{3371 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3372 \textcolor{preprocessor}{    \#if defined(\_FILE\_OFFSET\_BITS) \&\& \_FILE\_OFFSET\_BITS == 64 \&\& defined(\_LARGEFILE64\_SOURCE)}}
\DoxyCodeLine{3373         *ppFile = fopen64(pFilePath, pOpenMode);}
\DoxyCodeLine{3374 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{3375         *ppFile = fopen(pFilePath, pOpenMode);}
\DoxyCodeLine{3376 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3377 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3378     \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{3379         drmp3\_result result = drmp3\_result\_from\_errno(errno);}
\DoxyCodeLine{3380         \textcolor{keywordflow}{if} (result == DRMP3\_SUCCESS) \{}
\DoxyCodeLine{3381             result = DRMP3\_ERROR;   \textcolor{comment}{/* Just a safety check to make sure we never ever return success when pFile == NULL. */}}
\DoxyCodeLine{3382         \}}
\DoxyCodeLine{3383 }
\DoxyCodeLine{3384         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3385     \}}
\DoxyCodeLine{3386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3387 }
\DoxyCodeLine{3388     \textcolor{keywordflow}{return} DRMP3\_SUCCESS;}
\DoxyCodeLine{3389 \}}
\DoxyCodeLine{3390 }
\DoxyCodeLine{3391 \textcolor{comment}{/*}}
\DoxyCodeLine{3392 \textcolor{comment}{\_wfopen() isn't always available in all compilation environments.}}
\DoxyCodeLine{3393 \textcolor{comment}{}}
\DoxyCodeLine{3394 \textcolor{comment}{    * Windows only.}}
\DoxyCodeLine{3395 \textcolor{comment}{    * MSVC seems to support it universally as far back as VC6 from what I can tell (haven't checked further back).}}
\DoxyCodeLine{3396 \textcolor{comment}{    * MinGW-\/64 (both 32-\/ and 64-\/bit) seems to support it.}}
\DoxyCodeLine{3397 \textcolor{comment}{    * MinGW wraps it in !defined(\_\_STRICT\_ANSI\_\_).}}
\DoxyCodeLine{3398 \textcolor{comment}{    * OpenWatcom wraps it in !defined(\_NO\_EXT\_KEYS).}}
\DoxyCodeLine{3399 \textcolor{comment}{}}
\DoxyCodeLine{3400 \textcolor{comment}{This can be reviewed as compatibility issues arise. The preference is to use \_wfopen\_s() and \_wfopen() as opposed to the wcsrtombs()}}
\DoxyCodeLine{3401 \textcolor{comment}{fallback, so if you notice your compiler not detecting this properly I'm happy to look at adding support.}}
\DoxyCodeLine{3402 \textcolor{comment}{*/}}
\DoxyCodeLine{3403 \textcolor{preprocessor}{\#if defined(\_WIN32)}}
\DoxyCodeLine{3404 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) || defined(\_\_MINGW64\_\_) || (!defined(\_\_STRICT\_ANSI\_\_) \&\& !defined(\_NO\_EXT\_KEYS))}}
\DoxyCodeLine{3405 \textcolor{preprocessor}{        \#define DRMP3\_HAS\_WFOPEN}}
\DoxyCodeLine{3406 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3407 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3408 }
\DoxyCodeLine{3409 \textcolor{keyword}{static} drmp3\_result drmp3\_wfopen(FILE** ppFile, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePath, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pOpenMode, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{3410 \{}
\DoxyCodeLine{3411     \textcolor{keywordflow}{if} (ppFile != NULL) \{}
\DoxyCodeLine{3412         *ppFile = NULL;  \textcolor{comment}{/* Safety. */}}
\DoxyCodeLine{3413     \}}
\DoxyCodeLine{3414 }
\DoxyCodeLine{3415     \textcolor{keywordflow}{if} (pFilePath == NULL || pOpenMode == NULL || ppFile == NULL) \{}
\DoxyCodeLine{3416         \textcolor{keywordflow}{return} DRMP3\_INVALID\_ARGS;}
\DoxyCodeLine{3417     \}}
\DoxyCodeLine{3418 }
\DoxyCodeLine{3419 \textcolor{preprocessor}{\#if defined(DRMP3\_HAS\_WFOPEN)}}
\DoxyCodeLine{3420     \{}
\DoxyCodeLine{3421         \textcolor{comment}{/* Use \_wfopen() on Windows. */}}
\DoxyCodeLine{3422 \textcolor{preprocessor}{    \#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{3423         errno\_t err = \_wfopen\_s(ppFile, pFilePath, pOpenMode);}
\DoxyCodeLine{3424         \textcolor{keywordflow}{if} (err != 0) \{}
\DoxyCodeLine{3425             \textcolor{keywordflow}{return} drmp3\_result\_from\_errno(err);}
\DoxyCodeLine{3426         \}}
\DoxyCodeLine{3427 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{3428         *ppFile = \_wfopen(pFilePath, pOpenMode);}
\DoxyCodeLine{3429         \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{3430             \textcolor{keywordflow}{return} drmp3\_result\_from\_errno(errno);}
\DoxyCodeLine{3431         \}}
\DoxyCodeLine{3432 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{3433         (void)pAllocationCallbacks;}
\DoxyCodeLine{3434     \}}
\DoxyCodeLine{3435 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3436     \textcolor{comment}{/*}}
\DoxyCodeLine{3437 \textcolor{comment}{    Use fopen() on anything other than Windows. Requires a conversion. This is annoying because fopen() is locale specific. The only real way I can}}
\DoxyCodeLine{3438 \textcolor{comment}{    think of to do this is with wcsrtombs(). Note that wcstombs() is apparently not thread-\/safe because it uses a static global mbstate\_t object for}}
\DoxyCodeLine{3439 \textcolor{comment}{    maintaining state. I've checked this with -\/std=c89 and it works, but if somebody get's a compiler error I'll look into improving compatibility.}}
\DoxyCodeLine{3440 \textcolor{comment}{    */}}
\DoxyCodeLine{3441     \{}
\DoxyCodeLine{3442         mbstate\_t mbs;}
\DoxyCodeLine{3443         \textcolor{keywordtype}{size\_t} lenMB;}
\DoxyCodeLine{3444         \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePathTemp = pFilePath;}
\DoxyCodeLine{3445         \textcolor{keywordtype}{char}* pFilePathMB = NULL;}
\DoxyCodeLine{3446         \textcolor{keywordtype}{char} pOpenModeMB[32] = \{0\};}
\DoxyCodeLine{3447 }
\DoxyCodeLine{3448         \textcolor{comment}{/* Get the length first. */}}
\DoxyCodeLine{3449         DRMP3\_ZERO\_OBJECT(\&mbs);}
\DoxyCodeLine{3450         lenMB = wcsrtombs(NULL, \&pFilePathTemp, 0, \&mbs);}
\DoxyCodeLine{3451         \textcolor{keywordflow}{if} (lenMB == (\textcolor{keywordtype}{size\_t})-\/1) \{}
\DoxyCodeLine{3452             \textcolor{keywordflow}{return} drmp3\_result\_from\_errno(errno);}
\DoxyCodeLine{3453         \}}
\DoxyCodeLine{3454 }
\DoxyCodeLine{3455         pFilePathMB = (\textcolor{keywordtype}{char}*)drmp3\_\_malloc\_from\_callbacks(lenMB + 1, pAllocationCallbacks);}
\DoxyCodeLine{3456         \textcolor{keywordflow}{if} (pFilePathMB == NULL) \{}
\DoxyCodeLine{3457             \textcolor{keywordflow}{return} DRMP3\_OUT\_OF\_MEMORY;}
\DoxyCodeLine{3458         \}}
\DoxyCodeLine{3459 }
\DoxyCodeLine{3460         pFilePathTemp = pFilePath;}
\DoxyCodeLine{3461         DRMP3\_ZERO\_OBJECT(\&mbs);}
\DoxyCodeLine{3462         wcsrtombs(pFilePathMB, \&pFilePathTemp, lenMB + 1, \&mbs);}
\DoxyCodeLine{3463 }
\DoxyCodeLine{3464         \textcolor{comment}{/* The open mode should always consist of ASCII characters so we should be able to do a trivial conversion. */}}
\DoxyCodeLine{3465         \{}
\DoxyCodeLine{3466             \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{3467             \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3468                 \textcolor{keywordflow}{if} (pOpenMode[i] == 0) \{}
\DoxyCodeLine{3469                     pOpenModeMB[i] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{3470                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{3471                 \}}
\DoxyCodeLine{3472 }
\DoxyCodeLine{3473                 pOpenModeMB[i] = (char)pOpenMode[i];}
\DoxyCodeLine{3474                 i += 1;}
\DoxyCodeLine{3475             \}}
\DoxyCodeLine{3476         \}}
\DoxyCodeLine{3477 }
\DoxyCodeLine{3478         *ppFile = fopen(pFilePathMB, pOpenModeMB);}
\DoxyCodeLine{3479 }
\DoxyCodeLine{3480         drmp3\_\_free\_from\_callbacks(pFilePathMB, pAllocationCallbacks);}
\DoxyCodeLine{3481     \}}
\DoxyCodeLine{3482 }
\DoxyCodeLine{3483     \textcolor{keywordflow}{if} (*ppFile == NULL) \{}
\DoxyCodeLine{3484         \textcolor{keywordflow}{return} DRMP3\_ERROR;}
\DoxyCodeLine{3485     \}}
\DoxyCodeLine{3486 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3487 }
\DoxyCodeLine{3488     \textcolor{keywordflow}{return} DRMP3\_SUCCESS;}
\DoxyCodeLine{3489 \}}
\DoxyCodeLine{3490 }
\DoxyCodeLine{3491 }
\DoxyCodeLine{3492 }
\DoxyCodeLine{3493 \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} drmp3\_\_on\_read\_stdio(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{void}* pBufferOut, \textcolor{keywordtype}{size\_t} bytesToRead)}
\DoxyCodeLine{3494 \{}
\DoxyCodeLine{3495     \textcolor{keywordflow}{return} fread(pBufferOut, 1, bytesToRead, (FILE*)pUserData);}
\DoxyCodeLine{3496 \}}
\DoxyCodeLine{3497 }
\DoxyCodeLine{3498 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_\_on\_seek\_stdio(\textcolor{keywordtype}{void}* pUserData, \textcolor{keywordtype}{int} offset, drmp3\_seek\_origin origin)}
\DoxyCodeLine{3499 \{}
\DoxyCodeLine{3500     \textcolor{keywordflow}{return} fseek((FILE*)pUserData, offset, (origin == drmp3\_seek\_origin\_current) ? SEEK\_CUR : SEEK\_SET) == 0;}
\DoxyCodeLine{3501 \}}
\DoxyCodeLine{3502 }
\DoxyCodeLine{3503 DRMP3\_API drmp3\_bool32 drmp3\_init\_file(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* pFilePath, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{3504 \{}
\DoxyCodeLine{3505     drmp3\_bool32 result;}
\DoxyCodeLine{3506     FILE* pFile;}
\DoxyCodeLine{3507 }
\DoxyCodeLine{3508     \textcolor{keywordflow}{if} (drmp3\_fopen(\&pFile, pFilePath, \textcolor{stringliteral}{"{}rb"{}}) != DRMP3\_SUCCESS) \{}
\DoxyCodeLine{3509         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3510     \}}
\DoxyCodeLine{3511 }
\DoxyCodeLine{3512     result = drmp3\_init(pMP3, drmp3\_\_on\_read\_stdio, drmp3\_\_on\_seek\_stdio, (\textcolor{keywordtype}{void}*)pFile, pAllocationCallbacks);}
\DoxyCodeLine{3513     \textcolor{keywordflow}{if} (result != DRMP3\_TRUE) \{}
\DoxyCodeLine{3514         fclose(pFile);}
\DoxyCodeLine{3515         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3516     \}}
\DoxyCodeLine{3517 }
\DoxyCodeLine{3518     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3519 \}}
\DoxyCodeLine{3520 }
\DoxyCodeLine{3521 DRMP3\_API drmp3\_bool32 drmp3\_init\_file\_w(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* pFilePath, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{3522 \{}
\DoxyCodeLine{3523     drmp3\_bool32 result;}
\DoxyCodeLine{3524     FILE* pFile;}
\DoxyCodeLine{3525 }
\DoxyCodeLine{3526     \textcolor{keywordflow}{if} (drmp3\_wfopen(\&pFile, pFilePath, L\textcolor{stringliteral}{"{}rb"{}}, pAllocationCallbacks) != DRMP3\_SUCCESS) \{}
\DoxyCodeLine{3527         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3528     \}}
\DoxyCodeLine{3529 }
\DoxyCodeLine{3530     result = drmp3\_init(pMP3, drmp3\_\_on\_read\_stdio, drmp3\_\_on\_seek\_stdio, (\textcolor{keywordtype}{void}*)pFile, pAllocationCallbacks);}
\DoxyCodeLine{3531     \textcolor{keywordflow}{if} (result != DRMP3\_TRUE) \{}
\DoxyCodeLine{3532         fclose(pFile);}
\DoxyCodeLine{3533         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3534     \}}
\DoxyCodeLine{3535 }
\DoxyCodeLine{3536     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3537 \}}
\DoxyCodeLine{3538 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3539 }
\DoxyCodeLine{3540 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_uninit(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{3541 \{}
\DoxyCodeLine{3542     \textcolor{keywordflow}{if} (pMP3 == NULL) \{}
\DoxyCodeLine{3543         \textcolor{keywordflow}{return};}
\DoxyCodeLine{3544     \}}
\DoxyCodeLine{3545     }
\DoxyCodeLine{3546 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{3547     \textcolor{keywordflow}{if} (pMP3-\/>onRead == drmp3\_\_on\_read\_stdio) \{}
\DoxyCodeLine{3548         FILE* pFile = (FILE*)pMP3-\/>pUserData;}
\DoxyCodeLine{3549         if (pFile != NULL) \{}
\DoxyCodeLine{3550             fclose(pFile);}
\DoxyCodeLine{3551             pMP3-\/>pUserData = NULL; \textcolor{comment}{/* Make sure the file handle is cleared to NULL to we don't attempt to close it a second time. */}}
\DoxyCodeLine{3552         \}}
\DoxyCodeLine{3553     \}}
\DoxyCodeLine{3554 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3555 }
\DoxyCodeLine{3556     drmp3\_\_free\_from\_callbacks(pMP3-\/>pData, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{3557 \}}
\DoxyCodeLine{3558 }
\DoxyCodeLine{3559 \textcolor{preprocessor}{\#if defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3560 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_f32\_to\_s16(drmp3\_int16* dst, \textcolor{keyword}{const} \textcolor{keywordtype}{float}* src, drmp3\_uint64 sampleCount)}
\DoxyCodeLine{3561 \{}
\DoxyCodeLine{3562     drmp3\_uint64 i;}
\DoxyCodeLine{3563     drmp3\_uint64 i4;}
\DoxyCodeLine{3564     drmp3\_uint64 sampleCount4;}
\DoxyCodeLine{3565 }
\DoxyCodeLine{3566     \textcolor{comment}{/* Unrolled. */}}
\DoxyCodeLine{3567     i = 0;}
\DoxyCodeLine{3568     sampleCount4 = sampleCount >> 2;}
\DoxyCodeLine{3569     \textcolor{keywordflow}{for} (i4 = 0; i4 < sampleCount4; i4 += 1) \{}
\DoxyCodeLine{3570         \textcolor{keywordtype}{float} x0 = src[i+0];}
\DoxyCodeLine{3571         \textcolor{keywordtype}{float} x1 = src[i+1];}
\DoxyCodeLine{3572         \textcolor{keywordtype}{float} x2 = src[i+2];}
\DoxyCodeLine{3573         \textcolor{keywordtype}{float} x3 = src[i+3];}
\DoxyCodeLine{3574 }
\DoxyCodeLine{3575         x0 = ((x0 < -\/1) ? -\/1 : ((x0 > 1) ? 1 : x0));}
\DoxyCodeLine{3576         x1 = ((x1 < -\/1) ? -\/1 : ((x1 > 1) ? 1 : x1));}
\DoxyCodeLine{3577         x2 = ((x2 < -\/1) ? -\/1 : ((x2 > 1) ? 1 : x2));}
\DoxyCodeLine{3578         x3 = ((x3 < -\/1) ? -\/1 : ((x3 > 1) ? 1 : x3));}
\DoxyCodeLine{3579 }
\DoxyCodeLine{3580         x0 = x0 * 32767.0f;}
\DoxyCodeLine{3581         x1 = x1 * 32767.0f;}
\DoxyCodeLine{3582         x2 = x2 * 32767.0f;}
\DoxyCodeLine{3583         x3 = x3 * 32767.0f;}
\DoxyCodeLine{3584 }
\DoxyCodeLine{3585         dst[i+0] = (drmp3\_int16)x0;}
\DoxyCodeLine{3586         dst[i+1] = (drmp3\_int16)x1;}
\DoxyCodeLine{3587         dst[i+2] = (drmp3\_int16)x2;}
\DoxyCodeLine{3588         dst[i+3] = (drmp3\_int16)x3;}
\DoxyCodeLine{3589 }
\DoxyCodeLine{3590         i += 4;}
\DoxyCodeLine{3591     \}}
\DoxyCodeLine{3592 }
\DoxyCodeLine{3593     \textcolor{comment}{/* Leftover. */}}
\DoxyCodeLine{3594     \textcolor{keywordflow}{for} (; i < sampleCount; i += 1) \{}
\DoxyCodeLine{3595         \textcolor{keywordtype}{float} x = src[i];}
\DoxyCodeLine{3596         x = ((x < -\/1) ? -\/1 : ((x > 1) ? 1 : x));    \textcolor{comment}{/* clip */}}
\DoxyCodeLine{3597         x = x * 32767.0f;                           \textcolor{comment}{/* -\/1..1 to -\/32767..32767 */}}
\DoxyCodeLine{3598 }
\DoxyCodeLine{3599         dst[i] = (drmp3\_int16)x;}
\DoxyCodeLine{3600     \}}
\DoxyCodeLine{3601 \}}
\DoxyCodeLine{3602 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3603 }
\DoxyCodeLine{3604 \textcolor{preprocessor}{\#if !defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3605 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_s16\_to\_f32(\textcolor{keywordtype}{float}* dst, \textcolor{keyword}{const} drmp3\_int16* src, drmp3\_uint64 sampleCount)}
\DoxyCodeLine{3606 \{}
\DoxyCodeLine{3607     drmp3\_uint64 i;}
\DoxyCodeLine{3608     \textcolor{keywordflow}{for} (i = 0; i < sampleCount; i += 1) \{}
\DoxyCodeLine{3609         \textcolor{keywordtype}{float} x = (float)src[i];}
\DoxyCodeLine{3610         x = x * 0.000030517578125f;         \textcolor{comment}{/* -\/32768..32767 to -\/1..0.999969482421875 */}}
\DoxyCodeLine{3611         dst[i] = x;}
\DoxyCodeLine{3612     \}}
\DoxyCodeLine{3613 \}}
\DoxyCodeLine{3614 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3615 }
\DoxyCodeLine{3616 }
\DoxyCodeLine{3617 \textcolor{keyword}{static} drmp3\_uint64 drmp3\_read\_pcm\_frames\_raw(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 framesToRead, \textcolor{keywordtype}{void}* pBufferOut)}
\DoxyCodeLine{3618 \{}
\DoxyCodeLine{3619     drmp3\_uint64 totalFramesRead = 0;}
\DoxyCodeLine{3620 }
\DoxyCodeLine{3621     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{3622     DRMP3\_ASSERT(pMP3-\/>onRead != NULL);}
\DoxyCodeLine{3623 }
\DoxyCodeLine{3624     \textcolor{keywordflow}{while} (framesToRead > 0) \{}
\DoxyCodeLine{3625         drmp3\_uint32 framesToConsume = (drmp3\_uint32)DRMP3\_MIN(pMP3-\/>pcmFramesRemainingInMP3Frame, framesToRead);}
\DoxyCodeLine{3626         \textcolor{keywordflow}{if} (pBufferOut != NULL) \{}
\DoxyCodeLine{3627 \textcolor{preprocessor}{        \#if defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3628             \textcolor{comment}{/* f32 */}}
\DoxyCodeLine{3629             \textcolor{keywordtype}{float}* pFramesOutF32 = (\textcolor{keywordtype}{float}*)DRMP3\_OFFSET\_PTR(pBufferOut,          \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * totalFramesRead                   * pMP3-\/>channels);}
\DoxyCodeLine{3630             \textcolor{keywordtype}{float}* pFramesInF32  = (\textcolor{keywordtype}{float}*)DRMP3\_OFFSET\_PTR(\&pMP3-\/>pcmFrames[0], \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * pMP3-\/>pcmFramesConsumedInMP3Frame * pMP3-\/>mp3FrameChannels);}
\DoxyCodeLine{3631             DRMP3\_COPY\_MEMORY(pFramesOutF32, pFramesInF32, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * framesToConsume * pMP3-\/>channels);}
\DoxyCodeLine{3632 \textcolor{preprocessor}{        \#else}}
\DoxyCodeLine{3633             \textcolor{comment}{/* s16 */}}
\DoxyCodeLine{3634             drmp3\_int16* pFramesOutS16 = (drmp3\_int16*)DRMP3\_OFFSET\_PTR(pBufferOut,          \textcolor{keyword}{sizeof}(drmp3\_int16) * totalFramesRead                   * pMP3-\/>channels);}
\DoxyCodeLine{3635             drmp3\_int16* pFramesInS16  = (drmp3\_int16*)DRMP3\_OFFSET\_PTR(\&pMP3-\/>pcmFrames[0], \textcolor{keyword}{sizeof}(drmp3\_int16) * pMP3-\/>pcmFramesConsumedInMP3Frame * pMP3-\/>mp3FrameChannels);}
\DoxyCodeLine{3636             DRMP3\_COPY\_MEMORY(pFramesOutS16, pFramesInS16, \textcolor{keyword}{sizeof}(drmp3\_int16) * framesToConsume * pMP3-\/>channels);}
\DoxyCodeLine{3637 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{3638         \}}
\DoxyCodeLine{3639 }
\DoxyCodeLine{3640         pMP3-\/>currentPCMFrame              += framesToConsume;}
\DoxyCodeLine{3641         pMP3-\/>pcmFramesConsumedInMP3Frame  += framesToConsume;}
\DoxyCodeLine{3642         pMP3-\/>pcmFramesRemainingInMP3Frame -\/= framesToConsume;}
\DoxyCodeLine{3643         totalFramesRead                    += framesToConsume;}
\DoxyCodeLine{3644         framesToRead                       -\/= framesToConsume;}
\DoxyCodeLine{3645 }
\DoxyCodeLine{3646         \textcolor{keywordflow}{if} (framesToRead == 0) \{}
\DoxyCodeLine{3647             \textcolor{keywordflow}{break};}
\DoxyCodeLine{3648         \}}
\DoxyCodeLine{3649 }
\DoxyCodeLine{3650         DRMP3\_ASSERT(pMP3-\/>pcmFramesRemainingInMP3Frame == 0);}
\DoxyCodeLine{3651 }
\DoxyCodeLine{3652         \textcolor{comment}{/*}}
\DoxyCodeLine{3653 \textcolor{comment}{        At this point we have exhausted our in-\/memory buffer so we need to re-\/fill. Note that the sample rate may have changed}}
\DoxyCodeLine{3654 \textcolor{comment}{        at this point which means we'll also need to update our sample rate conversion pipeline.}}
\DoxyCodeLine{3655 \textcolor{comment}{        */}}
\DoxyCodeLine{3656         \textcolor{keywordflow}{if} (drmp3\_decode\_next\_frame(pMP3) == 0) \{}
\DoxyCodeLine{3657             \textcolor{keywordflow}{break};}
\DoxyCodeLine{3658         \}}
\DoxyCodeLine{3659     \}}
\DoxyCodeLine{3660 }
\DoxyCodeLine{3661     \textcolor{keywordflow}{return} totalFramesRead;}
\DoxyCodeLine{3662 \}}
\DoxyCodeLine{3663 }
\DoxyCodeLine{3664 }
\DoxyCodeLine{3665 DRMP3\_API drmp3\_uint64 drmp3\_read\_pcm\_frames\_f32(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 framesToRead, \textcolor{keywordtype}{float}* pBufferOut)}
\DoxyCodeLine{3666 \{}
\DoxyCodeLine{3667     \textcolor{keywordflow}{if} (pMP3 == NULL || pMP3-\/>onRead == NULL) \{}
\DoxyCodeLine{3668         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3669     \}}
\DoxyCodeLine{3670 }
\DoxyCodeLine{3671 \textcolor{preprocessor}{\#if defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3672     \textcolor{comment}{/* Fast path. No conversion required. */}}
\DoxyCodeLine{3673     \textcolor{keywordflow}{return} drmp3\_read\_pcm\_frames\_raw(pMP3, framesToRead, pBufferOut);}
\DoxyCodeLine{3674 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3675     \textcolor{comment}{/* Slow path. Convert from s16 to f32. */}}
\DoxyCodeLine{3676     \{}
\DoxyCodeLine{3677         drmp3\_int16 pTempS16[8192];}
\DoxyCodeLine{3678         drmp3\_uint64 totalPCMFramesRead = 0;}
\DoxyCodeLine{3679 }
\DoxyCodeLine{3680         \textcolor{keywordflow}{while} (totalPCMFramesRead < framesToRead) \{}
\DoxyCodeLine{3681             drmp3\_uint64 framesJustRead;}
\DoxyCodeLine{3682             drmp3\_uint64 framesRemaining = framesToRead -\/ totalPCMFramesRead;}
\DoxyCodeLine{3683             drmp3\_uint64 framesToReadNow = DRMP3\_COUNTOF(pTempS16) / pMP3-\/>channels;}
\DoxyCodeLine{3684             \textcolor{keywordflow}{if} (framesToReadNow > framesRemaining) \{}
\DoxyCodeLine{3685                 framesToReadNow = framesRemaining;}
\DoxyCodeLine{3686             \}}
\DoxyCodeLine{3687 }
\DoxyCodeLine{3688             framesJustRead = drmp3\_read\_pcm\_frames\_raw(pMP3, framesToReadNow, pTempS16);}
\DoxyCodeLine{3689             \textcolor{keywordflow}{if} (framesJustRead == 0) \{}
\DoxyCodeLine{3690                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3691             \}}
\DoxyCodeLine{3692 }
\DoxyCodeLine{3693             drmp3\_s16\_to\_f32((\textcolor{keywordtype}{float}*)DRMP3\_OFFSET\_PTR(pBufferOut, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * totalPCMFramesRead * pMP3-\/>channels), pTempS16, framesJustRead * pMP3-\/>channels);}
\DoxyCodeLine{3694             totalPCMFramesRead += framesJustRead;}
\DoxyCodeLine{3695         \}}
\DoxyCodeLine{3696 }
\DoxyCodeLine{3697         \textcolor{keywordflow}{return} totalPCMFramesRead;}
\DoxyCodeLine{3698     \}}
\DoxyCodeLine{3699 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3700 \}}
\DoxyCodeLine{3701 }
\DoxyCodeLine{3702 DRMP3\_API drmp3\_uint64 drmp3\_read\_pcm\_frames\_s16(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 framesToRead, drmp3\_int16* pBufferOut)}
\DoxyCodeLine{3703 \{}
\DoxyCodeLine{3704     \textcolor{keywordflow}{if} (pMP3 == NULL || pMP3-\/>onRead == NULL) \{}
\DoxyCodeLine{3705         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3706     \}}
\DoxyCodeLine{3707 }
\DoxyCodeLine{3708 \textcolor{preprocessor}{\#if !defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3709     \textcolor{comment}{/* Fast path. No conversion required. */}}
\DoxyCodeLine{3710     \textcolor{keywordflow}{return} drmp3\_read\_pcm\_frames\_raw(pMP3, framesToRead, pBufferOut);}
\DoxyCodeLine{3711 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3712     \textcolor{comment}{/* Slow path. Convert from f32 to s16. */}}
\DoxyCodeLine{3713     \{}
\DoxyCodeLine{3714         \textcolor{keywordtype}{float} pTempF32[4096];}
\DoxyCodeLine{3715         drmp3\_uint64 totalPCMFramesRead = 0;}
\DoxyCodeLine{3716 }
\DoxyCodeLine{3717         \textcolor{keywordflow}{while} (totalPCMFramesRead < framesToRead) \{}
\DoxyCodeLine{3718             drmp3\_uint64 framesJustRead;}
\DoxyCodeLine{3719             drmp3\_uint64 framesRemaining = framesToRead -\/ totalPCMFramesRead;}
\DoxyCodeLine{3720             drmp3\_uint64 framesToReadNow = DRMP3\_COUNTOF(pTempF32) / pMP3-\/>channels;}
\DoxyCodeLine{3721             \textcolor{keywordflow}{if} (framesToReadNow > framesRemaining) \{}
\DoxyCodeLine{3722                 framesToReadNow = framesRemaining;}
\DoxyCodeLine{3723             \}}
\DoxyCodeLine{3724 }
\DoxyCodeLine{3725             framesJustRead = drmp3\_read\_pcm\_frames\_raw(pMP3, framesToReadNow, pTempF32);}
\DoxyCodeLine{3726             \textcolor{keywordflow}{if} (framesJustRead == 0) \{}
\DoxyCodeLine{3727                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3728             \}}
\DoxyCodeLine{3729 }
\DoxyCodeLine{3730             drmp3\_f32\_to\_s16((drmp3\_int16*)DRMP3\_OFFSET\_PTR(pBufferOut, \textcolor{keyword}{sizeof}(drmp3\_int16) * totalPCMFramesRead * pMP3-\/>channels), pTempF32, framesJustRead * pMP3-\/>channels);}
\DoxyCodeLine{3731             totalPCMFramesRead += framesJustRead;}
\DoxyCodeLine{3732         \}}
\DoxyCodeLine{3733 }
\DoxyCodeLine{3734         \textcolor{keywordflow}{return} totalPCMFramesRead;}
\DoxyCodeLine{3735     \}}
\DoxyCodeLine{3736 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3737 \}}
\DoxyCodeLine{3738 }
\DoxyCodeLine{3739 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_reset(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{3740 \{}
\DoxyCodeLine{3741     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{3742 }
\DoxyCodeLine{3743     pMP3-\/>pcmFramesConsumedInMP3Frame = 0;}
\DoxyCodeLine{3744     pMP3-\/>pcmFramesRemainingInMP3Frame = 0;}
\DoxyCodeLine{3745     pMP3-\/>currentPCMFrame = 0;}
\DoxyCodeLine{3746     pMP3-\/>dataSize = 0;}
\DoxyCodeLine{3747     pMP3-\/>atEnd = DRMP3\_FALSE;}
\DoxyCodeLine{3748     drmp3dec\_init(\&pMP3-\/>decoder);}
\DoxyCodeLine{3749 \}}
\DoxyCodeLine{3750 }
\DoxyCodeLine{3751 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_seek\_to\_start\_of\_stream(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{3752 \{}
\DoxyCodeLine{3753     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{3754     DRMP3\_ASSERT(pMP3-\/>onSeek != NULL);}
\DoxyCodeLine{3755 }
\DoxyCodeLine{3756     \textcolor{comment}{/* Seek to the start of the stream to begin with. */}}
\DoxyCodeLine{3757     \textcolor{keywordflow}{if} (!drmp3\_\_on\_seek(pMP3, 0, drmp3\_seek\_origin\_start)) \{}
\DoxyCodeLine{3758         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3759     \}}
\DoxyCodeLine{3760 }
\DoxyCodeLine{3761     \textcolor{comment}{/* Clear any cached data. */}}
\DoxyCodeLine{3762     drmp3\_reset(pMP3);}
\DoxyCodeLine{3763     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3764 \}}
\DoxyCodeLine{3765 }
\DoxyCodeLine{3766 }
\DoxyCodeLine{3767 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_seek\_forward\_by\_pcm\_frames\_\_brute\_force(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameOffset)}
\DoxyCodeLine{3768 \{}
\DoxyCodeLine{3769     drmp3\_uint64 framesRead;}
\DoxyCodeLine{3770 }
\DoxyCodeLine{3771     \textcolor{comment}{/*}}
\DoxyCodeLine{3772 \textcolor{comment}{    Just using a dumb read-\/and-\/discard for now. What would be nice is to parse only the header of the MP3 frame, and then skip over leading}}
\DoxyCodeLine{3773 \textcolor{comment}{    frames without spending the time doing a full decode. I cannot see an easy way to do this in minimp3, however, so it may involve some}}
\DoxyCodeLine{3774 \textcolor{comment}{    kind of manual processing.}}
\DoxyCodeLine{3775 \textcolor{comment}{    */}}
\DoxyCodeLine{3776 \textcolor{preprocessor}{\#if defined(DR\_MP3\_FLOAT\_OUTPUT)}}
\DoxyCodeLine{3777     framesRead = drmp3\_read\_pcm\_frames\_f32(pMP3, frameOffset, NULL);}
\DoxyCodeLine{3778 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{3779     framesRead = drmp3\_read\_pcm\_frames\_s16(pMP3, frameOffset, NULL);}
\DoxyCodeLine{3780 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3781     \textcolor{keywordflow}{if} (framesRead != frameOffset) \{}
\DoxyCodeLine{3782         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3783     \}}
\DoxyCodeLine{3784 }
\DoxyCodeLine{3785     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3786 \}}
\DoxyCodeLine{3787 }
\DoxyCodeLine{3788 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_seek\_to\_pcm\_frame\_\_brute\_force(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameIndex)}
\DoxyCodeLine{3789 \{}
\DoxyCodeLine{3790     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{3791 }
\DoxyCodeLine{3792     \textcolor{keywordflow}{if} (frameIndex == pMP3-\/>currentPCMFrame) \{}
\DoxyCodeLine{3793         \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3794     \}}
\DoxyCodeLine{3795 }
\DoxyCodeLine{3796     \textcolor{comment}{/*}}
\DoxyCodeLine{3797 \textcolor{comment}{    If we're moving foward we just read from where we're at. Otherwise we need to move back to the start of}}
\DoxyCodeLine{3798 \textcolor{comment}{    the stream and read from the beginning.}}
\DoxyCodeLine{3799 \textcolor{comment}{    */}}
\DoxyCodeLine{3800     \textcolor{keywordflow}{if} (frameIndex < pMP3-\/>currentPCMFrame) \{}
\DoxyCodeLine{3801         \textcolor{comment}{/* Moving backward. Move to the start of the stream and then move forward. */}}
\DoxyCodeLine{3802         \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_start\_of\_stream(pMP3)) \{}
\DoxyCodeLine{3803             \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3804         \}}
\DoxyCodeLine{3805     \}}
\DoxyCodeLine{3806 }
\DoxyCodeLine{3807     DRMP3\_ASSERT(frameIndex >= pMP3-\/>currentPCMFrame);}
\DoxyCodeLine{3808     \textcolor{keywordflow}{return} drmp3\_seek\_forward\_by\_pcm\_frames\_\_brute\_force(pMP3, (frameIndex -\/ pMP3-\/>currentPCMFrame));}
\DoxyCodeLine{3809 \}}
\DoxyCodeLine{3810 }
\DoxyCodeLine{3811 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_find\_closest\_seek\_point(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameIndex, drmp3\_uint32* pSeekPointIndex)}
\DoxyCodeLine{3812 \{}
\DoxyCodeLine{3813     drmp3\_uint32 iSeekPoint;}
\DoxyCodeLine{3814 }
\DoxyCodeLine{3815     DRMP3\_ASSERT(pSeekPointIndex != NULL);}
\DoxyCodeLine{3816 }
\DoxyCodeLine{3817     *pSeekPointIndex = 0;}
\DoxyCodeLine{3818 }
\DoxyCodeLine{3819     \textcolor{keywordflow}{if} (frameIndex < pMP3-\/>pSeekPoints[0].pcmFrameIndex) \{}
\DoxyCodeLine{3820         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3821     \}}
\DoxyCodeLine{3822 }
\DoxyCodeLine{3823     \textcolor{comment}{/* Linear search for simplicity to begin with while I'm getting this thing working. Once it's all working change this to a binary search. */}}
\DoxyCodeLine{3824     \textcolor{keywordflow}{for} (iSeekPoint = 0; iSeekPoint < pMP3-\/>seekPointCount; ++iSeekPoint) \{}
\DoxyCodeLine{3825         \textcolor{keywordflow}{if} (pMP3-\/>pSeekPoints[iSeekPoint].pcmFrameIndex > frameIndex) \{}
\DoxyCodeLine{3826             \textcolor{keywordflow}{break};  \textcolor{comment}{/* Found it. */}}
\DoxyCodeLine{3827         \}}
\DoxyCodeLine{3828 }
\DoxyCodeLine{3829         *pSeekPointIndex = iSeekPoint;}
\DoxyCodeLine{3830     \}}
\DoxyCodeLine{3831 }
\DoxyCodeLine{3832     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3833 \}}
\DoxyCodeLine{3834 }
\DoxyCodeLine{3835 \textcolor{keyword}{static} drmp3\_bool32 drmp3\_seek\_to\_pcm\_frame\_\_seek\_table(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameIndex)}
\DoxyCodeLine{3836 \{}
\DoxyCodeLine{3837     \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}} seekPoint;}
\DoxyCodeLine{3838     drmp3\_uint32 priorSeekPointIndex;}
\DoxyCodeLine{3839     drmp3\_uint16 iMP3Frame;}
\DoxyCodeLine{3840     drmp3\_uint64 leftoverFrames;}
\DoxyCodeLine{3841 }
\DoxyCodeLine{3842     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{3843     DRMP3\_ASSERT(pMP3-\/>pSeekPoints != NULL);}
\DoxyCodeLine{3844     DRMP3\_ASSERT(pMP3-\/>seekPointCount > 0);}
\DoxyCodeLine{3845 }
\DoxyCodeLine{3846     \textcolor{comment}{/* If there is no prior seekpoint it means the target PCM frame comes before the first seek point. Just assume a seekpoint at the start of the file in this case. */}}
\DoxyCodeLine{3847     \textcolor{keywordflow}{if} (drmp3\_find\_closest\_seek\_point(pMP3, frameIndex, \&priorSeekPointIndex)) \{}
\DoxyCodeLine{3848         seekPoint = pMP3-\/>pSeekPoints[priorSeekPointIndex];}
\DoxyCodeLine{3849     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3850         seekPoint.seekPosInBytes     = 0;}
\DoxyCodeLine{3851         seekPoint.pcmFrameIndex      = 0;}
\DoxyCodeLine{3852         seekPoint.mp3FramesToDiscard = 0;}
\DoxyCodeLine{3853         seekPoint.pcmFramesToDiscard = 0;}
\DoxyCodeLine{3854     \}}
\DoxyCodeLine{3855 }
\DoxyCodeLine{3856     \textcolor{comment}{/* First thing to do is seek to the first byte of the relevant MP3 frame. */}}
\DoxyCodeLine{3857     \textcolor{keywordflow}{if} (!drmp3\_\_on\_seek\_64(pMP3, seekPoint.seekPosInBytes, drmp3\_seek\_origin\_start)) \{}
\DoxyCodeLine{3858         \textcolor{keywordflow}{return} DRMP3\_FALSE; \textcolor{comment}{/* Failed to seek. */}}
\DoxyCodeLine{3859     \}}
\DoxyCodeLine{3860 }
\DoxyCodeLine{3861     \textcolor{comment}{/* Clear any cached data. */}}
\DoxyCodeLine{3862     drmp3\_reset(pMP3);}
\DoxyCodeLine{3863 }
\DoxyCodeLine{3864     \textcolor{comment}{/* Whole MP3 frames need to be discarded first. */}}
\DoxyCodeLine{3865     \textcolor{keywordflow}{for} (iMP3Frame = 0; iMP3Frame < seekPoint.mp3FramesToDiscard; ++iMP3Frame) \{}
\DoxyCodeLine{3866         drmp3\_uint32 pcmFramesRead;}
\DoxyCodeLine{3867         drmp3d\_sample\_t* pPCMFrames;}
\DoxyCodeLine{3868 }
\DoxyCodeLine{3869         \textcolor{comment}{/* Pass in non-\/null for the last frame because we want to ensure the sample rate converter is preloaded correctly. */}}
\DoxyCodeLine{3870         pPCMFrames = NULL;}
\DoxyCodeLine{3871         \textcolor{keywordflow}{if} (iMP3Frame == seekPoint.mp3FramesToDiscard-\/1) \{}
\DoxyCodeLine{3872             pPCMFrames = (drmp3d\_sample\_t*)pMP3-\/>pcmFrames;}
\DoxyCodeLine{3873         \}}
\DoxyCodeLine{3874 }
\DoxyCodeLine{3875         \textcolor{comment}{/* We first need to decode the next frame. */}}
\DoxyCodeLine{3876         pcmFramesRead = drmp3\_decode\_next\_frame\_ex(pMP3, pPCMFrames);}
\DoxyCodeLine{3877         \textcolor{keywordflow}{if} (pcmFramesRead == 0) \{}
\DoxyCodeLine{3878             \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3879         \}}
\DoxyCodeLine{3880     \}}
\DoxyCodeLine{3881 }
\DoxyCodeLine{3882     \textcolor{comment}{/* We seeked to an MP3 frame in the raw stream so we need to make sure the current PCM frame is set correctly. */}}
\DoxyCodeLine{3883     pMP3-\/>currentPCMFrame = seekPoint.pcmFrameIndex -\/ seekPoint.pcmFramesToDiscard;}
\DoxyCodeLine{3884 }
\DoxyCodeLine{3885     \textcolor{comment}{/*}}
\DoxyCodeLine{3886 \textcolor{comment}{    Now at this point we can follow the same process as the brute force technique where we just skip over unnecessary MP3 frames and then}}
\DoxyCodeLine{3887 \textcolor{comment}{    read-\/and-\/discard at least 2 whole MP3 frames.}}
\DoxyCodeLine{3888 \textcolor{comment}{    */}}
\DoxyCodeLine{3889     leftoverFrames = frameIndex -\/ pMP3-\/>currentPCMFrame;}
\DoxyCodeLine{3890     \textcolor{keywordflow}{return} drmp3\_seek\_forward\_by\_pcm\_frames\_\_brute\_force(pMP3, leftoverFrames);}
\DoxyCodeLine{3891 \}}
\DoxyCodeLine{3892 }
\DoxyCodeLine{3893 DRMP3\_API drmp3\_bool32 drmp3\_seek\_to\_pcm\_frame(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64 frameIndex)}
\DoxyCodeLine{3894 \{}
\DoxyCodeLine{3895     \textcolor{keywordflow}{if} (pMP3 == NULL || pMP3-\/>onSeek == NULL) \{}
\DoxyCodeLine{3896         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3897     \}}
\DoxyCodeLine{3898 }
\DoxyCodeLine{3899     \textcolor{keywordflow}{if} (frameIndex == 0) \{}
\DoxyCodeLine{3900         \textcolor{keywordflow}{return} drmp3\_seek\_to\_start\_of\_stream(pMP3);}
\DoxyCodeLine{3901     \}}
\DoxyCodeLine{3902 }
\DoxyCodeLine{3903     \textcolor{comment}{/* Use the seek table if we have one. */}}
\DoxyCodeLine{3904     \textcolor{keywordflow}{if} (pMP3-\/>pSeekPoints != NULL \&\& pMP3-\/>seekPointCount > 0) \{}
\DoxyCodeLine{3905         \textcolor{keywordflow}{return} drmp3\_seek\_to\_pcm\_frame\_\_seek\_table(pMP3, frameIndex);}
\DoxyCodeLine{3906     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3907         \textcolor{keywordflow}{return} drmp3\_seek\_to\_pcm\_frame\_\_brute\_force(pMP3, frameIndex);}
\DoxyCodeLine{3908     \}}
\DoxyCodeLine{3909 \}}
\DoxyCodeLine{3910 }
\DoxyCodeLine{3911 DRMP3\_API drmp3\_bool32 drmp3\_get\_mp3\_and\_pcm\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint64* pMP3FrameCount, drmp3\_uint64* pPCMFrameCount)}
\DoxyCodeLine{3912 \{}
\DoxyCodeLine{3913     drmp3\_uint64 currentPCMFrame;}
\DoxyCodeLine{3914     drmp3\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{3915     drmp3\_uint64 totalMP3FrameCount;}
\DoxyCodeLine{3916 }
\DoxyCodeLine{3917     \textcolor{keywordflow}{if} (pMP3 == NULL) \{}
\DoxyCodeLine{3918         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3919     \}}
\DoxyCodeLine{3920 }
\DoxyCodeLine{3921     \textcolor{comment}{/*}}
\DoxyCodeLine{3922 \textcolor{comment}{    The way this works is we move back to the start of the stream, iterate over each MP3 frame and calculate the frame count based}}
\DoxyCodeLine{3923 \textcolor{comment}{    on our output sample rate, the seek back to the PCM frame we were sitting on before calling this function.}}
\DoxyCodeLine{3924 \textcolor{comment}{    */}}
\DoxyCodeLine{3925 }
\DoxyCodeLine{3926     \textcolor{comment}{/* The stream must support seeking for this to work. */}}
\DoxyCodeLine{3927     \textcolor{keywordflow}{if} (pMP3-\/>onSeek == NULL) \{}
\DoxyCodeLine{3928         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3929     \}}
\DoxyCodeLine{3930 }
\DoxyCodeLine{3931     \textcolor{comment}{/* We'll need to seek back to where we were, so grab the PCM frame we're currently sitting on so we can restore later. */}}
\DoxyCodeLine{3932     currentPCMFrame = pMP3-\/>currentPCMFrame;}
\DoxyCodeLine{3933     }
\DoxyCodeLine{3934     \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_start\_of\_stream(pMP3)) \{}
\DoxyCodeLine{3935         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3936     \}}
\DoxyCodeLine{3937 }
\DoxyCodeLine{3938     totalPCMFrameCount = 0;}
\DoxyCodeLine{3939     totalMP3FrameCount = 0;}
\DoxyCodeLine{3940 }
\DoxyCodeLine{3941     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{3942         drmp3\_uint32 pcmFramesInCurrentMP3Frame;}
\DoxyCodeLine{3943 }
\DoxyCodeLine{3944         pcmFramesInCurrentMP3Frame = drmp3\_decode\_next\_frame\_ex(pMP3, NULL);}
\DoxyCodeLine{3945         \textcolor{keywordflow}{if} (pcmFramesInCurrentMP3Frame == 0) \{}
\DoxyCodeLine{3946             \textcolor{keywordflow}{break};}
\DoxyCodeLine{3947         \}}
\DoxyCodeLine{3948 }
\DoxyCodeLine{3949         totalPCMFrameCount += pcmFramesInCurrentMP3Frame;}
\DoxyCodeLine{3950         totalMP3FrameCount += 1;}
\DoxyCodeLine{3951     \}}
\DoxyCodeLine{3952 }
\DoxyCodeLine{3953     \textcolor{comment}{/* Finally, we need to seek back to where we were. */}}
\DoxyCodeLine{3954     \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_start\_of\_stream(pMP3)) \{}
\DoxyCodeLine{3955         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3956     \}}
\DoxyCodeLine{3957 }
\DoxyCodeLine{3958     \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_pcm\_frame(pMP3, currentPCMFrame)) \{}
\DoxyCodeLine{3959         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{3960     \}}
\DoxyCodeLine{3961 }
\DoxyCodeLine{3962     \textcolor{keywordflow}{if} (pMP3FrameCount != NULL) \{}
\DoxyCodeLine{3963         *pMP3FrameCount = totalMP3FrameCount;}
\DoxyCodeLine{3964     \}}
\DoxyCodeLine{3965     \textcolor{keywordflow}{if} (pPCMFrameCount != NULL) \{}
\DoxyCodeLine{3966         *pPCMFrameCount = totalPCMFrameCount;}
\DoxyCodeLine{3967     \}}
\DoxyCodeLine{3968 }
\DoxyCodeLine{3969     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{3970 \}}
\DoxyCodeLine{3971 }
\DoxyCodeLine{3972 DRMP3\_API drmp3\_uint64 drmp3\_get\_pcm\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{3973 \{}
\DoxyCodeLine{3974     drmp3\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{3975     \textcolor{keywordflow}{if} (!drmp3\_get\_mp3\_and\_pcm\_frame\_count(pMP3, NULL, \&totalPCMFrameCount)) \{}
\DoxyCodeLine{3976         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3977     \}}
\DoxyCodeLine{3978 }
\DoxyCodeLine{3979     \textcolor{keywordflow}{return} totalPCMFrameCount;}
\DoxyCodeLine{3980 \}}
\DoxyCodeLine{3981 }
\DoxyCodeLine{3982 DRMP3\_API drmp3\_uint64 drmp3\_get\_mp3\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3)}
\DoxyCodeLine{3983 \{}
\DoxyCodeLine{3984     drmp3\_uint64 totalMP3FrameCount;}
\DoxyCodeLine{3985     \textcolor{keywordflow}{if} (!drmp3\_get\_mp3\_and\_pcm\_frame\_count(pMP3, \&totalMP3FrameCount, NULL)) \{}
\DoxyCodeLine{3986         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3987     \}}
\DoxyCodeLine{3988 }
\DoxyCodeLine{3989     \textcolor{keywordflow}{return} totalMP3FrameCount;}
\DoxyCodeLine{3990 \}}
\DoxyCodeLine{3991 }
\DoxyCodeLine{3992 \textcolor{keyword}{static} \textcolor{keywordtype}{void} drmp3\_\_accumulate\_running\_pcm\_frame\_count(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint32 pcmFrameCountIn, drmp3\_uint64* pRunningPCMFrameCount, \textcolor{keywordtype}{float}* pRunningPCMFrameCountFractionalPart)}
\DoxyCodeLine{3993 \{}
\DoxyCodeLine{3994     \textcolor{keywordtype}{float} srcRatio;}
\DoxyCodeLine{3995     \textcolor{keywordtype}{float} pcmFrameCountOutF;}
\DoxyCodeLine{3996     drmp3\_uint32 pcmFrameCountOut;}
\DoxyCodeLine{3997 }
\DoxyCodeLine{3998     srcRatio = (float)pMP3-\/>mp3FrameSampleRate / (\textcolor{keywordtype}{float})pMP3-\/>sampleRate;}
\DoxyCodeLine{3999     DRMP3\_ASSERT(srcRatio > 0);}
\DoxyCodeLine{4000 }
\DoxyCodeLine{4001     pcmFrameCountOutF = *pRunningPCMFrameCountFractionalPart + (pcmFrameCountIn / srcRatio);}
\DoxyCodeLine{4002     pcmFrameCountOut  = (drmp3\_uint32)pcmFrameCountOutF;}
\DoxyCodeLine{4003     *pRunningPCMFrameCountFractionalPart = pcmFrameCountOutF -\/ pcmFrameCountOut;}
\DoxyCodeLine{4004     *pRunningPCMFrameCount += pcmFrameCountOut;}
\DoxyCodeLine{4005 \}}
\DoxyCodeLine{4006 }
\DoxyCodeLine{4007 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{4008 \{}
\DoxyCodeLine{4009     drmp3\_uint64 bytePos;}
\DoxyCodeLine{4010     drmp3\_uint64 pcmFrameIndex; \textcolor{comment}{/* <-\/-\/ After sample rate conversion. */}}
\DoxyCodeLine{4011 \} drmp3\_\_seeking\_mp3\_frame\_info;}
\DoxyCodeLine{4012 }
\DoxyCodeLine{4013 DRMP3\_API drmp3\_bool32 drmp3\_calculate\_seek\_points(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint32* pSeekPointCount, \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}}* pSeekPoints)}
\DoxyCodeLine{4014 \{}
\DoxyCodeLine{4015     drmp3\_uint32 seekPointCount;}
\DoxyCodeLine{4016     drmp3\_uint64 currentPCMFrame;}
\DoxyCodeLine{4017     drmp3\_uint64 totalMP3FrameCount;}
\DoxyCodeLine{4018     drmp3\_uint64 totalPCMFrameCount;}
\DoxyCodeLine{4019 }
\DoxyCodeLine{4020     \textcolor{keywordflow}{if} (pMP3 == NULL || pSeekPointCount == NULL || pSeekPoints == NULL) \{}
\DoxyCodeLine{4021         \textcolor{keywordflow}{return} DRMP3\_FALSE; \textcolor{comment}{/* Invalid args. */}}
\DoxyCodeLine{4022     \}}
\DoxyCodeLine{4023 }
\DoxyCodeLine{4024     seekPointCount = *pSeekPointCount;}
\DoxyCodeLine{4025     \textcolor{keywordflow}{if} (seekPointCount == 0) \{}
\DoxyCodeLine{4026         \textcolor{keywordflow}{return} DRMP3\_FALSE;  \textcolor{comment}{/* The client has requested no seek points. Consider this to be invalid arguments since the client has probably not intended this. */}}
\DoxyCodeLine{4027     \}}
\DoxyCodeLine{4028 }
\DoxyCodeLine{4029     \textcolor{comment}{/* We'll need to seek back to the current sample after calculating the seekpoints so we need to go ahead and grab the current location at the top. */}}
\DoxyCodeLine{4030     currentPCMFrame = pMP3-\/>currentPCMFrame;}
\DoxyCodeLine{4031     }
\DoxyCodeLine{4032     \textcolor{comment}{/* We never do more than the total number of MP3 frames and we limit it to 32-\/bits. */}}
\DoxyCodeLine{4033     \textcolor{keywordflow}{if} (!drmp3\_get\_mp3\_and\_pcm\_frame\_count(pMP3, \&totalMP3FrameCount, \&totalPCMFrameCount)) \{}
\DoxyCodeLine{4034         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{4035     \}}
\DoxyCodeLine{4036 }
\DoxyCodeLine{4037     \textcolor{comment}{/* If there's less than DRMP3\_SEEK\_LEADING\_MP3\_FRAMES+1 frames we just report 1 seek point which will be the very start of the stream. */}}
\DoxyCodeLine{4038     \textcolor{keywordflow}{if} (totalMP3FrameCount < DRMP3\_SEEK\_LEADING\_MP3\_FRAMES+1) \{}
\DoxyCodeLine{4039         seekPointCount = 1;}
\DoxyCodeLine{4040         pSeekPoints[0].seekPosInBytes     = 0;}
\DoxyCodeLine{4041         pSeekPoints[0].pcmFrameIndex      = 0;}
\DoxyCodeLine{4042         pSeekPoints[0].mp3FramesToDiscard = 0;}
\DoxyCodeLine{4043         pSeekPoints[0].pcmFramesToDiscard = 0;}
\DoxyCodeLine{4044     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4045         drmp3\_uint64 pcmFramesBetweenSeekPoints;}
\DoxyCodeLine{4046         drmp3\_\_seeking\_mp3\_frame\_info mp3FrameInfo[DRMP3\_SEEK\_LEADING\_MP3\_FRAMES+1];}
\DoxyCodeLine{4047         drmp3\_uint64 runningPCMFrameCount = 0;}
\DoxyCodeLine{4048         \textcolor{keywordtype}{float} runningPCMFrameCountFractionalPart = 0;}
\DoxyCodeLine{4049         drmp3\_uint64 nextTargetPCMFrame;}
\DoxyCodeLine{4050         drmp3\_uint32 iMP3Frame;}
\DoxyCodeLine{4051         drmp3\_uint32 iSeekPoint;}
\DoxyCodeLine{4052 }
\DoxyCodeLine{4053         \textcolor{keywordflow}{if} (seekPointCount > totalMP3FrameCount-\/1) \{}
\DoxyCodeLine{4054             seekPointCount = (drmp3\_uint32)totalMP3FrameCount-\/1;}
\DoxyCodeLine{4055         \}}
\DoxyCodeLine{4056 }
\DoxyCodeLine{4057         pcmFramesBetweenSeekPoints = totalPCMFrameCount / (seekPointCount+1);}
\DoxyCodeLine{4058 }
\DoxyCodeLine{4059         \textcolor{comment}{/*}}
\DoxyCodeLine{4060 \textcolor{comment}{        Here is where we actually calculate the seek points. We need to start by moving the start of the stream. We then enumerate over each}}
\DoxyCodeLine{4061 \textcolor{comment}{        MP3 frame.}}
\DoxyCodeLine{4062 \textcolor{comment}{        */}}
\DoxyCodeLine{4063         \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_start\_of\_stream(pMP3)) \{}
\DoxyCodeLine{4064             \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{4065         \}}
\DoxyCodeLine{4066 }
\DoxyCodeLine{4067         \textcolor{comment}{/*}}
\DoxyCodeLine{4068 \textcolor{comment}{        We need to cache the byte positions of the previous MP3 frames. As a new MP3 frame is iterated, we cycle the byte positions in this}}
\DoxyCodeLine{4069 \textcolor{comment}{        array. The value in the first item in this array is the byte position that will be reported in the next seek point.}}
\DoxyCodeLine{4070 \textcolor{comment}{        */}}
\DoxyCodeLine{4071 }
\DoxyCodeLine{4072         \textcolor{comment}{/* We need to initialize the array of MP3 byte positions for the leading MP3 frames. */}}
\DoxyCodeLine{4073         \textcolor{keywordflow}{for} (iMP3Frame = 0; iMP3Frame < DRMP3\_SEEK\_LEADING\_MP3\_FRAMES+1; ++iMP3Frame) \{}
\DoxyCodeLine{4074             drmp3\_uint32 pcmFramesInCurrentMP3FrameIn;}
\DoxyCodeLine{4075 }
\DoxyCodeLine{4076             \textcolor{comment}{/* The byte position of the next frame will be the stream's cursor position, minus whatever is sitting in the buffer. */}}
\DoxyCodeLine{4077             DRMP3\_ASSERT(pMP3-\/>streamCursor >= pMP3-\/>dataSize);}
\DoxyCodeLine{4078             mp3FrameInfo[iMP3Frame].bytePos       = pMP3-\/>streamCursor -\/ pMP3-\/>dataSize;}
\DoxyCodeLine{4079             mp3FrameInfo[iMP3Frame].pcmFrameIndex = runningPCMFrameCount;}
\DoxyCodeLine{4080 }
\DoxyCodeLine{4081             \textcolor{comment}{/* We need to get information about this frame so we can know how many samples it contained. */}}
\DoxyCodeLine{4082             pcmFramesInCurrentMP3FrameIn = drmp3\_decode\_next\_frame\_ex(pMP3, NULL);}
\DoxyCodeLine{4083             \textcolor{keywordflow}{if} (pcmFramesInCurrentMP3FrameIn == 0) \{}
\DoxyCodeLine{4084                 \textcolor{keywordflow}{return} DRMP3\_FALSE; \textcolor{comment}{/* This should never happen. */}}
\DoxyCodeLine{4085             \}}
\DoxyCodeLine{4086 }
\DoxyCodeLine{4087             drmp3\_\_accumulate\_running\_pcm\_frame\_count(pMP3, pcmFramesInCurrentMP3FrameIn, \&runningPCMFrameCount, \&runningPCMFrameCountFractionalPart);}
\DoxyCodeLine{4088         \}}
\DoxyCodeLine{4089 }
\DoxyCodeLine{4090         \textcolor{comment}{/*}}
\DoxyCodeLine{4091 \textcolor{comment}{        At this point we will have extracted the byte positions of the leading MP3 frames. We can now start iterating over each seek point and}}
\DoxyCodeLine{4092 \textcolor{comment}{        calculate them.}}
\DoxyCodeLine{4093 \textcolor{comment}{        */}}
\DoxyCodeLine{4094         nextTargetPCMFrame = 0;}
\DoxyCodeLine{4095         \textcolor{keywordflow}{for} (iSeekPoint = 0; iSeekPoint < seekPointCount; ++iSeekPoint) \{}
\DoxyCodeLine{4096             nextTargetPCMFrame += pcmFramesBetweenSeekPoints;}
\DoxyCodeLine{4097 }
\DoxyCodeLine{4098             \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{4099                 \textcolor{keywordflow}{if} (nextTargetPCMFrame < runningPCMFrameCount) \{}
\DoxyCodeLine{4100                     \textcolor{comment}{/* The next seek point is in the current MP3 frame. */}}
\DoxyCodeLine{4101                     pSeekPoints[iSeekPoint].seekPosInBytes     = mp3FrameInfo[0].bytePos;}
\DoxyCodeLine{4102                     pSeekPoints[iSeekPoint].pcmFrameIndex      = nextTargetPCMFrame;}
\DoxyCodeLine{4103                     pSeekPoints[iSeekPoint].mp3FramesToDiscard = DRMP3\_SEEK\_LEADING\_MP3\_FRAMES;}
\DoxyCodeLine{4104                     pSeekPoints[iSeekPoint].pcmFramesToDiscard = (drmp3\_uint16)(nextTargetPCMFrame -\/ mp3FrameInfo[DRMP3\_SEEK\_LEADING\_MP3\_FRAMES-\/1].pcmFrameIndex);}
\DoxyCodeLine{4105                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{4106                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4107                     \textcolor{keywordtype}{size\_t} i;}
\DoxyCodeLine{4108                     drmp3\_uint32 pcmFramesInCurrentMP3FrameIn;}
\DoxyCodeLine{4109 }
\DoxyCodeLine{4110                     \textcolor{comment}{/*}}
\DoxyCodeLine{4111 \textcolor{comment}{                    The next seek point is not in the current MP3 frame, so continue on to the next one. The first thing to do is cycle the cached}}
\DoxyCodeLine{4112 \textcolor{comment}{                    MP3 frame info.}}
\DoxyCodeLine{4113 \textcolor{comment}{                    */}}
\DoxyCodeLine{4114                     \textcolor{keywordflow}{for} (i = 0; i < DRMP3\_COUNTOF(mp3FrameInfo)-\/1; ++i) \{}
\DoxyCodeLine{4115                         mp3FrameInfo[i] = mp3FrameInfo[i+1];}
\DoxyCodeLine{4116                     \}}
\DoxyCodeLine{4117 }
\DoxyCodeLine{4118                     \textcolor{comment}{/* Cache previous MP3 frame info. */}}
\DoxyCodeLine{4119                     mp3FrameInfo[DRMP3\_COUNTOF(mp3FrameInfo)-\/1].bytePos       = pMP3-\/>streamCursor -\/ pMP3-\/>dataSize;}
\DoxyCodeLine{4120                     mp3FrameInfo[DRMP3\_COUNTOF(mp3FrameInfo)-\/1].pcmFrameIndex = runningPCMFrameCount;}
\DoxyCodeLine{4121 }
\DoxyCodeLine{4122                     \textcolor{comment}{/*}}
\DoxyCodeLine{4123 \textcolor{comment}{                    Go to the next MP3 frame. This shouldn't ever fail, but just in case it does we just set the seek point and break. If it happens, it}}
\DoxyCodeLine{4124 \textcolor{comment}{                    should only ever do it for the last seek point.}}
\DoxyCodeLine{4125 \textcolor{comment}{                    */}}
\DoxyCodeLine{4126                     pcmFramesInCurrentMP3FrameIn = drmp3\_decode\_next\_frame\_ex(pMP3, NULL);}
\DoxyCodeLine{4127                     \textcolor{keywordflow}{if} (pcmFramesInCurrentMP3FrameIn == 0) \{}
\DoxyCodeLine{4128                         pSeekPoints[iSeekPoint].seekPosInBytes     = mp3FrameInfo[0].bytePos;}
\DoxyCodeLine{4129                         pSeekPoints[iSeekPoint].pcmFrameIndex      = nextTargetPCMFrame;}
\DoxyCodeLine{4130                         pSeekPoints[iSeekPoint].mp3FramesToDiscard = DRMP3\_SEEK\_LEADING\_MP3\_FRAMES;}
\DoxyCodeLine{4131                         pSeekPoints[iSeekPoint].pcmFramesToDiscard = (drmp3\_uint16)(nextTargetPCMFrame -\/ mp3FrameInfo[DRMP3\_SEEK\_LEADING\_MP3\_FRAMES-\/1].pcmFrameIndex);}
\DoxyCodeLine{4132                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{4133                     \}}
\DoxyCodeLine{4134 }
\DoxyCodeLine{4135                     drmp3\_\_accumulate\_running\_pcm\_frame\_count(pMP3, pcmFramesInCurrentMP3FrameIn, \&runningPCMFrameCount, \&runningPCMFrameCountFractionalPart);}
\DoxyCodeLine{4136                 \}}
\DoxyCodeLine{4137             \}}
\DoxyCodeLine{4138         \}}
\DoxyCodeLine{4139 }
\DoxyCodeLine{4140         \textcolor{comment}{/* Finally, we need to seek back to where we were. */}}
\DoxyCodeLine{4141         \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_start\_of\_stream(pMP3)) \{}
\DoxyCodeLine{4142             \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{4143         \}}
\DoxyCodeLine{4144         \textcolor{keywordflow}{if} (!drmp3\_seek\_to\_pcm\_frame(pMP3, currentPCMFrame)) \{}
\DoxyCodeLine{4145             \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{4146         \}}
\DoxyCodeLine{4147     \}}
\DoxyCodeLine{4148 }
\DoxyCodeLine{4149     *pSeekPointCount = seekPointCount;}
\DoxyCodeLine{4150     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{4151 \}}
\DoxyCodeLine{4152 }
\DoxyCodeLine{4153 DRMP3\_API drmp3\_bool32 drmp3\_bind\_seek\_table(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, drmp3\_uint32 seekPointCount, \mbox{\hyperlink{structdrmp3__seek__point}{drmp3\_seek\_point}}* pSeekPoints)}
\DoxyCodeLine{4154 \{}
\DoxyCodeLine{4155     \textcolor{keywordflow}{if} (pMP3 == NULL) \{}
\DoxyCodeLine{4156         \textcolor{keywordflow}{return} DRMP3\_FALSE;}
\DoxyCodeLine{4157     \}}
\DoxyCodeLine{4158 }
\DoxyCodeLine{4159     \textcolor{keywordflow}{if} (seekPointCount == 0 || pSeekPoints == NULL) \{}
\DoxyCodeLine{4160         \textcolor{comment}{/* Unbinding. */}}
\DoxyCodeLine{4161         pMP3-\/>seekPointCount = 0;}
\DoxyCodeLine{4162         pMP3-\/>pSeekPoints = NULL;}
\DoxyCodeLine{4163     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4164         \textcolor{comment}{/* Binding. */}}
\DoxyCodeLine{4165         pMP3-\/>seekPointCount = seekPointCount;}
\DoxyCodeLine{4166         pMP3-\/>pSeekPoints = pSeekPoints;}
\DoxyCodeLine{4167     \}}
\DoxyCodeLine{4168 }
\DoxyCodeLine{4169     \textcolor{keywordflow}{return} DRMP3\_TRUE;}
\DoxyCodeLine{4170 \}}
\DoxyCodeLine{4171 }
\DoxyCodeLine{4172 }
\DoxyCodeLine{4173 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* drmp3\_\_full\_read\_and\_close\_f32(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount)}
\DoxyCodeLine{4174 \{}
\DoxyCodeLine{4175     drmp3\_uint64 totalFramesRead = 0;}
\DoxyCodeLine{4176     drmp3\_uint64 framesCapacity = 0;}
\DoxyCodeLine{4177     \textcolor{keywordtype}{float}* pFrames = NULL;}
\DoxyCodeLine{4178     \textcolor{keywordtype}{float} temp[4096];}
\DoxyCodeLine{4179 }
\DoxyCodeLine{4180     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{4181 }
\DoxyCodeLine{4182     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{4183         drmp3\_uint64 framesToReadRightNow = DRMP3\_COUNTOF(temp) / pMP3-\/>channels;}
\DoxyCodeLine{4184         drmp3\_uint64 framesJustRead = drmp3\_read\_pcm\_frames\_f32(pMP3, framesToReadRightNow, temp);}
\DoxyCodeLine{4185         \textcolor{keywordflow}{if} (framesJustRead == 0) \{}
\DoxyCodeLine{4186             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4187         \}}
\DoxyCodeLine{4188 }
\DoxyCodeLine{4189         \textcolor{comment}{/* Reallocate the output buffer if there's not enough room. */}}
\DoxyCodeLine{4190         \textcolor{keywordflow}{if} (framesCapacity < totalFramesRead + framesJustRead) \{}
\DoxyCodeLine{4191             drmp3\_uint64 oldFramesBufferSize;}
\DoxyCodeLine{4192             drmp3\_uint64 newFramesBufferSize;}
\DoxyCodeLine{4193             drmp3\_uint64 newFramesCap;}
\DoxyCodeLine{4194             \textcolor{keywordtype}{float}* pNewFrames;}
\DoxyCodeLine{4195 }
\DoxyCodeLine{4196             newFramesCap = framesCapacity * 2;}
\DoxyCodeLine{4197             \textcolor{keywordflow}{if} (newFramesCap < totalFramesRead + framesJustRead) \{}
\DoxyCodeLine{4198                 newFramesCap = totalFramesRead + framesJustRead;}
\DoxyCodeLine{4199             \}}
\DoxyCodeLine{4200 }
\DoxyCodeLine{4201             oldFramesBufferSize = framesCapacity * pMP3-\/>channels * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{4202             newFramesBufferSize = newFramesCap   * pMP3-\/>channels * \textcolor{keyword}{sizeof}(float);}
\DoxyCodeLine{4203             \textcolor{keywordflow}{if} (newFramesBufferSize > (drmp3\_uint64)DRMP3\_SIZE\_MAX) \{}
\DoxyCodeLine{4204                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4205             \}}
\DoxyCodeLine{4206 }
\DoxyCodeLine{4207             pNewFrames = (\textcolor{keywordtype}{float}*)drmp3\_\_realloc\_from\_callbacks(pFrames, (\textcolor{keywordtype}{size\_t})newFramesBufferSize, (size\_t)oldFramesBufferSize, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{4208             \textcolor{keywordflow}{if} (pNewFrames == NULL) \{}
\DoxyCodeLine{4209                 drmp3\_\_free\_from\_callbacks(pFrames, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{4210                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4211             \}}
\DoxyCodeLine{4212 }
\DoxyCodeLine{4213             pFrames = pNewFrames;}
\DoxyCodeLine{4214             framesCapacity = newFramesCap;}
\DoxyCodeLine{4215         \}}
\DoxyCodeLine{4216 }
\DoxyCodeLine{4217         DRMP3\_COPY\_MEMORY(pFrames + totalFramesRead*pMP3-\/>channels, temp, (\textcolor{keywordtype}{size\_t})(framesJustRead*pMP3-\/>channels*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})));}
\DoxyCodeLine{4218         totalFramesRead += framesJustRead;}
\DoxyCodeLine{4219 }
\DoxyCodeLine{4220         \textcolor{comment}{/* If the number of frames we asked for is less that what we actually read it means we've reached the end. */}}
\DoxyCodeLine{4221         \textcolor{keywordflow}{if} (framesJustRead != framesToReadRightNow) \{}
\DoxyCodeLine{4222             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4223         \}}
\DoxyCodeLine{4224     \}}
\DoxyCodeLine{4225 }
\DoxyCodeLine{4226     \textcolor{keywordflow}{if} (pConfig != NULL) \{}
\DoxyCodeLine{4227         pConfig-\/>channels   = pMP3-\/>channels;}
\DoxyCodeLine{4228         pConfig-\/>sampleRate = pMP3-\/>sampleRate;}
\DoxyCodeLine{4229     \}}
\DoxyCodeLine{4230 }
\DoxyCodeLine{4231     drmp3\_uninit(pMP3);}
\DoxyCodeLine{4232 }
\DoxyCodeLine{4233     \textcolor{keywordflow}{if} (pTotalFrameCount) \{}
\DoxyCodeLine{4234         *pTotalFrameCount = totalFramesRead;}
\DoxyCodeLine{4235     \}}
\DoxyCodeLine{4236 }
\DoxyCodeLine{4237     \textcolor{keywordflow}{return} pFrames;}
\DoxyCodeLine{4238 \}}
\DoxyCodeLine{4239 }
\DoxyCodeLine{4240 \textcolor{keyword}{static} drmp3\_int16* drmp3\_\_full\_read\_and\_close\_s16(\mbox{\hyperlink{structdrmp3}{drmp3}}* pMP3, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount)}
\DoxyCodeLine{4241 \{}
\DoxyCodeLine{4242     drmp3\_uint64 totalFramesRead = 0;}
\DoxyCodeLine{4243     drmp3\_uint64 framesCapacity = 0;}
\DoxyCodeLine{4244     drmp3\_int16* pFrames = NULL;}
\DoxyCodeLine{4245     drmp3\_int16 temp[4096];}
\DoxyCodeLine{4246 }
\DoxyCodeLine{4247     DRMP3\_ASSERT(pMP3 != NULL);}
\DoxyCodeLine{4248 }
\DoxyCodeLine{4249     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{4250         drmp3\_uint64 framesToReadRightNow = DRMP3\_COUNTOF(temp) / pMP3-\/>channels;}
\DoxyCodeLine{4251         drmp3\_uint64 framesJustRead = drmp3\_read\_pcm\_frames\_s16(pMP3, framesToReadRightNow, temp);}
\DoxyCodeLine{4252         \textcolor{keywordflow}{if} (framesJustRead == 0) \{}
\DoxyCodeLine{4253             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4254         \}}
\DoxyCodeLine{4255 }
\DoxyCodeLine{4256         \textcolor{comment}{/* Reallocate the output buffer if there's not enough room. */}}
\DoxyCodeLine{4257         \textcolor{keywordflow}{if} (framesCapacity < totalFramesRead + framesJustRead) \{}
\DoxyCodeLine{4258             drmp3\_uint64 newFramesBufferSize;}
\DoxyCodeLine{4259             drmp3\_uint64 oldFramesBufferSize;}
\DoxyCodeLine{4260             drmp3\_uint64 newFramesCap;}
\DoxyCodeLine{4261             drmp3\_int16* pNewFrames;}
\DoxyCodeLine{4262 }
\DoxyCodeLine{4263             newFramesCap = framesCapacity * 2;}
\DoxyCodeLine{4264             \textcolor{keywordflow}{if} (newFramesCap < totalFramesRead + framesJustRead) \{}
\DoxyCodeLine{4265                 newFramesCap = totalFramesRead + framesJustRead;}
\DoxyCodeLine{4266             \}}
\DoxyCodeLine{4267 }
\DoxyCodeLine{4268             oldFramesBufferSize = framesCapacity * pMP3-\/>channels * \textcolor{keyword}{sizeof}(drmp3\_int16);}
\DoxyCodeLine{4269             newFramesBufferSize = newFramesCap   * pMP3-\/>channels * \textcolor{keyword}{sizeof}(drmp3\_int16);}
\DoxyCodeLine{4270             \textcolor{keywordflow}{if} (newFramesBufferSize > (drmp3\_uint64)DRMP3\_SIZE\_MAX) \{}
\DoxyCodeLine{4271                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4272             \}}
\DoxyCodeLine{4273 }
\DoxyCodeLine{4274             pNewFrames = (drmp3\_int16*)drmp3\_\_realloc\_from\_callbacks(pFrames, (\textcolor{keywordtype}{size\_t})newFramesBufferSize, (size\_t)oldFramesBufferSize, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{4275             \textcolor{keywordflow}{if} (pNewFrames == NULL) \{}
\DoxyCodeLine{4276                 drmp3\_\_free\_from\_callbacks(pFrames, \&pMP3-\/>allocationCallbacks);}
\DoxyCodeLine{4277                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4278             \}}
\DoxyCodeLine{4279 }
\DoxyCodeLine{4280             pFrames = pNewFrames;}
\DoxyCodeLine{4281             framesCapacity = newFramesCap;}
\DoxyCodeLine{4282         \}}
\DoxyCodeLine{4283 }
\DoxyCodeLine{4284         DRMP3\_COPY\_MEMORY(pFrames + totalFramesRead*pMP3-\/>channels, temp, (\textcolor{keywordtype}{size\_t})(framesJustRead*pMP3-\/>channels*\textcolor{keyword}{sizeof}(drmp3\_int16)));}
\DoxyCodeLine{4285         totalFramesRead += framesJustRead;}
\DoxyCodeLine{4286 }
\DoxyCodeLine{4287         \textcolor{comment}{/* If the number of frames we asked for is less that what we actually read it means we've reached the end. */}}
\DoxyCodeLine{4288         \textcolor{keywordflow}{if} (framesJustRead != framesToReadRightNow) \{}
\DoxyCodeLine{4289             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4290         \}}
\DoxyCodeLine{4291     \}}
\DoxyCodeLine{4292 }
\DoxyCodeLine{4293     \textcolor{keywordflow}{if} (pConfig != NULL) \{}
\DoxyCodeLine{4294         pConfig-\/>channels   = pMP3-\/>channels;}
\DoxyCodeLine{4295         pConfig-\/>sampleRate = pMP3-\/>sampleRate;}
\DoxyCodeLine{4296     \}}
\DoxyCodeLine{4297 }
\DoxyCodeLine{4298     drmp3\_uninit(pMP3);}
\DoxyCodeLine{4299 }
\DoxyCodeLine{4300     \textcolor{keywordflow}{if} (pTotalFrameCount) \{}
\DoxyCodeLine{4301         *pTotalFrameCount = totalFramesRead;}
\DoxyCodeLine{4302     \}}
\DoxyCodeLine{4303 }
\DoxyCodeLine{4304     \textcolor{keywordflow}{return} pFrames;}
\DoxyCodeLine{4305 \}}
\DoxyCodeLine{4306 }
\DoxyCodeLine{4307 }
\DoxyCodeLine{4308 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_and\_read\_pcm\_frames\_f32(drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4309 \{}
\DoxyCodeLine{4310     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4311     \textcolor{keywordflow}{if} (!drmp3\_init(\&mp3, onRead, onSeek, pUserData, pAllocationCallbacks)) \{}
\DoxyCodeLine{4312         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4313     \}}
\DoxyCodeLine{4314 }
\DoxyCodeLine{4315     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_f32(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4316 \}}
\DoxyCodeLine{4317 }
\DoxyCodeLine{4318 DRMP3\_API drmp3\_int16* drmp3\_open\_and\_read\_pcm\_frames\_s16(drmp3\_read\_proc onRead, drmp3\_seek\_proc onSeek, \textcolor{keywordtype}{void}* pUserData, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4319 \{}
\DoxyCodeLine{4320     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4321     \textcolor{keywordflow}{if} (!drmp3\_init(\&mp3, onRead, onSeek, pUserData, pAllocationCallbacks)) \{}
\DoxyCodeLine{4322         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4323     \}}
\DoxyCodeLine{4324 }
\DoxyCodeLine{4325     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_s16(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4326 \}}
\DoxyCodeLine{4327 }
\DoxyCodeLine{4328 }
\DoxyCodeLine{4329 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4330 \{}
\DoxyCodeLine{4331     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4332     \textcolor{keywordflow}{if} (!drmp3\_init\_memory(\&mp3, pData, dataSize, pAllocationCallbacks)) \{}
\DoxyCodeLine{4333         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4334     \}}
\DoxyCodeLine{4335 }
\DoxyCodeLine{4336     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_f32(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4337 \}}
\DoxyCodeLine{4338 }
\DoxyCodeLine{4339 DRMP3\_API drmp3\_int16* drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* pData, \textcolor{keywordtype}{size\_t} dataSize, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4340 \{}
\DoxyCodeLine{4341     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4342     \textcolor{keywordflow}{if} (!drmp3\_init\_memory(\&mp3, pData, dataSize, pAllocationCallbacks)) \{}
\DoxyCodeLine{4343         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4344     \}}
\DoxyCodeLine{4345 }
\DoxyCodeLine{4346     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_s16(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4347 \}}
\DoxyCodeLine{4348 }
\DoxyCodeLine{4349 }
\DoxyCodeLine{4350 \textcolor{preprocessor}{\#ifndef DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{4351 DRMP3\_API \textcolor{keywordtype}{float}* drmp3\_open\_file\_and\_read\_pcm\_frames\_f32(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filePath, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4352 \{}
\DoxyCodeLine{4353     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4354     \textcolor{keywordflow}{if} (!drmp3\_init\_file(\&mp3, filePath, pAllocationCallbacks)) \{}
\DoxyCodeLine{4355         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4356     \}}
\DoxyCodeLine{4357 }
\DoxyCodeLine{4358     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_f32(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4359 \}}
\DoxyCodeLine{4360 }
\DoxyCodeLine{4361 DRMP3\_API drmp3\_int16* drmp3\_open\_file\_and\_read\_pcm\_frames\_s16(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filePath, \mbox{\hyperlink{structdrmp3__config}{drmp3\_config}}* pConfig, drmp3\_uint64* pTotalFrameCount, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4362 \{}
\DoxyCodeLine{4363     \mbox{\hyperlink{structdrmp3}{drmp3}} mp3;}
\DoxyCodeLine{4364     \textcolor{keywordflow}{if} (!drmp3\_init\_file(\&mp3, filePath, pAllocationCallbacks)) \{}
\DoxyCodeLine{4365         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4366     \}}
\DoxyCodeLine{4367 }
\DoxyCodeLine{4368     \textcolor{keywordflow}{return} drmp3\_\_full\_read\_and\_close\_s16(\&mp3, pConfig, pTotalFrameCount);}
\DoxyCodeLine{4369 \}}
\DoxyCodeLine{4370 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4371 }
\DoxyCodeLine{4372 DRMP3\_API \textcolor{keywordtype}{void}* drmp3\_malloc(\textcolor{keywordtype}{size\_t} sz, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4373 \{}
\DoxyCodeLine{4374     \textcolor{keywordflow}{if} (pAllocationCallbacks != NULL) \{}
\DoxyCodeLine{4375         \textcolor{keywordflow}{return} drmp3\_\_malloc\_from\_callbacks(sz, pAllocationCallbacks);}
\DoxyCodeLine{4376     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4377         \textcolor{keywordflow}{return} drmp3\_\_malloc\_default(sz, NULL);}
\DoxyCodeLine{4378     \}}
\DoxyCodeLine{4379 \}}
\DoxyCodeLine{4380 }
\DoxyCodeLine{4381 DRMP3\_API \textcolor{keywordtype}{void} drmp3\_free(\textcolor{keywordtype}{void}* p, \textcolor{keyword}{const} \mbox{\hyperlink{structdrmp3__allocation__callbacks}{drmp3\_allocation\_callbacks}}* pAllocationCallbacks)}
\DoxyCodeLine{4382 \{}
\DoxyCodeLine{4383     \textcolor{keywordflow}{if} (pAllocationCallbacks != NULL) \{}
\DoxyCodeLine{4384         drmp3\_\_free\_from\_callbacks(p, pAllocationCallbacks);}
\DoxyCodeLine{4385     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4386         drmp3\_\_free\_default(p, NULL);}
\DoxyCodeLine{4387     \}}
\DoxyCodeLine{4388 \}}
\DoxyCodeLine{4389 }
\DoxyCodeLine{4390 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/* dr\_mp3\_c */}\textcolor{preprocessor}{}}
\DoxyCodeLine{4391 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{/*DR\_MP3\_IMPLEMENTATION*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{4392 }
\DoxyCodeLine{4393 \textcolor{comment}{/*}}
\DoxyCodeLine{4394 \textcolor{comment}{DIFFERENCES BETWEEN minimp3 AND dr\_mp3}}
\DoxyCodeLine{4395 \textcolor{comment}{======================================}}
\DoxyCodeLine{4396 \textcolor{comment}{-\/ First, keep in mind that minimp3 (https://github.com/lieff/minimp3) is where all the real work was done. All of the}}
\DoxyCodeLine{4397 \textcolor{comment}{  code relating to the actual decoding remains mostly unmodified, apart from some namespacing changes.}}
\DoxyCodeLine{4398 \textcolor{comment}{-\/ dr\_mp3 adds a pulling style API which allows you to deliver raw data via callbacks. So, rather than pushing data}}
\DoxyCodeLine{4399 \textcolor{comment}{  to the decoder, the decoder \_pulls\_ data from your callbacks.}}
\DoxyCodeLine{4400 \textcolor{comment}{-\/ In addition to callbacks, a decoder can be initialized from a block of memory and a file.}}
\DoxyCodeLine{4401 \textcolor{comment}{-\/ The dr\_mp3 pull API reads PCM frames rather than whole MP3 frames.}}
\DoxyCodeLine{4402 \textcolor{comment}{-\/ dr\_mp3 adds convenience APIs for opening and decoding entire files in one go.}}
\DoxyCodeLine{4403 \textcolor{comment}{-\/ dr\_mp3 is fully namespaced, including the implementation section, which is more suitable when compiling projects}}
\DoxyCodeLine{4404 \textcolor{comment}{  as a single translation unit (aka unity builds). At the time of writing this, a unity build is not possible when}}
\DoxyCodeLine{4405 \textcolor{comment}{  using minimp3 in conjunction with stb\_vorbis. dr\_mp3 addresses this.}}
\DoxyCodeLine{4406 \textcolor{comment}{*/}}
\DoxyCodeLine{4407 }
\DoxyCodeLine{4408 \textcolor{comment}{/*}}
\DoxyCodeLine{4409 \textcolor{comment}{RELEASE NOTES -\/ v0.5.0}}
\DoxyCodeLine{4410 \textcolor{comment}{=======================}}
\DoxyCodeLine{4411 \textcolor{comment}{Version 0.5.0 has breaking API changes.}}
\DoxyCodeLine{4412 \textcolor{comment}{}}
\DoxyCodeLine{4413 \textcolor{comment}{Improved Client-\/Defined Memory Allocation}}
\DoxyCodeLine{4414 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{4415 \textcolor{comment}{The main change with this release is the addition of a more flexible way of implementing custom memory allocation routines. The}}
\DoxyCodeLine{4416 \textcolor{comment}{existing system of DRMP3\_MALLOC, DRMP3\_REALLOC and DRMP3\_FREE are still in place and will be used by default when no custom}}
\DoxyCodeLine{4417 \textcolor{comment}{allocation callbacks are specified.}}
\DoxyCodeLine{4418 \textcolor{comment}{}}
\DoxyCodeLine{4419 \textcolor{comment}{To use the new system, you pass in a pointer to a drmp3\_allocation\_callbacks object to drmp3\_init() and family, like this:}}
\DoxyCodeLine{4420 \textcolor{comment}{}}
\DoxyCodeLine{4421 \textcolor{comment}{    void* my\_malloc(size\_t sz, void* pUserData)}}
\DoxyCodeLine{4422 \textcolor{comment}{    \{}}
\DoxyCodeLine{4423 \textcolor{comment}{        return malloc(sz);}}
\DoxyCodeLine{4424 \textcolor{comment}{    \}}}
\DoxyCodeLine{4425 \textcolor{comment}{    void* my\_realloc(void* p, size\_t sz, void* pUserData)}}
\DoxyCodeLine{4426 \textcolor{comment}{    \{}}
\DoxyCodeLine{4427 \textcolor{comment}{        return realloc(p, sz);}}
\DoxyCodeLine{4428 \textcolor{comment}{    \}}}
\DoxyCodeLine{4429 \textcolor{comment}{    void my\_free(void* p, void* pUserData)}}
\DoxyCodeLine{4430 \textcolor{comment}{    \{}}
\DoxyCodeLine{4431 \textcolor{comment}{        free(p);}}
\DoxyCodeLine{4432 \textcolor{comment}{    \}}}
\DoxyCodeLine{4433 \textcolor{comment}{}}
\DoxyCodeLine{4434 \textcolor{comment}{    ...}}
\DoxyCodeLine{4435 \textcolor{comment}{}}
\DoxyCodeLine{4436 \textcolor{comment}{    drmp3\_allocation\_callbacks allocationCallbacks;}}
\DoxyCodeLine{4437 \textcolor{comment}{    allocationCallbacks.pUserData = \&myData;}}
\DoxyCodeLine{4438 \textcolor{comment}{    allocationCallbacks.onMalloc  = my\_malloc;}}
\DoxyCodeLine{4439 \textcolor{comment}{    allocationCallbacks.onRealloc = my\_realloc;}}
\DoxyCodeLine{4440 \textcolor{comment}{    allocationCallbacks.onFree    = my\_free;}}
\DoxyCodeLine{4441 \textcolor{comment}{    drmp3\_init\_file(\&mp3, "{}my\_file.mp3"{}, NULL, \&allocationCallbacks);}}
\DoxyCodeLine{4442 \textcolor{comment}{}}
\DoxyCodeLine{4443 \textcolor{comment}{The advantage of this new system is that it allows you to specify user data which will be passed in to the allocation routines.}}
\DoxyCodeLine{4444 \textcolor{comment}{}}
\DoxyCodeLine{4445 \textcolor{comment}{Passing in null for the allocation callbacks object will cause dr\_mp3 to use defaults which is the same as DRMP3\_MALLOC,}}
\DoxyCodeLine{4446 \textcolor{comment}{DRMP3\_REALLOC and DRMP3\_FREE and the equivalent of how it worked in previous versions.}}
\DoxyCodeLine{4447 \textcolor{comment}{}}
\DoxyCodeLine{4448 \textcolor{comment}{Every API that opens a drmp3 object now takes this extra parameter. These include the following:}}
\DoxyCodeLine{4449 \textcolor{comment}{}}
\DoxyCodeLine{4450 \textcolor{comment}{    drmp3\_init()}}
\DoxyCodeLine{4451 \textcolor{comment}{    drmp3\_init\_file()}}
\DoxyCodeLine{4452 \textcolor{comment}{    drmp3\_init\_memory()}}
\DoxyCodeLine{4453 \textcolor{comment}{    drmp3\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4454 \textcolor{comment}{    drmp3\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4455 \textcolor{comment}{    drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4456 \textcolor{comment}{    drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4457 \textcolor{comment}{    drmp3\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4458 \textcolor{comment}{    drmp3\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4459 \textcolor{comment}{}}
\DoxyCodeLine{4460 \textcolor{comment}{Renamed APIs}}
\DoxyCodeLine{4461 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{4462 \textcolor{comment}{The following APIs have been renamed for consistency with other dr\_* libraries and to make it clear that they return PCM frame}}
\DoxyCodeLine{4463 \textcolor{comment}{counts rather than sample counts.}}
\DoxyCodeLine{4464 \textcolor{comment}{}}
\DoxyCodeLine{4465 \textcolor{comment}{    drmp3\_open\_and\_read\_f32()        -\/> drmp3\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4466 \textcolor{comment}{    drmp3\_open\_and\_read\_s16()        -\/> drmp3\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4467 \textcolor{comment}{    drmp3\_open\_memory\_and\_read\_f32() -\/> drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4468 \textcolor{comment}{    drmp3\_open\_memory\_and\_read\_s16() -\/> drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4469 \textcolor{comment}{    drmp3\_open\_file\_and\_read\_f32()   -\/> drmp3\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4470 \textcolor{comment}{    drmp3\_open\_file\_and\_read\_s16()   -\/> drmp3\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4471 \textcolor{comment}{*/}}
\DoxyCodeLine{4472 }
\DoxyCodeLine{4473 \textcolor{comment}{/*}}
\DoxyCodeLine{4474 \textcolor{comment}{REVISION HISTORY}}
\DoxyCodeLine{4475 \textcolor{comment}{================}}
\DoxyCodeLine{4476 \textcolor{comment}{v0.6.31 -\/ 2021-\/08-\/22}}
\DoxyCodeLine{4477 \textcolor{comment}{  -\/ Fix a bug when loading from memory.}}
\DoxyCodeLine{4478 \textcolor{comment}{}}
\DoxyCodeLine{4479 \textcolor{comment}{v0.6.30 -\/ 2021-\/08-\/16}}
\DoxyCodeLine{4480 \textcolor{comment}{  -\/ Silence some warnings.}}
\DoxyCodeLine{4481 \textcolor{comment}{  -\/ Replace memory operations with DRMP3\_* macros.}}
\DoxyCodeLine{4482 \textcolor{comment}{}}
\DoxyCodeLine{4483 \textcolor{comment}{v0.6.29 -\/ 2021-\/08-\/08}}
\DoxyCodeLine{4484 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4485 \textcolor{comment}{}}
\DoxyCodeLine{4486 \textcolor{comment}{v0.6.28 -\/ 2021-\/07-\/31}}
\DoxyCodeLine{4487 \textcolor{comment}{  -\/ Fix platform detection for ARM64.}}
\DoxyCodeLine{4488 \textcolor{comment}{  -\/ Fix a compilation error with C89.}}
\DoxyCodeLine{4489 \textcolor{comment}{}}
\DoxyCodeLine{4490 \textcolor{comment}{v0.6.27 -\/ 2021-\/02-\/21}}
\DoxyCodeLine{4491 \textcolor{comment}{  -\/ Fix a warning due to referencing \_MSC\_VER when it is undefined.}}
\DoxyCodeLine{4492 \textcolor{comment}{}}
\DoxyCodeLine{4493 \textcolor{comment}{v0.6.26 -\/ 2021-\/01-\/31}}
\DoxyCodeLine{4494 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4495 \textcolor{comment}{}}
\DoxyCodeLine{4496 \textcolor{comment}{v0.6.25 -\/ 2020-\/12-\/26}}
\DoxyCodeLine{4497 \textcolor{comment}{  -\/ Remove DRMP3\_DEFAULT\_CHANNELS and DRMP3\_DEFAULT\_SAMPLE\_RATE which are leftovers from some removed APIs.}}
\DoxyCodeLine{4498 \textcolor{comment}{}}
\DoxyCodeLine{4499 \textcolor{comment}{v0.6.24 -\/ 2020-\/12-\/07}}
\DoxyCodeLine{4500 \textcolor{comment}{  -\/ Fix a typo in version date for 0.6.23.}}
\DoxyCodeLine{4501 \textcolor{comment}{}}
\DoxyCodeLine{4502 \textcolor{comment}{v0.6.23 -\/ 2020-\/12-\/03}}
\DoxyCodeLine{4503 \textcolor{comment}{  -\/ Fix an error where a file can be closed twice when initialization of the decoder fails.}}
\DoxyCodeLine{4504 \textcolor{comment}{}}
\DoxyCodeLine{4505 \textcolor{comment}{v0.6.22 -\/ 2020-\/12-\/02}}
\DoxyCodeLine{4506 \textcolor{comment}{  -\/ Fix an error where it's possible for a file handle to be left open when initialization of the decoder fails.}}
\DoxyCodeLine{4507 \textcolor{comment}{}}
\DoxyCodeLine{4508 \textcolor{comment}{v0.6.21 -\/ 2020-\/11-\/28}}
\DoxyCodeLine{4509 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4510 \textcolor{comment}{}}
\DoxyCodeLine{4511 \textcolor{comment}{v0.6.20 -\/ 2020-\/11-\/21}}
\DoxyCodeLine{4512 \textcolor{comment}{  -\/ Fix compilation with OpenWatcom.}}
\DoxyCodeLine{4513 \textcolor{comment}{}}
\DoxyCodeLine{4514 \textcolor{comment}{v0.6.19 -\/ 2020-\/11-\/13}}
\DoxyCodeLine{4515 \textcolor{comment}{  -\/ Minor code clean up.}}
\DoxyCodeLine{4516 \textcolor{comment}{}}
\DoxyCodeLine{4517 \textcolor{comment}{v0.6.18 -\/ 2020-\/11-\/01}}
\DoxyCodeLine{4518 \textcolor{comment}{  -\/ Improve compiler support for older versions of GCC.}}
\DoxyCodeLine{4519 \textcolor{comment}{}}
\DoxyCodeLine{4520 \textcolor{comment}{v0.6.17 -\/ 2020-\/09-\/28}}
\DoxyCodeLine{4521 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4522 \textcolor{comment}{}}
\DoxyCodeLine{4523 \textcolor{comment}{v0.6.16 -\/ 2020-\/08-\/02}}
\DoxyCodeLine{4524 \textcolor{comment}{  -\/ Simplify sized types.}}
\DoxyCodeLine{4525 \textcolor{comment}{}}
\DoxyCodeLine{4526 \textcolor{comment}{v0.6.15 -\/ 2020-\/07-\/25}}
\DoxyCodeLine{4527 \textcolor{comment}{  -\/ Fix a compilation warning.}}
\DoxyCodeLine{4528 \textcolor{comment}{}}
\DoxyCodeLine{4529 \textcolor{comment}{v0.6.14 -\/ 2020-\/07-\/23}}
\DoxyCodeLine{4530 \textcolor{comment}{  -\/ Fix undefined behaviour with memmove().}}
\DoxyCodeLine{4531 \textcolor{comment}{}}
\DoxyCodeLine{4532 \textcolor{comment}{v0.6.13 -\/ 2020-\/07-\/06}}
\DoxyCodeLine{4533 \textcolor{comment}{  -\/ Fix a bug when converting from s16 to f32 in drmp3\_read\_pcm\_frames\_f32().}}
\DoxyCodeLine{4534 \textcolor{comment}{}}
\DoxyCodeLine{4535 \textcolor{comment}{v0.6.12 -\/ 2020-\/06-\/23}}
\DoxyCodeLine{4536 \textcolor{comment}{  -\/ Add include guard for the implementation section.}}
\DoxyCodeLine{4537 \textcolor{comment}{}}
\DoxyCodeLine{4538 \textcolor{comment}{v0.6.11 -\/ 2020-\/05-\/26}}
\DoxyCodeLine{4539 \textcolor{comment}{  -\/ Fix use of uninitialized variable error.}}
\DoxyCodeLine{4540 \textcolor{comment}{}}
\DoxyCodeLine{4541 \textcolor{comment}{v0.6.10 -\/ 2020-\/05-\/16}}
\DoxyCodeLine{4542 \textcolor{comment}{  -\/ Add compile-\/time and run-\/time version querying.}}
\DoxyCodeLine{4543 \textcolor{comment}{    -\/ DRMP3\_VERSION\_MINOR}}
\DoxyCodeLine{4544 \textcolor{comment}{    -\/ DRMP3\_VERSION\_MAJOR}}
\DoxyCodeLine{4545 \textcolor{comment}{    -\/ DRMP3\_VERSION\_REVISION}}
\DoxyCodeLine{4546 \textcolor{comment}{    -\/ DRMP3\_VERSION\_STRING}}
\DoxyCodeLine{4547 \textcolor{comment}{    -\/ drmp3\_version()}}
\DoxyCodeLine{4548 \textcolor{comment}{    -\/ drmp3\_version\_string()}}
\DoxyCodeLine{4549 \textcolor{comment}{}}
\DoxyCodeLine{4550 \textcolor{comment}{v0.6.9 -\/ 2020-\/04-\/30}}
\DoxyCodeLine{4551 \textcolor{comment}{  -\/ Change the `pcm` parameter of drmp3dec\_decode\_frame() to a `const drmp3\_uint8*` for consistency with internal APIs.}}
\DoxyCodeLine{4552 \textcolor{comment}{}}
\DoxyCodeLine{4553 \textcolor{comment}{v0.6.8 -\/ 2020-\/04-\/26}}
\DoxyCodeLine{4554 \textcolor{comment}{  -\/ Optimizations to decoding when initializing from memory.}}
\DoxyCodeLine{4555 \textcolor{comment}{}}
\DoxyCodeLine{4556 \textcolor{comment}{v0.6.7 -\/ 2020-\/04-\/25}}
\DoxyCodeLine{4557 \textcolor{comment}{  -\/ Fix a compilation error with DR\_MP3\_NO\_STDIO}}
\DoxyCodeLine{4558 \textcolor{comment}{  -\/ Optimization to decoding by reducing some data movement.}}
\DoxyCodeLine{4559 \textcolor{comment}{}}
\DoxyCodeLine{4560 \textcolor{comment}{v0.6.6 -\/ 2020-\/04-\/23}}
\DoxyCodeLine{4561 \textcolor{comment}{  -\/ Fix a minor bug with the running PCM frame counter.}}
\DoxyCodeLine{4562 \textcolor{comment}{}}
\DoxyCodeLine{4563 \textcolor{comment}{v0.6.5 -\/ 2020-\/04-\/19}}
\DoxyCodeLine{4564 \textcolor{comment}{  -\/ Fix compilation error on ARM builds.}}
\DoxyCodeLine{4565 \textcolor{comment}{}}
\DoxyCodeLine{4566 \textcolor{comment}{v0.6.4 -\/ 2020-\/04-\/19}}
\DoxyCodeLine{4567 \textcolor{comment}{  -\/ Bring up to date with changes to minimp3.}}
\DoxyCodeLine{4568 \textcolor{comment}{}}
\DoxyCodeLine{4569 \textcolor{comment}{v0.6.3 -\/ 2020-\/04-\/13}}
\DoxyCodeLine{4570 \textcolor{comment}{  -\/ Fix some pedantic warnings.}}
\DoxyCodeLine{4571 \textcolor{comment}{}}
\DoxyCodeLine{4572 \textcolor{comment}{v0.6.2 -\/ 2020-\/04-\/10}}
\DoxyCodeLine{4573 \textcolor{comment}{  -\/ Fix a crash in drmp3\_open\_*\_and\_read\_pcm\_frames\_*() if the output config object is NULL.}}
\DoxyCodeLine{4574 \textcolor{comment}{}}
\DoxyCodeLine{4575 \textcolor{comment}{v0.6.1 -\/ 2020-\/04-\/05}}
\DoxyCodeLine{4576 \textcolor{comment}{  -\/ Fix warnings.}}
\DoxyCodeLine{4577 \textcolor{comment}{}}
\DoxyCodeLine{4578 \textcolor{comment}{v0.6.0 -\/ 2020-\/04-\/04}}
\DoxyCodeLine{4579 \textcolor{comment}{  -\/ API CHANGE: Remove the pConfig parameter from the following APIs:}}
\DoxyCodeLine{4580 \textcolor{comment}{    -\/ drmp3\_init()}}
\DoxyCodeLine{4581 \textcolor{comment}{    -\/ drmp3\_init\_memory()}}
\DoxyCodeLine{4582 \textcolor{comment}{    -\/ drmp3\_init\_file()}}
\DoxyCodeLine{4583 \textcolor{comment}{  -\/ Add drmp3\_init\_file\_w() for opening a file from a wchar\_t encoded path.}}
\DoxyCodeLine{4584 \textcolor{comment}{}}
\DoxyCodeLine{4585 \textcolor{comment}{v0.5.6 -\/ 2020-\/02-\/12}}
\DoxyCodeLine{4586 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4587 \textcolor{comment}{}}
\DoxyCodeLine{4588 \textcolor{comment}{v0.5.5 -\/ 2020-\/01-\/29}}
\DoxyCodeLine{4589 \textcolor{comment}{  -\/ Fix a memory allocation bug in high level s16 decoding APIs.}}
\DoxyCodeLine{4590 \textcolor{comment}{}}
\DoxyCodeLine{4591 \textcolor{comment}{v0.5.4 -\/ 2019-\/12-\/02}}
\DoxyCodeLine{4592 \textcolor{comment}{  -\/ Fix a possible null pointer dereference when using custom memory allocators for realloc().}}
\DoxyCodeLine{4593 \textcolor{comment}{}}
\DoxyCodeLine{4594 \textcolor{comment}{v0.5.3 -\/ 2019-\/11-\/14}}
\DoxyCodeLine{4595 \textcolor{comment}{  -\/ Fix typos in documentation.}}
\DoxyCodeLine{4596 \textcolor{comment}{}}
\DoxyCodeLine{4597 \textcolor{comment}{v0.5.2 -\/ 2019-\/11-\/02}}
\DoxyCodeLine{4598 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4599 \textcolor{comment}{}}
\DoxyCodeLine{4600 \textcolor{comment}{v0.5.1 -\/ 2019-\/10-\/08}}
\DoxyCodeLine{4601 \textcolor{comment}{  -\/ Fix a warning with GCC.}}
\DoxyCodeLine{4602 \textcolor{comment}{}}
\DoxyCodeLine{4603 \textcolor{comment}{v0.5.0 -\/ 2019-\/10-\/07}}
\DoxyCodeLine{4604 \textcolor{comment}{  -\/ API CHANGE: Add support for user defined memory allocation routines. This system allows the program to specify their own memory allocation}}
\DoxyCodeLine{4605 \textcolor{comment}{    routines with a user data pointer for client-\/specific contextual data. This adds an extra parameter to the end of the following APIs:}}
\DoxyCodeLine{4606 \textcolor{comment}{    -\/ drmp3\_init()}}
\DoxyCodeLine{4607 \textcolor{comment}{    -\/ drmp3\_init\_file()}}
\DoxyCodeLine{4608 \textcolor{comment}{    -\/ drmp3\_init\_memory()}}
\DoxyCodeLine{4609 \textcolor{comment}{    -\/ drmp3\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4610 \textcolor{comment}{    -\/ drmp3\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4611 \textcolor{comment}{    -\/ drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4612 \textcolor{comment}{    -\/ drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4613 \textcolor{comment}{    -\/ drmp3\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4614 \textcolor{comment}{    -\/ drmp3\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4615 \textcolor{comment}{  -\/ API CHANGE: Renamed the following APIs:}}
\DoxyCodeLine{4616 \textcolor{comment}{    -\/ drmp3\_open\_and\_read\_f32()        -\/> drmp3\_open\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4617 \textcolor{comment}{    -\/ drmp3\_open\_and\_read\_s16()        -\/> drmp3\_open\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4618 \textcolor{comment}{    -\/ drmp3\_open\_memory\_and\_read\_f32() -\/> drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4619 \textcolor{comment}{    -\/ drmp3\_open\_memory\_and\_read\_s16() -\/> drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4620 \textcolor{comment}{    -\/ drmp3\_open\_file\_and\_read\_f32()   -\/> drmp3\_open\_file\_and\_read\_pcm\_frames\_f32()}}
\DoxyCodeLine{4621 \textcolor{comment}{    -\/ drmp3\_open\_file\_and\_read\_s16()   -\/> drmp3\_open\_file\_and\_read\_pcm\_frames\_s16()}}
\DoxyCodeLine{4622 \textcolor{comment}{}}
\DoxyCodeLine{4623 \textcolor{comment}{v0.4.7 -\/ 2019-\/07-\/28}}
\DoxyCodeLine{4624 \textcolor{comment}{  -\/ Fix a compiler error.}}
\DoxyCodeLine{4625 \textcolor{comment}{}}
\DoxyCodeLine{4626 \textcolor{comment}{v0.4.6 -\/ 2019-\/06-\/14}}
\DoxyCodeLine{4627 \textcolor{comment}{  -\/ Fix a compiler error.}}
\DoxyCodeLine{4628 \textcolor{comment}{}}
\DoxyCodeLine{4629 \textcolor{comment}{v0.4.5 -\/ 2019-\/06-\/06}}
\DoxyCodeLine{4630 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4631 \textcolor{comment}{}}
\DoxyCodeLine{4632 \textcolor{comment}{v0.4.4 -\/ 2019-\/05-\/06}}
\DoxyCodeLine{4633 \textcolor{comment}{  -\/ Fixes to the VC6 build.}}
\DoxyCodeLine{4634 \textcolor{comment}{}}
\DoxyCodeLine{4635 \textcolor{comment}{v0.4.3 -\/ 2019-\/05-\/05}}
\DoxyCodeLine{4636 \textcolor{comment}{  -\/ Use the channel count and/or sample rate of the first MP3 frame instead of DRMP3\_DEFAULT\_CHANNELS and}}
\DoxyCodeLine{4637 \textcolor{comment}{    DRMP3\_DEFAULT\_SAMPLE\_RATE when they are set to 0. To use the old behaviour, just set the relevant property to}}
\DoxyCodeLine{4638 \textcolor{comment}{    DRMP3\_DEFAULT\_CHANNELS or DRMP3\_DEFAULT\_SAMPLE\_RATE.}}
\DoxyCodeLine{4639 \textcolor{comment}{  -\/ Add s16 reading APIs}}
\DoxyCodeLine{4640 \textcolor{comment}{    -\/ drmp3\_read\_pcm\_frames\_s16}}
\DoxyCodeLine{4641 \textcolor{comment}{    -\/ drmp3\_open\_memory\_and\_read\_pcm\_frames\_s16}}
\DoxyCodeLine{4642 \textcolor{comment}{    -\/ drmp3\_open\_and\_read\_pcm\_frames\_s16}}
\DoxyCodeLine{4643 \textcolor{comment}{    -\/ drmp3\_open\_file\_and\_read\_pcm\_frames\_s16}}
\DoxyCodeLine{4644 \textcolor{comment}{  -\/ Add drmp3\_get\_mp3\_and\_pcm\_frame\_count() to the public header section.}}
\DoxyCodeLine{4645 \textcolor{comment}{  -\/ Add support for C89.}}
\DoxyCodeLine{4646 \textcolor{comment}{  -\/ Change license to choice of public domain or MIT-\/0.}}
\DoxyCodeLine{4647 \textcolor{comment}{}}
\DoxyCodeLine{4648 \textcolor{comment}{v0.4.2 -\/ 2019-\/02-\/21}}
\DoxyCodeLine{4649 \textcolor{comment}{  -\/ Fix a warning.}}
\DoxyCodeLine{4650 \textcolor{comment}{}}
\DoxyCodeLine{4651 \textcolor{comment}{v0.4.1 -\/ 2018-\/12-\/30}}
\DoxyCodeLine{4652 \textcolor{comment}{  -\/ Fix a warning.}}
\DoxyCodeLine{4653 \textcolor{comment}{}}
\DoxyCodeLine{4654 \textcolor{comment}{v0.4.0 -\/ 2018-\/12-\/16}}
\DoxyCodeLine{4655 \textcolor{comment}{  -\/ API CHANGE: Rename some APIs:}}
\DoxyCodeLine{4656 \textcolor{comment}{    -\/ drmp3\_read\_f32 -\/> to drmp3\_read\_pcm\_frames\_f32}}
\DoxyCodeLine{4657 \textcolor{comment}{    -\/ drmp3\_seek\_to\_frame -\/> drmp3\_seek\_to\_pcm\_frame}}
\DoxyCodeLine{4658 \textcolor{comment}{    -\/ drmp3\_open\_and\_decode\_f32 -\/> drmp3\_open\_and\_read\_pcm\_frames\_f32}}
\DoxyCodeLine{4659 \textcolor{comment}{    -\/ drmp3\_open\_and\_decode\_memory\_f32 -\/> drmp3\_open\_memory\_and\_read\_pcm\_frames\_f32}}
\DoxyCodeLine{4660 \textcolor{comment}{    -\/ drmp3\_open\_and\_decode\_file\_f32 -\/> drmp3\_open\_file\_and\_read\_pcm\_frames\_f32}}
\DoxyCodeLine{4661 \textcolor{comment}{  -\/ Add drmp3\_get\_pcm\_frame\_count().}}
\DoxyCodeLine{4662 \textcolor{comment}{  -\/ Add drmp3\_get\_mp3\_frame\_count().}}
\DoxyCodeLine{4663 \textcolor{comment}{  -\/ Improve seeking performance.}}
\DoxyCodeLine{4664 \textcolor{comment}{}}
\DoxyCodeLine{4665 \textcolor{comment}{v0.3.2 -\/ 2018-\/09-\/11}}
\DoxyCodeLine{4666 \textcolor{comment}{  -\/ Fix a couple of memory leaks.}}
\DoxyCodeLine{4667 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4668 \textcolor{comment}{}}
\DoxyCodeLine{4669 \textcolor{comment}{v0.3.1 -\/ 2018-\/08-\/25}}
\DoxyCodeLine{4670 \textcolor{comment}{  -\/ Fix C++ build.}}
\DoxyCodeLine{4671 \textcolor{comment}{}}
\DoxyCodeLine{4672 \textcolor{comment}{v0.3.0 -\/ 2018-\/08-\/25}}
\DoxyCodeLine{4673 \textcolor{comment}{  -\/ Bring up to date with minimp3. This has a minor API change: the "{}pcm"{} parameter of drmp3dec\_decode\_frame() has}}
\DoxyCodeLine{4674 \textcolor{comment}{    been changed from short* to void* because it can now output both s16 and f32 samples, depending on whether or}}
\DoxyCodeLine{4675 \textcolor{comment}{    not the DR\_MP3\_FLOAT\_OUTPUT option is set.}}
\DoxyCodeLine{4676 \textcolor{comment}{}}
\DoxyCodeLine{4677 \textcolor{comment}{v0.2.11 -\/ 2018-\/08-\/08}}
\DoxyCodeLine{4678 \textcolor{comment}{  -\/ Fix a bug where the last part of a file is not read.}}
\DoxyCodeLine{4679 \textcolor{comment}{}}
\DoxyCodeLine{4680 \textcolor{comment}{v0.2.10 -\/ 2018-\/08-\/07}}
\DoxyCodeLine{4681 \textcolor{comment}{  -\/ Improve 64-\/bit detection.}}
\DoxyCodeLine{4682 \textcolor{comment}{}}
\DoxyCodeLine{4683 \textcolor{comment}{v0.2.9 -\/ 2018-\/08-\/05}}
\DoxyCodeLine{4684 \textcolor{comment}{  -\/ Fix C++ build on older versions of GCC.}}
\DoxyCodeLine{4685 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4686 \textcolor{comment}{}}
\DoxyCodeLine{4687 \textcolor{comment}{v0.2.8 -\/ 2018-\/08-\/02}}
\DoxyCodeLine{4688 \textcolor{comment}{  -\/ Fix compilation errors with older versions of GCC.}}
\DoxyCodeLine{4689 \textcolor{comment}{}}
\DoxyCodeLine{4690 \textcolor{comment}{v0.2.7 -\/ 2018-\/07-\/13}}
\DoxyCodeLine{4691 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4692 \textcolor{comment}{}}
\DoxyCodeLine{4693 \textcolor{comment}{v0.2.6 -\/ 2018-\/07-\/12}}
\DoxyCodeLine{4694 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4695 \textcolor{comment}{}}
\DoxyCodeLine{4696 \textcolor{comment}{v0.2.5 -\/ 2018-\/06-\/22}}
\DoxyCodeLine{4697 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4698 \textcolor{comment}{}}
\DoxyCodeLine{4699 \textcolor{comment}{v0.2.4 -\/ 2018-\/05-\/12}}
\DoxyCodeLine{4700 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4701 \textcolor{comment}{}}
\DoxyCodeLine{4702 \textcolor{comment}{v0.2.3 -\/ 2018-\/04-\/29}}
\DoxyCodeLine{4703 \textcolor{comment}{  -\/ Fix TCC build.}}
\DoxyCodeLine{4704 \textcolor{comment}{}}
\DoxyCodeLine{4705 \textcolor{comment}{v0.2.2 -\/ 2018-\/04-\/28}}
\DoxyCodeLine{4706 \textcolor{comment}{  -\/ Fix bug when opening a decoder from memory.}}
\DoxyCodeLine{4707 \textcolor{comment}{}}
\DoxyCodeLine{4708 \textcolor{comment}{v0.2.1 -\/ 2018-\/04-\/27}}
\DoxyCodeLine{4709 \textcolor{comment}{  -\/ Efficiency improvements when the decoder reaches the end of the stream.}}
\DoxyCodeLine{4710 \textcolor{comment}{}}
\DoxyCodeLine{4711 \textcolor{comment}{v0.2 -\/ 2018-\/04-\/21}}
\DoxyCodeLine{4712 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4713 \textcolor{comment}{  -\/ Start using major.minor.revision versioning.}}
\DoxyCodeLine{4714 \textcolor{comment}{}}
\DoxyCodeLine{4715 \textcolor{comment}{v0.1d -\/ 2018-\/03-\/30}}
\DoxyCodeLine{4716 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4717 \textcolor{comment}{}}
\DoxyCodeLine{4718 \textcolor{comment}{v0.1c -\/ 2018-\/03-\/11}}
\DoxyCodeLine{4719 \textcolor{comment}{  -\/ Fix C++ build error.}}
\DoxyCodeLine{4720 \textcolor{comment}{}}
\DoxyCodeLine{4721 \textcolor{comment}{v0.1b -\/ 2018-\/03-\/07}}
\DoxyCodeLine{4722 \textcolor{comment}{  -\/ Bring up to date with minimp3.}}
\DoxyCodeLine{4723 \textcolor{comment}{}}
\DoxyCodeLine{4724 \textcolor{comment}{v0.1a -\/ 2018-\/02-\/28}}
\DoxyCodeLine{4725 \textcolor{comment}{  -\/ Fix compilation error on GCC/Clang.}}
\DoxyCodeLine{4726 \textcolor{comment}{  -\/ Fix some warnings.}}
\DoxyCodeLine{4727 \textcolor{comment}{}}
\DoxyCodeLine{4728 \textcolor{comment}{v0.1 -\/ 2018-\/02-\/xx}}
\DoxyCodeLine{4729 \textcolor{comment}{  -\/ Initial versioned release.}}
\DoxyCodeLine{4730 \textcolor{comment}{*/}}
\DoxyCodeLine{4731 }
\DoxyCodeLine{4732 \textcolor{comment}{/*}}
\DoxyCodeLine{4733 \textcolor{comment}{This software is available as a choice of the following licenses. Choose}}
\DoxyCodeLine{4734 \textcolor{comment}{whichever you prefer.}}
\DoxyCodeLine{4735 \textcolor{comment}{}}
\DoxyCodeLine{4736 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{4737 \textcolor{comment}{ALTERNATIVE 1 -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{4738 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{4739 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{4740 \textcolor{comment}{}}
\DoxyCodeLine{4741 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{4742 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{4743 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{4744 \textcolor{comment}{}}
\DoxyCodeLine{4745 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{4746 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{4747 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{4748 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{4749 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{4750 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{4751 \textcolor{comment}{}}
\DoxyCodeLine{4752 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{4753 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{4754 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{4755 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{4756 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{4757 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{4758 \textcolor{comment}{}}
\DoxyCodeLine{4759 \textcolor{comment}{For more information, please refer to <http://unlicense.org/>}}
\DoxyCodeLine{4760 \textcolor{comment}{}}
\DoxyCodeLine{4761 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{4762 \textcolor{comment}{ALTERNATIVE 2 -\/ MIT No Attribution}}
\DoxyCodeLine{4763 \textcolor{comment}{===============================================================================}}
\DoxyCodeLine{4764 \textcolor{comment}{Copyright 2020 David Reid}}
\DoxyCodeLine{4765 \textcolor{comment}{}}
\DoxyCodeLine{4766 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{4767 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{4768 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{4769 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{4770 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{4771 \textcolor{comment}{so.}}
\DoxyCodeLine{4772 \textcolor{comment}{}}
\DoxyCodeLine{4773 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{4774 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{4775 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{4776 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{4777 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{4778 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{4779 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{4780 \textcolor{comment}{*/}}
\DoxyCodeLine{4781 }
\DoxyCodeLine{4782 \textcolor{comment}{/*}}
\DoxyCodeLine{4783 \textcolor{comment}{    https://github.com/lieff/minimp3}}
\DoxyCodeLine{4784 \textcolor{comment}{    To the extent possible under law, the author(s) have dedicated all copyright and related and neighboring rights to this software to the public domain worldwide.}}
\DoxyCodeLine{4785 \textcolor{comment}{    This software is distributed without any warranty.}}
\DoxyCodeLine{4786 \textcolor{comment}{    See <http://creativecommons.org/publicdomain/zero/1.0/>.}}
\DoxyCodeLine{4787 \textcolor{comment}{*/}}

\end{DoxyCode}
